<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="933px" preserveAspectRatio="none" style="width:1007px;height:933px;" version="1.1" viewBox="0 0 1007 933" width="1007px" zoomAndPan="magnify"><defs><filter height="300%" id="f6ycmeqv3v014" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="20" font-weight="bold" lengthAdjust="spacing" textLength="271" x="361.5" y="18.5645">Stroom Logical Architecture</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="173" x="389.5" y="39.9893">Client connections in</text><text fill="#0000FF" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="37" x="567.5" y="39.9893">blue</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="260" x="340.5" y="60.9424">Reverse proxied connections in</text><text fill="#008000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="48" x="605.5" y="60.9424">green</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="458" x="213.5" y="81.8955">Effective connections (ignoring nginx reverse proxying)</text><text fill="#808080" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="104" x="676.5" y="81.8955">dashed grey</text><!--MD5=[bf51939d10c4f1fcb727a44d3ddbdd25]
cluster stroom estate--><rect fill="#FFFFFF" filter="url(#f6ycmeqv3v014)" height="673" style="stroke:#000000;stroke-width:1.5;" width="988" x="7" y="248.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="101" x="450.5" y="263.1357">stroom estate</text><!--MD5=[fa6e3a9222af9f8270524df4a8c73c70]
cluster stroom_all_dbs--><path d="M207,772.1406 C207,762.1406 395,762.1406 395,762.1406 C395,762.1406 583,762.1406 583,772.1406 L583,887.1406 C583,897.1406 395,897.1406 395,897.1406 C395,897.1406 207,897.1406 207,887.1406 L207,772.1406 " fill="#FFFFFF" filter="url(#f6ycmeqv3v014)" style="stroke:#000000;stroke-width:1.5;"/><path d="M207,772.1406 C207,782.1406 395,782.1406 395,782.1406 C395,782.1406 583,782.1406 583,772.1406 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="53" x="368.5" y="797.1357">«mysql»</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="105" x="342.5" y="813.4326">stroom_all_dbs</text><!--MD5=[8824c66cba45be527cf3dd56bcd70cd2]
entity nginx--><polygon fill="#FEFECE" filter="url(#f6ycmeqv3v014)" points="436,293.1406,446,283.1406,560,283.1406,560,335.7344,550,345.7344,436,345.7344,436,293.1406" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="550" x2="560" y1="293.1406" y2="283.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="436" x2="550" y1="293.1406" y2="293.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="550" x2="550" y1="293.1406" y2="345.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="84" x="451" y="316.1357">«web server»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="476" y="332.4326">nginx</text><!--MD5=[ce712441c445748376048ba9369e1787]
entity stroom_auth_ui_nginx--><polygon fill="#FEFECE" filter="url(#f6ycmeqv3v014)" points="23,500.1406,33,490.1406,197,490.1406,197,542.7344,187,552.7344,23,552.7344,23,500.1406" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="187" x2="197" y1="500.1406" y2="490.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="23" x2="187" y1="500.1406" y2="500.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="187" x2="187" y1="500.1406" y2="552.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="84" x="63" y="523.1357">«web server»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="38" y="539.4326">stroom-auth-ui nginx</text><!--MD5=[4d35d13dc2ac8356870cbe0936c1d7d9]
entity stroom_auth_service_dropwiz--><polygon fill="#FEFECE" filter="url(#f6ycmeqv3v014)" points="232,500.1406,242,490.1406,402,490.1406,402,542.7344,392,552.7344,232,552.7344,232,500.1406" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="392" x2="402" y1="500.1406" y2="490.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="232" x2="392" y1="500.1406" y2="500.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="392" x2="392" y1="500.1406" y2="552.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="66" x="279" y="523.1357">«java app»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="247" y="539.4326">stroom-auth-service</text><!--MD5=[86aea49c4f2a65fdacf06468b1745a8a]
entity stroom_dropwiz--><polygon fill="#FEFECE" filter="url(#f6ycmeqv3v014)" points="468,662.1406,478,652.1406,574,652.1406,574,704.7344,564,714.7344,468,714.7344,468,662.1406" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="564" x2="574" y1="662.1406" y2="652.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="468" x2="564" y1="662.1406" y2="662.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="564" x2="564" y1="662.1406" y2="714.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="66" x="483" y="685.1357">«java app»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="493" y="701.4326">stroom</text><!--MD5=[c975d85d39155e291a3db48688621a0f]
entity stroom_proxy_dropwiz--><polygon fill="#FEFECE" filter="url(#f6ycmeqv3v014)" points="437,500.1406,447,490.1406,605,490.1406,605,542.7344,595,552.7344,437,552.7344,437,500.1406" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="595" x2="605" y1="500.1406" y2="490.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="437" x2="595" y1="500.1406" y2="500.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="595" x2="595" y1="500.1406" y2="552.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="66" x="483" y="523.1357">«java app»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="452" y="539.4326">stroom-proxy (local)</text><!--MD5=[c3d424efc77a9e66034b64d0570dbfed]
entity stroom_log_sender_script--><polygon fill="#FEFECE" filter="url(#f6ycmeqv3v014)" points="143.5,293.1406,153.5,283.1406,302.5,283.1406,302.5,335.7344,292.5,345.7344,143.5,345.7344,143.5,293.1406" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="292.5" x2="302.5" y1="293.1406" y2="283.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="143.5" x2="292.5" y1="293.1406" y2="293.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="292.5" x2="292.5" y1="293.1406" y2="345.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="50" x="193" y="316.1357">«script»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="158.5" y="332.4326">stroom-log-sender</text><!--MD5=[40b2f2205cc740157f5e31447dce3a90]
entity stroom_db--><rect fill="#FEFECE" filter="url(#f6ycmeqv3v014)" height="52.5938" rx="35" ry="35" style="stroke:#000000;stroke-width:1.5;" width="91" x="475.5" y="828.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="71" x="485.5" y="851.1357">«database»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="498" y="867.4326">stroom</text><!--MD5=[4556cb27c697ea38b95df37aa8ac3618]
entity stroom_stats_db--><rect fill="#FEFECE" filter="url(#f6ycmeqv3v014)" height="52.5938" rx="35" ry="35" style="stroke:#000000;stroke-width:1.5;" width="91" x="349.5" y="828.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="71" x="359.5" y="851.1357">«database»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="379.5" y="867.4326">stats</text><!--MD5=[3b81d93e285c59cc92c49b55358c67ba]
entity stroom_auth_db--><rect fill="#FEFECE" filter="url(#f6ycmeqv3v014)" height="52.5938" rx="35" ry="35" style="stroke:#000000;stroke-width:1.5;" width="91" x="223.5" y="828.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="71" x="233.5" y="851.1357">«database»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="255" y="867.4326">auth</text><!--MD5=[960860b3b3295bcd1d432a531990153b]
entity dataload_client_app--><polygon fill="#FEFECE" filter="url(#f6ycmeqv3v014)" points="168,102.1406,178,92.1406,308,92.1406,308,144.7344,298,154.7344,168,154.7344,168,102.1406" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="298" x2="308" y1="102.1406" y2="92.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="168" x2="298" y1="102.1406" y2="102.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="298" x2="298" y1="102.1406" y2="154.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="84" x="191" y="125.1357">«application»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="183" y="141.4326">Event generator</text><!--MD5=[3677200128df26b0ab79a654f7c368fe]
entity ui_client_browser--><polygon fill="#FEFECE" filter="url(#f6ycmeqv3v014)" points="346.5,102.1406,356.5,92.1406,481.5,92.1406,481.5,144.7344,471.5,154.7344,346.5,154.7344,346.5,102.1406" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="471.5" x2="481.5" y1="102.1406" y2="92.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="346.5" x2="471.5" y1="102.1406" y2="102.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="471.5" x2="471.5" y1="102.1406" y2="154.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="95" x="361.5" y="125.1357">«web browser»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="367" y="141.4326">Web browser</text><!--MD5=[2de77eb5f4a5ea603a06f959b37fb769]
entity api_client_app--><polygon fill="#FEFECE" filter="url(#f6ycmeqv3v014)" points="517,102.1406,527,92.1406,641,92.1406,641,144.7344,631,154.7344,517,154.7344,517,102.1406" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="631" x2="641" y1="102.1406" y2="92.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="517" x2="631" y1="102.1406" y2="102.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="631" x2="631" y1="102.1406" y2="154.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="84" x="532" y="125.1357">«application»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="543" y="141.4326">API client</text><!--MD5=[fe6f05c8cee4bc5bf69b8554e9ede833]
entity remote_proxy--><polygon fill="#FEFECE" filter="url(#f6ycmeqv3v014)" points="676,102.1406,686,92.1406,856,92.1406,856,144.7344,846,154.7344,676,154.7344,676,102.1406" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="846" x2="856" y1="102.1406" y2="92.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="676" x2="846" y1="102.1406" y2="102.1406"/><line style="stroke:#000000;stroke-width:1.5;" x1="846" x2="846" y1="102.1406" y2="154.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="84" x="719" y="125.1357">«application»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="691" y="141.4326">Remote stroom-proxy</text><!--MD5=[933c8918fff6242c0a2d1d5b74e9d808]
link stroom_auth_service_dropwiz to stroom_auth_db--><path d="M247.59,553.2706 C233.34,562.9306 220.2,575.1106 212,590.1406 C169.98,667.1006 219.99,772.5406 249.83,823.5606 " fill="none" id="stroom_auth_service_dropwiz-to-stroom_auth_db" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="252.48,828.0306,251.3419,818.2478,249.9349,823.7268,244.4558,822.3199,252.48,828.0306" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[eff598a3d230a4b3fe1489c601efcf46]
link stroom_dropwiz to stroom_db--><path d="M521,715.2406 C521,745.7306 521,792.2706 521,822.8206 " fill="none" id="stroom_dropwiz-to-stroom_db" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="521,827.9606,525,818.9606,521,822.9606,517,818.9606,521,827.9606" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[4f990febc6486ab9063d0139f8e9efdc]
link stroom_dropwiz to stroom_stats_db--><path d="M490.95,715.4806 C480.1,727.2006 468.06,740.9206 458,754.1406 C441.08,776.3806 424.27,803.2306 412.28,823.4306 " fill="none" id="stroom_dropwiz-to-stroom_stats_db" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="409.64,827.8906,417.6642,822.1799,412.1851,823.5868,410.7781,818.1078,409.64,827.8906" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[989ef6e3dbf0f2cd69ae14acc8487b5d]
link ui_client_browser to nginx--><path d="M427.26,155.2706 C436.61,176.8106 449.48,206.2806 461,232.1406 C467.76,247.3206 475.33,264.0306 481.85,278.3506 " fill="none" id="ui_client_browser-to-nginx" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="484.02,283.1106,483.9372,273.2621,481.951,278.5588,476.6543,276.5725,484.02,283.1106" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="463" y="205.7075">HTTPS:443</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="462" y="220.8403">/stroom/ui</text><!--MD5=[f8c9e3aec2baf3f57b61323ecf9cc273]
link api_client_app to nginx--><path d="M565.81,155.4306 C551.39,189.0606 528.34,242.8606 513.18,278.2206 " fill="none" id="api_client_app-to-nginx" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="511.19,282.8706,518.4119,276.174,513.1596,278.2749,511.0587,273.0226,511.19,282.8706" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="554" y="205.7075">HTTPS:443</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="573" y="220.8403">/api</text><!--MD5=[a4e1cfae1c63071152643add18806a87]
link dataload_client_app to nginx--><path d="M246.71,155.2506 C255.09,179.3906 270.07,212.2106 294,232.1406 C303.29,239.8806 308.62,236.0506 320,240.1406 C357.19,253.5106 397.97,270.2006 431.11,284.2906 " fill="none" id="dataload_client_app-to-nginx" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="435.95,286.3506,429.2344,279.1464,431.3491,284.3931,426.1024,286.5078,435.95,286.3506" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="333.5" y="205.7075">HTTPS:443</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="295" y="220.8403">/datafeed(direct) POSTs</text><!--MD5=[fb1d713660c745da3a71d8c4842aab4b]
link remote_proxy to nginx--><path d="M727.1,155.3206 C698.88,177.2706 659.58,207.2106 624,232.1406 C600.6,248.5406 574.12,265.8406 551.49,280.2706 " fill="none" id="remote_proxy-to-nginx" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="547.02,283.1206,556.7595,281.657,551.2365,280.4335,552.4601,274.9105,547.02,283.1206" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="727.5" y="198.2075">HTTPS:443</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="725" y="213.3403">/feedstatus</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="689" y="228.4731">/datafeed(direct) POSTs</text><!--MD5=[8066c330616ff30344d2bc14b3a7392c]
link stroom_dropwiz to nginx--><path d="M574.14,669.4106 C598.82,660.3606 625.96,645.6206 641,622.1406 C679.51,562.0206 668.73,408.4106 647,376.1406 C628.57,348.7706 595.41,333.7806 565.04,325.5706 " fill="none" id="stroom_dropwiz-to-nginx" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="560.19,324.3106,567.8962,330.4436,565.0296,325.5669,569.9063,322.7003,560.19,324.3106" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="714.5" y="503.7075">HTTP:80</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="695" y="518.8403">Authentication</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="709.5" y="533.9731">REST calls</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="668" y="549.106">(to stroom-auth-service)</text><!--MD5=[bf0769b61f4aa6b7ccd3d02a7a51964e]
link nginx to stroom_dropwiz--><path d="M560.12,326.5306 C637.88,343.9906 766.94,386.6706 817,483.1406 C832.76,513.5206 836.02,531.6906 817,560.1406 C763.96,639.5006 648.99,667.5106 578.97,677.3506 " fill="none" id="nginx-to-stroom_dropwiz" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="574.01,678.0306,583.4654,680.7864,578.9648,677.3595,582.3917,672.8588,574.01,678.0306" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="845.5" y="496.2075">HTTP:8080</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="852.5" y="511.3403">/stroom</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="864.5" y="526.4731">/api</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="831" y="541.606">/datafeeddirect</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="845.5" y="556.7388">Rev. proxy</text><!--MD5=[bbde8797b048df9cb48c0a03dc9a7f2a]
link stroom_auth_service_dropwiz to nginx--><path d="M328.38,490.0106 C341.26,458.5306 364.72,409.5406 397,376.1406 C406.93,365.8606 418.97,356.6906 431.23,348.7806 " fill="none" id="stroom_auth_service_dropwiz-to-nginx" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="435.75,345.9206,426.0048,347.3458,431.5229,348.5911,430.2776,354.1092,435.75,345.9206" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="414.5" y="396.7075">HTTP:80</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="398" y="411.8403">Authorisation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="409.5" y="426.9731">REST calls</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="405.5" y="442.106">(to stroom)</text><!--MD5=[bd542ee22d6f7e143c45175079b67844]
link nginx to stroom_auth_service_dropwiz--><path d="M435.94,324.0706 C377.27,333.4606 295.4,350.7406 276,376.1406 C251.56,408.1406 271.51,454.1006 291.2,485.5506 " fill="none" id="nginx-to-stroom_auth_service_dropwiz" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="294.1,490.0806,292.6129,480.3447,291.4027,485.8706,285.8768,484.6604,294.1,490.0806" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="277" y="404.2075">HTTP:8099</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="280" y="419.3403">/api/auth</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="277" y="434.4731">Rev. proxy</text><!--MD5=[7ba3628c1b5996396710a0aab81a7175]
link stroom_proxy_dropwiz to nginx--><path d="M544.44,490.0306 C551.52,479.0006 558.38,466.0806 562,453.1406 C571.22,420.1806 575.54,407.5706 562,376.1406 C557.84,366.4906 551.3,357.6506 543.96,349.9006 " fill="none" id="stroom_proxy_dropwiz-to-nginx" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="540.29,346.1806,543.7698,355.3943,543.804,349.7375,549.4608,349.7718,540.29,346.1806" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="574.5" y="396.7075">HTTPS:443</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="572" y="411.8403">Feed status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="576.5" y="426.9731">REST calls</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="572.5" y="442.106">(to stroom)</text><!--MD5=[e2675319a6e5076e1cd90accd23bb7bc]
link nginx to stroom_proxy_dropwiz--><path d="M491.96,346.3106 C487.47,374.4106 483.33,417.0206 491,453.1406 C493.31,464.0206 497.5,475.2706 502.02,485.4006 " fill="none" id="nginx-to-stroom_proxy_dropwiz" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="504.12,489.9706,504,480.1225,502.0338,485.4267,496.7296,483.4605,504.12,489.9706" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="492" y="404.2075">HTTP:8090</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="494" y="419.3403">/datafeed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="492" y="434.4731">Rev. proxy</text><!--MD5=[e1d53fe24ae918fdefed786cd6fae00a]
link stroom_log_sender_script to nginx--><path d="M302.54,314.6406 C343.08,314.6406 391.83,314.6406 430.51,314.6406 " fill="none" id="stroom_log_sender_script-to-nginx" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="435.66,314.6406,426.66,310.6406,430.66,314.6406,426.66,318.6406,435.66,314.6406" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="338.75" y="292.7075">HTTPS:443</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="320.75" y="307.8403">/datafeed POSTs</text><!--MD5=[fab8689ddda3c2cb0bc5d52ba1764e27]
link nginx to stroom_auth_ui_nginx--><path d="M435.78,326.6706 C349.74,342.1306 203.84,369.1106 194,376.1406 C156.64,402.8306 133.38,451.7206 121.05,485.1806 " fill="none" id="nginx-to-stroom_auth_ui_nginx" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="119.31,490.0006,126.1258,482.8912,121.0061,485.2971,118.6002,480.1774,119.31,490.0006" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="195" y="389.2075">HTTP:9443</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="204" y="404.3403">/authui</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="208" y="419.4731">/static</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="11" x="220" y="434.606">/s</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="195" y="449.7388">Rev. proxy</text><!--MD5=[1192e40102ab0c7bbd0ad3fbe8173e17]
link stroom_dropwiz to stroom_auth_service_dropwiz--><path d="M467.98,657.3606 C449.51,647.4906 429.13,635.3706 412,622.1406 C404.93,616.6806 373.66,583.6006 348.91,557.0706 " fill="none" id="stroom_dropwiz-to-stroom_auth_service_dropwiz" style="stroke:#808080;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#808080" points="345.3,553.2006,348.4985,562.5157,348.7044,556.8626,354.3576,557.0685,345.3,553.2006" style="stroke:#808080;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="452.5" y="603.2075">HTTP:8099</text><text fill="#808080" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="413" y="618.3403">Authorisation REST calls</text><!--MD5=[6f82faaecb0e8ff916e3d0198401298f]
link stroom_auth_service_dropwiz to stroom_dropwiz--><path d="M259.88,553.2106 C231.27,572.4906 206.47,598.2006 226,622.1406 C255.31,658.0706 385.6,673.2506 462.88,679.1906 " fill="none" id="stroom_auth_service_dropwiz-to-stroom_dropwiz" style="stroke:#808080;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#808080" points="467.89,679.5706,459.212,674.913,462.9038,679.1992,458.6177,682.8909,467.89,679.5706" style="stroke:#808080;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="269.5" y="603.2075">HTTP:8080</text><text fill="#808080" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="227" y="618.3403">Authentication REST calls</text><!--MD5=[cf0cec77f57ec00c7d19119f941c400d]
link stroom_proxy_dropwiz to stroom_dropwiz--><path d="M545.63,553.4606 C558.11,572.8506 569.24,598.5606 562,622.1406 C559.3,630.9406 554.83,639.6106 549.82,647.5206 " fill="none" id="stroom_proxy_dropwiz-to-stroom_dropwiz" style="stroke:#808080;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#808080" points="546.99,651.8406,555.2685,646.5053,549.7305,647.6585,548.5772,642.1205,546.99,651.8406" style="stroke:#808080;stroke-width:1.0;"/><text fill="#808080" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="568.5" y="603.2075">HTTP:8080</text><text fill="#808080" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="566" y="618.3403">Feed status</text><!--MD5=[a4b7a2edcb19a71f0210dee5a8905c61]
@startuml

title
    ==Stroom Logical Architecture
    Client connections in <color:blue>blue</color>
    Reverse proxied connections in <color:green>green</color>
    Effective connections (ignoring nginx reverse proxying) <color:grey>dashed grey</color>
end title

'Define the various application ports
!stroom_auth_service_port=8099
!stroom_auth_ui_port=9443
!stroom_port=8080
!stroom_proxy_port=8090

'Define all the nodes (services, actors, etc.)
node "Event generator" as dataload_client_app <<application>>
node "Web browser" as ui_client_browser <<web browser>>
node "API client" as api_client_app <<application>>
node "Remote stroom-proxy" as remote_proxy <<application>>

rectangle "stroom estate" {
    node "nginx" as nginx <<web server>>
    node "stroom-auth-ui nginx" as stroom_auth_ui_nginx <<web server>>
    node "stroom-auth-service" as stroom_auth_service_dropwiz <<java app>>
    node "stroom" as stroom_dropwiz <<java app>>
    node "stroom-proxy (local)" as stroom_proxy_dropwiz <<java app>>
    node "stroom-log-sender" as stroom_log_sender_script <<script>>

    database stroom_all_dbs <<mysql>> {
        storage "stroom" as stroom_db <<database>>
        storage "stats" as stroom_stats_db <<database>>
        storage "auth" as stroom_auth_db <<database>>
    }
}

'DB connections
stroom_auth_service_dropwiz - -> stroom_auth_db
stroom_dropwiz - -> stroom_db
stroom_dropwiz - -> stroom_stats_db

'Client connections
ui_client_browser -[#Blue]-> nginx : HTTPS:443\n/stroom/ui
api_client_app -[#Blue]-> nginx : HTTPS:443\n/api
dataload_client_app -[#Blue]-> nginx : HTTPS:443\n/datafeed(direct) POSTs
remote_proxy -[#Blue]-> nginx : HTTPS:443\n/feedstatus\n/datafeed(direct) POSTs

' Inter-service REST calls to nginx api gateway
stroom_dropwiz - -> nginx     : HTTP:80\nAuthentication\nREST calls\n(to stroom-auth-service)
stroom_auth_service_dropwiz - -> nginx     : HTTP:80\nAuthorisation\nREST calls\n(to stroom)
stroom_proxy_dropwiz - -> nginx     : HTTPS:443\nFeed status\nREST calls\n(to stroom)
stroom_log_sender_script -right-> nginx     : HTTPS:443\n/datafeed POSTs

'Reverse proxy connections
nginx -[#Green]-> stroom_dropwiz : HTTP:stroom_port\n/stroom\n/api\n/datafeeddirect\nRev. proxy
nginx -[#Green]-> stroom_proxy_dropwiz : HTTP:stroom_proxy_port\n/datafeed\nRev. proxy
nginx -[#Green]-> stroom_auth_ui_nginx : HTTP:stroom_auth_ui_port\n/authui\n/static\n/s\nRev. proxy
nginx -[#Green]-> stroom_auth_service_dropwiz : HTTP:stroom_auth_service_port\n/api/auth\nRev. proxy

'Effective connections (i.e. ignoring ngix gateway)
stroom_dropwiz .[#Grey].> stroom_auth_service_dropwiz     : <color:Grey>HTTP:stroom_auth_service_port</color>\n<color:Grey>Authorisation REST calls</color>
stroom_proxy_dropwiz .[#Grey].> stroom_dropwiz     : <color:Grey>HTTP:stroom_port</color>\n<color:Grey>Feed status</color>
stroom_auth_service_dropwiz .[#Grey].> stroom_dropwiz     : <color:Grey>HTTP:stroom_port</color>\n<color:Grey>Authentication REST calls</color>

' see http://plantuml.com/skinparam & https://github.com/plantuml/plantuml/pull/31

'skinparam handwritten true
'skinparam monochrome reverse
'skinparam backgroundColor DimGrey
'skinparam ClassBackgroundColor DimGrey
'skinparam ClassBorderColor WhiteSmoke
'skinparam backgroundColor transparent

' light theme
'skinparam backgroundColor LightGrey
'skinparam ClassBackgroundColor LightGrey
'skinparam ClassBorderColor CornflowerBlue
'skinparam DatabaseBackgroundColor LightGrey
'skinparam DatabaseBorderColor CornflowerBlue

'hide empty members

@enduml

@startuml

title
    ==Stroom Logical Architecture
    Client connections in <color:blue>blue</color>
    Reverse proxied connections in <color:green>green</color>
    Effective connections (ignoring nginx reverse proxying) <color:grey>dashed grey</color>
end title


node "Event generator" as dataload_client_app <<application>>
node "Web browser" as ui_client_browser <<web browser>>
node "API client" as api_client_app <<application>>
node "Remote stroom-proxy" as remote_proxy <<application>>

rectangle "stroom estate" {
    node "nginx" as nginx <<web server>>
    node "stroom-auth-ui nginx" as stroom_auth_ui_nginx <<web server>>
    node "stroom-auth-service" as stroom_auth_service_dropwiz <<java app>>
    node "stroom" as stroom_dropwiz <<java app>>
    node "stroom-proxy (local)" as stroom_proxy_dropwiz <<java app>>
    node "stroom-log-sender" as stroom_log_sender_script <<script>>

    database stroom_all_dbs <<mysql>> {
        storage "stroom" as stroom_db <<database>>
        storage "stats" as stroom_stats_db <<database>>
        storage "auth" as stroom_auth_db <<database>>
    }
}

stroom_auth_service_dropwiz - -> stroom_auth_db
stroom_dropwiz - -> stroom_db
stroom_dropwiz - -> stroom_stats_db

ui_client_browser -[#Blue]-> nginx : HTTPS:443\n/stroom/ui
api_client_app -[#Blue]-> nginx : HTTPS:443\n/api
dataload_client_app -[#Blue]-> nginx : HTTPS:443\n/datafeed(direct) POSTs
remote_proxy -[#Blue]-> nginx : HTTPS:443\n/feedstatus\n/datafeed(direct) POSTs

stroom_dropwiz - -> nginx     : HTTP:80\nAuthentication\nREST calls\n(to stroom-auth-service)
stroom_auth_service_dropwiz - -> nginx     : HTTP:80\nAuthorisation\nREST calls\n(to stroom)
stroom_proxy_dropwiz - -> nginx     : HTTPS:443\nFeed status\nREST calls\n(to stroom)
stroom_log_sender_script -right-> nginx     : HTTPS:443\n/datafeed POSTs

nginx -[#Green]-> stroom_dropwiz : HTTP:8080\n/stroom\n/api\n/datafeeddirect\nRev. proxy
nginx -[#Green]-> stroom_proxy_dropwiz : HTTP:8090\n/datafeed\nRev. proxy
nginx -[#Green]-> stroom_auth_ui_nginx : HTTP:9443\n/authui\n/static\n/s\nRev. proxy
nginx -[#Green]-> stroom_auth_service_dropwiz : HTTP:8099\n/api/auth\nRev. proxy

stroom_dropwiz .[#Grey].> stroom_auth_service_dropwiz     : <color:Grey>HTTP:8099</color>\n<color:Grey>Authorisation REST calls</color>
stroom_proxy_dropwiz .[#Grey].> stroom_dropwiz     : <color:Grey>HTTP:8080</color>\n<color:Grey>Feed status</color>
stroom_auth_service_dropwiz .[#Grey].> stroom_dropwiz     : <color:Grey>HTTP:8080</color>\n<color:Grey>Authentication REST calls</color>





@enduml

PlantUML version 1.2021.5(Sun Apr 25 11:20:28 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>