<!doctype html>
<html lang="en" class="no-js">
  <head>
    
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.95.0" />
<link rel="canonical" type="text/html" href="../../../../community/dev-guide/release-process/">
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="../../../../favicons/favicon.ico" >
<link rel="apple-touch-icon" href="../../../../favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="../../../../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../../../../favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../../favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="../../../../favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../../../../favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="../../../../favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../../favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="../../../../favicons/android-192x192.png" sizes="192x192">

<title>Release Process | Stroom</title>
<meta name="description" content="How to release new versions of the software.
">
<meta property="og:title" content="Release Process" />
<meta property="og:description" content="How to release new versions of the software.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/community/dev-guide/release-process/" /><meta property="og:site_name" content="Stroom" />

<meta itemprop="name" content="Release Process">
<meta itemprop="description" content="How to release new versions of the software.
"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Release Process"/>
<meta name="twitter:description" content="How to release new versions of the software.
"/>




<link rel="preload" href="../../../../scss/main.min.a3071161b58f543881abc376bafc351c1990dece0d97fb76463bacd39540eb2b.css" as="style">
<link href="../../../../scss/main.min.a3071161b58f543881abc376bafc351c1990dece0d97fb76463bacd39540eb2b.css" rel="stylesheet" integrity="">


<script src='../../../../js/jquery-3.6.0.min.js'></script>


<script src='../../../../js/lunr.min.js'></script>
  
<link rel="stylesheet" href="../../../../css/prism.css"/>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-00000000-0', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="../../../../">
		<span class="navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="110.61089" height="30.000004" viewBox="0 0 88.488641 23.999957" id="svg2" inkscape:version="0.91 r13725" sodipodi:docname="logo.svg"><defs id="defs20"/><sodipodi:namedview pagecolor="#989898" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1137" id="namedview18" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:zoom="5.5951814" inkscape:cx="55.451414" inkscape:cy="16.275348" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="svg2"/><g id="g4150" style="opacity:.97000002" transform="matrix(0.03883584,0,0,0.03883584,0,-3.1155874e-4)"><path id="path6" d="M121.99991 205.98497C54.999958 205.98497.0 259.98493.0 327.98487c0 66.99994 54.999958 121.99989 121.99991 121.99989h167.99987c24.99998.0 44.99996 20.99998 44.99996 44.99996.0 24.99998-19.99998 44.99996-44.99996 44.99996H109.20929C65.984126 553.87219 27.100843 581.57313.01093599 617.98462H289.99978c66.99994.0 121.99991-54.99996 121.99991-122.9999.0-66.99994-54.99997-121.99989-121.99991-121.99989H121.99991c-24.999984.0-44.999969-19.99999-44.999969-44.99996.0-24.99998 19.999985-44.99996 44.999969-44.99996h228.79045c26.9905-35.88325 65.47093-63.18547 108.21554-76.99994H121.99991z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path8" d="M601.44485-.00077860649C572.6583 8.3697982 546.49491 22.822962 524.44491 41.902305V205.78969l.002.19528h-.002c-65.11 48e-5-123.03145 30.0199-160.74675 76.99994h160.74675v334.99971h76.99994V282.98491h144.85298c27.16134-36.05885 65.96411-63.39275 109.02184-76.99994H601.44485v-205.98574860649z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path10" d="m919.42586 205.98497c-113.99519.0-205.99537 92.00648-206.00296 205.99982-15e-5 68.67178.0 137.32749.0 205.99983h77.99994c-.012-68.6493.0176-137.46869.0-205.99983.0846-70.92785 57.05747-128.99988 128.00462-128.99988 5.28623.0 10.49823.32864 15.62183.95311 18.2219-24.51229 41.78461-45.0838 68.42501-60.15146-25.65065-11.43799-54.08662-17.80159-84.04684-17.80159z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path12" d="m1109.4153 205.98457c-113.99994.0-205.99983 91.99993-205.99983 205.99984.0 112.9999 91.99989 205.9998 205.99983 205.9998 114 0 205.9999-92.9999 205.9999-205.9998.0-113.99991-91.9999-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.99994-56.99996-128.99994-127.9999.0-70.99995 58.00004-128.9999 128.99994-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path14" d="m1444.4737 205.98457c-113.9999.0-205.9998 91.99993-205.9998 205.99984.0 112.9999 91.9999 205.9998 205.9998 205.9998s205.9999-92.9999 205.9999-205.9998c0-113.99991-92-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.9999-56.99996-128.9999-127.9999.0-70.99995 58-128.9999 128.9999-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path16" d="m1738.5308 379.98447c0-53 43-97 95.9999-97 53 0 97 44 97 97v237.9997h76.9999v-237.9997c0-53 43-97 96.9999-97 53 0 95.9999 44 95.9999 97v237.9997h77v-237.9997c0-96-77-173.9999-172.9999-173.9999-54.9999.0-103.9999 24.99998-135.9999 64.99995-31.9999-39.99997-79.9999-64.99995-134.9999-64.99995-95.9999.0-173.9998 77.9999-173.9998 173.9999v237.9997h77.9999z" style="fill:#fff" inkscape:connector-curvature="0"/></g></svg></span><span class="font-weight-bold">Stroom</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="../../../../about/about/" ><span>About</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="../../../../docs/" ><span>Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="../../../../news/" ><span>News / Releases</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="../../../../community/" ><span class="active">Community</span></a>
			</li>
			
			
			<li class="nav-item dropdown mr-4 d-none d-lg-block">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Stroom Version (7.1)
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="../../../../">7.1 (Latest)</a>
	
	<a class="dropdown-item" href="../../../../7.0">7.0</a>
	
	<a class="dropdown-item" href="../../../../legacy">Legacy</a>
	
</div>

			</li>
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"><input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="../../../../offline-search-index.13533ca1a78cbdd844c9f5e05bf16e65.json"
  data-offline-search-base-href="../../../../"
  data-offline-search-max-results="50"
>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="../../../../community/dev-guide/release-process/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Release Process</h1>
<div class="lead">How to release new versions of the software.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-ab04a4b5e3a8bf14e1879f1cf73e88bc">Releasing Stroom</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '1.'; ">
    
  <h1 id="pg-ab04a4b5e3a8bf14e1879f1cf73e88bc">1 - Releasing Stroom</h1>
    <div class="lead">How to release a new version of Stroom</div>
	<h2 id="pre-requisites-for-a-release">Pre-requisites for a release</h2>
<p>The follow need to be completed before a release is made.</p>
<h3 id="logging-changes">Logging changes</h3>
<p>Stroom and its related repositories all have a <code>CHANGELOG.md</code> file for recording changes made between releases.
Before making a release you should ensure that all changes have been recorded in the <em>CHANGELOG</em>.
This is not done by directly editing the file but instead using the script <code>./log_change.sh</code>.</p>
<p><em>log_change</em> creates change entry files in the directory <code>./unreleased_changes/</code>.
This prevents merge conflicts that would happen with multiple people editing the <em>CHANGELOG</em> file.</p>
<p>The following examples show you how to use the <em>log_change</em> script.</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="dev" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash"># Log a change for the issue number in your current branch (e.g. branch: gh-1234-fix-dead-locks)
./log_change auto &#34;Fix database dead locks during purge job&#34;
(out)
# Log a change for the issue number in your current branch (e.g. branch: gh-1234-fix-dead-locks)
# Your default editor will open the created skeleton change file
./log_change auto
(out)
# Log a change with no associated issue
./log_change 0 &#34;Fix typo on about screen&#34;
(out)
# Log a change for issue #1234
./log_change 1234 &#34;Fix database dead locks during purge job&#34;
(out)
# Log a change for issue #1234
# Your default editor will open the created skeleton change file
./log_change 1234
(out)
# Log a change for an issue in a different repository
./log_change gchq/stroom#2424 &#34;Fix database dead locks during purge job&#34;
(out)
# Log a change for an issue in a different repository
# Your default editor will open the created skeleton change file
./log_change gchq/stroom#2424
(out)
# List all unreleased changes
./log_change list</code></pre>
</div>

<h3 id="commit-and-push-all-changes">Commit and push all changes</h3>
<p>Before releasing all local changes that you want in the release should be committed and pushed.
Commits that you want in a release should be merged down to a release branch, e.g. <code>7.0</code> or <code>master</code>.
Once pushed and merged ensure that the branch passes the 






  

<span class="external-link">
  <a href="https://github.com/gchq/stroom/actions" target="_blank" class="" style="" title="CI build (external link)">
    <span>CI build</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<h3 id="decide-on-the-next-version-number">Decide on the next version number</h3>
<p>Stroom versioning follows 






  

<span class="external-link">
  <a href="https://semver.org" target="_blank" class="" style="" title="Semantic Versioning (external link)">
    <span>Semantic Versioning</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<p>Given a version number <em>MAJOR</em>.<em>MINOR</em>.<em>PATCH</em>:</p>
<ul>
<li><em>MAJOR</em> is incremented when there are major or breaking changes.</li>
<li><em>MINOR</em> is incremented when functionality is added in a backwards compatible manner.</li>
<li><em>PATCH</em> is incremented when bugs are fixed.</li>
</ul>
<p>Based on the changes since the last release establish if it is a major, minor or patch release to determine the next version number.</p>
<h2 id="performing-a-named-release-of-stroom">Performing a named release of Stroom</h2>
<p>Once all the above pre-requisites have been met you can trigger the release by running this command:</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="dev" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">./tag_release.sh</code></pre>
</div>

<p>This script will do the following:</p>
<ul>
<li>Adds the content of the unreleased change entry files (created by <code>log_change.sh</code>) to the <em>CHANGELOG</em>.</li>
<li>Prompts for (and suggests) the next version based on the previous release.</li>
<li>Adds a new version heading to <em>CHANGELOG</em>.</li>
<li>Adds/updates the version compare links in the <em>CHANGELOG</em>.</li>
<li>Commits and pushes the change log changes.</li>
<li>Creates an annotated git tag using the release version number and change entries.</li>
</ul>
<p>The tagged git commit will trigger a CI build that includes additional release elements such as:</p>
<ul>
<li>Pushing the built docker images to DockerHub.</li>
<li>Creating a release for the git tag in GitHub with all the release artefacts.</li>
<li>Publishing any libraries to Sonatype and Maven Central.</li>
</ul>
<h2 id="performing-a-named-release-of-the-docker-stacks">Performing a named release of the docker stacks</h2>
<p>Once the <em>Stroom</em> release build has finished and the artefacts are available on 






  

<span class="external-link">
  <a href="https://github.com/gchq/stroom/releases" target="_blank" class="" style="" title="GitHub Releases (external link)">
    <span>GitHub Releases</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 and 






  

<span class="external-link">
  <a href="https://hub.docker.com/r/gchq/stroom/tags" target="_blank" class="" style="" title="DockerHub (external link)">
    <span>DockerHub</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 you can create an associated release of the Stroom docker stacks.</p>
<p>In the following examples we will assume that you have just released <em>Stroom</em> <code>v7.0.1</code> on branch <code>7.0</code>, and the previous release was <code>v7.0.0</code>.</p>
<p>Checkout and pull the corresponding release branch in the <em>stroom-resources</em> repository.</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="dev" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">cd stroom-resources
(out)
git checkout 7.0
(out)
git pull</code></pre>
</div>

<p>Now edit the file <code>bin/stack/container_versions.env</code> and edit the following line, setting it to the version of stroom you have just released:</p>
<div class="card-deck mb-4">
  <div class="card mb-4">
  
    <div class="card-header">
      
        Before
      
    </div>
  
  <div class="card-body">
    
    
    
      <p class="card-text">
        
          <pre><code class="language-bash">  STROOM_TAG=&quot;v7.0.0&quot;
</code></pre>

        
      </p>
    
  </div>
  
</div>

  <div class="card mb-4">
  
    <div class="card-header">
      
        After
      
    </div>
  
  <div class="card-body">
    
    
    
      <p class="card-text">
        
          <pre><code class="language-bash">  STROOM_TAG=&quot;v7.0.1&quot;
</code></pre>

        
      </p>
    
  </div>
  
</div>

</div>
<p>If any of the other docker image versions need updating then do it at this point.</p>
<p>Now add/commit/push the change.
Check the 






  

<span class="external-link">
  <a href="https://github.com/gchq/stroom-resources/actions" target="_blank" class="" style="" title="CI build (external link)">
    <span>CI build</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 is successful for the new Stroom image.</p>
<p>If the build is green then tag the stacks release as follows:</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="dev" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">pwd
(out)/home/dev/git_work/stroom-resources
(out)
# Clear out any previous build
rm -rf ./bin/stack/build
(out)
./tag_release-stroom-stacks.sh stroom-stacks-v7.0.1</code></pre>
</div>

<p>This script will build all the stack variants locally to ensure they will build successfully, though it does not test them.
If the local build is successful it will then create an annotated git tag which will trigger a release CI build.
The release CI build will create an archive for each stack variant and add them as a release artefacts.</p>
<h2 id="snapshot-releases">SNAPSHOT releases</h2>
<p>SNAPSHOT releases should not be released to Sonatype or Maven Central.
If a development version of a library needs to be shared between projects then you can either use the Gradle task <code>publishToMavenLocal</code> to publish a <code>SNAPSHOT</code> version to your local Maven repository and change your dependency version to <code>SNAPSHOT</code>, or perform a named release along the lines of <code>vx.y.z-alpha.n</code>.</p>
<h2 id="release-versioning-conventions">Release Versioning conventions</h2>
<p>Semantic versioning is used, and this should be adhered to, see 






  

<span class="external-link">
  <a href="https://semver.org/" target="_blank" class="" style="" title="SemVer (external link)">
    <span>SemVer</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
. The following are examples of valid version names</p>
<ul>
<li><code>SNAPSHOT</code> - Used only for local development, never to be published publicly.</li>
<li><code>v3.3.0</code> - Initial release of v3.3, with an associated <code>3.3</code> branch.</li>
<li><code>v3.3.1</code> - A patch release to v3.3 on the <code>3.3</code> branch.</li>
<li><code>v3.4.0-alpha.1</code> - An alpha release of v3.4, either on <code>master</code> or a <code>3.4</code> branch</li>
<li><code>v3.4.0-beta.1</code> - An beta release of v3.4, either on <code>master</code> or a <code>3.4</code> branch</li>
</ul>
<h2 id="to-perform-a-local-build">To Perform a Local Build</h2>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="dev" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash"># Full build:
./gradlew clean build
(out)
# Build without unit tests
./gradlew clean build -x test
(out)
# Build without any tests or GWT compilation (GWT compilation applies to stroom only)
./gradlew clean build -x test -x gwtCompile</code></pre>
</div>


</div>




    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/gchq/stroom" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2022 Crown Copyright All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    

<script src='../../../../js/popper.min.js'></script>
<script src='../../../../js/bootstrap.min.js'></script>






<script src='../../../../js/tabpane-persist.js'></script>




















<script src="../../../../js/main.min.fc1551b8c1b40a6eaa08f3cb9c76f12ccd9aebc436cecdaf2341c890206d024a.js" integrity="sha256-/BVRuMG0Cm6qCPPLnHbxLM2a68Q2zs2vI0HIkCBtAko=" crossorigin="anonymous"></script>



<script src='../../../../js/prism.js'></script>



  </body>
</html>
