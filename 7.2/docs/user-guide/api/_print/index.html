<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.95.0" />
<link rel="canonical" type="text/html" href="../../../../docs/user-guide/api/">
<meta name="robots" content="noindex, nofollow">


<link rel="canonical" href="../../../../../">


<link rel="shortcut icon" href="../../../../favicons/favicon.ico" >
<link rel="apple-touch-icon" href="../../../../favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="../../../../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../../../../favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../../favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="../../../../favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../../../../favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="../../../../favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../../favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="../../../../favicons/android-192x192.png" sizes="192x192">

<title>Application Programming Interfaces (API) | Stroom</title>
<meta name="description" content="Stroom&#39; public REST APIs for querying and interacting with all aspects of Stroom.
">
<meta property="og:title" content="Application Programming Interfaces (API)" />
<meta property="og:description" content="Stroom&#39; public REST APIs for querying and interacting with all aspects of Stroom.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/user-guide/api/" /><meta property="og:site_name" content="Stroom" />

<meta itemprop="name" content="Application Programming Interfaces (API)">
<meta itemprop="description" content="Stroom&#39; public REST APIs for querying and interacting with all aspects of Stroom.
"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Application Programming Interfaces (API)"/>
<meta name="twitter:description" content="Stroom&#39; public REST APIs for querying and interacting with all aspects of Stroom.
"/>




<link rel="preload" href="../../../../scss/main.min.6fb226cd71039497ffa58fcc5b6c8de1eb8cd6450b734f716f31e08585905411.css" as="style">
<link href="../../../../scss/main.min.6fb226cd71039497ffa58fcc5b6c8de1eb8cd6450b734f716f31e08585905411.css" rel="stylesheet" integrity="">


<script src='../../../../js/jquery-3.6.0.min.js'></script>


<script src='../../../../js/lunr.min.js'></script>
  
<link rel="stylesheet" href="../../../../css/prism.css"/>
<link rel="stylesheet" href="../../../../css/stroom-ui/icon-colours.css"/>
<link rel="stylesheet" href="../../../../css/stroom-ui/material_design_colors.css"/>
<link rel="stylesheet" href="../../../../css/stroom-ui/theme-root.css"/>




  </head>
  <body class="td-section">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="../../../../"><span class="navbar-brand__logo navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="110.61089" height="30.000004" viewBox="0 0 88.488641 23.999957" id="svg2" inkscape:version="0.91 r13725" sodipodi:docname="logo.svg"><defs id="defs20"/><sodipodi:namedview pagecolor="#989898" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1137" id="namedview18" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:zoom="5.5951814" inkscape:cx="55.451414" inkscape:cy="16.275348" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="svg2"/><g id="g4150" style="opacity:.97000002" transform="matrix(0.03883584,0,0,0.03883584,0,-3.1155874e-4)"><path id="path6" d="M121.99991 205.98497C54.999958 205.98497.0 259.98493.0 327.98487c0 66.99994 54.999958 121.99989 121.99991 121.99989h167.99987c24.99998.0 44.99996 20.99998 44.99996 44.99996.0 24.99998-19.99998 44.99996-44.99996 44.99996H109.20929C65.984126 553.87219 27.100843 581.57313.01093599 617.98462H289.99978c66.99994.0 121.99991-54.99996 121.99991-122.9999.0-66.99994-54.99997-121.99989-121.99991-121.99989H121.99991c-24.999984.0-44.999969-19.99999-44.999969-44.99996.0-24.99998 19.999985-44.99996 44.999969-44.99996h228.79045c26.9905-35.88325 65.47093-63.18547 108.21554-76.99994H121.99991z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path8" d="M601.44485-.00077860649C572.6583 8.3697982 546.49491 22.822962 524.44491 41.902305V205.78969l.002.19528h-.002c-65.11 48e-5-123.03145 30.0199-160.74675 76.99994h160.74675v334.99971h76.99994V282.98491h144.85298c27.16134-36.05885 65.96411-63.39275 109.02184-76.99994H601.44485v-205.98574860649z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path10" d="m919.42586 205.98497c-113.99519.0-205.99537 92.00648-206.00296 205.99982-15e-5 68.67178.0 137.32749.0 205.99983h77.99994c-.012-68.6493.0176-137.46869.0-205.99983.0846-70.92785 57.05747-128.99988 128.00462-128.99988 5.28623.0 10.49823.32864 15.62183.95311 18.2219-24.51229 41.78461-45.0838 68.42501-60.15146-25.65065-11.43799-54.08662-17.80159-84.04684-17.80159z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path12" d="m1109.4153 205.98457c-113.99994.0-205.99983 91.99993-205.99983 205.99984.0 112.9999 91.99989 205.9998 205.99983 205.9998 114 0 205.9999-92.9999 205.9999-205.9998.0-113.99991-91.9999-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.99994-56.99996-128.99994-127.9999.0-70.99995 58.00004-128.9999 128.99994-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path14" d="m1444.4737 205.98457c-113.9999.0-205.9998 91.99993-205.9998 205.99984.0 112.9999 91.9999 205.9998 205.9998 205.9998s205.9999-92.9999 205.9999-205.9998c0-113.99991-92-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.9999-56.99996-128.9999-127.9999.0-70.99995 58-128.9999 128.9999-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path16" d="m1738.5308 379.98447c0-53 43-97 95.9999-97 53 0 97 44 97 97v237.9997h76.9999v-237.9997c0-53 43-97 96.9999-97 53 0 95.9999 44 95.9999 97v237.9997h77v-237.9997c0-96-77-173.9999-172.9999-173.9999-54.9999.0-103.9999 24.99998-135.9999 64.99995-31.9999-39.99997-79.9999-64.99995-134.9999-64.99995-95.9999.0-173.9998 77.9999-173.9998 173.9999v237.9997h77.9999z" style="fill:#fff" inkscape:connector-curvature="0"/></g></svg></span><span class="navbar-brand__name">Stroom</span></a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="../../../../about/about/"><span>About</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link active" href="../../../../docs/"><span class="active">Documentation</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="../../../../releases/"><span>Releases Notes</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="../../../../community/"><span>Community</span></a>
      </li>
      <li class="nav-item dropdown mr-4 d-none d-lg-block">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Stroom Version (7.2)
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	
	
	<a class="dropdown-item" href="">7.8 (Latest)</a>
	
	<a class="dropdown-item" href="">7.7</a>
	
	<a class="dropdown-item" href="">7.6</a>
	
	<a class="dropdown-item" href="">7.5</a>
	
	<a class="dropdown-item" href="">7.4</a>
	
	<a class="dropdown-item" href="">7.3</a>
	
	<a class="dropdown-item" href="">7.2</a>
	
	<a class="dropdown-item" href="">7.1</a>
	
	<a class="dropdown-item" href="">7.0</a>
	
	<a class="dropdown-item" href="">Legacy</a>
	
</div>
</li>
      </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="../../../../offline-search-index.3be2d84d34bbb8f603ee8c1f2dc167da.json"
    data-offline-search-base-href="../../../../"
    data-offline-search-max-results="50"
  >
</div>

  </div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="../../../../docs/user-guide/api/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Application Programming Interfaces (API)</h1>
<div class="lead">Stroom&rsquo; public REST APIs for querying and interacting with all aspects of Stroom.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-04cba67b7e546ca3a9e37430f4d89611">API Specification</a></li>


    
  
    
    
	
<li>2: <a href="#pg-6cf4fc9aeb992974c48bbc90aa44e2ed">Calling an API</a></li>


    
  
    
    
	
<li>3: <a href="#pg-ebfd226579200a398d8590ddcf775ace">Query APIs</a></li>


    
  
    
    
	
<li>4: <a href="#pg-8ed196b75957dc22a07bf211c5127a88">Export Content API</a></li>


    
  
    
    
	
<li>5: <a href="#pg-73fff410e6d154b348127ae441c14736">Reference Data</a></li>


    
  

    </ul>


<div class="content">
      <p><em>Stroom</em> has many public REST <span class="glossary-link">
  <a href="../../../../docs/glossary/#api" title="Glossary entry for APIs">
    <span>APIs</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> to allow other systems to interact with <em>Stroom</em>.
Everything that can be done via the user interface can also be done using the API.</p>
<p>All methods on the API will are authenticated and authorised, so the permissions will be exactly the same as if the API user is using the Stroom user interface directly.</p>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '1.'; page-break-before: always">
    
  <h1 id="pg-04cba67b7e546ca3a9e37430f4d89611">1 - API Specification</h1>
    <div class="lead">Details of the API specifcation and how to find what API endpoints are available.</div>
	<h2 id="swagger-ui">Swagger UI</h2>
<p>The APIs are available as a <em>Swagger</em> Open API specification in the following forms:</p>
<ul>
<li>JSON - 







  
  

<span class="external-link">
  <a href="https://gchq.github.io/stroom/v7.2/stroom.json" target="_blank" class="" style="" title="stroom.json (external link to https://gchq.github.io/stroom/v7.2/stroom.json)">
    <span>stroom.json</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
</li>
<li>YAML - 







  
  

<span class="external-link">
  <a href="https://gchq.github.io/stroom/v7.2/stroom.yaml" target="_blank" class="" style="" title="stroom.yaml (external link to https://gchq.github.io/stroom/v7.2/stroom.yaml)">
    <span>stroom.yaml</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
</li>
</ul>
<p>A dynamic Swagger user interface is also available for viewing all the API endpoints with details of parameters and data types.
This can be found in two places.</p>
<ul>
<li>Published on GitHub for each minor version 







  
  

<span class="external-link">
  <a href="https://gchq.github.io/stroom/v7.2" target="_blank" class="" style="" title="Swagger user interface (external link to https://gchq.github.io/stroom/v7.2)">
    <span>Swagger user interface</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</li>
<li>Published on a running stroom instance at the path <code>/stroom/noauth/swagger-ui</code>.</li>
</ul>
<h2 id="api-endpoints-in-application-logs">API Endpoints in Application Logs</h2>
<p>The API methods are also all listed in the application logs when Stroom first boots up, e.g.</p>
<pre><code class="language-text">INFO  2023-01-17T11:09:30.244Z main i.d.j.DropwizardResourceConfig The following paths were found for the configured resources:

    GET     /api/account/v1/ (stroom.security.identity.account.AccountResourceImpl)
    POST    /api/account/v1/ (stroom.security.identity.account.AccountResourceImpl)
    POST    /api/account/v1/search (stroom.security.identity.account.AccountResourceImpl)
    DELETE  /api/account/v1/{id} (stroom.security.identity.account.AccountResourceImpl)
    GET     /api/account/v1/{id} (stroom.security.identity.account.AccountResourceImpl)
    PUT     /api/account/v1/{id} (stroom.security.identity.account.AccountResourceImpl)
    GET     /api/activity/v1 (stroom.activity.impl.ActivityResourceImpl)
    POST    /api/activity/v1 (stroom.activity.impl.ActivityResourceImpl)
    POST    /api/activity/v1/acknowledge (stroom.activity.impl.ActivityResourceImpl)
    GET     /api/activity/v1/current (stroom.activity.impl.ActivityResourceImpl)
    ...
</code></pre>
<p>You will also see entries in the logs for the various servlets exposed by Stroom, e.g.</p>
<pre><code class="language-text">INFO  ... main s.d.common.Servlets            Adding servlets to application path/port: 
INFO  ... main s.d.common.Servlets            	stroom.core.servlet.DashboardServlet          =&gt; /stroom/dashboard 
INFO  ... main s.d.common.Servlets            	stroom.core.servlet.DynamicCSSServlet         =&gt; /stroom/dynamic.css 
INFO  ... main s.d.common.Servlets            	stroom.data.store.impl.ImportFileServlet      =&gt; /stroom/importfile.rpc 
INFO  ... main s.d.common.Servlets            	stroom.receive.common.ReceiveDataServlet      =&gt; /stroom/noauth/datafeed 
INFO  ... main s.d.common.Servlets            	stroom.receive.common.ReceiveDataServlet      =&gt; /stroom/noauth/datafeed/* 
INFO  ... main s.d.common.Servlets            	stroom.receive.common.DebugServlet            =&gt; /stroom/noauth/debug 
INFO  ... main s.d.common.Servlets            	stroom.data.store.impl.fs.EchoServlet         =&gt; /stroom/noauth/echo 
INFO  ... main s.d.common.Servlets            	stroom.receive.common.RemoteFeedServiceRPC    =&gt; /stroom/noauth/remoting/remotefeedservice.rpc 
INFO  ... main s.d.common.Servlets            	stroom.core.servlet.StatusServlet             =&gt; /stroom/noauth/status 
INFO  ... main s.d.common.Servlets            	stroom.core.servlet.SwaggerUiServlet          =&gt; /stroom/noauth/swagger-ui 
INFO  ... main s.d.common.Servlets            	stroom.resource.impl.SessionResourceStoreImpl =&gt; /stroom/resourcestore/* 
INFO  ... main s.d.common.Servlets            	stroom.dashboard.impl.script.ScriptServlet    =&gt; /stroom/script 
INFO  ... main s.d.common.Servlets            	stroom.security.impl.SessionListServlet       =&gt; /stroom/sessionList 
INFO  ... main s.d.common.Servlets            	stroom.core.servlet.StroomServlet             =&gt; /stroom/ui 
</code></pre>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '2.'; page-break-before: always">
    
  <h1 id="pg-6cf4fc9aeb992974c48bbc90aa44e2ed">2 - Calling an API</h1>
    <div class="lead">How to call a method on the Stroom API using curl.</div>
	<h2 id="authentication">Authentication</h2>
<p>In order to use the API endpoints you will need to authenticate.
Authentication is achieved using an <span class="glossary-link">
  <a href="../../../../docs/glossary/#api-key" title="Glossary entry for API Key">
    <span>API Key</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> or <span class="glossary-link">
  <a href="../../../../docs/glossary/#token" title="Glossary entry for Token">
    <span>Token</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span>.</p>
<p>You will either need to create an API key for your personal Stroom user account or for a shared processing user account.
Whichever user account you use it will need to have the necessary permissions for each API endpoint it is to be used with.</p>
<p>To create an API key (token) for a user:</p>
<ol>
<li>In the top menu, select:</li>
</ol>
<p>




  <div class="stroom-menu">
    
    

      

      
      


      

  
  
  <div class="stroom-menu-item-background" style="margin-top: 0px;">
    
    <div class="stroom-menu-item " >

      <div class="stroom-menu-item-text">Tools
      </div>
        <div class="stroom-menu-item-arrow">
          <span class="stroom-icon inline-svg-button icon-button  " >
    <span class="face" title="Arrow right"><svg xmlns="http://www.w3.org/2000/svg" width="1427.7665" height="1427.7665" viewBox="0 0 1427.7665 1427.7665"><g style="stroke:currentColor;stroke-width:167.567"><path d="m 415.05387,83.70929 c -39.92654,0.4303 -75.41463,48.3887 -40.0468,81.9121 C 567.552,348.69899 760.75555,531.15431 953.73208,713.82391 760.75555,896.49341 567.552,1078.9486 375.00707,1262.0262 c -46.19471,43.7855 28.48812,112.1966 76.0571,67.1681 195.93558,-185.823 392.95261,-370.82479 587.98693,-557.52749 5.6117,-4.8034 10.4633,-10.2473 14.4855,-16.1231 9.643,-12.4844 13.9638,-27.0796 13.6909,-41.7198 0.2729,-14.6402 -4.0479,-29.2354 -13.6909,-41.7198 -4.0222,-5.8758 -8.8738,-11.3198 -14.4855,-16.1231 C 844.01678,469.27821 646.99975,284.27629 451.06417,98.45319 439.91519,87.89979 427.27628,83.57749 415.05387,83.70929 Z"/></g></svg> </span>
  </span>
        </div>
    </div>
  </div>

      

      
      
        
      


      

  
  
  <div class="stroom-menu-item-background" style="margin-top: 7px;">
    
    <div class="stroom-menu-item stroom-menu-item-leaf" >
        <div class="stroom-menu-item-icon">
          <span class="stroom-icon inline-svg-button icon-button  " >
    <span class="face" title="Key"><svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512"><path style="fill:var(--icon-colour__orange)" d="M512 176.001C512 273.203 433.202 352 336 352c-11.22 0-22.19-1.062-32.827-3.069l-24.012 27.014A23.999 23.999 0 0 1 261.223 384H224v40c0 13.255-10.745 24-24 24h-40v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-78.059c0-6.365 2.529-12.47 7.029-16.971l161.802-161.802C163.108 213.814 160 195.271 160 176 160 78.798 238.797.001 335.999 0 433.488-.001 512 78.511 512 176.001zM336 128c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z"></path></svg></span>
  </span>
        </div>

      <div class="stroom-menu-item-text">API Keys
      </div>
    </div>
  </div>
  </div>


</br></p>
<ol>
<li>Click <em>Create</em>.</li>
<li>Enter a suitable expiration date.
Short expiry periods are more secure in case the key is compromised.</li>
<li>Select the user account that you are creating the key for.</li>
<li>Click 



<span class="stroom-button" title="OK button" >
  <span class="stroom-button-text">OK</span>
</span>
</li>
<li>Select the newly created API Key from the list of keys and double click it to open it.</li>
<li>Click 



<span class="stroom-button" title="Copy Key button" >
  <span class="stroom-button-text">Copy Key</span>
</span>
 to copy the key to the clipboard.</li>
</ol>
<p>To make an authenticated API call you need to provide a header of the form <code>Authorization:Bearer ${TOKEN}</code>, where <code>${TOKEN}</code> is your API Key as copied from Stroom.</p>
<h2 id="calling-an-api-method-with-curl">Calling an API method with <code>curl</code></h2>
<p>This section describes how to call an API method using the command line tool <code>curl</code> as an example client.
Other clients can be used, e.g. using python, but these examples should provide enough help to get started using another client.</p>
<h3 id="http-requests-without-a-body">HTTP Requests Without a Body</h3>
<p>Typically HTTP <code>GET</code> requests will have no body/payload
Often <code>PUT</code> and <code>DELETE</code> requests will also have no body/payload.</p>
<p>The following is an example of how to call an HTTP GET method (i.e. a method that does not require a request body) on the API using <code>curl</code>.</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="somehost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">TOKEN=&#39;API KEY GOES IN HERE&#39; \
curl \
  --silent \
  --insecure \
  --header &#34;Authorization:Bearer ${TOKEN}&#34; \
  https://stroom-fqdn/api/node/v1/info/node1a
(out){&#34;discoverTime&#34;:&#34;2022-02-16T17:28:37.710Z&#34;,&#34;buildInfo&#34;:{&#34;buildDate&#34;:&#34;2022-01-19T15:27:25.024677714Z&#34;,&#34;buildVersion&#34;:&#34;7.0-beta.175&#34;,&#34;upDate&#34;:&#34;2022-02-16T09:28:11.733Z&#34;},&#34;nodeName&#34;:&#34;node1a&#34;,&#34;endpointUrl&#34;:&#34;http://192.168.1.64:8080&#34;,&#34;itemList&#34;:[{&#34;nodeName&#34;:&#34;node1a&#34;,&#34;active&#34;:true,&#34;master&#34;:true}],&#34;ping&#34;:2}</code></pre>
</div>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    <p>The <code>--insecure</code> argument is used in this example which means certificate verification will not take place.
It is recommended not to use this argument and instead supply curl with client and certificate authority certificates to make a secure connection.</p>
<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">TOKEN=&#39;API KEY GOES IN HERE&#39; \
curl \
  --silent \
  --cert /path/to/client-cert \
  --key /path/to/client-key \
  --cacert /path/to/ca-cert \
  --header &#34;Authorization:Bearer ${TOKEN}&#34; \
  https://stroom-fqdn/api/some/path</code></pre>
</div>


</div>


<p>You can either call the API via Nginx (or similar reverse proxy) at <code>https://stroom-fddn/api/some/path</code> or if you are making the call from one of the stroom hosts you can go direct using <code>http://localhost:8080/api/some/path</code>. The former is preferred as it is more secure.</p>
<h3 id="requests-with-a-body">Requests With a Body</h3>
<p>A lot of the API methods in Stroom require complex bodies/payloads for the request.
The following example is an HTTP <code>POST</code> to perform a reference data lookup on the local host.</p>
<p>Create a file <code>req.json</code> containing:</p>
<pre><code class="language-json">{
  &quot;mapName&quot;: &quot;USER_ID_TO_STAFF_NO_MAP&quot;,
  &quot;effectiveTime&quot;: &quot;2024-12-02T08:37:02.772Z&quot;,
  &quot;key&quot;: &quot;user2&quot;,
  &quot;referenceLoaders&quot;: [
    {
      &quot;loaderPipeline&quot; : {
        &quot;name&quot; : &quot;Reference Loader&quot;,
        &quot;uuid&quot; : &quot;da1c7351-086f-493b-866a-b42dbe990700&quot;,
        &quot;type&quot; : &quot;Pipeline&quot;
      },
      &quot;referenceFeed&quot; : {
        &quot;name&quot;: &quot;STAFF-NO-REFERENCE&quot;,
        &quot;uuid&quot;: &quot;350003fe-2b6c-4c57-95ed-2e6018c5b3d5&quot;,
        &quot;type&quot; : &quot;Feed&quot;
      }
    }
  ]
}
</code></pre>
<p>Now send the request with <code>curl</code>.</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">TOKEN=&#39;API KEY GOES IN HERE&#39; \
curl \
  --json @req.json \
  --request POST \
  --header &#34;Authorization:Bearer ${TOKEN}&#34; \
  http://localhost:8080/api/refData/v1/lookup
(out)staff2</code></pre>
</div>

<p>This API method returns plain text or XML depending on the reference data value.</p>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>


    <p>This assumes you are using <code>curl</code> version <code>7.82.0</code> or later that supports the <code>--json</code> argument.
If not you will need to replace <code>--json</code> with <code>--data</code> and add these arguments:</p>
<pre><code class="language-text">--header &quot;Content-Type: application/json&quot;
--header &quot;Accept: application/json&quot;
</code></pre>


</div>


<h2 id="handling-json">Handling JSON</h2>
<p>







  
  

<span class="external-link">
  <a href="https://stedolan.github.io/jq/" target="_blank" class="" style="" title="jq (external link to https://stedolan.github.io/jq/)">
    <span>jq</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 is a utility for processing JSON and is very useful when using the API methods.</p>
<p>For example to get just the build version from the node info endpoint:</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">TOKEN=&#39;API KEY GOES IN HERE&#39; \
curl \
    --silent \
    --insecure \
    --header &#34;Authorization:Bearer ${TOKEN}&#34; \
    https://localhost/api/node/v1/info/node1a \
  | jq -r &#39;.buildInfo.buildVersion&#39;
(out)7.0-beta.175</code></pre>
</div>


</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '3.'; page-break-before: always">
    
  <h1 id="pg-ebfd226579200a398d8590ddcf775ace">3 - Query APIs</h1>
    <div class="lead">The APIs to allow other systems to query the data held in Stroom.</div>
	<p>The Query APIs use common request/response models and end points for querying each type of data source held in <em>Stroom</em>.
The request/response models are defined in 







  
  

<span class="external-link">
  <a href="https://github.com/gchq/stroom-query" target="_blank" class="" style="" title="stroom-query (external link to https://github.com/gchq/stroom-query)">
    <span>stroom-query</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<p>Currently <em>Stroom</em> exposes a set of query endpoints for the following data source types.
Each data source type will have its own endpoint due to differences in the way the data is queried and the restrictions imposed on the query terms.
However they all share the same API definition.</p>
<ul>
<li><span class="stroom-icon inline-svg-button icon-button  " >
    <span class="face" title="Index"><svg xmlns="http://www.w3.org/2000/svg" width="1792" height="1792" viewBox="0 0 1792 1792"><path style="fill:var(--icon-colour__orange)" d="M896 768q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-170q119 84 325 127t443 43zm0 768q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-170q119 84 325 127t443 43zm0-384q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-170q119 84 325 127t443 43zm0-1152q208 0 385 34.5t280 93.5 103 128v128q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-128q0-69 103-128t280-93.5 385-34.5z"/></svg></span>
  </span>







  
  

<span class="external-link">
  <a href="https://gchq.github.io/stroom/v7.2/#/Stroom-Index%20Queries" target="_blank" class="" style="" title="stroom-index Queries (external link to https://gchq.github.io/stroom/v7.2/#/Stroom-Index%20Queries)">
    <span>stroom-index Queries</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 -
The Lucene based search indexes.</li>
<li><span class="stroom-icon inline-svg-button icon-button  " >
    <span class="face" title="SQL Statistics"><svg xmlns="http://www.w3.org/2000/svg" width="1792" height="1792" viewBox="0 0 1792 1792"><path style="fill:var(--icon-colour__blue)" d="M896 768q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-170q119 84 325 127t443 43zm0 768q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-170q119 84 325 127t443 43zm0-384q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-170q119 84 325 127t443 43zm0-1152q208 0 385 34.5t280 93.5 103 128v128q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-128q0-69 103-128t280-93.5 385-34.5z"/></svg></span>
  </span>







  
  

<span class="external-link">
  <a href="https://gchq.github.io/stroom/v7.2/#/Sql%20Statistics%20Query" target="_blank" class="" style="" title="Sql Statistics Query (external link to https://gchq.github.io/stroom/v7.2/#/Sql%20Statistics%20Query)">
    <span>Sql Statistics Query</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 -
Stroom&rsquo;s SQL Statistics store.</li>
<li><span class="stroom-icon inline-svg-button icon-button  " >
    <span class="face" title="Searchable"><svg xmlns="http://www.w3.org/2000/svg" width="1792" height="1792" viewBox="0 0 1792 1792"><path style="fill:var(--icon-colour__grey)" d="M896 768q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-170q119 84 325 127t443 43zm0 768q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-170q119 84 325 127t443 43zm0-384q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-170q119 84 325 127t443 43zm0-1152q208 0 385 34.5t280 93.5 103 128v128q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-128q0-69 103-128t280-93.5 385-34.5z"/></svg> </span>
  </span>







  
  

<span class="external-link">
  <a href="https://gchq.github.io/stroom/v7.2/#/Searchable" target="_blank" class="" style="" title="Searchable (external link to https://gchq.github.io/stroom/v7.2/#/Searchable)">
    <span>Searchable</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 -
Searchables are various data sources that allow you to search the internals of Stroom, e.g. local reference data store, annotations, processor tasks, etc.</li>
</ul>
<p>The detailed documentation for the request/responses is contained in the <em>Swagger</em> definition linked to above.</p>
<h2 id="common-endpoints">Common endpoints</h2>
<p>The standard query endpoints are</p>
<ul>
<li>/<a href="#datasource">datasource</a></li>
<li>/<a href="#destroy">destroy</a></li>
<li>/<a href="#keepalive">keepAlive</a></li>
<li>/<a href="#search">search</a></li>
</ul>
<h3 id="datasource">Datasource</h3>
<p>The <span class="glossary-link">
  <a href="../../../../docs/glossary/#data-source" title="Glossary entry for Data Source">
    <span>Data Source</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> endpoint is used to query <em>Stroom</em> for the details of a data source with a given <span class="glossary-link">
  <a href="../../../../docs/glossary/#docref" title="Glossary entry for DocRef">
    <span>DocRef</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span>.
The details will include such things as the fields available and any restrictions on querying the data.</p>
<h3 id="search">Search</h3>
<p>The search endpoint is used to initiate a search against a data source or to request more data for an active search.
A search request can be made using iterative mode, where it will perform the search and then only return the data it has immediately available.
Subsequent requests for the same <em>queryKey</em> will also return the data immediately available, expecting that more results will have been found by the query.
Requesting a search in non-iterative mode will result in the response being returned when the query has completed and all known results have been found.</p>
<p>The SearchRequest model is fairly complicated and contains not only the query terms but also a definition of how the data should be returned.
A single SearchRequest can include multiple ResultRequest sections to return the queried data in multiple ways, e.g. as flat data and in an alternative aggregated form.</p>
<h4 id="_stroom_-as-a-query-builder"><em>Stroom</em> as a query builder</h4>
<p><em>Stroom</em> is able to export the json form of a SearchRequest model from its dashboards.
This makes the dashboard a useful tool for building a query and the table settings to go with it.
You can use the dashboard to defined the data source, define the query terms tree and build a table definition (or definitions) to describe how the data should be returned.
The, clicking the download icon on the query pane of the dashboard will generate the SearchRequest json which can be immediately used with the /search API or modified to suit.</p>
<h3 id="destroy">Destroy</h3>
<p>This endpoint is used to kill an active query by supplying the <em>queryKey</em> for query in question.</p>
<h3 id="keep-alive">Keep alive</h3>
<p>Stroom will only hold search results from completed queries for a certain lenght of time.
It will also terminate running queries that are too old.
In order to prevent queries being aged off you can hit this endpoint to indicate to Stroom that you still have an interest in a particular query by supplying the query key.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.'; page-break-before: always">
    
  <h1 id="pg-8ed196b75957dc22a07bf211c5127a88">4 - Export Content API</h1>
    <div class="lead">An API method for exporting all Stroom content to a zip file.</div>
	<p>Stroom has <span class="glossary-link">
  <a href="../../../../docs/glossary/#api" title="Glossary entry for API">
    <span>API</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> methods for exporting <span class="glossary-link">
  <a href="../../../../docs/glossary/#content" title="Glossary entry for content">
    <span>content</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> in Stroom to a single zip file.</p>
<h2 id="export-all---apiexportv1">Export All - <code>/api/export/v1</code></h2>
<p>This method will export all content in Stroom to a single zip file.
This is useful as an alternative backup of the content or where you need to export the content for import into another Stroom instance.</p>
<p>In order to perform a full export, the user (identified by their API Key) performing the export will need to ensure the following:</p>
<ul>
<li>Have created an <a href="../../../../docs/user-guide/api/#authentication">API Key</a></li>
<li>The system property <code>stroom.export.enabled</code> is set to <code>true</code>.</li>
<li>The user has the application permission <code>Export Configuration</code> or <code>Administrator</code>.</li>
</ul>
<p>Only those items that the user has <code>Read</code> permission on will be exported, so to export all items, the user performing the export will need <code>Read</code> permission on all items or have the <code>Administrator</code> application permission.</p>
<h3 id="performing-an-export">Performing an Export</h3>
<p>To export all readable content to a file called <code>export.zip</code> do something like the following:</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">TOKEN=&#34;API KEY GOES IN HERE&#34;
curl \
  --silent \
  --request GET \
  --header &#34;Authorization:Bearer ${TOKEN}&#34; \
  --output export.zip \
  https://stroom-fqdn/api/export/v1/</code></pre>
</div>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>


    If you encounter problems then replace <code>--silent</code> with <code>--verbose</code> to get more information.

</div>


<h2 id="export-zip-format">Export Zip Format</h2>
<p>The export zip will contain a number of files for each <span class="glossary-link">
  <a href="../../../../docs/glossary/#document" title="Glossary entry for document">
    <span>document</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> exported.
The number and type of these files will depend on the type of document, however every document will have the following two file types:</p>
<ul>
<li><code>.node</code> - This file represents the document&rsquo;s location in the explorer tree along with its name and UUID.</li>
<li><code>.meta</code> - This is the metadata for the document independent of the explorer tree.
It contains the name, type and UUID of the document along with the unique identifier for the version of the document.</li>
</ul>
<p>Documents may also have files like these (a non-exhaustive list):</p>
<ul>
<li><code>.json</code> - JSON data holding the content of the document, as used for Dashboards.</li>
<li><code>.txt</code> - Plain text data holding the content of the document, as used for Dictionaries.</li>
<li><code>.xml</code> - XML data holding the content of the document, as used for Pipelines.</li>
<li><code>.xsd</code> - XML Schema content.</li>
<li><code>.xsl</code> - XSLT content.</li>
</ul>
<p>The following is an example of the content of an export zip file:</p>
<pre><code class="language-text">TEST_FEED_CERT.Feed.fcee4270-a479-4cc0-a79c-0e8f18a4bad8.meta
TEST_FEED_CERT.Feed.fcee4270-a479-4cc0-a79c-0e8f18a4bad8.node
TEST_FEED_PROXY.Feed.f06d4416-8b0e-4774-94a9-729adc5633aa.meta
TEST_FEED_PROXY.Feed.f06d4416-8b0e-4774-94a9-729adc5633aa.node
TEST_REFERENCE_DATA_EVENTS_XXX.XSLT.4f74999e-9d69-47c7-97f7-5e88cc7459f7.meta
TEST_REFERENCE_DATA_EVENTS_XXX.XSLT.4f74999e-9d69-47c7-97f7-5e88cc7459f7.xsl
TEST_REFERENCE_DATA_EVENTS_XXX.XSLT.4f74999e-9d69-47c7-97f7-5e88cc7459f7.node
Standard_Pipelines/Reference_Loader.Pipeline.da1c7351-086f-493b-866a-b42dbe990700.xml
Standard_Pipelines/Reference_Loader.Pipeline.da1c7351-086f-493b-866a-b42dbe990700.meta
Standard_Pipelines/Reference_Loader.Pipeline.da1c7351-086f-493b-866a-b42dbe990700.node
</code></pre>
<h3 id="filenames">Filenames</h3>
<p>When documents are added to the zip, they are added with a directory structure that mirrors the explorer tree.</p>
<p>The filenames are of the form:</p>
<pre><code class="language-text">&lt;name&gt;.&lt;type&gt;.&lt;UUID&gt;.&lt;extension&gt;
</code></pre>
<p>As Stroom allows characters in document and folder names that would not be supported in operating system paths (or cause confusion), some characters in the name/directory parts are replaced by <code>_</code> to avoid this. e.g. <code>Dashboard 01/02/2020</code> would become <code>Dashboard_01_02_2020</code>.</p>
<p>If you need to see the contents of the zip as if viewing it within Stroom you can run this bash script in the root of the extracted zip.</p>
<pre><code class="language-bash">#!/usr/bin/env bash

shopt -s globstar
for node_file in **/*.node; do
  name=
  name=&quot;$(grep -o -P &quot;(?&lt;=name=).*&quot; &quot;${node_file}&quot; )&quot;
  path=
  path=&quot;$(grep -o -P &quot;(?&lt;=path=).*&quot; &quot;${node_file}&quot; )&quot;

  echo &quot;./${path}/${name}   (./${node_file})&quot;
done
</code></pre>
<p>This will output something like:</p>
<pre><code class="language-text">./Standard Pipelines/Json/Events to JSON   (./Standard_Pipelines/Json/Events_to_JSON.XSLT.1c3d42c2-f512-423f-aa6a-050c5cad7c0f.node)
./Standard Pipelines/Json/JSON Extraction   (./Standard_Pipelines/Json/JSON_Extraction.Pipeline.13143179-b494-4146-ac4b-9a6010cada89.node)
./Standard Pipelines/Json/JSON Search Extraction   (./Standard_Pipelines/Json/JSON_Search_Extraction.XSLT.a8c1aa77-fb90-461a-a121-d4d87d2ff072.node)
./Standard Pipelines/Reference Loader   (./Standard_Pipelines/Reference_Loader.Pipeline.da1c7351-086f-493b-866a-b42dbe990700.node)
</code></pre>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '5.'; page-break-before: always">
    
  <h1 id="pg-73fff410e6d154b348127ae441c14736">5 - Reference Data</h1>
    <div class="lead">How to perform reference data loads and lookups using the API.</div>
	<p>The reference data store has an API to allow other systems to access the reference data store.</p>
<h2 id="apirefdatav1lookup"><code>/api/refData/v1/lookup</code></h2>
<p>The <code>/lookup</code> endpoint requires the caller to provide details of the reference feed and loader pipeline so if the effective stream is not in the store it can be loaded prior to performing the lookup.
It is useful for forcing a reference load into the store and for performing ad-hoc lookups.</p>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>


    As reference data stores are local to a node, it is best to send the request to a node that does processing as it is more likely to have already loaded the data.
If you send it to a UI node that does not do processing, it is likely to trigger a load as the data will not be there.

</div>


<p>Below is an example of a lookup request file <code>req.json</code>.</p>
<pre><code class="language-json">{
  &quot;mapName&quot;: &quot;USER_ID_TO_LOCATION&quot;,
  &quot;effectiveTime&quot;: &quot;2020-12-02T08:37:02.772Z&quot;,
  &quot;key&quot;: &quot;jbloggs&quot;,
  &quot;referenceLoaders&quot;: [
    {
      &quot;loaderPipeline&quot; : {
        &quot;name&quot; : &quot;Reference Loader&quot;,
        &quot;uuid&quot; : &quot;da1c7351-086f-493b-866a-b42dbe990700&quot;,
        &quot;type&quot; : &quot;Pipeline&quot;
      },
      &quot;referenceFeed&quot; : {
        &quot;name&quot;: &quot;USER_ID_TOLOCATION-REFERENCE&quot;,
        &quot;uuid&quot;: &quot;60f9f51d-e5d6-41f5-86b9-ae866b8c9fa3&quot;,
        &quot;type&quot; : &quot;Feed&quot;
      }
    }
  ]
}
</code></pre>
<p>This is an example of how to perform the lookup on the local host.</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">curl \
  --json @req.json \
  --request POST \
  --header &#34;Authorization:Bearer ${TOKEN}&#34; \
  http://localhost:8080/api/refData/v1/lookup
(out)staff2</code></pre>
</div>


</div>




    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/gchq/stroom" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2025 Crown Copyright All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    

<script src='../../../../js/popper.min.js'></script>
<script src='../../../../js/bootstrap.min.js'></script>






<script src='../../../../js/tabpane-persist.js'></script>




















<script src="../../../../js/main.min.cbc1d428d83561c4dec32da9374290554119d7483329f849251cb7153b2ecd07.js" integrity="sha256-y8HUKNg1YcTewy2pN0KQVUEZ10gzKfhJJRy3FTsuzQc=" crossorigin="anonymous"></script>



<script src='../../../../js/prism.js'></script>



  </body>
</html>
