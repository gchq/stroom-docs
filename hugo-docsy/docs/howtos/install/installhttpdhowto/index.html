<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.86.0" /><META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/stroom-docs/hugo-docsy/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/stroom-docs/hugo-docsy/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/stroom-docs/hugo-docsy/favicons/android-192x192.png" sizes="192x192">

<title>Apache Httpd/Mod_JK configuration for Stroom | Stroom</title>
<meta name="description" content="A Stroom example site"><meta property="og:title" content="Apache Httpd/Mod_JK configuration for Stroom" />
<meta property="og:description" content="The following is a HOWTO to assist users in configuring Apache&#39;s HTTPD with Mod_JK for Stroom.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://gchq.github.io/stroom-docs/hugo-docsy/docs/howtos/install/installhttpdhowto/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2021-07-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-07-27T09:42:18+01:00" /><meta property="og:site_name" content="Stroom" />

<meta itemprop="name" content="Apache Httpd/Mod_JK configuration for Stroom">
<meta itemprop="description" content="The following is a HOWTO to assist users in configuring Apache&#39;s HTTPD with Mod_JK for Stroom.
"><meta itemprop="datePublished" content="2021-07-12T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-07-27T09:42:18+01:00" />
<meta itemprop="wordCount" content="4040">
<meta itemprop="keywords" content="httpd,installation," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Apache Httpd/Mod_JK configuration for Stroom"/>
<meta name="twitter:description" content="The following is a HOWTO to assist users in configuring Apache&#39;s HTTPD with Mod_JK for Stroom.
"/>




<link rel="preload" href="/stroom-docs/hugo-docsy/scss/main.min.c8dc854e8995873c14a92d491085e920db121ca55be59dc47d6e43a3dd403c68.css" as="style">
<link href="/stroom-docs/hugo-docsy/scss/main.min.c8dc854e8995873c14a92d491085e920db121ca55be59dc47d6e43a3dd403c68.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>



<link rel="stylesheet" href="/stroom-docs/hugo-docsy/css/prism.css"/>




  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/stroom-docs/hugo-docsy/">
		<span class="navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="110.61089" height="30.000004" viewBox="0 0 88.488641 23.999957" id="svg2" inkscape:version="0.91 r13725" sodipodi:docname="logo.svg"><defs id="defs20"/><sodipodi:namedview pagecolor="#989898" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1137" id="namedview18" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:zoom="5.5951814" inkscape:cx="55.451414" inkscape:cy="16.275348" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="svg2"/><g id="g4150" style="opacity:.97000002" transform="matrix(0.03883584,0,0,0.03883584,0,-3.1155874e-4)"><path id="path6" d="M121.99991 205.98497C54.999958 205.98497.0 259.98493.0 327.98487c0 66.99994 54.999958 121.99989 121.99991 121.99989h167.99987c24.99998.0 44.99996 20.99998 44.99996 44.99996.0 24.99998-19.99998 44.99996-44.99996 44.99996H109.20929C65.984126 553.87219 27.100843 581.57313.01093599 617.98462H289.99978c66.99994.0 121.99991-54.99996 121.99991-122.9999.0-66.99994-54.99997-121.99989-121.99991-121.99989H121.99991c-24.999984.0-44.999969-19.99999-44.999969-44.99996.0-24.99998 19.999985-44.99996 44.999969-44.99996h228.79045c26.9905-35.88325 65.47093-63.18547 108.21554-76.99994H121.99991z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path8" d="M601.44485-.00077860649C572.6583 8.3697982 546.49491 22.822962 524.44491 41.902305V205.78969l.002.19528h-.002c-65.11 48e-5-123.03145 30.0199-160.74675 76.99994h160.74675v334.99971h76.99994V282.98491h144.85298c27.16134-36.05885 65.96411-63.39275 109.02184-76.99994H601.44485v-205.98574860649z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path10" d="m919.42586 205.98497c-113.99519.0-205.99537 92.00648-206.00296 205.99982-15e-5 68.67178.0 137.32749.0 205.99983h77.99994c-.012-68.6493.0176-137.46869.0-205.99983.0846-70.92785 57.05747-128.99988 128.00462-128.99988 5.28623.0 10.49823.32864 15.62183.95311 18.2219-24.51229 41.78461-45.0838 68.42501-60.15146-25.65065-11.43799-54.08662-17.80159-84.04684-17.80159z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path12" d="m1109.4153 205.98457c-113.99994.0-205.99983 91.99993-205.99983 205.99984.0 112.9999 91.99989 205.9998 205.99983 205.9998 114 0 205.9999-92.9999 205.9999-205.9998.0-113.99991-91.9999-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.99994-56.99996-128.99994-127.9999.0-70.99995 58.00004-128.9999 128.99994-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path14" d="m1444.4737 205.98457c-113.9999.0-205.9998 91.99993-205.9998 205.99984.0 112.9999 91.9999 205.9998 205.9998 205.9998s205.9999-92.9999 205.9999-205.9998c0-113.99991-92-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.9999-56.99996-128.9999-127.9999.0-70.99995 58-128.9999 128.9999-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path16" d="m1738.5308 379.98447c0-53 43-97 95.9999-97 53 0 97 44 97 97v237.9997h76.9999v-237.9997c0-53 43-97 96.9999-97 53 0 95.9999 44 95.9999 97v237.9997h77v-237.9997c0-96-77-173.9999-172.9999-173.9999-54.9999.0-103.9999 24.99998-135.9999 64.99995-31.9999-39.99997-79.9999-64.99995-134.9999-64.99995-95.9999.0-173.9998 77.9999-173.9998 173.9999v237.9997h77.9999z" style="fill:#fff" inkscape:connector-curvature="0"/></g></svg></span><span class="text-uppercase font-weight-bold">Stroom</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/stroom-docs/hugo-docsy/about/" ><span>About</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/stroom-docs/hugo-docsy/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/stroom-docs/hugo-docsy/news/" ><span>News / Releases</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/stroom-docs/hugo-docsy/community/" ><span>Community</span></a>
			</li>
			
			
			<li class="nav-item dropdown mr-4 d-none d-lg-block">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Stroom Versions
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="https://gchq.github.io/stroom-docs/hugo-docsy/">7.1</a>
	
	<a class="dropdown-item" href="https://gchq.github.io/stroom-docs/hugo-docsy/">7.0</a>
	
	<a class="dropdown-item" href="https://gchq.github.io/stroom-docs/">Legacy</a>
	
</div>

			</li>
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/stroom-docs/hugo-docsy/offline-search-index.895da905db5896b209f71d63ca298e9e.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="50"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/stroom-docs/hugo-docsy/offline-search-index.895da905db5896b209f71d63ca298e9e.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="50"
>


    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-stroom-docshugo-docsydocs-li">
  <a href="/stroom-docs/hugo-docsy/docs/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-stroom-docshugo-docsydocs"><span class="">Documentation</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stroom-docshugo-docsydocsquick-start-guide-li">
  <a href="/stroom-docs/hugo-docsy/docs/quick-start-guide/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsquick-start-guide"><span class="">Quick Start Guide</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsquick-start-guiderunning-li">
  <a href="/stroom-docs/hugo-docsy/docs/quick-start-guide/running/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsquick-start-guiderunning"><span class="">Running Stroom</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsquick-start-guidefeed-li">
  <a href="/stroom-docs/hugo-docsy/docs/quick-start-guide/feed/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsquick-start-guidefeed"><span class="">Feeds</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsquick-start-guideprocess-li">
  <a href="/stroom-docs/hugo-docsy/docs/quick-start-guide/process/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsquick-start-guideprocess"><span class="">Pipeline Processing</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsquick-start-guideindex-li">
  <a href="/stroom-docs/hugo-docsy/docs/quick-start-guide/index/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsquick-start-guideindex"><span class="">Indexing</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsquick-start-guidedashboard-li">
  <a href="/stroom-docs/hugo-docsy/docs/quick-start-guide/dashboard/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsquick-start-guidedashboard"><span class="">Dashboards</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-stroom-docshugo-docsydocshowtos-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocshowtos"><span class="">How Tos</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-stroom-docshugo-docsydocshowtosinstall-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocshowtosinstall"><span class="">Installation</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-stroom-docshugo-docsydocshowtosinstallinstallhttpdhowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installhttpdhowto/" title="Apache Httpd/Mod_JK configuration for Stroom" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstallhttpdhowto"><span class="td-sidebar-nav-active-item">Apache Httpd/Mod_JK</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stroom-docshugo-docsydocshowtosinstallinstalldatabasehowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installdatabasehowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstalldatabasehowto"><span class="">Database Installation</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stroom-docshugo-docsydocshowtosinstallinstallhowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installhowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstallhowto"><span class="">Installation</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stroom-docshugo-docsydocshowtosinstallinstallapplicationhowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installapplicationhowto/" title="Installation of Stroom Application" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstallapplicationhowto"><span class="">Installation of Stroom</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stroom-docshugo-docsydocshowtosinstallinstallproxyhowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installproxyhowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstallproxyhowto"><span class="">Installation of Stroom Proxy</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stroom-docshugo-docsydocshowtosinstallinstallnfshowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installnfshowto/" title="NFS Installation and Configuration" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstallnfshowto"><span class="">NFS</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stroom-docshugo-docsydocshowtosinstallinstallnodeshowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installnodeshowto/" title="Node Cluster URL Setup" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstallnodeshowto"><span class="">Node Cluster</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stroom-docshugo-docsydocshowtosinstallinstallprocessingusersetuphowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installprocessingusersetuphowto/" title="Processing User setup" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstallprocessingusersetuphowto"><span class="">Processing User</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stroom-docshugo-docsydocshowtosinstallinstallcertificateshowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installcertificateshowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstallcertificateshowto"><span class="">SSL Certificate Generation</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stroom-docshugo-docsydocshowtosinstallinstalltestinghowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installtestinghowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstalltestinghowto"><span class="">Testing Stroom Installation</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-stroom-docshugo-docsydocshowtosinstallinstallvolumeshowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/install/installvolumeshowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosinstallinstallvolumeshowto"><span class="">Volume Maintenance</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stroom-docshugo-docsydocshowtosreferencefeeds-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/referencefeeds/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocshowtosreferencefeeds"><span class="">Reference Feeds</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtosreferencefeedscreatesimplereferencefeeds-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/referencefeeds/createsimplereferencefeeds/" title="Create a Simple Reference Feed" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosreferencefeedscreatesimplereferencefeeds"><span class="">Create a Reference Feed</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stroom-docshugo-docsydocshowtossearch-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/search/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocshowtossearch"><span class="">Search</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtossearchelasticsearch-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/search/elasticsearch/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtossearchelasticsearch"><span class="">Elasticsearch integration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtossearchsearchfrombash-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/search/searchfrombash/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtossearchsearchfrombash"><span class="">Search API</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtossearchsolr-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/search/solr/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtossearchsolr"><span class="">Solr integration</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stroom-docshugo-docsydocshowtosadministration-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/administration/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocshowtosadministration"><span class="">Administration</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtosadministrationsystemproperties-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/administration/systemproperties/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosadministrationsystemproperties"><span class="">System Properties</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stroom-docshugo-docsydocshowtosauthentication-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/authentication/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocshowtosauthentication"><span class="">Authentication</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtosauthenticationcreateuserhowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/authentication/createuserhowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosauthenticationcreateuserhowto"><span class="">Create a user</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtosauthenticationuserloginhowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/authentication/userloginhowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosauthenticationuserloginhowto"><span class="">Login</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtosauthenticationuserlogouthowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/authentication/userlogouthowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosauthenticationuserlogouthowto"><span class="">Logout</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stroom-docshugo-docsydocshowtoseventfeeds-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/eventfeeds/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocshowtoseventfeeds"><span class="">Event Feeds</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtoseventfeedscreateapachehttpdeventfeed-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/eventfeeds/createapachehttpdeventfeed/" title="Apache HTTPD Event Feed" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtoseventfeedscreateapachehttpdeventfeed"><span class="">Apache HTTPD</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtoseventfeedsprocessinghowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/eventfeeds/processinghowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtoseventfeedsprocessinghowto"><span class="">Event Processing</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stroom-docshugo-docsydocshowtosgeneral-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/general/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocshowtosgeneral"><span class="">General</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtosgeneralfeedmanagementhowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/general/feedmanagementhowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosgeneralfeedmanagementhowto"><span class="">Feed Management</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtosgeneralrawsourcetracking-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/general/rawsourcetracking/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosgeneralrawsourcetracking"><span class="">Raw Source Tracking</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocshowtosgeneraltaskshowto-li">
  <a href="/stroom-docs/hugo-docsy/docs/howtos/general/taskshowto/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocshowtosgeneraltaskshowto"><span class="">Task Management</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stroom-docshugo-docsydocsproxy-li">
  <a href="/stroom-docs/hugo-docsy/docs/proxy/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsproxy"><span class="">Stroom Proxy</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsproxyapache-forwarding-li">
  <a href="/stroom-docs/hugo-docsy/docs/proxy/apache-forwarding/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsproxyapache-forwarding"><span class="">Apache Forwarding</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsproxydocker-li">
  <a href="/stroom-docs/hugo-docsy/docs/proxy/docker/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsproxydocker"><span class="">Running with docker</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsproxyinstall-li">
  <a href="/stroom-docs/hugo-docsy/docs/proxy/install/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsproxyinstall"><span class="">Stroom Proxy Installation</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stroom-docshugo-docsydocsstyle-guide-li">
  <a href="/stroom-docs/hugo-docsy/docs/style-guide/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsstyle-guide"><span class="">Style Guide (DRAFT)</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsstyle-guidebasic-elements-li">
  <a href="/stroom-docs/hugo-docsy/docs/style-guide/basic-elements/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsstyle-guidebasic-elements"><span class="">Basic Page Elements</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsstyle-guideusing-images-li">
  <a href="/stroom-docs/hugo-docsy/docs/style-guide/using-images/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsstyle-guideusing-images"><span class="">Images</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsstyle-guideicon-gallery-li">
  <a href="/stroom-docs/hugo-docsy/docs/style-guide/icon-gallery/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsstyle-guideicon-gallery"><span class="">Icon Gallery</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsstyle-guidesite-structure-li">
  <a href="/stroom-docs/hugo-docsy/docs/style-guide/site-structure/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsstyle-guidesite-structure"><span class="">Site Structure</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-stroom-docshugo-docsydocsdocsy-examples-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsdocsy-examples"><span class="">Docsy Examples (DRAFT)</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplesoverview-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/overview/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsdocsy-examplesoverview"><span class="">Overview</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplesgetting-started-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/getting-started/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsdocsy-examplesgetting-started"><span class="">Getting Started</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplesgetting-startedexample-page-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/getting-started/example-page/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsdocsy-examplesgetting-startedexample-page"><span class="">Example Page</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplesgetting-startedstroom_test-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/getting-started/stroom_test/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsdocsy-examplesgetting-startedstroom_test"><span class="">Stroom Test Page</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplesexamples-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/examples/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsdocsy-examplesexamples"><span class="">Examples</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplesconcepts-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/concepts/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsdocsy-examplesconcepts"><span class="">Concepts</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplestasks-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/tasks/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsdocsy-examplestasks"><span class="">Core Tasks</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplestasksbeds-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/tasks/beds/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsdocsy-examplestasksbeds"><span class="">Bed and Chair Metrics</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplestasksporridge-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/tasks/porridge/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsdocsy-examplestasksporridge"><span class="">Porridge Assessment</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplestaskstask-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/tasks/task/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsdocsy-examplestaskstask"><span class="">Another Task</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplestasksponycopters-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/tasks/ponycopters/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsdocsy-examplestasksponycopters"><span class="">Working with Ponycopters</span></a>
  <ul class="ul-4 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplestasksponycoptersconfiguring-ponycopters-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/tasks/ponycopters/configuring-ponycopters/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsdocsy-examplestasksponycoptersconfiguring-ponycopters"><span class="">Configuring Ponycopters</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplestasksponycopterslaunching-ponycopters-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/tasks/ponycopters/launching-ponycopters/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsdocsy-examplestasksponycopterslaunching-ponycopters"><span class="">Launching Ponycopters</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplestutorials-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/tutorials/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsdocsy-examplestutorials"><span class="">Tutorials</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplestutorialsmulti-bear-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/tutorials/multi-bear/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsdocsy-examplestutorialsmulti-bear"><span class="">Multi-Bear Domicile Setup</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplestutorialstutorial2-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/tutorials/tutorial2/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsdocsy-examplestutorialstutorial2"><span class="">Another Tutorial</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplesreference-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/reference/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsdocsy-examplesreference"><span class="">Reference</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplesreferenceparameter-reference-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/reference/parameter-reference/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-stroom-docshugo-docsydocsdocsy-examplesreferenceparameter-reference"><span class="">Parameter Reference</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-stroom-docshugo-docsydocsdocsy-examplescontribution-guidelines-li">
  <a href="/stroom-docs/hugo-docsy/docs/docsy-examples/contribution-guidelines/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-stroom-docshugo-docsydocsdocsy-examplescontribution-guidelines"><span class="">Contribution Guidelines</span></a>
</li>
  </ul>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
  
  
  
  
  
  
  <div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
  
    
    
      
    
    
    
    
    
    
    

    <a href="https://github.com/gchq/stroom-docs/edit/master/content/en/docs/HOWTOs/Install/InstallHttpdHowTo.md" target="_blank"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
    <a href="https://github.com/gchq/stroom-docs/new/master/content/en/docs/HOWTOs/Install/InstallHttpdHowTo.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" target="_blank"><i class="fa fa-edit fa-fw"></i> Create child page</a>
    <a href="https://github.com/gchq/stroom-docs/issues/new?title=Apache%20Httpd/Mod_JK%20configuration%20for%20Stroom" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
    
      
      <a href="https://github.com/gchq/stroom/issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
    

  
  
    <a id="print" href="https://gchq.github.io/stroom-docs/hugo-docsy/docs/howtos/install/_print/"><i class="fa fa-print fa-fw"></i> Print entire section</a>
  
  </div>


            


<div class="td-toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#assumptions">Assumptions</a></li>
    <li><a href="#installation-of-apache-httpd-and-mod_jk-software">Installation of Apache httpd and Mod_JK Software</a></li>
    <li><a href="#configure-apache-httpd">Configure Apache httpd</a>
      <ul>
        <li><a href="#forwarding-file-for-stroom-user-interface-deployments">Forwarding file for Stroom User Interface deployments</a></li>
        <li><a href="#httpdconf-configuration">Httpd.conf Configuration</a></li>
        <li><a href="#configuration-of-sslconf">Configuration of ssl.conf</a>
          <ul>
            <li><a href="#sslconf-http-to-https-redirection---all-scenarios">ssl.conf: HTTP to HTTPS Redirection - All scenarios</a></li>
            <li><a href="#sslconf-virtualhost-directives---multi-node-application-and-proxy-deployment">ssl.conf: VirtualHost directives - Multi Node &lsquo;Application and Proxy&rsquo; deployment</a></li>
            <li><a href="#sslconf-virtualhost-directives---standalone-or-forwarding-proxy-deployment">ssl.conf: VirtualHost directives - Standalone or Forwarding Proxy deployment</a></li>
            <li><a href="#sslconf-virtualhost-directives---single-node-application-and-proxy-deployment">ssl.conf: VirtualHost directives - Single Node &lsquo;Application and Proxy&rsquo; deployment</a></li>
            <li><a href="#sslconf-certificate-file-changes---all-scenarios">ssl.conf: Certificate file changes - All scenarios</a></li>
            <li><a href="#sslconf-certificate-bundleno-ca-verification---all-scenarios">ssl.conf: Certificate Bundle/NO-CA Verification - All scenarios</a></li>
            <li><a href="#sslconf-servlet-protection---single-or-multi-node-scenarios-not-for-standaloneforwarding-proxy">ssl.conf: Servlet Protection - Single or Multi Node scenarios (not for Standalone/Forwarding Proxy)</a></li>
            <li><a href="#sslconf-log-formats---all-scenarios">ssl.conf: Log formats - All scenarios</a></li>
          </ul>
        </li>
        <li><a href="#apache-mod_jk-configuration">Apache Mod_JK configuration</a>
          <ul>
            <li><a href="#mod_jk-multi-node-application-and-proxy-deployment">Mod_JK Multi Node Application and Proxy Deployment</a></li>
            <li><a href="#mod_jk-standalone-or-forwarding-stroom-proxy-deployment">Mod_JK Standalone or Forwarding Stroom Proxy Deployment</a></li>
            <li><a href="#mod_jk-single-node-application-and-proxy-deployment">Mod_JK Single Node Application and Proxy Deployment</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#final-host-configuration-and-web-service-enablement">Final host configuration and web service enablement</a></li>
  </ul>
</nav></div>



            

	
		



  
  

	
		



  
  
    <div class="taxonomy taxonomy-terms-cloud taxo-tags">
      
        <h5 class="taxonomy-title">Tags</h5>
      
      <ul class="taxonomy-terms">
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/authentication/" data-taxonomy-term="authentication"><span class="taxonomy-label">authentication</span><span class="taxonomy-count">3</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/certificates/" data-taxonomy-term="certificates"><span class="taxonomy-label">certificates</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/cluster/" data-taxonomy-term="cluster"><span class="taxonomy-label">cluster</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/configuration/" data-taxonomy-term="configuration"><span class="taxonomy-label">configuration</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/dashboard/" data-taxonomy-term="dashboard"><span class="taxonomy-label">dashboard</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/database/" data-taxonomy-term="database"><span class="taxonomy-label">database</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/docker/" data-taxonomy-term="docker"><span class="taxonomy-label">docker</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/elastic-search/" data-taxonomy-term="elastic-search"><span class="taxonomy-label">elastic-search</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/feed/" data-taxonomy-term="feed"><span class="taxonomy-label">feed</span><span class="taxonomy-count">4</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/httpd/" data-taxonomy-term="httpd"><span class="taxonomy-label">httpd</span><span class="taxonomy-count">2</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/index/" data-taxonomy-term="index"><span class="taxonomy-label">index</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/installation/" data-taxonomy-term="installation"><span class="taxonomy-label">installation</span><span class="taxonomy-count">12</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/jobs/" data-taxonomy-term="jobs"><span class="taxonomy-label">jobs</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/nfs/" data-taxonomy-term="nfs"><span class="taxonomy-label">NFS</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/processing/" data-taxonomy-term="processing"><span class="taxonomy-label">processing</span><span class="taxonomy-count">3</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/properties/" data-taxonomy-term="properties"><span class="taxonomy-label">properties</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/proxy/" data-taxonomy-term="proxy"><span class="taxonomy-label">proxy</span><span class="taxonomy-count">4</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/query/" data-taxonomy-term="query"><span class="taxonomy-label">query</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/raw/" data-taxonomy-term="raw"><span class="taxonomy-label">raw</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/reference-data/" data-taxonomy-term="reference-data"><span class="taxonomy-label">reference-data</span><span class="taxonomy-count">2</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/search/" data-taxonomy-term="search"><span class="taxonomy-label">search</span><span class="taxonomy-count">3</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/solr/" data-taxonomy-term="solr"><span class="taxonomy-label">solr</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/source/" data-taxonomy-term="source"><span class="taxonomy-label">source</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/style/" data-taxonomy-term="style"><span class="taxonomy-label">style</span><span class="taxonomy-count">3</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/tasks/" data-taxonomy-term="tasks"><span class="taxonomy-label">tasks</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/testing/" data-taxonomy-term="testing"><span class="taxonomy-label">testing</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/users/" data-taxonomy-term="users"><span class="taxonomy-label">users</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/v5/" data-taxonomy-term="v5"><span class="taxonomy-label">v5</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/visualisation/" data-taxonomy-term="visualisation"><span class="taxonomy-label">visualisation</span><span class="taxonomy-count">1</span></a></li>
        
          <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/volumes/" data-taxonomy-term="volumes"><span class="taxonomy-label">volumes</span><span class="taxonomy-count">1</span></a></li>
        
      </ul>
    </div>
  

	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		













<li class="breadcrumb-item" >
	<a href="https://gchq.github.io/stroom-docs/hugo-docsy/docs/">Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://gchq.github.io/stroom-docs/hugo-docsy/docs/howtos/">How Tos</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://gchq.github.io/stroom-docs/hugo-docsy/docs/howtos/install/">Installation</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://gchq.github.io/stroom-docs/hugo-docsy/docs/howtos/install/installhttpdhowto/">Apache Httpd/Mod_JK</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>Apache Httpd/Mod_JK configuration for Stroom</h1>
	<div class="lead">The following is a HOWTO to assist users in configuring Apache&rsquo;s HTTPD with Mod_JK for Stroom.</div>
	<header class="article-meta">
		
		
			
				


			
				


<div class="taxonomy taxonomy-terms-article taxo-tags">
  <h5 class="taxonomy-title">Tags:</h5>
  <ul class="taxonomy-terms">
    
      <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/httpd/" data-taxonomy-term="httpd"><span class="taxonomy-label">httpd</span></a></li>
    
      <li><a class="taxonomy-term" href="https://gchq.github.io/stroom-docs/hugo-docsy/tags/installation/" data-taxonomy-term="installation"><span class="taxonomy-label">installation</span></a></li>
    
  </ul>
</div>

			
		
		
	</header>    
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>the user has reasonable RHEL/Centos System administration skills</li>
<li>installations are on Centos 7.3 minimal systems (fully patched)</li>
<li>the security of the HTTPD deployment should be reviewed for a production environment.</li>
</ul>
<h2 id="installation-of-apache-httpd-and-mod_jk-software">Installation of Apache httpd and Mod_JK Software</h2>
<p>To deploy Stroom using Apache&rsquo;s httpd web service as a front end (https) and Apache&rsquo;s mod_jk as the interface between Apache and the Stroom tomcat applications, we also need</p>
<ul>
<li>apr</li>
<li>apr-util</li>
<li>apr-devel</li>
<li>gcc</li>
<li>httpd</li>
<li>httpd-devel</li>
<li>mod_ssl</li>
<li>epel-release</li>
<li>tomcat-native</li>
<li>apache&rsquo;s mod_jk tomcat connector plugin</li>
</ul>
<p>Most of the required software are packages available via standard repositories and hence we can simply execute</p>
<pre><code class="language-bash">sudo yum -y install apr apr-util apr-devel gcc httpd httpd-devel mod_ssl epel-release
sudo yum -y install tomcat-native
</code></pre>
<p>The reason for the distinct <code>tomcat-native</code> installation is that this package is from the <a href="https://fedoraproject.org/wiki/EPEL" title="Extra Packages for Enterprise Linux (EPEL)">EPEL (external link)</a> repository so it must be installed first.</p>
<p>For the Apache mod_jk Tomcat connector we need to acquire a recent
<a href="http://tomcat.apache.org/connectors-doc/" title="The Apache Tomcat Connectors: mod_jk, ISAPI redirector, NSAPI redirector">release (external link)</a> and install it.
The following commands achieve this for the 1.2.42 release.</p>
<pre><code class="language-bash">sudo bash
cd /tmp
V=1.2.42
wget https://www.apache.org/dist/tomcat/tomcat-connectors/jk/tomcat-connectors-${V}-src.tar.gz
tar xf tomcat-connectors-${V}-src.tar.gz
cd tomcat-connectors-*-src/native
./configure --with-apxs=/bin/apxs
make &amp;&amp; make install
cd /tmp
rm -rf tomcat-connectors-*-src
</code></pre>
<p>Although you could remove the gcc compiler at this point, we leave it installed as one <em>should</em> continue to upgrade the Tomcat Connectors to later releases.</p>
<h2 id="configure-apache-httpd">Configure Apache httpd</h2>
<p>We need to configure Apache as the <code>root</code> user.</p>
<p>If the Apache httpd service is &lsquo;fronting&rsquo; a Stroom user interface, we should create an index file (/var/www/html/index.html) on all nodes so browsing to
the root of the node will present the Stroom UI. This is not needed if you are deploying a Forwarding or Standalone Stroom proxy.</p>
<h3 id="forwarding-file-for-stroom-user-interface-deployments">Forwarding file for Stroom User Interface deployments</h3>
<pre><code class="language-bash">F=/var/www/html/index.html
printf '&lt;html&gt;\n' &gt; ${F}
printf '&lt;head&gt;\n' &gt;&gt; ${F}
printf '  &lt;meta http-equiv=&quot;Refresh&quot; content=&quot;0; URL=stroom&quot;/&gt;\n' &gt;&gt; ${F}
printf '&lt;/head&gt;\n' &gt;&gt; ${F}
printf '&lt;/html&gt;\n' &gt;&gt; ${F}
chmod 644 ${F}
</code></pre>
<p>Remember, deploy this file on all nodes running the Stroom Application.</p>
<h3 id="httpdconf-configuration">Httpd.conf Configuration</h3>
<p>We modify <code>/etc/httpd/conf/httpd.conf</code> on all nodes, but backup the file first with</p>
<pre><code class="language-bash">cp /etc/httpd/conf/httpd.conf /etc/httpd/conf/httpd.conf.ORIG
</code></pre>
<p>Irrespective of the Stroom scenario being deployed - Multi Node Stroom (Application and Proxy), single Standalone Stroom Proxy or single Forwarding
Stroom Proxy, the configuration of the <code>/etc/httpd/conf/httpd.conf</code> file is the same.</p>
<p>We start by modify the configuration file by,
add just before the ServerRoot directive the following directives which are designed to make the httpd service more secure.</p>
<pre><code class="language-text"># Stroom Change: Start - Apply generic security directives
ServerTokens Prod
ServerSignature Off
FileETag None
RewriteEngine On
RewriteCond %{THE_REQUEST} !HTTP/1.1$
RewriteRule .* - [F]
Header set X-XSS-Protection &quot;1; mode=block&quot;
# Stroom Change: End
</code></pre>
<p>That is,</p>
<pre><code>...
# Do not add a slash at the end of the directory path.  If you point
# ServerRoot at a non-local disk, be sure to specify a local disk on the
# Mutex directive, if file-based mutexes are used.  If you wish to share the
# same ServerRoot for multiple httpd daemons, you will need to change at
# least PidFile.
#
ServerRoot &quot;/etc/httpd&quot;

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
...
</code></pre>
<p>becomes</p>
<pre><code>...
# Do not add a slash at the end of the directory path.  If you point
# ServerRoot at a non-local disk, be sure to specify a local disk on the
# Mutex directive, if file-based mutexes are used.  If you wish to share the
# same ServerRoot for multiple httpd daemons, you will need to change at
# least PidFile.
#
# Stroom Change: Start - Apply generic security directives
ServerTokens Prod
ServerSignature Off
FileETag None
RewriteEngine On
RewriteCond %{THE_REQUEST} !HTTP/1.1$
RewriteRule .* - [F]
Header set X-XSS-Protection &quot;1; mode=block&quot;
# Stroom Change: End
ServerRoot &quot;/etc/httpd&quot;

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
...
</code></pre>
<p>We now block access to the /var/www directory by commenting out</p>
<pre><code>&lt;Directory &quot;/var/www&quot;&gt;
  AllowOverride None
  # Allow open access:
  Require all granted
&lt;/Directory&gt;
</code></pre>
<p>that is</p>
<pre><code>...
#
# Relax access to content within /var/www.
#
&lt;Directory &quot;/var/www&quot;&gt;
    AllowOverride None
    # Allow open access:
    Require all granted
&lt;/Directory&gt;

# Further relax access to the default document root:
...
</code></pre>
<p>becomes</p>
<pre><code>...
#
# Relax access to content within /var/www.
#
# Stroom Change: Start - Block access to /var/www
# &lt;Directory &quot;/var/www&quot;&gt;
#     AllowOverride None
#     # Allow open access:
#     Require all granted
# &lt;/Directory&gt;
# Stroom Change: End

# Further relax access to the default document root:
...
</code></pre>
<p>then within the /var/www/html directory turn off Indexes FollowSymLinks by commenting out the line</p>
<pre><code>Options Indexes FollowSymLinks
</code></pre>
<p>That is</p>
<pre><code>...
    # The Options directive is both complicated and important.  Please see
    # http://httpd.apache.org/docs/2.4/mod/core.html#options
    # for more information.
    #
    Options Indexes FollowSymLinks

    #
    # AllowOverride controls what directives may be placed in .htaccess files.
    # It can be &quot;All&quot;, &quot;None&quot;, or any combination of the keywords:
...
</code></pre>
<p>becomes</p>
<pre><code>...
    # The Options directive is both complicated and important.  Please see
    # http://httpd.apache.org/docs/2.4/mod/core.html#options
    # for more information.
    #
    # Stroom Change: Start - turn off indexes and FollowSymLinks
    # Options Indexes FollowSymLinks
    # Stroom Change: End

    #
    # AllowOverride controls what directives may be placed in .htaccess files.
    # It can be &quot;All&quot;, &quot;None&quot;, or any combination of the keywords:
...
</code></pre>
<p>Then finally we add two new log formats and configure the access log to use the new format. This is done within the <code>&lt;IfModule logio_module&gt;</code> by adding the two new LogFormat directives</p>
<pre><code>LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%u\&quot; \&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxUser
LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN}x\&quot; \&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxSSLUser
</code></pre>
<p>and replacing the CustomLog directive</p>
<pre><code>CustomLog &quot;logs/access_log&quot; combined
</code></pre>
<p>with</p>
<pre><code>CustomLog logs/access_log blackboxSSLUser
</code></pre>
<p>That is</p>
<pre><code>...
    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common

    &lt;IfModule logio_module&gt;
      # You need to enable mod_logio.c to use %I and %O
      LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %I %O&quot; combinedio
    &lt;/IfModule&gt;

    #
    # The location and format of the access logfile (Common Logfile Format).
    # If you do not define any access logfiles within a &lt;VirtualHost&gt;
    # container, they will be logged here.  Contrariwise, if you *do*
    # define per-&lt;VirtualHost&gt; access logfiles, transactions will be
    # logged therein and *not* in this file.
    #
    #CustomLog &quot;logs/access_log&quot; common

    #
    # If you prefer a logfile with access, agent, and referer information
    # (Combined Logfile Format) you can use the following directive.
    #
    CustomLog &quot;logs/access_log&quot; combined
&lt;/IfModule&gt;
...
</code></pre>
<p>becomes</p>
<pre><code>...
    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common

    &lt;IfModule logio_module&gt;
      # You need to enable mod_logio.c to use %I and %O
      LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %I %O&quot; combinedio
      # Stroom Change: Start - Add new logformats
      LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%u\&quot; \&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxUser
      LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN}x\&quot; \&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxSSLUser
      # Stroom Change: End
    &lt;/IfModule&gt;
    # Stroom Change: Start - Add new logformats without the additional byte values
    &lt;IfModule !logio_module&gt;
      LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%u\&quot; \&quot;%r\&quot; %s/%&gt;s %D 0/0/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxUser
      LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN}x\&quot; \&quot;%r\&quot; %s/%&gt;s %D 0/0/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxSSLUser
    &lt;/IfModule&gt;
    # Stroom Change: End

    #
    # The location and format of the access logfile (Common Logfile Format).
    # If you do not define any access logfiles within a &lt;VirtualHost&gt;
    # container, they will be logged here.  Contrariwise, if you *do*
    # define per-&lt;VirtualHost&gt; access logfiles, transactions will be
    # logged therein and *not* in this file.
    #
    #CustomLog &quot;logs/access_log&quot; common

    #
    # If you prefer a logfile with access, agent, and referer information
    # (Combined Logfile Format) you can use the following directive.
    #
    # Stroom Change: Start - Make the access log use a new format
    # CustomLog &quot;logs/access_log&quot; combined
    CustomLog logs/access_log blackboxSSLUser
    # Stroom Change: End
&lt;/IfModule&gt;
...
</code></pre>
<p>Remember, deploy this file on all nodes.</p>
<h3 id="configuration-of-sslconf">Configuration of ssl.conf</h3>
<p>We modify <code>/etc/httpd/conf.d/ssl.conf</code> on all nodes, backing up first,</p>
<pre><code class="language-base">cp /etc/httpd/conf.d/ssl.conf /etc/httpd/conf.d/ssl.conf.ORIG
</code></pre>
<p>The configuration of the <code>/etc/httpd/conf.d/ssl.conf</code> <strong>does</strong> change depending on the Stroom scenario deployed. In the following we will indicate
differences by tagged sub-headings. If the configuration applies irrespective of scenario, then <strong>All scenarios</strong> is the tag, else the tag indicated the
type of Stroom deployment.</p>
<h4 id="sslconf-http-to-https-redirection---all-scenarios">ssl.conf: HTTP to HTTPS Redirection - All scenarios</h4>
<p>Before the <VirtualHost _default_:443> context we add http to https redirection by adding the directives (noting we specify the actual server name)</p>
<pre><code>&lt;VirtualHost *:80&gt;
  ServerName stroomp00.strmdev00.org
  Redirect permanent &quot;/&quot; &quot;https://stroomp00.strmdev00.org/&quot;
&lt;/VirtualHost&gt;
</code></pre>
<p>That is, we change</p>
<pre><code>...
## SSL Virtual Host Context
##

&lt;VirtualHost _default_:443&gt;
...
</code></pre>
<p>to</p>
<pre><code>...
## SSL Virtual Host Context
##

# Stroom Change: Start - Add http redirection to https
&lt;VirtualHost *:80&gt;
  ServerName stroomp00.strmdev00.org
  Redirect permanent &quot;/&quot; &quot;https://stroomp00.strmdev00.org/&quot;
&lt;/VirtualHost&gt;
# Stroom Change: End

&lt;VirtualHost _default_:443&gt;
</code></pre>
<h4 id="sslconf-virtualhost-directives---multi-node-application-and-proxy-deployment">ssl.conf: VirtualHost directives - Multi Node &lsquo;Application and Proxy&rsquo; deployment</h4>
<p>Within the <VirtualHost _default_:443> context we set the directives, in this case, we use the CNAME <code>stroomp.strmdev00.org</code></p>
<pre><code>ServerName stroomp.strmdev00.org
JkMount /stroom* loadbalancer
JkMount /stroom/remoting/cluster* local
JkMount /stroom/datafeed* loadbalancer_proxy
JkMount /stroom/remoting* loadbalancer_proxy
JkMount /stroom/datafeed/direct* loadbalancer
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
</code></pre>
<p>That is, we change</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<p>to</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443
# Stroom Change: Start - Set servername and mod_jk connectivity
ServerName stroomp.strmdev00.org
JkMount /stroom* loadbalancer
JkMount /stroom/remoting/cluster* local
JkMount /stroom/datafeed* loadbalancer_proxy
JkMount /stroom/remoting* loadbalancer_proxy
JkMount /stroom/datafeed/direct* loadbalancer
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
# Stroom Change: End

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<h4 id="sslconf-virtualhost-directives---standalone-or-forwarding-proxy-deployment">ssl.conf: VirtualHost directives - Standalone or Forwarding Proxy deployment</h4>
<p>Within the <VirtualHost _default_:443> context set the directives, in this case, for a node named say <code>stroomfp0.strmdev00.org</code></p>
<pre><code>ServerName stroomfp0.strmdev00.org
JkMount /stroom/datafeed* local_proxy
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
</code></pre>
<p>That is, we change</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<p>to</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443
# Stroom Change: Start - Set servername and mod_jk connectivity
ServerName stroomfp0.strmdev00.org
JkMount /stroom/datafeed* local_proxy
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
# Stroom Change: End

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<h4 id="sslconf-virtualhost-directives---single-node-application-and-proxy-deployment">ssl.conf: VirtualHost directives - Single Node &lsquo;Application and Proxy&rsquo; deployment</h4>
<p>Within the <VirtualHost _default_:443> context set the directives, in this case, for a node name <code>stroomp00.strmdev00.org</code></p>
<pre><code>ServerName stroomp00.strmdev00.org
JkMount /stroom* local
JkMount /stroom/remoting/cluster* local
JkMount /stroom/datafeed* local_proxy
JkMount /stroom/remoting* local_proxy
JkMount /stroom/datafeed/direct* local
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
</code></pre>
<p>That is, we change</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<p>to</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443
# Stroom Change: Start - Set servername and mod_jk connectivity
ServerName stroomp00.strmdev00.org
JkMount /stroom* local
JkMount /stroom/remoting/cluster* local
JkMount /stroom/datafeed* local_proxy
JkMount /stroom/remoting* local_proxy
JkMount /stroom/datafeed/direct* local
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
# Stroom Change: End

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<h4 id="sslconf-certificate-file-changes---all-scenarios">ssl.conf: Certificate file changes - All scenarios</h4>
<p>We replace the standard certificate files with the generated certificates. In the example below, we are using the multi node scenario, in
that the key file names are <code>stroomp.crt</code> and <code>stroomp.key</code>. For other scenarios, use the appropriate file names generated. We replace</p>
<pre><code>SSLCertificateFile /etc/pki/tls/certs/localhost.crt
</code></pre>
<p>with</p>
<pre><code>SSLCertificateFile /home/stroomuser/stroom-jks/public/stroomp.crt
</code></pre>
<p>and</p>
<pre><code>SSLCertificateKeyFile /etc/pki/tls/private/localhost.key
</code></pre>
<p>with</p>
<pre><code>SSLCertificateKeyFile /home/stroomuser/stroom-jks/private/stroomp.key
</code></pre>
<p>That is, change</p>
<pre><code>...
# pass phrase.  Note that a kill -HUP will prompt again.  A new
# certificate can be generated using the genkey(1) command.
SSLCertificateFile /etc/pki/tls/certs/localhost.crt

#   Server Private Key:
#   If the key is not combined with the certificate, use this
#   directive to point at the key file.  Keep in mind that if
#   you've both a RSA and a DSA private key you can configure
#   both in parallel (to also allow the use of DSA ciphers, etc.)
SSLCertificateKeyFile /etc/pki/tls/private/localhost.key

#   Server Certificate Chain:
#   Point SSLCertificateChainFile at a file containing the
...
</code></pre>
<p>to</p>
<pre><code>...
# pass phrase.  Note that a kill -HUP will prompt again.  A new
# certificate can be generated using the genkey(1) command.
# Stroom Change: Start - Replace with Stroom server certificate
# SSLCertificateFile /etc/pki/tls/certs/localhost.crt
SSLCertificateFile /home/stroomuser/stroom-jks/public/stroomp.crt
# Stroom Change: End

#   Server Private Key:
#   If the key is not combined with the certificate, use this
#   directive to point at the key file.  Keep in mind that if
#   you've both a RSA and a DSA private key you can configure
#   both in parallel (to also allow the use of DSA ciphers, etc.)
# Stroom Change: Start - Replace with Stroom server private key file
# SSLCertificateKeyFile /etc/pki/tls/private/localhost.key
SSLCertificateKeyFile /home/stroomuser/stroom-jks/private/stroomp.key
# Stroom Change: End

#   Server Certificate Chain:
#   Point SSLCertificateChainFile at a file containing the
...
</code></pre>
<h4 id="sslconf-certificate-bundleno-ca-verification---all-scenarios">ssl.conf: Certificate Bundle/NO-CA Verification - All scenarios</h4>
<p>If you have signed your Stroom server certificate with a Certificate Authority, then change</p>
<pre><code>SSLCACertificateFile /etc/pki/tls/certs/ca-bundle.crt
</code></pre>
<p>to be your own certificate bundle which you should probably store as <code>~stroomuser/stroom-jks/public/stroomp-ca-bundle.crt</code>.</p>
<p>Now if you are using a self signed certificate, you will need to set the Client Authentication to have a value of</p>
<pre><code>SSLVerifyClient optional_no_ca
</code></pre>
<p>noting that this may change if you actually use a CA.
That is, changing</p>
<pre><code>...
#   Client Authentication (Type):
#   Client certificate verification type and depth.  Types are
#   none, optional, require and optional_no_ca.  Depth is a
#   number which specifies how deeply to verify the certificate
#   issuer chain before deciding the certificate is not valid.
#SSLVerifyClient require
#SSLVerifyDepth  10

#   Access Control:
#   With SSLRequire you can do per-directory access control based
...
</code></pre>
<p>to</p>
<pre><code>...
#   Client Authentication (Type):
#   Client certificate verification type and depth.  Types are
#   none, optional, require and optional_no_ca.  Depth is a
#   number which specifies how deeply to verify the certificate
#   issuer chain before deciding the certificate is not valid.
#SSLVerifyClient require
#SSLVerifyDepth  10
# Stroom Change: Start - Set optional_no_ca (given we have a self signed certificate)
SSLVerifyClient optional_no_ca
# Stroom Change: End

#   Access Control:
#   With SSLRequire you can do per-directory access control based
...
</code></pre>
<h4 id="sslconf-servlet-protection---single-or-multi-node-scenarios-not-for-standaloneforwarding-proxy">ssl.conf: Servlet Protection - Single or Multi Node scenarios (not for Standalone/Forwarding Proxy)</h4>
<p>We now need to secure certain Stroom Application servlets, to ensure they are only accessed under appropriate control.</p>
<p>This set of servlets will be accessible by all nodes in the subnet 192.168.2 (as well as localhost). We achieve this by adding after the example Location directives</p>
<pre><code>&lt;Location ~ &quot;stroom/(status|echo|sessionList|debug)&quot; &gt;
 Require all denied
 Require ip 127.0.0.1 192.168.2
&lt;/Location&gt;
</code></pre>
<p>We further restrict the clustercall and export servlets to just the localhost. If we had multiple Stroom processing nodes, you would specify each node, or preferably, the subnet they are on. In our multi node case this is 192.168.2.</p>
<pre><code>&lt;Location ~ &quot;stroom/export/|stroom/remoting/clustercall.rpc&quot; &gt;
 Require all denied
 Require ip 127.0.0.1 192.168.2
&lt;/Location&gt;
</code></pre>
<p>That is, the following</p>
<pre><code>...
#            and %{TIME_WDAY} &gt;= 1 and %{TIME_WDAY} &lt;= 5 \
#            and %{TIME_HOUR} &gt;= 8 and %{TIME_HOUR} &lt;= 20       ) \
#           or %{REMOTE_ADDR} =~ m/^192\.76\.162\.[0-9]+$/
#&lt;/Location&gt;

#   SSL Engine Options:
#   Set various options for the SSL engine.
#   o FakeBasicAuth:
...
</code></pre>
<p>changes to</p>
<pre><code>...
#            and %{TIME_WDAY} &gt;= 1 and %{TIME_WDAY} &lt;= 5 \
#            and %{TIME_HOUR} &gt;= 8 and %{TIME_HOUR} &lt;= 20       ) \
#           or %{REMOTE_ADDR} =~ m/^192\.76\.162\.[0-9]+$/
#&lt;/Location&gt;

# Stroom Change: Start - Lock access to certain servlets
&lt;Location ~ &quot;stroom/(status|echo|sessionList|debug)&quot; &gt;
 Require all denied
 Require ip 127.0.0.1 192.168.2
&lt;/Location&gt;
# Lock these Servlets more securely - to just localhost and processing node(s)
&lt;Location ~ &quot;stroom/export/|stroom/remoting/clustercall.rpc&quot; &gt;
 Require all denied
 Require ip 127.0.0.1 192.168.2
&lt;/Location&gt;
# Stroom Change: End

#   SSL Engine Options:
#   Set various options for the SSL engine.
#   o FakeBasicAuth:
...
</code></pre>
<h4 id="sslconf-log-formats---all-scenarios">ssl.conf: Log formats - All scenarios</h4>
<p>Finally, as we make use of the Black Box Apache log format, we replace the standard format</p>
<pre><code>CustomLog logs/ssl_request_log \
        &quot;%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \&quot;%r\&quot; %b&quot;
</code></pre>
<p>with</p>
<pre><code>CustomLog logs/ssl_request_log blackboxSSLUser
</code></pre>
<p>That is, change</p>
<pre><code>...
#   Per-Server Logging:
#   The home of a custom SSL log file. Use this when you want a
#   compact non-error SSL logfile on a virtual host basis.
CustomLog logs/ssl_request_log \
          &quot;%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \&quot;%r\&quot; %b&quot;

&lt;/VirtualHost&gt;
</code></pre>
<p>to</p>
<pre><code>...
#   Per-Server Logging:
#   The home of a custom SSL log file. Use this when you want a
#   compact non-error SSL logfile on a virtual host basis.
# Stroom Change: Start - Change ssl_request log to use our BlackBox format
# CustomLog logs/ssl_request_log \
#           &quot;%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \&quot;%r\&quot; %b&quot;
CustomLog logs/ssl_request_log blackboxSSLUser
# Stroom Change: End

&lt;/VirtualHost&gt;
</code></pre>
<p>Remember, in the case of Multi node stroom Application servers, deploy this file on all servers.</p>
<h3 id="apache-mod_jk-configuration">Apache Mod_JK configuration</h3>
<p>Apache Mod_JK has two configuration files</p>
<ul>
<li>/etc/httpd/conf.d/mod_jk.conf - for the http server configuration</li>
<li>/etc/httpd/conf/workers.properties - to configure the Tomcat workers</li>
</ul>
<p>In multi node scenarios, <code>/etc/httpd/conf.d/mod_jk.conf</code> is the same on all servers, but the <code>/etc/httpd/conf/workers.properties</code> file is different.
The contents of these two configuration files differ depending on the Stroom deployment. The following provide the various deployment scenarios.</p>
<h4 id="mod_jk-multi-node-application-and-proxy-deployment">Mod_JK Multi Node Application and Proxy Deployment</h4>
<p>For a Stroom Multi node Application and Proxy server,</p>
<ul>
<li>we configure <code>/etc/httpd/conf.d/mod_jk.conf</code> as per</li>
</ul>
<pre><code class="language-bash">F=/etc/httpd/conf.d/mod_jk.conf
printf 'LoadModule jk_module modules/mod_jk.so\n' &gt; ${F}
printf 'JkWorkersFile conf/workers.properties\n' &gt;&gt; ${F}
printf 'JkLogFile logs/mod_jk.log\n' &gt;&gt; ${F}
printf 'JkLogLevel info\n' &gt;&gt; ${F}
printf 'JkLogStampFormat  &quot;[%%a %%b %%d %%H:%%M:%%S %%Y]&quot;\n' &gt;&gt; ${F}
printf 'JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories\n' &gt;&gt; ${F}
printf 'JkRequestLogFormat &quot;%%w %%V %%T&quot;\n' &gt;&gt; ${F}
printf 'JkMount /stroom* loadbalancer\n' &gt;&gt; ${F}
printf 'JkMount /stroom/remoting/cluster* local\n' &gt;&gt; ${F}
printf 'JkMount /stroom/datafeed* loadbalancer_proxy\n' &gt;&gt; ${F}
printf 'JkMount /stroom/remoting* loadbalancer_proxy\n' &gt;&gt; ${F}
printf 'JkMount /stroom/datafeed/direct* loadbalancer\n' &gt;&gt; ${F}
printf '# Note: Replaced JkShmFile logs/jk.shm due to SELinux issues. Refer to\n' &gt;&gt; ${F}
printf '# https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=225452\n' &gt;&gt; ${F}
printf '# The following makes use of the existing /run/httpd directory\n' &gt;&gt; ${F}
printf 'JkShmFile run/jk.shm\n' &gt;&gt; ${F}
printf '&lt;Location /jkstatus/&gt;\n' &gt;&gt; ${F}
printf '  JkMount status\n' &gt;&gt; ${F}
printf '  Order deny,allow\n' &gt;&gt; ${F}
printf '  Deny from all\n' &gt;&gt; ${F}
printf '  Allow from 127.0.0.1\n' &gt;&gt; ${F}
printf '&lt;/Location&gt;\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<ul>
<li>we configure <code>/etc/httpd/conf/workers.properties</code> as per</li>
</ul>
<p>Since we are deploying for a cluster with load balancing, we need a <em>workers.properties</em> file per node. Executing the following will result in two files (<em>workers.properties.stroomp00</em> and <em>workers.properties.stroomp01</em>) which should be deployed to their respective servers.</p>
<pre><code class="language-bash">cd /tmp
# Set the list of nodes
Nodes=&quot;stroomp00.strmdev00.org stroomp01.strmdev00.org&quot;
for oN in ${Nodes}; do
  _n=`echo ${oN} | cut -f1 -d\.`
  (
  printf '# Workers.properties for Stroom Cluster member: %s %s\n' ${oN}
  printf 'worker.list=loadbalancer,loadbalancer_proxy,local,local_proxy,status\n'
  L_t=&quot;&quot;
  Lp_t=&quot;&quot;
  for FQDN in ${Nodes}; do
    N=`echo ${FQDN} | cut -f1 -d\.`
    printf 'worker.%s.port=8009\n' ${N}
    printf 'worker.%s.host=%s\n' ${N} ${FQDN}
    printf 'worker.%s.type=ajp13\n' ${N}
    printf 'worker.%s.lbfactor=1\n' ${N}
    printf 'worker.%s.max_packet_size=65536\n' ${N}
    printf 'worker.%s_proxy.port=9009\n' ${N}
    printf 'worker.%s_proxy.host=%s\n' ${N} ${FQDN}
    printf 'worker.%s_proxy.type=ajp13\n' ${N}
    printf 'worker.%s_proxy.lbfactor=1\n' ${N}
    printf 'worker.%s_proxy.max_packet_size=65536\n' ${N}
    L_t=&quot;${L_t}${N},&quot;
    Lp_t=&quot;${Lp_t}${N}_proxy,&quot;
  done
  L=`echo $L_t | sed -e 's/.$//'`
  Lp=`echo $Lp_t | sed -e 's/.$//'`
  printf 'worker.loadbalancer.type=lb\n'
  printf 'worker.loadbalancer.balance_workers=%s\n' $L
  printf 'worker.loadbalancer.sticky_session=1\n'
  printf 'worker.loadbalancer_proxy.type=lb\n'
  printf 'worker.loadbalancer_proxy.balance_workers=%s\n' $Lp
  printf 'worker.loadbalancer_proxy.sticky_session=1\n'
  printf 'worker.local.type=lb\n'
  printf 'worker.local.balance_workers=%s\n' ${_n}
  printf 'worker.local.sticky_session=1\n'
  printf 'worker.local_proxy.type=lb\n'
  printf 'worker.local_proxy.balance_workers=%s_proxy\n' ${_n}
  printf 'worker.local_proxy.sticky_session=1\n'
  printf 'worker.status.type=status\n'
  ) &gt; workers.properties.${_n}
  chmod 640 workers.properties.${_n}
done
</code></pre>
<p>Now depending in the node you are on, copy the relevant workers.properties.nodename file to /etc/httpd/conf/workers.properties. The following command makes this simple.</p>
<pre><code class="language-bash">cp workers.properties.`hostname -s` /etc/httpd/conf/workers.properties
</code></pre>
<p>If you were to add an additional node to a multi node cluster, say the node <code>stroomp02.strmdev00.org</code>, then you would re-run the above script with</p>
<pre><code class="language-bash">Nodes=&quot;stroomp00.strmdev00.org stroomp01.strmdev00.org stroomp02.strmdev00.org&quot;
</code></pre>
<p>then redeploy all three files to the respective servers. Also note, that for the newly created workers.properties files for the existing nodes to
take effect you will need to restart the Apache Httpd service on both nodes.</p>
<p>Remember, in multi node cluster deployments, the following files are the same and hence can be created on one node, but copied to the
others not forgetting to backup the other node&rsquo;s original files. That is, the files</p>
<ul>
<li>/var/www/html/index.html</li>
<li>/etc/httpd/conf.d/mod_jk.conf</li>
<li>/etc/httpd/conf/httpd.conf</li>
</ul>
<p>are to be the same on all nodes. Only the /etc/httpd/conf.d/ssl.conf and /etc/httpd/conf/workers.properties files change.</p>
<h4 id="mod_jk-standalone-or-forwarding-stroom-proxy-deployment">Mod_JK Standalone or Forwarding Stroom Proxy Deployment</h4>
<p>For a Stroom Standalone or Forwarding proxy,</p>
<ul>
<li>we configure <code>/etc/httpd/conf.d/mod_jk.conf</code> as per</li>
</ul>
<pre><code class="language-bash">F=/etc/httpd/conf.d/mod_jk.conf
printf 'LoadModule jk_module modules/mod_jk.so\n' &gt; ${F}
printf 'JkWorkersFile conf/workers.properties\n' &gt;&gt; ${F}
printf 'JkLogFile logs/mod_jk.log\n' &gt;&gt; ${F}
printf 'JkLogLevel info\n' &gt;&gt; ${F}
printf 'JkLogStampFormat  &quot;[%%a %%b %%d %%H:%%M:%%S %%Y]&quot;\n' &gt;&gt; ${F}
printf 'JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories\n' &gt;&gt; ${F}
printf 'JkRequestLogFormat &quot;%%w %%V %%T&quot;\n' &gt;&gt; ${F}
printf 'JkMount /stroom/datafeed* local_proxy\n' &gt;&gt; ${F}
printf '# Note: Replaced JkShmFile logs/jk.shm due to SELinux issues. Refer to\n' &gt;&gt; ${F}
printf '# https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=225452\n' &gt;&gt; ${F}
printf '# The following makes use of the existing /run/httpd directory\n' &gt;&gt; ${F}
printf 'JkShmFile run/jk.shm\n' &gt;&gt; ${F}
printf '&lt;Location /jkstatus/&gt;\n' &gt;&gt; ${F}
printf '  JkMount status\n' &gt;&gt; ${F}
printf '  Order deny,allow\n' &gt;&gt; ${F}
printf '  Deny from all\n' &gt;&gt; ${F}
printf '  Allow from 127.0.0.1\n' &gt;&gt; ${F}
printf '&lt;/Location&gt;\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<ul>
<li>we configure <code>/etc/httpd/conf/workers.properties</code> as per</li>
</ul>
<p>The variable <strong>N</strong> in the script below is to be the node name (not FQDN) of your sever (i.e. stroomfp0).</p>
<pre><code class="language-bash">N=stroomfp0
FQDN=`hostname -f`
F=/etc/httpd/conf/workers.properties
printf 'worker.list=local_proxy,status\n' &gt; ${F}
printf 'worker.%s_proxy.port=9009\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.host=%s\n' ${N} ${FQDN} &gt;&gt; ${F}
printf 'worker.%s_proxy.type=ajp13\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.lbfactor=1\n' ${N} &gt;&gt; ${F}
printf 'worker.local_proxy.type=lb\n' &gt;&gt; ${F}
printf 'worker.local_proxy.balance_workers=%s_proxy\n' ${N} &gt;&gt; ${F}
printf 'worker.local_proxy.sticky_session=1\n' &gt;&gt; ${F}
printf 'worker.status.type=status\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<h4 id="mod_jk-single-node-application-and-proxy-deployment">Mod_JK Single Node Application and Proxy Deployment</h4>
<p>For a Stroom Single node Application and Proxy server,</p>
<ul>
<li>we configure <code>/etc/httpd/conf.d/mod_jk.conf</code> as per</li>
</ul>
<pre><code class="language-bash">F=/etc/httpd/conf.d/mod_jk.conf
printf 'LoadModule jk_module modules/mod_jk.so\n' &gt; ${F}
printf 'JkWorkersFile conf/workers.properties\n' &gt;&gt; ${F}
printf 'JkLogFile logs/mod_jk.log\n' &gt;&gt; ${F}
printf 'JkLogLevel info\n' &gt;&gt; ${F}
printf 'JkLogStampFormat  &quot;[%%a %%b %%d %%H:%%M:%%S %%Y]&quot;\n' &gt;&gt; ${F}
printf 'JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories\n' &gt;&gt; ${F}
printf 'JkRequestLogFormat &quot;%%w %%V %%T&quot;\n' &gt;&gt; ${F}
printf 'JkMount /stroom* local\n' &gt;&gt; ${F}
printf 'JkMount /stroom/remoting/cluster* local\n' &gt;&gt; ${F}
printf 'JkMount /stroom/datafeed* local_proxy\n' &gt;&gt; ${F}
printf 'JkMount /stroom/remoting* local_proxy\n' &gt;&gt; ${F}
printf 'JkMount /stroom/datafeed/direct* local\n' &gt;&gt; ${F}
printf '# Note: Replaced JkShmFile logs/jk.shm due to SELinux issues. Refer to\n' &gt;&gt; ${F}
printf '# https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=225452\n' &gt;&gt; ${F}
printf '# The following makes use of the existing /run/httpd directory\n' &gt;&gt; ${F}
printf 'JkShmFile run/jk.shm\n' &gt;&gt; ${F}
printf '&lt;Location /jkstatus/&gt;\n' &gt;&gt; ${F}
printf '  JkMount status\n' &gt;&gt; ${F}
printf '  Order deny,allow\n' &gt;&gt; ${F}
printf '  Deny from all\n' &gt;&gt; ${F}
printf '  Allow from 127.0.0.1\n' &gt;&gt; ${F}
printf '&lt;/Location&gt;\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<ul>
<li>we configure <code>/etc/httpd/conf/workers.properties</code> as per</li>
</ul>
<p>The variable <strong>N</strong> in the script below is to be the node name (not FQDN) of your sever (i.e. stroomp00).</p>
<pre><code class="language-bash">N=stroomp00
FQDN=`hostname -f`
F=/etc/httpd/conf/workers.properties
printf 'worker.list=local,local_proxy,status\n' &gt; ${F}
printf 'worker.%s.port=8009\n' ${N} &gt;&gt; ${F}
printf 'worker.%s.host=%s\n' ${N} ${FQDN} &gt;&gt; ${F}
printf 'worker.%s.type=ajp13\n' ${N} &gt;&gt; ${F}
printf 'worker.%s.lbfactor=1\n' ${N} &gt;&gt; ${F}
printf 'worker.%s.max_packet_size=65536\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.port=9009\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.host=%s\n' ${N} ${FQDN} &gt;&gt; ${F}
printf 'worker.%s_proxy.type=ajp13\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.lbfactor=1\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.max_packet_size=65536\n' ${N} &gt;&gt; ${F}
printf 'worker.local.type=lb\n' &gt;&gt; ${F}
printf 'worker.local.balance_workers=%s\n' ${N} &gt;&gt; ${F}
printf 'worker.local.sticky_session=1\n' &gt;&gt; ${F}
printf 'worker.local_proxy.type=lb\n' &gt;&gt; ${F}
printf 'worker.local_proxy.balance_workers=%s_proxy\n' ${N} &gt;&gt; ${F}
printf 'worker.local_proxy.sticky_session=1\n' &gt;&gt; ${F}
printf 'worker.status.type=status\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<h2 id="final-host-configuration-and-web-service-enablement">Final host configuration and web service enablement</h2>
<p>Now tidy up the SELinux context for access on all nodes and files via the commands</p>
<pre><code class="language-bash">setsebool -P httpd_enable_homedirs on
setsebool -P httpd_can_network_connect on
chcon --reference /etc/httpd/conf.d/README /etc/httpd/conf.d/mod_jk.conf
chcon --reference /etc/httpd/conf/magic /etc/httpd/conf/workers.properties
</code></pre>
<p>We also enable both http and https services via the firewall on all nodes. If you don&rsquo;t want to present a http access point,
then don&rsquo;t enable it in the firewall setting. This is done with</p>
<pre><code class="language-bash">firewall-cmd --zone=public --add-service=http --permanent
firewall-cmd --zone=public --add-service=https --permanent
firewall-cmd --reload
firewall-cmd --zone=public --list-all
</code></pre>
<p>Finally enable then start the httpd service, correcting any errors. It should be noted that on any errors,
the suggestion of a systemctl status or viewing the journal are good, but also review information in the httpd error logs found in <code>/var/log/httpd/</code>.</p>
<pre><code class="language-bash">systemctl enable httpd.service
systemctl start httpd.service
</code></pre>

	
	
	<div class="text-muted mt-5 pt-3 border-top">

    Last modified
    July 27, 2021
    : <a  href="https://github.com/gchq/stroom-docs/commit/49bc354f7748817df2f59d2db463ba7fb4efba3a">Move quick-start-guide images (49bc354)</a>

</div>

</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/gchq/stroom" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 Crown Copyright 2021 All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>






 













<script src="/stroom-docs/hugo-docsy/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js" integrity="sha256-OxcsE7YsK&#43;qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin="anonymous"></script>



<script src='/stroom-docs/hugo-docsy/js/prism.js'></script>



  </body>
</html>