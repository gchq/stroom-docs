<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.95.0" />
<link rel="canonical" type="text/html" href="../../../docs/howtos/">
<meta name="robots" content="noindex, nofollow">


<link rel="canonical" href="../../../../">


<link rel="shortcut icon" href="../../../favicons/favicon.ico" >
<link rel="apple-touch-icon" href="../../../favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="../../../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../../../favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="../../../favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../../../favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="../../../favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="../../../favicons/android-192x192.png" sizes="192x192">

<title>How Tos | Stroom</title>
<meta name="description" content="This is a series of *HOWTOs* that are designed to get one started with Stroom. The *HOWTOs* are broken down into different functional concepts or areas of Stroom.
">
<meta property="og:title" content="How Tos" />
<meta property="og:description" content="This is a series of *HOWTOs* that are designed to get one started with Stroom. The *HOWTOs* are broken down into different functional concepts or areas of Stroom.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/howtos/" /><meta property="og:site_name" content="Stroom" />

<meta itemprop="name" content="How Tos">
<meta itemprop="description" content="This is a series of *HOWTOs* that are designed to get one started with Stroom. The *HOWTOs* are broken down into different functional concepts or areas of Stroom.
"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How Tos"/>
<meta name="twitter:description" content="This is a series of *HOWTOs* that are designed to get one started with Stroom. The *HOWTOs* are broken down into different functional concepts or areas of Stroom.
"/>




<link rel="preload" href="../../../scss/main.min.9f5ad9a5a4b3baa052b8de502edf7a1c7b3297f7bca39dfe306feff85e5d9897.css" as="style">
<link href="../../../scss/main.min.9f5ad9a5a4b3baa052b8de502edf7a1c7b3297f7bca39dfe306feff85e5d9897.css" rel="stylesheet" integrity="">


<script src='../../../js/jquery-3.6.0.min.js'></script>


<script src='../../../js/lunr.min.js'></script>
  
<link rel="stylesheet" href="../../../css/prism.css"/>



  </head>
  <body class="td-section">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="../../../"><span class="navbar-brand__logo navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="110.61089" height="30.000004" viewBox="0 0 88.488641 23.999957" id="svg2" inkscape:version="0.91 r13725" sodipodi:docname="logo.svg"><defs id="defs20"/><sodipodi:namedview pagecolor="#989898" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1137" id="namedview18" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:zoom="5.5951814" inkscape:cx="55.451414" inkscape:cy="16.275348" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="svg2"/><g id="g4150" style="opacity:.97000002" transform="matrix(0.03883584,0,0,0.03883584,0,-3.1155874e-4)"><path id="path6" d="M121.99991 205.98497C54.999958 205.98497.0 259.98493.0 327.98487c0 66.99994 54.999958 121.99989 121.99991 121.99989h167.99987c24.99998.0 44.99996 20.99998 44.99996 44.99996.0 24.99998-19.99998 44.99996-44.99996 44.99996H109.20929C65.984126 553.87219 27.100843 581.57313.01093599 617.98462H289.99978c66.99994.0 121.99991-54.99996 121.99991-122.9999.0-66.99994-54.99997-121.99989-121.99991-121.99989H121.99991c-24.999984.0-44.999969-19.99999-44.999969-44.99996.0-24.99998 19.999985-44.99996 44.999969-44.99996h228.79045c26.9905-35.88325 65.47093-63.18547 108.21554-76.99994H121.99991z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path8" d="M601.44485-.00077860649C572.6583 8.3697982 546.49491 22.822962 524.44491 41.902305V205.78969l.002.19528h-.002c-65.11 48e-5-123.03145 30.0199-160.74675 76.99994h160.74675v334.99971h76.99994V282.98491h144.85298c27.16134-36.05885 65.96411-63.39275 109.02184-76.99994H601.44485v-205.98574860649z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path10" d="m919.42586 205.98497c-113.99519.0-205.99537 92.00648-206.00296 205.99982-15e-5 68.67178.0 137.32749.0 205.99983h77.99994c-.012-68.6493.0176-137.46869.0-205.99983.0846-70.92785 57.05747-128.99988 128.00462-128.99988 5.28623.0 10.49823.32864 15.62183.95311 18.2219-24.51229 41.78461-45.0838 68.42501-60.15146-25.65065-11.43799-54.08662-17.80159-84.04684-17.80159z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path12" d="m1109.4153 205.98457c-113.99994.0-205.99983 91.99993-205.99983 205.99984.0 112.9999 91.99989 205.9998 205.99983 205.9998 114 0 205.9999-92.9999 205.9999-205.9998.0-113.99991-91.9999-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.99994-56.99996-128.99994-127.9999.0-70.99995 58.00004-128.9999 128.99994-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path14" d="m1444.4737 205.98457c-113.9999.0-205.9998 91.99993-205.9998 205.99984.0 112.9999 91.9999 205.9998 205.9998 205.9998s205.9999-92.9999 205.9999-205.9998c0-113.99991-92-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.9999-56.99996-128.9999-127.9999.0-70.99995 58-128.9999 128.9999-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path16" d="m1738.5308 379.98447c0-53 43-97 95.9999-97 53 0 97 44 97 97v237.9997h76.9999v-237.9997c0-53 43-97 96.9999-97 53 0 95.9999 44 95.9999 97v237.9997h77v-237.9997c0-96-77-173.9999-172.9999-173.9999-54.9999.0-103.9999 24.99998-135.9999 64.99995-31.9999-39.99997-79.9999-64.99995-134.9999-64.99995-95.9999.0-173.9998 77.9999-173.9998 173.9999v237.9997h77.9999z" style="fill:#fff" inkscape:connector-curvature="0"/></g></svg></span><span class="navbar-brand__name">Stroom</span></a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="../../../about/about/"><span>About</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link active" href="../../../docs/"><span class="active">Documentation</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="../../../releases/"><span>Releases Notes</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="../../../community/"><span>Community</span></a>
      </li>
      <li class="nav-item dropdown mr-4 d-none d-lg-block">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Stroom Version (7.0)
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	
	
	<a class="dropdown-item" href="../../../../">7.6 (Latest)</a>
	
	<a class="dropdown-item" href="../../../../7.5">7.5</a>
	
	<a class="dropdown-item" href="../../../../7.4">7.4</a>
	
	<a class="dropdown-item" href="../../../../7.3">7.3</a>
	
	<a class="dropdown-item" href="../../../../7.2">7.2</a>
	
	<a class="dropdown-item" href="../../../../7.1">7.1</a>
	
	<a class="dropdown-item" href="../../../">7.0</a>
	
	<a class="dropdown-item" href="../../../../legacy">Legacy</a>
	
</div>
</li>
      </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="../../../offline-search-index.c9e0222a4334011bd4e06156082d1a88.json"
    data-offline-search-base-href="../../../"
    data-offline-search-max-results="50"
  >
</div>

  </div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="../../../docs/howtos/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">How Tos</h1>
<div class="lead">This is a series of <em>HOWTOs</em> that are designed to get one started with Stroom. The <em>HOWTOs</em> are broken down into different functional concepts or areas of Stroom.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-fd26b0362a5ef080d30d5b17267aa92d">General</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>1.1: <a href="#pg-c1774aa8e3596cef30847edd591d65cc">Enabling Processors</a></li>


    
  
    
    
	
<li>1.2: <a href="#pg-125417638bc89642c176a77825d0a7cf">Explorer Management</a></li>


    
  
    
    
	
<li>1.3: <a href="#pg-bda32d7256f308042de9aa5e35facc20">Feed Management</a></li>


    
  
    
    
	
<li>1.4: <a href="#pg-539a05846ccfc6ea9aaa02403d8d4be0">Raw Source Tracking</a></li>


    
  
    
    
	
<li>1.5: <a href="#pg-591a4b717a58b789a35c85adbace1b0c">Task Management</a></li>


    
  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-28964c3a5d9236a1740816422613941f">Administration</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.1: <a href="#pg-0b76ec0221067e4df0417f79c30e159d">System Properties</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-e1a1534a2750f91fe96eedf5e87798ca">Authentication</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1: <a href="#pg-f8eef5b4748b57510b328ba975ed968f">Create a user</a></li>


    
  
    
    
	
<li>3.2: <a href="#pg-51e73b087842d591d96091681a3d2f4c">Login</a></li>


    
  
    
    
	
<li>3.3: <a href="#pg-b890044b086b0af2d02c19cdbb1ef642">Logout</a></li>


    
  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-05ac22234589a8130c163fe287318d24">Installation</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>4.1: <a href="#pg-82aa13e518a524f24a7b8e335aad1203">Apache Httpd/Mod_JK configuration for Stroom</a></li>


    
  
    
    
	
<li>4.2: <a href="#pg-ed03feb41ce97db6bd52aaca9e8e2276">Database Installation</a></li>


    
  
    
    
	
<li>4.3: <a href="#pg-86ea86569879380008d85e7b9a20e6fe">Installation</a></li>


    
  
    
    
	
<li>4.4: <a href="#pg-41b0d4ff1e99a75027ba01fe4180ef2b">Installation of Stroom Application</a></li>


    
  
    
    
	
<li>4.5: <a href="#pg-13c4bed09b40651e4a0ec3326dd4d404">Installation of Stroom Proxy</a></li>


    
  
    
    
	
<li>4.6: <a href="#pg-8f351908a29ef3b1acce233351630e06">NFS Installation and Configuration</a></li>


    
  
    
    
	
<li>4.7: <a href="#pg-e1902c7f9911560579e1b0418879914b">Node Cluster URL Setup</a></li>


    
  
    
    
	
<li>4.8: <a href="#pg-2cd81f535c13c52b322e27141321700f">Processing User setup</a></li>


    
  
    
    
	
<li>4.9: <a href="#pg-15073cc8313abe2f3ac870d7650fdf59">SSL Certificate Generation</a></li>


    
  
    
    
	
<li>4.10: <a href="#pg-e9a18d235554418fd3d74b4db41248ae">Testing Stroom Installation</a></li>


    
  
    
    
	
<li>4.11: <a href="#pg-2ef6500b50bd5b10b788f5f28d20bfbe">Volume Maintenance</a></li>


    
  

    </ul>
    
  
    
    
	
<li>5: <a href="#pg-e7fffeb5cb3e8aec39005a5ceae1fc8b">Event Feeds</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>5.1: <a href="#pg-5fc7c4e24c9ba560fe48c8b7d7bd2717">Writing an XSLT Translation</a></li>


    
  
    
    
	
<li>5.2: <a href="#pg-388147b082f84379beb8941e0b22eb4c">Apache HTTPD Event Feed</a></li>


    
  
    
    
	
<li>5.3: <a href="#pg-656f55bea6a3f201557a536fbbd05b1a">Event Processing</a></li>


    
  

    </ul>
    
  
    
    
	
<li>6: <a href="#pg-87a637151168d6d82c881ea18b31af35">Reference Feeds</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>6.1: <a href="#pg-4d7d330b5f12d891a26573075b19d451">Use a Reference Feed</a></li>


    
  
    
    
	
<li>6.2: <a href="#pg-5a8e03835fa0abb246a40bb39bc465d5">Create a Simple Reference Feed</a></li>


    
  

    </ul>
    
  
    
    
	
<li>7: <a href="#pg-a8dc99605d0ca1bf62927e149cb91965">Search</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>7.1: <a href="#pg-8b7048c9a87146a09d8583a0c24e6139">Elasticsearch integration</a></li>


    
  
    
    
	
<li>7.2: <a href="#pg-1903af404d4813cef8da382cea0f650d">Search API</a></li>


    
  
    
    
	
<li>7.3: <a href="#pg-afe3aae761f55c7bc015a6134f44f6d5">Solr integration</a></li>


    
  

    </ul>
    
  
    
    
	
<li>8: <a href="#pg-e3bc865056467ce77e907a179d52fbb5">Event Post Processing</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>8.1: <a href="#pg-11dc23704255d3336b69c10c5c6a88d1">Event Forwarding</a></li>


    
  

    </ul>
    
  

    </ul>


<div class="content">
      
<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>


    These <em>HOWTOs</em> will match the development of Stroom and as a result, various elements will be updated over time, including screen captures.
In some instances, screen captures will contain timestamps and so you may note inconsistent date or time movements within a complete HOWTO, although if a sequence of captures is contained within a section of a document, they all will be replaced.

</div>


<h2 id="general">General</h2>
<p><a href="../../../docs/howtos/general/rawsourcetracking/">Raw Source Tracking</a> show how to associate a processed Event with the source line that generated it.</p>
<p>Other topics in this section are</p>
<ol>
<li><a href="../../../docs/howtos/general/taskshowto/">Feed Management</a>.</li>
<li><a href="../../../docs/howtos/general/taskshowto/">Tasks</a></li>
<li><a href="../../../docs/howtos/general/explorermanagementhowto/">Moving Object in Explorer</a></li>
<li><a href="../../../docs/howtos/general/enablingprocessorshowto/">Enabling Processors</a></li>
</ol>
<h2 id="administration">Administration</h2>
<p>HOWTO documents that illustrate how to perform certain system administration tasks within Stroom: <a href="../../../docs/howtos/administration/systemproperties/">Manage System Properties</a></p>
<h2 id="authentication">Authentication</h2>
<p>Contains <a href="../../../docs/howtos/authentication/userloginhowto/">User Login</a>, <a href="../../../docs/howtos/authentication/userlogouthowto/">User Logout</a>, <a href="../../../docs/howtos/authentication/createuserhowto/">Create User</a> HOWTO documents.</p>
<h2 id="installation">Installation</h2>
<p>The <a href="../../../docs/howtos/install/installhowto/">Installation Scenarios</a> HOWTO is provided to assist users in setting up a number
of different Stroom deployments.</p>
<h2 id="event-feed-processing">Event Feed Processing</h2>
<p>The <a href="../../../docs/howtos/eventfeeds/processinghowto/">Event Feed Processing</a> HOWTO is provided to assist users in setting up Stroom to process inbound event logs and transform them into the Stroom Event Logging XML Schema.</p>
<p>The <a href="../../../docs/howtos/eventfeeds/createapachehttpdeventfeed/">Apache HTTPD Event Feed</a> is interwoven into other HOWTOs that utilise this feed as a datasource.</p>
<h2 id="reference-feeds">Reference Feeds</h2>
<p>Reference Feeds are used to provide look up data for a translation.
The reference feed HOWTOs illustrate how to create reference feeds <a href="../../../docs/howtos/referencefeeds/createsimplereferencefeed/">Create Reference Feed</a> and how to use look up reference data maps to enrich the data you are processing <a href="../../../docs/howtos/referencefeeds/usesimplereferencefeedhowto/">Use Reference Feed</a>.</p>
<h2 id="searches-and-indexing">Searches and Indexing</h2>
<p>This section covers Indexing and Searching for data in Stroom</p>
<ul>
<li><a href="../../../docs/howtos/search/searchfrombash/">Search using bash</a></li>
<li><a href="../../../docs/howtos/search/elasticsearch/">Elasticsearch integration</a></li>
<li><a href="../../../docs/howtos/search/solr/">Solr integration</a></li>
</ul>
<h2 id="event-post-processing">Event Post Processing</h2>
<p>The <a href="../../../docs/howtos/eventpostprocessing/eventforwardinghowto/">Event Forwarding</a> HOWTO demonstrates how to extract certain events from the Stroom event store and export the events in XML to a file system.</p>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '1.'; page-break-before: always">
    
  <h1 id="pg-fd26b0362a5ef080d30d5b17267aa92d">1 - General</h1>
    <div class="lead">General How Tos for using Stroom.</div>
	
</div>




    
      
  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '1.1.'; ">
    
  <h1 id="pg-c1774aa8e3596cef30847edd591d65cc">1.1 - Enabling Processors</h1>
    <div class="lead">How to enable processing for a Pipeline.</div>
	<!-- Created with Stroom v6.1-beta.16 -->

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">See Also</h4>


    <p><a href="../../../docs/howtos/referencefeeds/createsimplereferencefeed/">HOWTO - Creating a Simple Reference Feed</a></p>


</div>


<h2 id="introduction">Introduction</h2>
<p>A pipeline is a structure that allows for the processing of streams of data.
Once you have defined a pipeline, built its structure, and tested it via &lsquo;Stepping&rsquo; the pipeline, you will want to enable the automatic processing of raw event data streams.
In this example we will build on our <code>Apache-SSLBlackBox-V2.0-EVENTS</code> event feed and enable automatic processing of raw event data streams. <br>
If this is the first time you have set up pipeline processing on your Stroom instance you may need to check that the <strong>Stream Processor</strong> job is enabled on your Stroom instance.
Refer to the Stream Processor Tasks section of the Stroom HOWTO - Task Maintenance
documentation for detailed instruction on this.</p>
<h2 id="pipeline">Pipeline</h2>
<p>Initially we need to open the <code>Apache-SSLBlackBox-V2.0-EVENTS</code> pipeline.
Within the Explorer pane, navigate to the Apache HTTPD folder, then double click on the</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Pipeline.svg" 
    title="Pipeline" 
    alt="document/Pipeline.svg">


 <em>Apache-SSLBlackBox-V2.0-EVENTS</em> Pipeline</p>
<p>to bring up the <code>Apache-SSLBlackBox-V2.0-EVENTS</code> pipeline configuration tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-01.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-01.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - Apache HTTPD pipeline</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Next, select the <strong>Processors</strong> sub-item to show</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-02.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-02.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline processors tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This configuration tab is divided into two panes.
The top pane shows the current enabled Processors and any recently processed streams and the bottom pane provides meta-data about each Processor or recently processed streams.</p>
<h3 id="add-a-processor">Add a Processor</h3>
<p>We now want to add A Processor for the <code>Apache-SSLBlackBox-V2.0-EVENTS</code> pipeline.</p>
<p>First, move the mouse to the Add Processor 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add" 
    alt="add.svg">


 icon at the top left of the top pane.
Select by left clicking this icon to display the <strong>Add Filter</strong> selection window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-03.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-03.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Add Filter selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This selection window allows us to <em>filter</em> what set of data streams we want our Processor to process.
As our intent is to enable processing for all Apache-SSLBlackBox-V2.0-EVENT streams, both already received and yet to be received, then our filtering criteria is just to process all Raw Events streams for this feed, ignoring all other conditions.</p>
<p>To do this, first click on the <strong>Add Term</strong> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add" 
    alt="add.svg">


 icon.
Keep the term and operator at the default settings, and select the <strong>Choose item</strong> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/assorted/popup.png" 
    title="Select Feed" 
    alt="assorted/popup.png">


 icon to navigate to the desired feed name (<em>Apache-SSLBlackBox-V2.0-EVENT</em>) object</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-04.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-04.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Processors - choose feed name</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and press <strong>OK</strong> to make the selection.</p>
<p>Next, we select the required <em>stream type</em>.
To do this click on the <strong>Add Term</strong> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add" 
    alt="add.svg">


 icon again.
Click on the down arrow to change the Term selection from <em>Feed</em> to <em>Type</em>.
Click in the <strong>Value</strong> position on the highlighted line (it will be currently empty).
Once you have clicked here a drop-down box will appear as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-05.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-05.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Processors - choose type</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>at which point, select the <em>Stream Type</em> of <strong>Raw Events</strong> and then press <strong>OK</strong>.
At this we return to the <strong>Add Processor</strong> selection window to see that the <em>Raw Events</em> stream type has been added.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-06.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-06.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Processors - pipeline criteria set</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If the expected feed rate is small, for example, <em>NOT</em> operating system or database access feeds, then you would leave the Processor <strong>Priority</strong> at the default of <em>10</em>.
Typically, Apache HTTPD access events are not considered to have an excessive feed rate (by comparison to operating system or database access feeds), so we leave the <strong>Priority</strong> at <em>10</em>.</p>
<p>Note the Processor has been added but it is in a <strong>disabled</strong> state.
We <strong>enable</strong> both pipeline processor and the processor filter by checking <em>both</em> <strong>Enabled</strong> check boxes</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-07.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-07.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-07.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-07.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Processors - Enable</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Once the processor has been enabled, at first you will see nothing.
But if you press the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


 button at the top of the right of the top pane, you will see that the <em>Child</em> processor has processed a stream, listing the time it did it and also listing the last time the processor looked for more streams to process and how many it found.
If your event feed contained multiple streams you would see the streams count incrementing and the <strong>Tracker%</strong> incrementing (when the Tracker% reaches 100% then all current streams you filtered for have been processed).
You may need to click on the refresh 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


 icon to see the stream count and Tracker% changes.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-10.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-10.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-10.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-10.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Processor state</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>When in the <strong>Processors</strong> sub-item, if we select the Parent Processor, then no meta-data is displayed</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-08.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-08.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-08.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-08.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Display Parent Processor</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we select the Parent&rsquo;s child, then we see the meta-data for this, the actual actionable Processor</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-09.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-09.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-09.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-09.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Display Child Processor</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If you select the <strong>Active Tasks</strong> sub-item, you will see a summary of the recently processed streams</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-11.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-11.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-11.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-11.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Processor status</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The top pane provides a summary table of recent stream batches processed, based on Pipeline and Feed, and if selected, the individual streams will be displayed in the bottom pane</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-12.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-12.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-12.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-12.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Processor status selected</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If further detail is required, then left click on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/info.svg" 
    title="Info" 
    alt="info.svg">


 icon at the top left of a pane.
This will reveal additional information such as</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-13.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-13.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-13.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-13.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Processor infoA</figcaption>
      </div>
      
    </figure>
  </a>
</div>








  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-14.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-14.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-14.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-14.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Processor infoB</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
<p>At this point, if you click on the <strong>Data</strong> sub-item you will see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-15.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-15.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-15.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-15.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Data Tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This view displays the recently processed streams in the top pane.
If a stream is selected, then the <em>Specific</em> stream and any related streams are displayed in the middle pane and the bottom pane displays the data itself</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-16.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-16.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-16.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-16.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Data Tab Selected</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As you can see, the processed stream has an associated <em>Raw Events</em> stream.
If we click on that stream we will see the raw data</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-17.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-17.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-17.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-17.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Data Tab Raw Selected</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h3 id="processor-errors">Processor Errors</h3>
<p>Occasionally you may need to reprocess a stream.
This is most likely required as a result of correcting translation issues during the development phase, or it can occur from the data source having an unexpected change (unnotified application upgrade for example).
You can reprocess a stream by selecting its check box and then pressing the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/process.svg" 
    title="Process" 
    alt="process.svg">


 icon in the top left of the same pane.
This will cause the pipeline to reprocess the selected stream.
One can only reprocess <em>Event</em> or <em>Error</em> streams.</p>
<p>In the below example we have a stream that is displaying errors (this was due to a translation that did not conform to the schema version).</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-18.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-18.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-18.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-18.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Data Events Selected</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Once the translation was remediated to remove schema issues the pipeline could successfully process the stream and the errors disappeared.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-19.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-19.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-19.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-19.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Data Events reprocessed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You should be aware that if you need to reprocess bulk streams that there is an upper limit of 1000 streams that can be reprocessed in a single batch.
As at Stroom v6 if you exceed this number then you receive no error notification but the task never completes.
The reason for this behaviour is to do with database performance and complexity.
When you reprocess the current selection of filtered data, it can contain data that has resulted from many pipelines and this requires creation of new processor filters for each of these pipelines.
Due to this complexity there exists an arbitrary limit of 1000 streams.</p>
<p>A workaround for this limitation is to create batches of &lsquo;Events&rsquo; by filtering the event streams based on <strong>Type</strong> and <strong>Create Time</strong>.</p>
<p>For example in our <code>Apache-SSLBlackBox-V2.0-EVENTS</code> event feed select the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/filter.svg" 
    title="Filter" 
    alt="filter.svg">


 icon.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-20.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-20.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-20.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-20.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Data Events reprocessed filter </figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Filter the feed by errors and creation time.
Then click <strong>OK</strong>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-21.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-21.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-21.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-21.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Data Events reprocessed filter selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You will need to adjust the  create time range until you get the number of event streams displayed in the feed window below 1000.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-22.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-22.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-22.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-22.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Data Events reprocessed filter selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Once you are displaying less than 1000 streams you can select all the streams in your filtered selection by clicking in the topmost check box.
Then click on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/process.svg" 
    title="Reprocess" 
    alt="process.svg">


 icon to reprocess these streams.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-EnableProcessors-23.png" href="../../../images/HOWTOs/v6/UI-EnableProcessors-23.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-EnableProcessors-23.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-EnableProcessors-23.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI EnableProcessors - pipeline Data Events reprocessed filter selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Repeat the process in batches of less that 1000 until your entire error stream backlog has been reprocessed.</p>
<p>In a worst case senario, one can also delete a set of streams for a given time period and then reprocess them all.
The only risk here is that if there
are other pipelines that trigger on Event creation, you will activate them.</p>
<p>The reprocessing may result in having two index entries in an index.
Stroom dashboards can silently cater for this, or you may chose to re-flatten data to some external downstream capability.</p>
<p>When considering reprocessing streams there are some other &lsquo;downstream effects&rsquo; to be mindful of.</p>
<p>If you have indexing in place, then additional index documents will be added to the index as the indexing capability does not replace documents, but adds them.
If there are only a small number of streams reprocessed then there should not be too big an index storage impost, but should a large number of streams be reprocessed, then consideration of rebuilding resultant indices may need to be considered.</p>
<p>If the pipeline exports data for consumption by another capability, then you will have exported a portion of the data twice.
Depending on the risk of downstream data duplication, you may need to prevent the export or the consumption of the export.
Some ways to address this can vary from creating a new pipeline to reprocess the errant streams which does not export data, to temporarily redirecting the export destination whilst reprocessing and preventing ingest of new source data to the pipeline at the same time.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '1.2.'; page-break-before: always">
    
  <h1 id="pg-125417638bc89642c176a77825d0a7cf">1.2 - Explorer Management</h1>
    <div class="lead">How to manage Documents and Entities in the Explorer Tree.</div>
	<!-- Created with Stroom v6.1-beta.16  -->
<h2 id="moving-a-set-of-objects">Moving a set of Objects</h2>
<p>The following shows how to create a System Folder(s) within the Explorer tree and move a set of objects into the new structure.
We will create the system group GeoHost Reference and move all the GeoHost reference feed objects into this system group.
Because Stroom Explorer is a flat structure you can move resources around to reorganise the content without any impact on directory paths, configurations etc.</p>
<h3 id="create-a-system-group">Create a System Group</h3>
<p>First, move your mouse over the <code>Event Sources</code> object in the explorer, single click to highlight this object to highlight, you will see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-00.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-00.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - Highlighted object in Explorer</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now right click to bring up the object context menu</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-01.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-01.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - Menu in Explorer</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Next move the mouse over the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 New icon to reveal the New sub-context menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-02.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-02.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - Sub-Menu in Explorer</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Click on the folder 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/folder.svg" 
    title="Folder" 
    alt="folder.svg">


 icon, at which point the <em>New Folder</em> selection window will be presented</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-03.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-03.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - New folder selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We will enter the name <em>Reference</em> into the <strong>Name:</strong> entry box</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-04.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-04.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - New folder selection - Name</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>With the newly created <code>Reference</code> folder highlighted, repeat the above process but use the folder <strong>Name:</strong> of GeoHost</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-05.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-05.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - New folder selection - Name</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then click 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to save.</p>
<p>Note that we could have navigated within the explorer tree but as we want the Reference/GeoHost system group at the top level of the <code>Event Sources</code> group, there is no need to perform any navigation.
Had we needed to, double click any system group that contains objects, indicated by the   icon and to select the system group you want to store your new group in, just left or right click the mouse once over the group to select it.
You will note that the <code>Event Sources</code> system group was selected above.</p>
<p>At this point, our new folders will display in the main pane.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-06.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-06.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - New folders created</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You can look at the folder properties by selecting the desired folder, right clicking and choosing <em>Info</em> option</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-07.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-07.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-07.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-07.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - New folder Info</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This will return a window with folder specific information</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-08.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-08.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-08.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-08.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - New folder Info detail</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Should you wish to limit the users who can access this folder, you similarly select the desired folder, right click and choose <em>Permissions</em></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-09.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-09.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-09.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-09.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - New folder Permissions</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You can limit folder access as required in the resultant window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-10.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-10.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-10.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-10.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI ExplorerManagement - New folder set Permissions</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Make any required changes and click on 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to save the changes.</p>
<h3 id="moving-objects-into-a-system-group">Moving Objects into a System Group</h3>
<p>Now you have created the new folder structure you can move the various GeoHost resources to this location.</p>
<p>Select all four resources by using the mouse right-click button while holding down the <em>Shift</em> key.
Then right click on the highlighted group to display the action menu</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-11.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-11.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-11.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-11.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Organise Resources - move content</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Select <strong>move</strong> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/move.svg" 
    title="Move" 
    alt="move.svg">


 and the <em>Move Multiple Items</em> window will display.
Navigate to the <code>Reference/GeoHost</code> folder to move the items to this destination.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-12.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-12.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-12.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-12.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Organise Resources - select destination</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The final structure is seen below</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-13.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-13.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-13.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-13.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Organise Resources - finished</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note that when a folder contains child objects this is indicated by a folder icon with an arrow to the left of the folder.
Whether the arrow is pointing right 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/tree-closed.svg" 
    title="Tree branch closed" 
    alt="tree-closed.svg">


 or down 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/tree-open.svg" 
    title="Tree branch open" 
    alt="tree-open.svg">


 indicates whether or not the folder is expanded.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ExplorerMgmt-14.png" href="../../../images/HOWTOs/v6/UI-ExplorerMgmt-14.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ExplorerMgmt-14.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ExplorerMgmt-14.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Organise Resources - finished</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The GeoHost resources move has now been completed.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '1.3.'; page-break-before: always">
    
  <h1 id="pg-bda32d7256f308042de9aa5e35facc20">1.3 - Feed Management</h1>
    <div class="lead">This HOWTO demonstrates how to manage feeds.</div>
	<p>This HOWTO demonstrates how to manage
<a href="../../../docs/user-guide/feeds/">Feeds</a></p>
<h2 id="assumptions">Assumptions</h2>
<ul>
<li>All Sections
<ul>
<li>an account with the <code>Administrator</code> Application <a href="../../../docs/user-guide/roles/">Permission</a> is currently logged in.</li>
</ul>
</li>
</ul>
<h2 id="creation-of-an-event-feed">Creation of an Event Feed</h2>
<p>We will be creating an Event Feed with the name <code>TEST-FEED-V1_0</code>.</p>
<p>Once you have logged in, move the cursor to the <strong>System</strong> folder within the <code>Explorer</code> tab and select it.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-CreateFeed-00.png" href="../../../images/HOWTOs/UI-CreateFeed-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-CreateFeed-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-CreateFeed-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - System selected</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Once selected, <em>right click</em> to bring up the <code>New Item</code> selection sub-menu. By selecting the <strong>System</strong> folder we are
requesting any  <em>new</em> item created to be placed within it.</p>
<p>Select 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Feed.svg" 
    title="Feed" 
    alt="document/Feed.svg">


 <em>Feed</em>.</p>
<p>You will be presented with a <code>New Feed</code> configuration window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-CreateFeed-02.png" href="../../../images/HOWTOs/UI-CreateFeed-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-CreateFeed-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-CreateFeed-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New feed configuration window</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You will note that the <strong>System</strong> folder has already been selected as the <em>parent group</em> and all we need to do is enter our feed&rsquo;s name in the <strong>Name:</strong> entry box</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-CreateFeed-03.png" href="../../../images/HOWTOs/UI-CreateFeed-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-CreateFeed-03.png" style="max-width: fit-content" alt="images/HOWTOs/UI-CreateFeed-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New feed configuration window enter name</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>On pressing 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 we are presented with the <code>Feed</code> tab for our new feed. The tab is labelled with the feed name <code>TEST-FEED-V1_0</code>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-CreateFeed-04.png" href="../../../images/HOWTOs/UI-CreateFeed-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-CreateFeed-04.png" style="max-width: fit-content" alt="images/HOWTOs/UI-CreateFeed-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New feed tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We will leave the definitions of the Feed attributes for the present, but we <em>will</em> enter a <strong>Description:</strong> for our feed
as we should <em>ALWAYS</em> do this fundamental tenet of data management - document the data. We will use
the description of &lsquo;<em>Feed for installation validation only. No data value</em>&rsquo;.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-CreateFeed-05.png" href="../../../images/HOWTOs/UI-CreateFeed-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-CreateFeed-05.png" style="max-width: fit-content" alt="images/HOWTOs/UI-CreateFeed-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New feed tab with Description</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>One should note that the 







  



  





  <span class="stroom-tab stroom-tab-active" title="Feed tab - 'TEST-FEED-V1_0'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Feed.svg" 
      title="TEST-FEED-V1_0" 
      alt="Feed.svg">
    <span class="stroom-tab-name">* TEST-FEED-V1_0</span>
    <span class="stroom-tab-cross">×</span>
  </span>


 tab has been marked as having unsaved changes.
This is indicated by the asterisk character <code>*</code> between the <em>Feed</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Feed.svg" 
    title="Feed" 
    alt="document/Feed.svg">


 and the name of the feed <code>TEST-FEED-V1_0</code>.
We can save the changes to our feed by pressing the <em>Save</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 in the top left of the <code>TEST-FEED-V1_0</code> tab. At this point one should notice two things, the first is that the asterisk
has disappeared from the <code>Feed</code> tab and the <em>Save</em> icon 






  




  <img 
    class="stroom-icon stroom-icon-disabled" 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 is <em>ghosted</em>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-CreateFeed-06.png" href="../../../images/HOWTOs/UI-CreateFeed-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-CreateFeed-06.png" style="max-width: fit-content" alt="images/HOWTOs/UI-CreateFeed-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New feed tab with description saved</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h2 id="folder-structure-for-event-sources">Folder Structure for Event Sources</h2>
<p>In order to simplify the management of multiple event sources being processed by Stroom, it is suggested that an Event Source folder is created at the root of the <strong>System</strong> folder 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/oo.svg" 
    title="System" 
    alt="oo.svg">


 in the <code>Explorer</code> tab.</p>
<p>This can be achieved by right clicking on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/oo.svg" 
    title="System" 
    alt="oo.svg">


 <em>System</em> root folder and selecting</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/folder.svg" 
    title="Folder" 
    alt="folder.svg">


 <em>Folder</em></p>
<p>You will be presented with a <code>New Folder</code> configuration window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-EventSources-01.png" href="../../../images/HOWTOs/UI-EventSources-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-EventSources-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-EventSources-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Folder - New folder configuration window</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You will note that the <strong>System</strong> folder has already been selected as the <em>parent group</em> and all we need to do is enter our folders&rsquo;s name in the <strong>Name:</strong> entry box</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-EventSources-02.png" href="../../../images/HOWTOs/UI-EventSources-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-EventSources-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-EventSources-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Folder - New folder configuration window enter name</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>On pressing 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 we are presented with the 







  







  <span class="stroom-tab stroom-tab-active" title="Folder tab - 'Event Sources'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Folder.svg" 
      title="Event Sources" 
      alt="Folder.svg">
    <span class="stroom-tab-name">Event Sources</span>
    <span class="stroom-tab-cross">×</span>
  </span>


 tab for our new folder.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-EventSources-03.png" href="../../../images/HOWTOs/UI-EventSources-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-EventSources-03.png" style="max-width: fit-content" alt="images/HOWTOs/UI-EventSources-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Folder - New folder tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You will also note that the <code>Explorer</code> tab has displayed the <strong>Event Sources</strong> folder in its display.</p>
<h3 id="create-folder-for-specific-event-source">Create Folder for specific Event Source</h3>
<p>In order to manage all artefacts of a given Event Source (aka <code>Feed</code>), one would create an appropriately named sub-folder within the <strong>Event Sources</strong> folder structure.</p>
<p>In this example, we will create one for a BlueCoat Proxy <code>Feed</code>.</p>
<p>As we may eventually have multiple proxy event sources, we will first create a <strong>Proxy</strong> folder in the <strong>Event Sources</strong> before creating the desired <strong>BlueCoat</strong> folder that will hold the processing components.</p>
<p>So, right-click on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Folder.svg" 
    title="Folder" 
    alt="document/Folder.svg">


 <em>Event Sources</em> folder in the Explorer tree and select:</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/folder.svg" 
    title="Folder" 
    alt="folder.svg">


 <em>Folder</em></p>
<p>You will be presented with a <code>New Folder</code> configuration window.</p>
<p>Enter <strong>Proxy</strong> as the folder <strong>Name:</strong></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-EventSources-04.png" href="../../../images/HOWTOs/UI-EventSources-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-EventSources-04.png" style="max-width: fit-content" alt="images/HOWTOs/UI-EventSources-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Folder - New sub folder configuration window</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.</p>
<p>At this you will be presented with a new 







  







  <span class="stroom-tab stroom-tab-active" title="Folder tab - 'Proxy'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Folder.svg" 
      title="Proxy" 
      alt="Folder.svg">
    <span class="stroom-tab-name">Proxy</span>
    <span class="stroom-tab-cross">×</span>
  </span>


 tab for the new sub-folder and we note that it has been added below the <strong>Event Sources</strong> folder in the Explorer tree.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-EventSources-05.png" href="../../../images/HOWTOs/UI-EventSources-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-EventSources-05.png" style="max-width: fit-content" alt="images/HOWTOs/UI-EventSources-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Folder - New sub folder tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Repeat this process to create the desired <strong>BlueCoat</strong> sub-folder with the result</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-EventSources-06.png" href="../../../images/HOWTOs/UI-EventSources-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-EventSources-06.png" style="max-width: fit-content" alt="images/HOWTOs/UI-EventSources-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Folder - New BlueCoat sub folder tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>
.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '1.4.'; page-break-before: always">
    
  <h1 id="pg-539a05846ccfc6ea9aaa02403d8d4be0">1.4 - Raw Source Tracking</h1>
    <div class="lead">How to link every Event back to the Raw log</div>
	<p>Stroom v6.1 introduced a new feature (<em>stroom:source()</em>) to allow a translation developer to obtain positional details of the source file that is currently being processed.
Using the positional information it is possible to tag Events with sufficient details to link back to the Raw source.</p>
<h2 id="assumptions">Assumptions</h2>
<ol>
<li>You have a working pipeline that processes logs into Events.</li>
<li>Events are indexed</li>
<li>You have a Dashboard uses a Search Extraction pipeline.</li>
</ol>
<h2 id="steps">Steps</h2>
<ol>
<li>
<p>Create a new XSLT called Source Decoration containing the following:</p>
<pre><code class="language-xml">&lt;xsl:stylesheet 
    xpath-default-namespace=&quot;event-logging:3&quot; 
    xmlns:sm=&quot;stroom-meta&quot; xmlns=&quot;event-logging:3&quot; 
    xmlns:rec=&quot;records:2&quot; 
    xmlns:stroom=&quot;stroom&quot;  
    version=&quot;3.0&quot; 
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;
  &lt;xsl:template match=&quot;@*|node()&quot;&gt;
    &lt;xsl:copy&gt;
      &lt;xsl:apply-templates select=&quot;@*|node()&quot; /&gt;
    &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match=&quot;Event/Meta[not(sm:source)]&quot;&gt;
    &lt;xsl:copy&gt;
      &lt;xsl:apply-templates /&gt;
      &lt;xsl:copy-of select=&quot;stroom:source()&quot; /&gt;
    &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;
  &lt;xsl:template match=&quot;Event[not(Meta)]&quot;&gt;
    &lt;xsl:copy&gt;
      &lt;xsl:element name=&quot;Meta&quot;&gt;
        &lt;xsl:copy-of select=&quot;stroom:source()&quot; /&gt;
      &lt;/xsl:element&gt;
      &lt;xsl:apply-templates /&gt;
    &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>This XSLT will add or augment the Meta section of the Event with the source details.</p>
</li>
<li>
<p>Insert a new XSLT filter into your translation pipeline after your translation filter and set it to the XSLT created above.</p>
</li>
<li>
<p>Reprocess the Events through the modified pipeline, also ensure your Events are indexed.</p>
</li>
<li>
<p>Amend the translation performed by the Extraction pipeline to include the new data items that represent the source position data. Add the following to the XSLT:</p>
<pre><code class="language-xml">&lt;xsl:element name=&quot;data&quot;&gt;
  &lt;xsl:attribute name=&quot;name&quot;&gt;
    &lt;xsl:text&gt;src-id&lt;/xsl:text&gt;
  &lt;/xsl:attribute&gt;
  &lt;xsl:attribute name=&quot;value&quot; select=&quot;Meta/sm:source/sm:id&quot; /&gt;
&lt;/xsl:element&gt;
&lt;xsl:element name=&quot;data&quot;&gt;
  &lt;xsl:attribute name=&quot;name&quot;&gt;
    &lt;xsl:text&gt;src-partNo&lt;/xsl:text&gt;
  &lt;/xsl:attribute&gt;
  &lt;xsl:attribute name=&quot;value&quot; select=&quot;Meta/sm:source/sm:partNo&quot; /&gt;
&lt;/xsl:element&gt;
&lt;xsl:element name=&quot;data&quot;&gt;
  &lt;xsl:attribute name=&quot;name&quot;&gt;
    &lt;xsl:text&gt;src-recordNo&lt;/xsl:text&gt;
  &lt;/xsl:attribute&gt;
  &lt;xsl:attribute name=&quot;value&quot; select=&quot;Meta/sm:source/sm:recordNo&quot; /&gt;
&lt;/xsl:element&gt;
&lt;xsl:element name=&quot;data&quot;&gt;
  &lt;xsl:attribute name=&quot;name&quot;&gt;
    &lt;xsl:text&gt;src-lineFrom&lt;/xsl:text&gt;
  &lt;/xsl:attribute&gt;
  &lt;xsl:attribute name=&quot;value&quot; select=&quot;Meta/sm:source/sm:lineFrom&quot; /&gt;
&lt;/xsl:element&gt;
&lt;xsl:element name=&quot;data&quot;&gt;
  &lt;xsl:attribute name=&quot;name&quot;&gt;
    &lt;xsl:text&gt;src-colFrom&lt;/xsl:text&gt;
  &lt;/xsl:attribute&gt;
  &lt;xsl:attribute name=&quot;value&quot; select=&quot;Meta/sm:source/sm:colFrom&quot; /&gt;
&lt;/xsl:element&gt;
&lt;xsl:element name=&quot;data&quot;&gt;
  &lt;xsl:attribute name=&quot;name&quot;&gt;
    &lt;xsl:text&gt;src-lineTo&lt;/xsl:text&gt;
  &lt;/xsl:attribute&gt;
  &lt;xsl:attribute name=&quot;value&quot; select=&quot;Meta/sm:source/sm:lineTo&quot; /&gt;
&lt;/xsl:element&gt;
&lt;xsl:element name=&quot;data&quot;&gt;
  &lt;xsl:attribute name=&quot;name&quot;&gt;
    &lt;xsl:text&gt;src-colTo&lt;/xsl:text&gt;
  &lt;/xsl:attribute&gt;
  &lt;xsl:attribute name=&quot;value&quot; select=&quot;Meta/sm:source/sm:colTo&quot; /&gt;
&lt;/xsl:element&gt;
</code></pre>
</li>
<li>
<p>Open your dashboard, now add the following custom fields to your table:</p>
<pre><code class="language-text">${src-id}, ${src-partNo}, ${src-recordNo}, ${src-lineFrom}, ${src-lineTo}, ${src-colFrom}, ${src-colTo}
</code></pre>
</li>
<li>
<p>Now add a New Text Window to your Dashboard, and configure it as below:







  
  
  
  
  







  
  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="max-width: 510px">

  <a title="images/HOWTOs/HT-RawSourceTextWindow.png" href="../../../images/HOWTOs/HT-RawSourceTextWindow.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/HT-RawSourceTextWindow.png" style="max-width:500" alt="images/HOWTOs/HT-RawSourceTextWindow.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">TextWindow Config</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
</li>
<li>
<p>You can also add a column to the table that will open a data window showing the source.
Add a custom column with the following expression:</p>
<pre><code class="language-text">data('Raw Log',${src-id},${src-partNo},'',${src-lineFrom},${src-colFrom},${src-lineTo},${src-colTo})
</code></pre>
</li>
</ol>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '1.5.'; page-break-before: always">
    
  <h1 id="pg-591a4b717a58b789a35c85adbace1b0c">1.5 - Task Management</h1>
    <div class="lead">This HOWTO demonstrates how to manage background tasks.</div>
	<p>Various
<a href="../../../docs/user-guide/jobs/">Tasks</a>
run in the background within Stroom. This HOWTO demonstrates how to manage these tasks</p>
<h2 id="assumptions">Assumptions</h2>
<ul>
<li>All Sections
<ul>
<li>an account with the <code>Administrator</code> Application <a href="../../../docs/user-guide/roles/">Permission</a> is currently logged in.</li>
</ul>
</li>
<li>Proxy Aggregation Tasks
<ul>
<li>we have a multi node Stroom cluster with two nodes, <code>stroomp00</code> and <code>stroomp01</code>.</li>
</ul>
</li>
<li>Stream Processor Tasks
<ul>
<li>we have a multi node Stroom cluster with two nodes, <code>stroomp00</code> and <code>stroomp01</code>.</li>
<li>when demonstrating adding a new node to an existing cluster, the new node is <code>stroomp02</code>.</li>
</ul>
</li>
</ul>
<h2 id="proxy-aggregation">Proxy Aggregation</h2>
<h2 id="turn-off-proxy-aggregation">Turn Off Proxy Aggregation</h2>
<p>We first select the <code>Monitoring</code> item of the <strong>Main Menu</strong> to bring up the <code>Monitoring</code> sub-menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-MonitoringSubmenu-00.png" href="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-MonitoringSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Monitoring sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then move down and select the <code>Jobs</code> sub-item to be presented with the <code>Jobs</code> configuration tab as seen below.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-JobsTab-00.png" href="../../../images/HOWTOs/UI-JobsTab-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-JobsTab-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-JobsTab-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Jobs Management - management tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this we can select the <code>Proxy Aggregation</code> <em>Job</em> whose check-box is selected and the tab will show the individual Stroom Processor nodes
in the deployment.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ProxyAggregation-00.png" href="../../../images/HOWTOs/UI-ProxyAggregation-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ProxyAggregation-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ProxyAggregation-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Jobs Management - Proxy Aggregation Job</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this, uncheck the <code>Enabled</code> check-boxes for both nodes and also the main Proxy Aggregation check-box to see.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ProxyAggregation-01.png" href="../../../images/HOWTOs/UI-ProxyAggregation-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ProxyAggregation-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ProxyAggregation-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Jobs Management - Proxy Aggregation Job Off</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this point, no new proxy aggregation will occur and any inbound files received by the Store Proxies will accumulate in the proxy storage area.</p>
<h3 id="turn-on-proxy-aggregation">Turn On Proxy Aggregation</h3>
<p>We first select the <code>Monitoring</code> item of the <strong>Main Menu</strong> to bring up the <code>Monitoring</code> sub-menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-MonitoringSubmenu-00.png" href="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-MonitoringSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Monitoring sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then move down and select the <code>Jobs</code> sub-item then select the <code>Proxy Aggregation</code> <em>Job</em> to be presented with the <code>Jobs</code> configuration tab as seen below.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ProxyAggregation-01.png" href="../../../images/HOWTOs/UI-ProxyAggregation-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ProxyAggregation-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ProxyAggregation-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Jobs Management - Proxy Aggregation Job Off</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now, re-enable each node&rsquo;s <code>Proxy Aggregation</code> check-box and the main <code>Proxy Aggregation</code> check-box.</p>
<p>After checking the check-boxes, perform a refresh of the display by pressing the <em>Refresh</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


.</p>
<p>on the top right of the lower (node display) pane. You should note the <code>Last Executed</code> date/time change to see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-TestProxyAggregation-00.png" href="../../../images/HOWTOs/UI-TestProxyAggregation-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-TestProxyAggregation-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-TestProxyAggregation-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Test Feed - Re-enable Proxy Aggregation</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h2 id="stream-processors">Stream Processors</h2>
<h3 id="enable-stream-processors">Enable Stream Processors</h3>
<p>To enable the <code>Stream Processors</code> task, move to the <code>Monitoring</code> item of the <strong>Main Menu</strong> and select it to bring up the <code>Monitoring</code> sub-menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-MonitoringSubmenu-00.png" href="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-MonitoringSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Monitoring sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then move down and select the <code>Jobs</code> sub-item to be presented with the <code>Jobs</code> configuration tab as seen below.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeProcessors-00.png" href="../../../images/HOWTOs/UI-NodeProcessors-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeProcessors-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeProcessors-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Jobs Management - management tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this, we select the <code>Stream Processor</code> <em>Job</em> whose check-box is not selected and the tab will show the individual Stroom Processor
nodes in the Stroom deployment.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeProcessors-01.png" href="../../../images/HOWTOs/UI-NodeProcessors-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeProcessors-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeProcessors-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Jobs Management - Stream Processor</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Clearly, if it was a single node Stroom deployment, you would only see the one node at the bottom of the <code>Jobs</code> configuration tab.</p>
<p>We enable nodes nodes by selecting their check-boxes as well as the main <code>Stream Processors</code> check-box. Do so.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeProcessors-02.png" href="../../../images/HOWTOs/UI-NodeProcessors-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeProcessors-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeProcessors-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Jobs Management - Stream Processor enabled</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>That is it. Stroom will automatically take note of these changes and internally start each node&rsquo;s Stroom Processor task.</p>
<h3 id="enable-stream-processors-on-new-node">Enable Stream Processors On New Node</h3>
<p>When one expands a Multi Node Stroom cluster deployment, after the installation of the Stroom Proxy and Application software and
services on the new node, we need to enable it&rsquo;s <code>Stream Processors</code> task.</p>
<p>To enable the <code>Stream Processors</code> for this new node, move to the <code>Monitoring</code> item of the <strong>Main Menu</strong> and select it to bring up the <code>Monitoring</code> sub-menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-MonitoringSubmenu-00.png" href="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-MonitoringSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Monitoring sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then move down and select the <code>Jobs</code> sub-item to be presented with the <code>Jobs</code> configuration tab as seen below.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeProcessors-00.png" href="../../../images/HOWTOs/UI-NodeProcessors-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeProcessors-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeProcessors-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Jobs Management - management tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this we select the <code>Stream Processor</code> <em>Job</em> whose check-box is selected</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NewNodeProcessors-00.png" href="../../../images/HOWTOs/UI-NewNodeProcessors-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NewNodeProcessors-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NewNodeProcessors-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Jobs Management - Stream Processor new node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We enable the new node by selecting it&rsquo;s check-box.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NewNodeProcessors-01.png" href="../../../images/HOWTOs/UI-NewNodeProcessors-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NewNodeProcessors-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NewNodeProcessors-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Jobs Management - Stream Processor enabled on new node</figcaption>
      </div>
      
    </figure>
  </a>
</div>


</div>




    
	
  

    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '2.'; page-break-before: always">
    
  <h1 id="pg-28964c3a5d9236a1740816422613941f">2 - Administration</h1>
    
	
</div>




    
      
  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '2.1.'; ">
    
  <h1 id="pg-0b76ec0221067e4df0417f79c30e159d">2.1 - System Properties</h1>
    <div class="lead">This HOWTO is provided to assist users in managing Stroom <strong>System Properties</strong> via the User Interface.</div>
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>the user successfully logged into Stroom with the appropriate administrative privilege (<strong>Manage Properties</strong>).</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Certain Stroom <strong>System Properties</strong> can be edited via the Stroom User Interface.</p>
<h2 id="editing-a-system-property">Editing a System Property</h2>
<p>To edit a <strong>System Property</strong> select the <code>Tools</code> item of the <strong>Main Menu</strong> and select to bring up the <code>Tools</code> sub-menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ToolsSubmenu-00.png" href="../../../images/HOWTOs/UI-ToolsSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ToolsSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ToolsSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Tools sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Then move down and select the <code>Properties</code> sub-item to be presented with <code>System Properties</code> configuration window as seen below.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Tools-SystemProperties-00.png" href="../../../images/HOWTOs/UI-Tools-SystemProperties-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Tools-SystemProperties-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Tools-SystemProperties-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Tools System Properties</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Using the Scrollbar to the right of the <strong>System Properties</strong> configuration window and scroll down to the line where the property one wants to modify is displayed then select (<em>left click</em>) the line.
In the example below we have selected the <code>stroom.maxStreamSize</code> property.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Tools-SystemProperties-01.png" href="../../../images/HOWTOs/UI-Tools-SystemProperties-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Tools-SystemProperties-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Tools-SystemProperties-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Tools System Properties - Selected Property</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now bring up the editing window by <em>double clicking</em> on the selected line.
At this we will be presented with the
<code>Application Property - stroom.maxStreamSize</code> editing window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Tools-SystemProperties-02.png" href="../../../images/HOWTOs/UI-Tools-SystemProperties-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Tools-SystemProperties-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Tools-SystemProperties-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Tools System Properties - Editing Property</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now edit the property, by <em>double clicking</em> the string in the <code>Value</code> entry box.
In this case we select the <code>1G</code> value to see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Tools-SystemProperties-03.png" href="../../../images/HOWTOs/UI-Tools-SystemProperties-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Tools-SystemProperties-03.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Tools-SystemProperties-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Tools System Properties - Editing Property - Value selected</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now change the selected <code>1G</code> value to the value we want.
In this example, we are changing the value to <code>512M</code>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Tools-SystemProperties-04.png" href="../../../images/HOWTOs/UI-Tools-SystemProperties-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Tools-SystemProperties-04.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Tools-SystemProperties-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Tools System Properties - Editing Property - Value changed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this, press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to see the new value updated in the <strong>System Properties</strong> configuration window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Tools-SystemProperties-05.png" href="../../../images/HOWTOs/UI-Tools-SystemProperties-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Tools-SystemProperties-05.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Tools-SystemProperties-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Tools System Properties - Value changed</figcaption>
      </div>
      
    </figure>
  </a>
</div>


</div>




    
	
  

    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '3.'; page-break-before: always">
    
  <h1 id="pg-e1a1534a2750f91fe96eedf5e87798ca">3 - Authentication</h1>
    
	
</div>




    
      
  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '3.1.'; ">
    
  <h1 id="pg-f8eef5b4748b57510b328ba975ed968f">3.1 - Create a user</h1>
    <div class="lead">This HOWTO provides the steps to create a user via the Stroom User Interface.</div>
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>An account with the <code>Administrator</code> Application <a href="../../../docs/user-guide/roles/">Permission</a> is currently logged in.</li>
<li>We will be adding the user <code>burn</code></li>
<li>We will make this user an <code>Administrator</code></li>
</ul>
<h2 id="add-a-new-user">Add a new user</h2>
<p>To add a new user, move your cursor to the <code>Tools</code> item of the <strong>Main Menu</strong> and select to bring up the <code>Tools</code> sub-menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ToolsSubmenu-00.png" href="../../../images/HOWTOs/UI-ToolsSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ToolsSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ToolsSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Tools sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then move down and select the <code>Users and Groups</code> sub-item to be presented with the <code>Users and Groups</code> configuration window as seen below.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddUser-00.png" href="../../../images/HOWTOs/UI-AddUser-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddUser-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddUser-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New User - Users and Groups configuration</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>To add the user, move the cursor to the <em>New</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add" 
    alt="add.svg">


 in the top left and
select it. On selection you will be prompted for a user name. In our case we will enter the user <code>burn</code>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddUser-01.png" href="../../../images/HOWTOs/UI-AddUser-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddUser-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddUser-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New User - Add User</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and on pressing 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 will be presented with the User configuration window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddUser-02.png" href="../../../images/HOWTOs/UI-AddUser-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddUser-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddUser-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New User - User configuration</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h3 id="set-the-user-application-permissions">Set the User Application Permissions</h3>
<p>See
<a href="../../../user-guide/roles" title="Stroom Application Permissions">Permissions</a>
for an explanation of the various Application Permissions a user can have.</p>
<h4 id="assign-an-administrator-permission">Assign an Administrator Permission</h4>
<p>As we want the user to be an administrator, select the <strong>Administrator</strong> Permission check-box</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddUser-03.png" href="../../../images/HOWTOs/UI-AddUser-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddUser-03.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddUser-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New User - User configuration - set administrator permission</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h4 id="set-users-password">Set User&rsquo;s Password</h4>
<p>We need to set <code>burn's</code> password (which he will need to reset on first login). So, select the 



<span class="stroom-button" title="Reset Password button" >
  <span class="stroom-button-text">Reset Password</span>
</span>
 button to gain the Reset Password window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddUser-04.png" href="../../../images/HOWTOs/UI-AddUser-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddUser-04.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddUser-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New User - User configuration - reset password</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>After setting a password and pressing the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button we get the informational Alert window as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddUser-05.png" href="../../../images/HOWTOs/UI-AddUser-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddUser-05.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddUser-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New User - User configuration - reset password complete</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and on close of the Alert we are presented again with the <code>User</code> configuration window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddUser-06.png" href="../../../images/HOWTOs/UI-AddUser-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddUser-06.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddUser-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New User - User configuration - user added</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We should close this window by pressing the 



<span class="stroom-button" title="Close button" >
  <span class="stroom-button-text">Close</span>
</span>
 button to be presented with the <code>Users and Groups</code> window with the new user <code>burn</code> added.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddUser-07.png" href="../../../images/HOWTOs/UI-AddUser-07.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddUser-07.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddUser-07.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New User - User configuration - show user added</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this, one can close the <code>Users and Groups</code> configuration window by pressing the 



<span class="stroom-button" title="Close button" >
  <span class="stroom-button-text">Close</span>
</span>
 button at the bottom right of the window.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '3.2.'; page-break-before: always">
    
  <h1 id="pg-51e73b087842d591d96091681a3d2f4c">3.2 - Login</h1>
    <div class="lead">This HOWTO shows how to log into the Stroom User Interface.</div>
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>for manual login, we will log in as the user <code>admin</code> whose password is set to <code>admin</code> and the password is pre-expired</li>
<li>for PKI Certificate login, the Stroom deployment would have been configured to accept PKI Logins</li>
</ul>
<h2 id="manual-login">Manual Login</h2>
<p>Within the <strong>Login</strong> panel, enter <code>admin</code> into the <em>User Name:</em> entry box and <code>admin</code> into the <em>Password:</em> entry box as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Login-01.png" href="../../../images/HOWTOs/UI-Login-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Login-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Login-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Login - logging in as admin</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>When you press the 



<span class="stroom-button" title="Login button" >
  <span class="stroom-button-text">Login</span>
</span>
 button, you are advised that your user&rsquo;s password has expired and you need to change it.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Login-02.png" href="../../../images/HOWTOs/UI-Login-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Login-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Login-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Login - password expiry</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button and enter the old password <code>admin</code> and a new password with confirmation in the appropriate entry boxes.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Login-03.png" href="../../../images/HOWTOs/UI-Login-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Login-03.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Login-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Login - password change</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Again press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button to see the confirmation that the password has changed.</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Login-04.png" href="../../../images/HOWTOs/UI-Login-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Login-04.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Login-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Login - password change confirmation</figcaption>
      </div>
      
    </figure>
  </a>
</div>
.</p>
<p>On pressing 



<span class="stroom-button" title="Close button" >
  <span class="stroom-button-text">Close</span>
</span>
 you will be logged in as the <code>admin</code> user and you will be presented with the <strong>Main Menu</strong> (<code>Item Tools Monitoring User Help</code>), and the <code>Explorer</code> and <code>Welcome</code> panels (or tabs).</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Login-06.png" href="../../../images/HOWTOs/UI-Login-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Login-06.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Login-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Login - user logged in</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We have now successfully logged on as the <code>admin</code> user.</p>
<p>The next time you login with this account, you will not be prompted to change the password until the password expiry period has been met.</p>
<h2 id="pki-certificate-login">PKI Certificate Login</h2>
<p>To login using a PKI Certificate, a user should have their Personal PKI certificate loaded in the browser (and selected if
you have multiple certificates) and the user just needs to go to the Stroom UI URL, and providing you have an account, you will be
automatically logged in.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '3.3.'; page-break-before: always">
    
  <h1 id="pg-b890044b086b0af2d02c19cdbb1ef642">3.3 - Logout</h1>
    <div class="lead">This HOWTO shows how to log out of the Stroom User Interface.</div>
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>the user <code>admin</code> is currently logged in</li>
</ul>
<h2 id="log-out-of-ui">Log out of UI</h2>
<p>To log out of the UI, select the <code>User</code> item of the <strong>Main Menu</strong> and to bring up the <code>User</code> sub-menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-UserSubmenu-00.png" href="../../../images/HOWTOs/UI-UserSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-UserSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-UserSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI - User Sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and select the <code>Logout</code> sub-item and confirm you wish to log out by selecting the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-UserLogout-00.png" href="../../../images/HOWTOs/UI-UserLogout-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-UserLogout-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-UserLogout-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI - User Logout</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This will return you to the Login page</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Login-00.png" href="../../../images/HOWTOs/UI-Login-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Login-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Login-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Login Page</figcaption>
      </div>
      
    </figure>
  </a>
</div>


</div>




    
	
  

    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.'; page-break-before: always">
    
  <h1 id="pg-05ac22234589a8130c163fe287318d24">4 - Installation</h1>
    <div class="lead">Various How Tos convering installation of Stroom and its dependencies</div>
	
</div>




    
      
  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.1.'; ">
    
  <h1 id="pg-82aa13e518a524f24a7b8e335aad1203">4.1 - Apache Httpd/Mod_JK configuration for Stroom</h1>
    <div class="lead">The following is a HOWTO to assist users in configuring Apache&rsquo;s HTTPD with Mod_JK for Stroom.</div>
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>the user has reasonable RHEL/Centos System administration skills</li>
<li>installations are on Centos 7.3 minimal systems (fully patched)</li>
<li>the security of the HTTPD deployment should be reviewed for a production environment.</li>
</ul>
<h2 id="installation-of-apache-httpd-and-mod_jk-software">Installation of Apache httpd and Mod_JK Software</h2>
<p>To deploy Stroom using Apache&rsquo;s httpd web service as a front end (https) and Apache&rsquo;s mod_jk as the interface between Apache and the Stroom tomcat applications, we also need</p>
<ul>
<li>apr</li>
<li>apr-util</li>
<li>apr-devel</li>
<li>gcc</li>
<li>httpd</li>
<li>httpd-devel</li>
<li>mod_ssl</li>
<li>epel-release</li>
<li>tomcat-native</li>
<li>apache&rsquo;s mod_jk tomcat connector plugin</li>
</ul>
<p>Most of the required software are packages available via standard repositories and hence we can simply execute</p>
<pre><code class="language-bash">sudo yum -y install apr apr-util apr-devel gcc httpd httpd-devel mod_ssl epel-release
sudo yum -y install tomcat-native
</code></pre>
<p>The reason for the distinct <code>tomcat-native</code> installation is that this package is from the 






  

<span class="external-link">
  <a href="https://fedoraproject.org/wiki/EPEL" target="_blank" class="" style="" title="EPEL (external link)">
    <span>EPEL</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 repository so it must be installed first.</p>
<p>For the Apache mod_jk Tomcat connector we need to acquire a recent 






  

<span class="external-link">
  <a href="http://tomcat.apache.org/connectors-doc/" target="_blank" class="" style="" title="release (external link)">
    <span>release</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 and install it.
The following commands achieve this for the 1.2.42 release.</p>
<pre><code class="language-bash">sudo bash
cd /tmp
V=1.2.42
wget https://www.apache.org/dist/tomcat/tomcat-connectors/jk/tomcat-connectors-${V}-src.tar.gz
tar xf tomcat-connectors-${V}-src.tar.gz
cd tomcat-connectors-*-src/native
./configure --with-apxs=/bin/apxs
make &amp;&amp; make install
cd /tmp
rm -rf tomcat-connectors-*-src
</code></pre>
<p>Although you could remove the gcc compiler at this point, we leave it installed as one <em>should</em> continue to upgrade the Tomcat Connectors to later releases.</p>
<h2 id="configure-apache-httpd">Configure Apache httpd</h2>
<p>We need to configure Apache as the <code>root</code> user.</p>
<p>If the Apache httpd service is &lsquo;fronting&rsquo; a Stroom user interface, we should create an index file (/var/www/html/index.html) on all nodes so browsing to
the root of the node will present the Stroom UI. This is not needed if you are deploying a Forwarding or Standalone Stroom proxy.</p>
<h3 id="forwarding-file-for-stroom-user-interface-deployments">Forwarding file for Stroom User Interface deployments</h3>
<pre><code class="language-bash">F=/var/www/html/index.html
printf '&lt;html&gt;\n' &gt; ${F}
printf '&lt;head&gt;\n' &gt;&gt; ${F}
printf '  &lt;meta http-equiv=&quot;Refresh&quot; content=&quot;0; URL=stroom&quot;/&gt;\n' &gt;&gt; ${F}
printf '&lt;/head&gt;\n' &gt;&gt; ${F}
printf '&lt;/html&gt;\n' &gt;&gt; ${F}
chmod 644 ${F}
</code></pre>
<p>Remember, deploy this file on all nodes running the Stroom Application.</p>
<h3 id="httpdconf-configuration">Httpd.conf Configuration</h3>
<p>We modify <code>/etc/httpd/conf/httpd.conf</code> on all nodes, but backup the file first with</p>
<pre><code class="language-bash">cp /etc/httpd/conf/httpd.conf /etc/httpd/conf/httpd.conf.ORIG
</code></pre>
<p>Irrespective of the Stroom scenario being deployed - Multi Node Stroom (Application and Proxy), single Standalone Stroom Proxy or single Forwarding
Stroom Proxy, the configuration of the <code>/etc/httpd/conf/httpd.conf</code> file is the same.</p>
<p>We start by modify the configuration file by,
add just before the ServerRoot directive the following directives which are designed to make the httpd service more secure.</p>
<pre><code class="language-text"># Stroom Change: Start - Apply generic security directives
ServerTokens Prod
ServerSignature Off
FileETag None
RewriteEngine On
RewriteCond %{THE_REQUEST} !HTTP/1.1$
RewriteRule .* - [F]
Header set X-XSS-Protection &quot;1; mode=block&quot;
# Stroom Change: End
</code></pre>
<p>That is,</p>
<pre><code class="language-text">...
# Do not add a slash at the end of the directory path.  If you point
# ServerRoot at a non-local disk, be sure to specify a local disk on the
# Mutex directive, if file-based mutexes are used.  If you wish to share the
# same ServerRoot for multiple httpd daemons, you will need to change at
# least PidFile.
#
ServerRoot &quot;/etc/httpd&quot;

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
...
</code></pre>
<p>becomes</p>
<pre><code class="language-text">...
# Do not add a slash at the end of the directory path.  If you point
# ServerRoot at a non-local disk, be sure to specify a local disk on the
# Mutex directive, if file-based mutexes are used.  If you wish to share the
# same ServerRoot for multiple httpd daemons, you will need to change at
# least PidFile.
#
# Stroom Change: Start - Apply generic security directives
ServerTokens Prod
ServerSignature Off
FileETag None
RewriteEngine On
RewriteCond %{THE_REQUEST} !HTTP/1.1$
RewriteRule .* - [F]
Header set X-XSS-Protection &quot;1; mode=block&quot;
# Stroom Change: End
ServerRoot &quot;/etc/httpd&quot;

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
...
</code></pre>
<p>We now block access to the /var/www directory by commenting out</p>
<pre><code>&lt;Directory &quot;/var/www&quot;&gt;
  AllowOverride None
  # Allow open access:
  Require all granted
&lt;/Directory&gt;
</code></pre>
<p>that is</p>
<pre><code>...
#
# Relax access to content within /var/www.
#
&lt;Directory &quot;/var/www&quot;&gt;
    AllowOverride None
    # Allow open access:
    Require all granted
&lt;/Directory&gt;

# Further relax access to the default document root:
...
</code></pre>
<p>becomes</p>
<pre><code>...
#
# Relax access to content within /var/www.
#
# Stroom Change: Start - Block access to /var/www
# &lt;Directory &quot;/var/www&quot;&gt;
#     AllowOverride None
#     # Allow open access:
#     Require all granted
# &lt;/Directory&gt;
# Stroom Change: End

# Further relax access to the default document root:
...
</code></pre>
<p>then within the /var/www/html directory turn off Indexes FollowSymLinks by commenting out the line</p>
<pre><code>Options Indexes FollowSymLinks
</code></pre>
<p>That is</p>
<pre><code>...
    # The Options directive is both complicated and important.  Please see
    # http://httpd.apache.org/docs/2.4/mod/core.html#options
    # for more information.
    #
    Options Indexes FollowSymLinks

    #
    # AllowOverride controls what directives may be placed in .htaccess files.
    # It can be &quot;All&quot;, &quot;None&quot;, or any combination of the keywords:
...
</code></pre>
<p>becomes</p>
<pre><code>...
    # The Options directive is both complicated and important.  Please see
    # http://httpd.apache.org/docs/2.4/mod/core.html#options
    # for more information.
    #
    # Stroom Change: Start - turn off indexes and FollowSymLinks
    # Options Indexes FollowSymLinks
    # Stroom Change: End

    #
    # AllowOverride controls what directives may be placed in .htaccess files.
    # It can be &quot;All&quot;, &quot;None&quot;, or any combination of the keywords:
...
</code></pre>
<p>Then finally we add two new log formats and configure the access log to use the new format. This is done within the <code>&lt;IfModule logio_module&gt;</code> by adding the two new LogFormat directives</p>
<pre><code>LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%u\&quot; \&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxUser
LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN}x\&quot; \&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxSSLUser
</code></pre>
<p>and replacing the CustomLog directive</p>
<pre><code>CustomLog &quot;logs/access_log&quot; combined
</code></pre>
<p>with</p>
<pre><code>CustomLog logs/access_log blackboxSSLUser
</code></pre>
<p>That is</p>
<pre><code>...
    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common

    &lt;IfModule logio_module&gt;
      # You need to enable mod_logio.c to use %I and %O
      LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %I %O&quot; combinedio
    &lt;/IfModule&gt;

    #
    # The location and format of the access logfile (Common Logfile Format).
    # If you do not define any access logfiles within a &lt;VirtualHost&gt;
    # container, they will be logged here.  Contrariwise, if you *do*
    # define per-&lt;VirtualHost&gt; access logfiles, transactions will be
    # logged therein and *not* in this file.
    #
    #CustomLog &quot;logs/access_log&quot; common

    #
    # If you prefer a logfile with access, agent, and referer information
    # (Combined Logfile Format) you can use the following directive.
    #
    CustomLog &quot;logs/access_log&quot; combined
&lt;/IfModule&gt;
...
</code></pre>
<p>becomes</p>
<pre><code>...
    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common

    &lt;IfModule logio_module&gt;
      # You need to enable mod_logio.c to use %I and %O
      LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %I %O&quot; combinedio
      # Stroom Change: Start - Add new logformats
      LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%u\&quot; \&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxUser
      LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN}x\&quot; \&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxSSLUser
      # Stroom Change: End
    &lt;/IfModule&gt;
    # Stroom Change: Start - Add new logformats without the additional byte values
    &lt;IfModule !logio_module&gt;
      LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%u\&quot; \&quot;%r\&quot; %s/%&gt;s %D 0/0/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxUser
      LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN}x\&quot; \&quot;%r\&quot; %s/%&gt;s %D 0/0/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxSSLUser
    &lt;/IfModule&gt;
    # Stroom Change: End

    #
    # The location and format of the access logfile (Common Logfile Format).
    # If you do not define any access logfiles within a &lt;VirtualHost&gt;
    # container, they will be logged here.  Contrariwise, if you *do*
    # define per-&lt;VirtualHost&gt; access logfiles, transactions will be
    # logged therein and *not* in this file.
    #
    #CustomLog &quot;logs/access_log&quot; common

    #
    # If you prefer a logfile with access, agent, and referer information
    # (Combined Logfile Format) you can use the following directive.
    #
    # Stroom Change: Start - Make the access log use a new format
    # CustomLog &quot;logs/access_log&quot; combined
    CustomLog logs/access_log blackboxSSLUser
    # Stroom Change: End
&lt;/IfModule&gt;
...
</code></pre>
<p>Remember, deploy this file on all nodes.</p>
<h3 id="configuration-of-sslconf">Configuration of ssl.conf</h3>
<p>We modify <code>/etc/httpd/conf.d/ssl.conf</code> on all nodes, backing up first,</p>
<pre><code class="language-base">cp /etc/httpd/conf.d/ssl.conf /etc/httpd/conf.d/ssl.conf.ORIG
</code></pre>
<p>The configuration of the <code>/etc/httpd/conf.d/ssl.conf</code> <strong>does</strong> change depending on the Stroom scenario deployed. In the following we will indicate
differences by tagged sub-headings. If the configuration applies irrespective of scenario, then <strong>All scenarios</strong> is the tag, else the tag indicated the
type of Stroom deployment.</p>
<h4 id="sslconf-http-to-https-redirection---all-scenarios">ssl.conf: HTTP to HTTPS Redirection - All scenarios</h4>
<p>Before the <VirtualHost _default_:443> context we add http to https redirection by adding the directives (noting we specify the actual server name)</p>
<pre><code>&lt;VirtualHost *:80&gt;
  ServerName stroomp00.strmdev00.org
  Redirect permanent &quot;/&quot; &quot;https://stroomp00.strmdev00.org/&quot;
&lt;/VirtualHost&gt;
</code></pre>
<p>That is, we change</p>
<pre><code>...
## SSL Virtual Host Context
##

&lt;VirtualHost _default_:443&gt;
...
</code></pre>
<p>to</p>
<pre><code>...
## SSL Virtual Host Context
##

# Stroom Change: Start - Add http redirection to https
&lt;VirtualHost *:80&gt;
  ServerName stroomp00.strmdev00.org
  Redirect permanent &quot;/&quot; &quot;https://stroomp00.strmdev00.org/&quot;
&lt;/VirtualHost&gt;
# Stroom Change: End

&lt;VirtualHost _default_:443&gt;
</code></pre>
<h4 id="sslconf-virtualhost-directives---multi-node-application-and-proxy-deployment">ssl.conf: VirtualHost directives - Multi Node &lsquo;Application and Proxy&rsquo; deployment</h4>
<p>Within the <VirtualHost _default_:443> context we set the directives, in this case, we use the CNAME <code>stroomp.strmdev00.org</code></p>
<pre><code>ServerName stroomp.strmdev00.org
JkMount /stroom* loadbalancer
JkMount /stroom/remoting/cluster* local
JkMount /stroom/datafeed* loadbalancer_proxy
JkMount /stroom/remoting* loadbalancer_proxy
JkMount /stroom/datafeeddirect* loadbalancer
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
</code></pre>
<p>That is, we change</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<p>to</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443
# Stroom Change: Start - Set servername and mod_jk connectivity
ServerName stroomp.strmdev00.org
JkMount /stroom* loadbalancer
JkMount /stroom/remoting/cluster* local
JkMount /stroom/datafeed* loadbalancer_proxy
JkMount /stroom/remoting* loadbalancer_proxy
JkMount /stroom/datafeeddirect* loadbalancer
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
# Stroom Change: End

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<h4 id="sslconf-virtualhost-directives---standalone-or-forwarding-proxy-deployment">ssl.conf: VirtualHost directives - Standalone or Forwarding Proxy deployment</h4>
<p>Within the <VirtualHost _default_:443> context set the directives, in this case, for a node named say <code>stroomfp0.strmdev00.org</code></p>
<pre><code>ServerName stroomfp0.strmdev00.org
JkMount /stroom/datafeed* local_proxy
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
</code></pre>
<p>That is, we change</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<p>to</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443
# Stroom Change: Start - Set servername and mod_jk connectivity
ServerName stroomfp0.strmdev00.org
JkMount /stroom/datafeed* local_proxy
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
# Stroom Change: End

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<h4 id="sslconf-virtualhost-directives---single-node-application-and-proxy-deployment">ssl.conf: VirtualHost directives - Single Node &lsquo;Application and Proxy&rsquo; deployment</h4>
<p>Within the <VirtualHost _default_:443> context set the directives, in this case, for a node name <code>stroomp00.strmdev00.org</code></p>
<pre><code>ServerName stroomp00.strmdev00.org
JkMount /stroom* local
JkMount /stroom/remoting/cluster* local
JkMount /stroom/datafeed* local_proxy
JkMount /stroom/remoting* local_proxy
JkMount /stroom/datafeeddirect* local
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
</code></pre>
<p>That is, we change</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<p>to</p>
<pre><code>...
&lt;VirtualHost _default_:443&gt;

# General setup for the virtual host, inherited from global configuration
#DocumentRoot &quot;/var/www/html&quot;
#ServerName www.example.com:443
# Stroom Change: Start - Set servername and mod_jk connectivity
ServerName stroomp00.strmdev00.org
JkMount /stroom* local
JkMount /stroom/remoting/cluster* local
JkMount /stroom/datafeed* local_proxy
JkMount /stroom/remoting* local_proxy
JkMount /stroom/datafeeddirect* local
JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories
# Stroom Change: End

# Use separate log files for the SSL virtual host; note that LogLevel
# is not inherited from httpd.conf.
...
</code></pre>
<h4 id="sslconf-certificate-file-changes---all-scenarios">ssl.conf: Certificate file changes - All scenarios</h4>
<p>We replace the standard certificate files with the generated certificates. In the example below, we are using the multi node scenario, in
that the key file names are <code>stroomp.crt</code> and <code>stroomp.key</code>. For other scenarios, use the appropriate file names generated. We replace</p>
<pre><code>SSLCertificateFile /etc/pki/tls/certs/localhost.crt
</code></pre>
<p>with</p>
<pre><code>SSLCertificateFile /home/stroomuser/stroom-jks/public/stroomp.crt
</code></pre>
<p>and</p>
<pre><code>SSLCertificateKeyFile /etc/pki/tls/private/localhost.key
</code></pre>
<p>with</p>
<pre><code>SSLCertificateKeyFile /home/stroomuser/stroom-jks/private/stroomp.key
</code></pre>
<p>That is, change</p>
<pre><code>...
# pass phrase.  Note that a kill -HUP will prompt again.  A new
# certificate can be generated using the genkey(1) command.
SSLCertificateFile /etc/pki/tls/certs/localhost.crt

#   Server Private Key:
#   If the key is not combined with the certificate, use this
#   directive to point at the key file.  Keep in mind that if
#   you've both a RSA and a DSA private key you can configure
#   both in parallel (to also allow the use of DSA ciphers, etc.)
SSLCertificateKeyFile /etc/pki/tls/private/localhost.key

#   Server Certificate Chain:
#   Point SSLCertificateChainFile at a file containing the
...
</code></pre>
<p>to</p>
<pre><code>...
# pass phrase.  Note that a kill -HUP will prompt again.  A new
# certificate can be generated using the genkey(1) command.
# Stroom Change: Start - Replace with Stroom server certificate
# SSLCertificateFile /etc/pki/tls/certs/localhost.crt
SSLCertificateFile /home/stroomuser/stroom-jks/public/stroomp.crt
# Stroom Change: End

#   Server Private Key:
#   If the key is not combined with the certificate, use this
#   directive to point at the key file.  Keep in mind that if
#   you've both a RSA and a DSA private key you can configure
#   both in parallel (to also allow the use of DSA ciphers, etc.)
# Stroom Change: Start - Replace with Stroom server private key file
# SSLCertificateKeyFile /etc/pki/tls/private/localhost.key
SSLCertificateKeyFile /home/stroomuser/stroom-jks/private/stroomp.key
# Stroom Change: End

#   Server Certificate Chain:
#   Point SSLCertificateChainFile at a file containing the
...
</code></pre>
<h4 id="sslconf-certificate-bundleno-ca-verification---all-scenarios">ssl.conf: Certificate Bundle/NO-CA Verification - All scenarios</h4>
<p>If you have signed your Stroom server certificate with a Certificate Authority, then change</p>
<pre><code>SSLCACertificateFile /etc/pki/tls/certs/ca-bundle.crt
</code></pre>
<p>to be your own certificate bundle which you should probably store as <code>~stroomuser/stroom-jks/public/stroomp-ca-bundle.crt</code>.</p>
<p>Now if you are using a self signed certificate, you will need to set the Client Authentication to have a value of</p>
<pre><code>SSLVerifyClient optional_no_ca
</code></pre>
<p>noting that this may change if you actually use a CA.
That is, changing</p>
<pre><code>...
#   Client Authentication (Type):
#   Client certificate verification type and depth.  Types are
#   none, optional, require and optional_no_ca.  Depth is a
#   number which specifies how deeply to verify the certificate
#   issuer chain before deciding the certificate is not valid.
#SSLVerifyClient require
#SSLVerifyDepth  10

#   Access Control:
#   With SSLRequire you can do per-directory access control based
...
</code></pre>
<p>to</p>
<pre><code>...
#   Client Authentication (Type):
#   Client certificate verification type and depth.  Types are
#   none, optional, require and optional_no_ca.  Depth is a
#   number which specifies how deeply to verify the certificate
#   issuer chain before deciding the certificate is not valid.
#SSLVerifyClient require
#SSLVerifyDepth  10
# Stroom Change: Start - Set optional_no_ca (given we have a self signed certificate)
SSLVerifyClient optional_no_ca
# Stroom Change: End

#   Access Control:
#   With SSLRequire you can do per-directory access control based
...
</code></pre>
<h4 id="sslconf-servlet-protection---single-or-multi-node-scenarios-not-for-standaloneforwarding-proxy">ssl.conf: Servlet Protection - Single or Multi Node scenarios (not for Standalone/Forwarding Proxy)</h4>
<p>We now need to secure certain Stroom Application servlets, to ensure they are only accessed under appropriate control.</p>
<p>This set of servlets will be accessible by all nodes in the subnet 192.168.2 (as well as localhost). We achieve this by adding after the example Location directives</p>
<pre><code>&lt;Location ~ &quot;stroom/(status|echo|sessionList|debug)&quot; &gt;
 Require all denied
 Require ip 127.0.0.1 192.168.2
&lt;/Location&gt;
</code></pre>
<p>We further restrict the clustercall and export servlets to just the localhost. If we had multiple Stroom processing nodes, you would specify each node, or preferably, the subnet they are on. In our multi node case this is 192.168.2.</p>
<pre><code>&lt;Location ~ &quot;stroom/export/|stroom/remoting/clustercall.rpc&quot; &gt;
 Require all denied
 Require ip 127.0.0.1 192.168.2
&lt;/Location&gt;
</code></pre>
<p>That is, the following</p>
<pre><code>...
#            and %{TIME_WDAY} &gt;= 1 and %{TIME_WDAY} &lt;= 5 \
#            and %{TIME_HOUR} &gt;= 8 and %{TIME_HOUR} &lt;= 20       ) \
#           or %{REMOTE_ADDR} =~ m/^192\.76\.162\.[0-9]+$/
#&lt;/Location&gt;

#   SSL Engine Options:
#   Set various options for the SSL engine.
#   o FakeBasicAuth:
...
</code></pre>
<p>changes to</p>
<pre><code>...
#            and %{TIME_WDAY} &gt;= 1 and %{TIME_WDAY} &lt;= 5 \
#            and %{TIME_HOUR} &gt;= 8 and %{TIME_HOUR} &lt;= 20       ) \
#           or %{REMOTE_ADDR} =~ m/^192\.76\.162\.[0-9]+$/
#&lt;/Location&gt;

# Stroom Change: Start - Lock access to certain servlets
&lt;Location ~ &quot;stroom/(status|echo|sessionList|debug)&quot; &gt;
 Require all denied
 Require ip 127.0.0.1 192.168.2
&lt;/Location&gt;
# Lock these Servlets more securely - to just localhost and processing node(s)
&lt;Location ~ &quot;stroom/export/|stroom/remoting/clustercall.rpc&quot; &gt;
 Require all denied
 Require ip 127.0.0.1 192.168.2
&lt;/Location&gt;
# Stroom Change: End

#   SSL Engine Options:
#   Set various options for the SSL engine.
#   o FakeBasicAuth:
...
</code></pre>
<h4 id="sslconf-log-formats---all-scenarios">ssl.conf: Log formats - All scenarios</h4>
<p>Finally, as we make use of the Black Box Apache log format, we replace the standard format</p>
<pre><code>CustomLog logs/ssl_request_log \
        &quot;%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \&quot;%r\&quot; %b&quot;
</code></pre>
<p>with</p>
<pre><code>CustomLog logs/ssl_request_log blackboxSSLUser
</code></pre>
<p>That is, change</p>
<pre><code>...
#   Per-Server Logging:
#   The home of a custom SSL log file. Use this when you want a
#   compact non-error SSL logfile on a virtual host basis.
CustomLog logs/ssl_request_log \
          &quot;%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \&quot;%r\&quot; %b&quot;

&lt;/VirtualHost&gt;
</code></pre>
<p>to</p>
<pre><code>...
#   Per-Server Logging:
#   The home of a custom SSL log file. Use this when you want a
#   compact non-error SSL logfile on a virtual host basis.
# Stroom Change: Start - Change ssl_request log to use our BlackBox format
# CustomLog logs/ssl_request_log \
#           &quot;%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \&quot;%r\&quot; %b&quot;
CustomLog logs/ssl_request_log blackboxSSLUser
# Stroom Change: End

&lt;/VirtualHost&gt;
</code></pre>
<p>Remember, in the case of Multi node stroom Application servers, deploy this file on all servers.</p>
<h3 id="apache-mod_jk-configuration">Apache Mod_JK configuration</h3>
<p>Apache Mod_JK has two configuration files</p>
<ul>
<li>/etc/httpd/conf.d/mod_jk.conf - for the http server configuration</li>
<li>/etc/httpd/conf/workers.properties - to configure the Tomcat workers</li>
</ul>
<p>In multi node scenarios, <code>/etc/httpd/conf.d/mod_jk.conf</code> is the same on all servers, but the <code>/etc/httpd/conf/workers.properties</code> file is different.
The contents of these two configuration files differ depending on the Stroom deployment. The following provide the various deployment scenarios.</p>
<h4 id="mod_jk-multi-node-application-and-proxy-deployment">Mod_JK Multi Node Application and Proxy Deployment</h4>
<p>For a Stroom Multi node Application and Proxy server,</p>
<ul>
<li>we configure <code>/etc/httpd/conf.d/mod_jk.conf</code> as per</li>
</ul>
<pre><code class="language-bash">F=/etc/httpd/conf.d/mod_jk.conf
printf 'LoadModule jk_module modules/mod_jk.so\n' &gt; ${F}
printf 'JkWorkersFile conf/workers.properties\n' &gt;&gt; ${F}
printf 'JkLogFile logs/mod_jk.log\n' &gt;&gt; ${F}
printf 'JkLogLevel info\n' &gt;&gt; ${F}
printf 'JkLogStampFormat  &quot;[%%a %%b %%d %%H:%%M:%%S %%Y]&quot;\n' &gt;&gt; ${F}
printf 'JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories\n' &gt;&gt; ${F}
printf 'JkRequestLogFormat &quot;%%w %%V %%T&quot;\n' &gt;&gt; ${F}
printf 'JkMount /stroom* loadbalancer\n' &gt;&gt; ${F}
printf 'JkMount /stroom/remoting/cluster* local\n' &gt;&gt; ${F}
printf 'JkMount /stroom/datafeed* loadbalancer_proxy\n' &gt;&gt; ${F}
printf 'JkMount /stroom/remoting* loadbalancer_proxy\n' &gt;&gt; ${F}
printf 'JkMount /stroom/datafeeddirect* loadbalancer\n' &gt;&gt; ${F}
printf '# Note: Replaced JkShmFile logs/jk.shm due to SELinux issues. Refer to\n' &gt;&gt; ${F}
printf '# https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=225452\n' &gt;&gt; ${F}
printf '# The following makes use of the existing /run/httpd directory\n' &gt;&gt; ${F}
printf 'JkShmFile run/jk.shm\n' &gt;&gt; ${F}
printf '&lt;Location /jkstatus/&gt;\n' &gt;&gt; ${F}
printf '  JkMount status\n' &gt;&gt; ${F}
printf '  Order deny,allow\n' &gt;&gt; ${F}
printf '  Deny from all\n' &gt;&gt; ${F}
printf '  Allow from 127.0.0.1\n' &gt;&gt; ${F}
printf '&lt;/Location&gt;\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<ul>
<li>we configure <code>/etc/httpd/conf/workers.properties</code> as per</li>
</ul>
<p>Since we are deploying for a cluster with load balancing, we need a <em>workers.properties</em> file per node. Executing the following will result in two files (<em>workers.properties.stroomp00</em> and <em>workers.properties.stroomp01</em>) which should be deployed to their respective servers.</p>
<pre><code class="language-bash">cd /tmp
# Set the list of nodes
Nodes=&quot;stroomp00.strmdev00.org stroomp01.strmdev00.org&quot;
for oN in ${Nodes}; do
  _n=`echo ${oN} | cut -f1 -d\.`
  (
  printf '# Workers.properties for Stroom Cluster member: %s %s\n' ${oN}
  printf 'worker.list=loadbalancer,loadbalancer_proxy,local,local_proxy,status\n'
  L_t=&quot;&quot;
  Lp_t=&quot;&quot;
  for FQDN in ${Nodes}; do
    N=`echo ${FQDN} | cut -f1 -d\.`
    printf 'worker.%s.port=8009\n' ${N}
    printf 'worker.%s.host=%s\n' ${N} ${FQDN}
    printf 'worker.%s.type=ajp13\n' ${N}
    printf 'worker.%s.lbfactor=1\n' ${N}
    printf 'worker.%s.max_packet_size=65536\n' ${N}
    printf 'worker.%s_proxy.port=9009\n' ${N}
    printf 'worker.%s_proxy.host=%s\n' ${N} ${FQDN}
    printf 'worker.%s_proxy.type=ajp13\n' ${N}
    printf 'worker.%s_proxy.lbfactor=1\n' ${N}
    printf 'worker.%s_proxy.max_packet_size=65536\n' ${N}
    L_t=&quot;${L_t}${N},&quot;
    Lp_t=&quot;${Lp_t}${N}_proxy,&quot;
  done
  L=`echo $L_t | sed -e 's/.$//'`
  Lp=`echo $Lp_t | sed -e 's/.$//'`
  printf 'worker.loadbalancer.type=lb\n'
  printf 'worker.loadbalancer.balance_workers=%s\n' $L
  printf 'worker.loadbalancer.sticky_session=1\n'
  printf 'worker.loadbalancer_proxy.type=lb\n'
  printf 'worker.loadbalancer_proxy.balance_workers=%s\n' $Lp
  printf 'worker.loadbalancer_proxy.sticky_session=1\n'
  printf 'worker.local.type=lb\n'
  printf 'worker.local.balance_workers=%s\n' ${_n}
  printf 'worker.local.sticky_session=1\n'
  printf 'worker.local_proxy.type=lb\n'
  printf 'worker.local_proxy.balance_workers=%s_proxy\n' ${_n}
  printf 'worker.local_proxy.sticky_session=1\n'
  printf 'worker.status.type=status\n'
  ) &gt; workers.properties.${_n}
  chmod 640 workers.properties.${_n}
done
</code></pre>
<p>Now depending in the node you are on, copy the relevant workers.properties.nodename file to /etc/httpd/conf/workers.properties. The following command makes this simple.</p>
<pre><code class="language-bash">cp workers.properties.`hostname -s` /etc/httpd/conf/workers.properties
</code></pre>
<p>If you were to add an additional node to a multi node cluster, say the node <code>stroomp02.strmdev00.org</code>, then you would re-run the above script with</p>
<pre><code class="language-bash">Nodes=&quot;stroomp00.strmdev00.org stroomp01.strmdev00.org stroomp02.strmdev00.org&quot;
</code></pre>
<p>then redeploy all three files to the respective servers. Also note, that for the newly created workers.properties files for the existing nodes to
take effect you will need to restart the Apache Httpd service on both nodes.</p>
<p>Remember, in multi node cluster deployments, the following files are the same and hence can be created on one node, but copied to the
others not forgetting to backup the other node&rsquo;s original files. That is, the files</p>
<ul>
<li>/var/www/html/index.html</li>
<li>/etc/httpd/conf.d/mod_jk.conf</li>
<li>/etc/httpd/conf/httpd.conf</li>
</ul>
<p>are to be the same on all nodes. Only the /etc/httpd/conf.d/ssl.conf and /etc/httpd/conf/workers.properties files change.</p>
<h4 id="mod_jk-standalone-or-forwarding-stroom-proxy-deployment">Mod_JK Standalone or Forwarding Stroom Proxy Deployment</h4>
<p>For a Stroom Standalone or Forwarding proxy,</p>
<ul>
<li>we configure <code>/etc/httpd/conf.d/mod_jk.conf</code> as per</li>
</ul>
<pre><code class="language-bash">F=/etc/httpd/conf.d/mod_jk.conf
printf 'LoadModule jk_module modules/mod_jk.so\n' &gt; ${F}
printf 'JkWorkersFile conf/workers.properties\n' &gt;&gt; ${F}
printf 'JkLogFile logs/mod_jk.log\n' &gt;&gt; ${F}
printf 'JkLogLevel info\n' &gt;&gt; ${F}
printf 'JkLogStampFormat  &quot;[%%a %%b %%d %%H:%%M:%%S %%Y]&quot;\n' &gt;&gt; ${F}
printf 'JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories\n' &gt;&gt; ${F}
printf 'JkRequestLogFormat &quot;%%w %%V %%T&quot;\n' &gt;&gt; ${F}
printf 'JkMount /stroom/datafeed* local_proxy\n' &gt;&gt; ${F}
printf '# Note: Replaced JkShmFile logs/jk.shm due to SELinux issues. Refer to\n' &gt;&gt; ${F}
printf '# https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=225452\n' &gt;&gt; ${F}
printf '# The following makes use of the existing /run/httpd directory\n' &gt;&gt; ${F}
printf 'JkShmFile run/jk.shm\n' &gt;&gt; ${F}
printf '&lt;Location /jkstatus/&gt;\n' &gt;&gt; ${F}
printf '  JkMount status\n' &gt;&gt; ${F}
printf '  Order deny,allow\n' &gt;&gt; ${F}
printf '  Deny from all\n' &gt;&gt; ${F}
printf '  Allow from 127.0.0.1\n' &gt;&gt; ${F}
printf '&lt;/Location&gt;\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<ul>
<li>we configure <code>/etc/httpd/conf/workers.properties</code> as per</li>
</ul>
<p>The variable <strong>N</strong> in the script below is to be the node name (not FQDN) of your sever (i.e. stroomfp0).</p>
<pre><code class="language-bash">N=stroomfp0
FQDN=`hostname -f`
F=/etc/httpd/conf/workers.properties
printf 'worker.list=local_proxy,status\n' &gt; ${F}
printf 'worker.%s_proxy.port=9009\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.host=%s\n' ${N} ${FQDN} &gt;&gt; ${F}
printf 'worker.%s_proxy.type=ajp13\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.lbfactor=1\n' ${N} &gt;&gt; ${F}
printf 'worker.local_proxy.type=lb\n' &gt;&gt; ${F}
printf 'worker.local_proxy.balance_workers=%s_proxy\n' ${N} &gt;&gt; ${F}
printf 'worker.local_proxy.sticky_session=1\n' &gt;&gt; ${F}
printf 'worker.status.type=status\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<h4 id="mod_jk-single-node-application-and-proxy-deployment">Mod_JK Single Node Application and Proxy Deployment</h4>
<p>For a Stroom Single node Application and Proxy server,</p>
<ul>
<li>we configure <code>/etc/httpd/conf.d/mod_jk.conf</code> as per</li>
</ul>
<pre><code class="language-bash">F=/etc/httpd/conf.d/mod_jk.conf
printf 'LoadModule jk_module modules/mod_jk.so\n' &gt; ${F}
printf 'JkWorkersFile conf/workers.properties\n' &gt;&gt; ${F}
printf 'JkLogFile logs/mod_jk.log\n' &gt;&gt; ${F}
printf 'JkLogLevel info\n' &gt;&gt; ${F}
printf 'JkLogStampFormat  &quot;[%%a %%b %%d %%H:%%M:%%S %%Y]&quot;\n' &gt;&gt; ${F}
printf 'JkOptions +ForwardKeySize +ForwardURICompat +ForwardSSLCertChain -ForwardDirectories\n' &gt;&gt; ${F}
printf 'JkRequestLogFormat &quot;%%w %%V %%T&quot;\n' &gt;&gt; ${F}
printf 'JkMount /stroom* local\n' &gt;&gt; ${F}
printf 'JkMount /stroom/remoting/cluster* local\n' &gt;&gt; ${F}
printf 'JkMount /stroom/datafeed* local_proxy\n' &gt;&gt; ${F}
printf 'JkMount /stroom/remoting* local_proxy\n' &gt;&gt; ${F}
printf 'JkMount /stroom/datafeeddirect* local\n' &gt;&gt; ${F}
printf '# Note: Replaced JkShmFile logs/jk.shm due to SELinux issues. Refer to\n' &gt;&gt; ${F}
printf '# https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=225452\n' &gt;&gt; ${F}
printf '# The following makes use of the existing /run/httpd directory\n' &gt;&gt; ${F}
printf 'JkShmFile run/jk.shm\n' &gt;&gt; ${F}
printf '&lt;Location /jkstatus/&gt;\n' &gt;&gt; ${F}
printf '  JkMount status\n' &gt;&gt; ${F}
printf '  Order deny,allow\n' &gt;&gt; ${F}
printf '  Deny from all\n' &gt;&gt; ${F}
printf '  Allow from 127.0.0.1\n' &gt;&gt; ${F}
printf '&lt;/Location&gt;\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<ul>
<li>we configure <code>/etc/httpd/conf/workers.properties</code> as per</li>
</ul>
<p>The variable <strong>N</strong> in the script below is to be the node name (not FQDN) of your sever (i.e. stroomp00).</p>
<pre><code class="language-bash">N=stroomp00
FQDN=`hostname -f`
F=/etc/httpd/conf/workers.properties
printf 'worker.list=local,local_proxy,status\n' &gt; ${F}
printf 'worker.%s.port=8009\n' ${N} &gt;&gt; ${F}
printf 'worker.%s.host=%s\n' ${N} ${FQDN} &gt;&gt; ${F}
printf 'worker.%s.type=ajp13\n' ${N} &gt;&gt; ${F}
printf 'worker.%s.lbfactor=1\n' ${N} &gt;&gt; ${F}
printf 'worker.%s.max_packet_size=65536\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.port=9009\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.host=%s\n' ${N} ${FQDN} &gt;&gt; ${F}
printf 'worker.%s_proxy.type=ajp13\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.lbfactor=1\n' ${N} &gt;&gt; ${F}
printf 'worker.%s_proxy.max_packet_size=65536\n' ${N} &gt;&gt; ${F}
printf 'worker.local.type=lb\n' &gt;&gt; ${F}
printf 'worker.local.balance_workers=%s\n' ${N} &gt;&gt; ${F}
printf 'worker.local.sticky_session=1\n' &gt;&gt; ${F}
printf 'worker.local_proxy.type=lb\n' &gt;&gt; ${F}
printf 'worker.local_proxy.balance_workers=%s_proxy\n' ${N} &gt;&gt; ${F}
printf 'worker.local_proxy.sticky_session=1\n' &gt;&gt; ${F}
printf 'worker.status.type=status\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<h2 id="final-host-configuration-and-web-service-enablement">Final host configuration and web service enablement</h2>
<p>Now tidy up the SELinux context for access on all nodes and files via the commands</p>
<pre><code class="language-bash">setsebool -P httpd_enable_homedirs on
setsebool -P httpd_can_network_connect on
chcon --reference /etc/httpd/conf.d/README /etc/httpd/conf.d/mod_jk.conf
chcon --reference /etc/httpd/conf/magic /etc/httpd/conf/workers.properties
</code></pre>
<p>We also enable both http and https services via the firewall on all nodes. If you don&rsquo;t want to present a http access point,
then don&rsquo;t enable it in the firewall setting. This is done with</p>
<pre><code class="language-bash">firewall-cmd --zone=public --add-service=http --permanent
firewall-cmd --zone=public --add-service=https --permanent
firewall-cmd --reload
firewall-cmd --zone=public --list-all
</code></pre>
<p>Finally enable then start the httpd service, correcting any errors. It should be noted that on any errors,
the suggestion of a systemctl status or viewing the journal are good, but also review information in the httpd error logs found in <code>/var/log/httpd/</code>.</p>
<pre><code class="language-bash">systemctl enable httpd.service
systemctl start httpd.service
</code></pre>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.2.'; page-break-before: always">
    
  <h1 id="pg-ed03feb41ce97db6bd52aaca9e8e2276">4.2 - Database Installation</h1>
    <div class="lead">This HOWTO describes the installation of the Stroom databases.</div>
	<p>Following this HOWTO will produce a simple, minimally secured database deployment. In a production environment consideration needs to be made for redundancy, better security, data-store location, increased memory usage, and the like.</p>
<p>Stroom has two databases. The first, <code>stroom</code>, is used for management of Stroom itself and the second, <code>statistics</code> is used for the Stroom Statistics capability. There are many ways to deploy these two databases. One could</p>
<ul>
<li>have a single database instance and serve both databases from it</li>
<li>have two database instances on the same server and serve one database per instance</li>
<li>have two separate nodes, each with it&rsquo;s own database instance</li>
<li>the list goes on.</li>
</ul>
<p>In this HOWTO, we describe the deployment of two database instances on the one node, each serving a single database. We provide example deployments using either the 






  

<span class="external-link">
  <a href="https://mariadb.com" target="_blank" class="" style="" title="MariaDB (external link)">
    <span>MariaDB</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 or 






  

<span class="external-link">
  <a href="https://www.mysql.com/products/community/" target="_blank" class="" style="" title="MySQL Community (external link)">
    <span>MySQL Community</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 versions of MySQL.</p>
<h2 id="assumptions">Assumptions</h2>
<ul>
<li>we are installing the MariaDB or MySQL Community RDBMS software.</li>
<li>the primary database node is &lsquo;stroomdb0.strmdev00.org&rsquo;.</li>
<li>installation is on a fully patched minimal Centos 7.3 instance.</li>
<li>we are installing BOTH databases (<code>stroom</code> and <code>statistics</code>) on the same node - &lsquo;stroomdb0.stromdev00.org&rsquo; but with two distinct database engines. The first database will communicate on port <code>3307</code> and the second on <code>3308</code>.</li>
<li>we are deploying with SELinux in enforcing mode.</li>
<li>any scripts or commands that should run are in code blocks and are designed to allow the user to cut then paste the commands onto their systems.</li>
<li>in this document, when a textual screen capture is documented, data entry is identified by the data surrounded by &lsquo;&lt;<strong>&rsquo; &lsquo;</strong>&gt;&rsquo; . This excludes enter/return presses.</li>
</ul>
<h2 id="installation-of-software">Installation of Software</h2>
<h3 id="mariadb-server-installation">MariaDB Server Installation</h3>
<p>As MariaDB is directly supported by Centos 7, we simply install the database server software and SELinux policy files, as per</p>
<pre><code class="language-bash">sudo yum -y install policycoreutils-python mariadb-server
</code></pre>
<h3 id="mysql-community-server-installation">MySQL Community Server Installation</h3>
<p>As MySQL is not directly supported by Centos 7, we need to install it&rsquo;s repository files prior to installation.
We get the current MySQL Community release repository rpm and validate it&rsquo;s MD5 checksum against the published value found on the 






  

<span class="external-link">
  <a href="https://dev.mysql.com/downloads/repo/yum" target="_blank" class="" style="" title="MySQL Yum Repository (external link)">
    <span>MySQL Yum Repository</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 site.</p>
<pre><code class="language-bash">wget https://repo.mysql.com/mysql57-community-release-el7.rpm
md5sum mysql57-community-release-el7.rpm
</code></pre>
<p>On correct validation of the MD5 checksum, we install the repository files via</p>
<pre><code class="language-bash">sudo yum -y localinstall mysql57-community-release-el7.rpm
</code></pre>
<p><strong>NOTE:</strong> Stroom currently does not support the latest production MySQL version - 5.7. You will need to install MySQL Version 5.6.</p>
<p>Now since we must use MySQL Version 5.6 you will need to edit the MySQL repo file <code>/etc/yum.repos.d/mysql-community.repo</code> to
disable the <code>mysql57-community</code> channel and enable the <code>mysql56-community</code> channel. We start by, backing up the repo file with</p>
<pre><code class="language-bash">sudo cp /etc/yum.repos.d/mysql-community.repo /etc/yum.repos.d/mysql-community.repo.ORIG
</code></pre>
<p>Then edit the file to change</p>
<pre><code class="language-toml">...
# Enable to use MySQL 5.6
[mysql56-community]
name=MySQL 5.6 Community Server
baseurl=http://repo.mysql.com/yum/mysql-5.6-community/el/7/$basearch/
enabled=0
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql

[mysql57-community]
name=MySQL 5.7 Community Server
baseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/
enabled=1
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql
...
</code></pre>
<p>to become</p>
<pre><code class="language-toml">...
# Enable to use MySQL 5.6
[mysql56-community]
name=MySQL 5.6 Community Server
baseurl=http://repo.mysql.com/yum/mysql-5.6-community/el/7/$basearch/
enabled=1
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql

[mysql57-community]
name=MySQL 5.7 Community Server
baseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/
enabled=0
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql
...
</code></pre>
<p>Next we install server software and SELinux policy files, as per</p>
<pre><code class="language-bash">sudo yum -y install policycoreutils-python mysql-community-server
</code></pre>
<h2 id="preparing-the-database-deployment">Preparing the Database Deployment</h2>
<h3 id="mariadb-variant">MariaDB Variant</h3>
<h4 id="create-and-instantiate-both-database-instances">Create and instantiate both database instances</h4>
<p>To set up two MariaDB database instances on the one node, we will use <code>mysql_multi</code> and systemd service templates. The <code>mysql_multi</code> utility is a capability that manages multiple MariaDB databases on the same node and systemd service templates manage multiple services from one configuration file.  A systemd service template is unique in that it has an <code>@</code> character before the <code>.service</code> suffix.</p>
<p>To use this multiple-instance capability, we need to create two data directories for each database instance and also replace the main MariaDB configuration file, <code>/etc/my.cnf</code>, with one that includes configuration of key options for each instance. We will name our instances, <code>mysqld0</code> and <code>mysqld1</code>. We will also create specific log files for each instance.</p>
<p>We will use the directories, <code>/var/lib/mysql-mysqld0</code> and <code>/var/lib/mysql-mysqld1</code> for the data directories and <code>/var/log/mariadb/mysql-mysqld0.log</code> and <code>/var/log/mariadb/mysql-mysqld1.log</code> for the log files. Note you should modify /etc/logrotate.d/mariadb to manage these log files. Note also, we need to set the appropriate SELinux file contexts on the created directories and any files.</p>
<p>We create the data directories and log files and set their respective SELinux contexts via</p>
<pre><code class="language-bash">sudo mkdir /var/lib/mysql-mysqld0
sudo chown mysql:mysql /var/lib/mysql-mysqld0
sudo semanage fcontext -a -t mysqld_db_t &quot;/var/lib/mysql-mysqld0(/.*)?&quot;
sudo restorecon -Rv /var/lib/mysql-mysqld0

sudo touch /var/log/mariadb/mysql-mysqld0.log
sudo chown mysql:mysql /var/log/mariadb/mysql-mysqld0.log
sudo chcon --reference=/var/log/mariadb/mariadb.log /var/log/mariadb/mysql-mysqld0.log

sudo mkdir /var/lib/mysql-mysqld1
sudo chown mysql:mysql /var/lib/mysql-mysqld1
sudo semanage fcontext -a -t mysqld_db_t &quot;/var/lib/mysql-mysqld1(/.*)?&quot;
sudo restorecon -Rv /var/lib/mysql-mysqld1

sudo touch /var/log/mariadb/mysql-mysqld1.log
sudo chown mysql:mysql /var/log/mariadb/mysql-mysqld1.log
sudo chcon --reference=/var/log/mariadb/mariadb.log /var/log/mariadb/mysql-mysqld1.log
</code></pre>
<p>We now initialise the our two database data directories via</p>
<pre><code class="language-bash">sudo mysql_install_db --user=mysql --datadir=/var/lib/mysql-mysqld0
sudo mysql_install_db --user=mysql --datadir=/var/lib/mysql-mysqld1
</code></pre>
<p>We now replace the  MySQL configuration file to set the options for each instance. Note that we will serve <code>mysqld0</code> and <code>mysqld1</code> via TCP ports <code>3307</code> and <code>3308</code> respectively. First backup the existing configuration file with</p>
<pre><code class="language-bash">sudo cp /etc/my.cnf /etc/my.cnf.ORIG
</code></pre>
<p>then setup <code>/etc/my.cnf</code> as per</p>
<pre><code class="language-bash">sudo bash
F=/etc/my.cnf
printf '[mysqld_multi]\n' &gt; ${F}
printf 'mysqld = /usr/bin/mysqld_safe --basedir=/usr\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '[mysqld0]\n' &gt;&gt; ${F}
printf 'port=3307\n' &gt;&gt; ${F}
printf 'mysqld = /usr/bin/mysqld_safe --basedir=/usr\n' &gt;&gt; ${F}
printf 'datadir=/var/lib/mysql-mysqld0/\n' &gt;&gt; ${F}
printf 'socket=/var/lib/mysql-mysqld0/mysql.sock\n' &gt;&gt; ${F}
printf 'pid-file=/var/run/mariadb/mysql-mysqld0.pid\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf 'log-error=/var/log/mariadb/mysql-mysqld0.log\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '# Disabling symbolic-links is recommended to prevent assorted security\n' &gt;&gt; ${F}
printf '# risks\n' &gt;&gt; ${F}
printf 'symbolic-links=0\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '[mysqld1]\n' &gt;&gt; ${F}
printf 'mysqld = /usr/bin/mysqld_safe --basedir=/usr\n' &gt;&gt; ${F}
printf 'port=3308\n' &gt;&gt; ${F}
printf 'datadir=/var/lib/mysql-mysqld1/\n' &gt;&gt; ${F}
printf 'socket=/var/lib/mysql-mysqld1/mysql.sock\n' &gt;&gt; ${F}
printf 'pid-file=/var/run/mariadb/mysql-mysqld1.pid\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf 'log-error=/var/log/mariadb/mysql-mysqld1.log\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '# Disabling symbolic-links is recommended to prevent assorted security risks\n' &gt;&gt; ${F}
printf 'symbolic-links=0\n' &gt;&gt; ${F}
exit # To exit the root shell
</code></pre>
<p>We also need to associate the ports with the <code>mysqld_port_t</code> SELinux context as per</p>
<pre><code class="language-bash">sudo semanage port -a -t mysqld_port_t -p tcp 3307
sudo semanage port -a -t mysqld_port_t -p tcp 3308
</code></pre>
<p>We next create the systemd service template as per</p>
<pre><code class="language-bash">sudo bash
F=/etc/systemd/system/mysqld@.service

printf '# Install in /etc/systemd/system\n' &gt; ${F}
printf '# Enable via systemctl enable mysqld@0 or systemctl enable mysqld@1\n' &gt;&gt; ${F}
printf '[Unit]\n' &gt;&gt; ${F}
printf 'Description=MySQL Multi Server for instance %%i\n' &gt;&gt; ${F}
printf 'After=syslog.target\n' &gt;&gt; ${F}
printf 'After=network.target\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '[Service]\n' &gt;&gt; ${F}
printf 'User=mysql\n' &gt;&gt; ${F}
printf 'Group=mysql\n' &gt;&gt; ${F}
printf 'Type=forking\n' &gt;&gt; ${F}
printf 'ExecStart=/usr/bin/mysqld_multi start %%i\n' &gt;&gt; ${F}
printf 'ExecStop=/usr/bin/mysqld_multi stop %%i\n' &gt;&gt; ${F}
printf 'Restart=always\n' &gt;&gt; ${F}
printf 'PrivateTmp=true\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '[Install]\n' &gt;&gt; ${F}
printf 'WantedBy=multi-user.target\n' &gt;&gt; ${F}
chmod 644 ${F}
exit; # to exit the root shell
</code></pre>
<p>We next enable and start both instances via</p>
<pre><code class="language-bash">sudo systemctl enable mysqld@0
sudo systemctl enable mysqld@1
sudo systemctl start mysqld@0
sudo systemctl start mysqld@1
</code></pre>
<p>At this we should have both instances running. One should check each instance&rsquo;s log file for any errors.</p>
<h4 id="secure-each-database-instance">Secure each database instance</h4>
<p>We secure each database engine by running the <code>mysql_secure_installation</code> script. One should accept all defaults, which means the
only entry (aside from pressing returns) is the administrator (root) database password. Make a note of the password you use. In this case
we will use <code>Stroom5User@</code>.
The utility <code>mysql_secure_installation</code> expects to find the Linux socket file to access the database it&rsquo;s securing at <code>/var/lib/mysql/mysql.sock</code>.
Since we have used other locations, we temporarily link the real socket file to <code>/var/lib/mysql/mysql.sock</code> for each invocation of the
utility. Thus we execute</p>
<pre><code class="language-bash">sudo ln /var/lib/mysql-mysqld0/mysql.sock /var/lib/mysql/mysql.sock
sudo mysql_secure_installation
</code></pre>
<p>to see</p>
<pre><code class="language-text">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB
      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!

In order to log into MariaDB to secure it, we'll need the current
password for the root user.  If you've just installed MariaDB, and
you haven't set the root password yet, the password will be blank,
so you should just press enter here.

Enter current password for root (enter for none): 
OK, successfully used password, moving on...

Setting the root password ensures that nobody can log into the MariaDB
root user without the proper authorisation.

Set root password? [Y/n] 
New password: &lt;__ Stroom5User@ __&gt;
Re-enter new password: &lt;__ Stroom5User@ __&gt;
Password updated successfully!
Reloading privilege tables..
 ... Success!


By default, a MariaDB installation has an anonymous user, allowing anyone
to log into MariaDB without having to have a user account created for
them.  This is intended only for testing, and to make the installation
go a bit smoother.  You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n] 
 ... Success!

Normally, root should only be allowed to connect from 'localhost'.  This
ensures that someone cannot guess at the root password from the network.

Disallow root login remotely? [Y/n] 
 ... Success!

By default, MariaDB comes with a database named 'test' that anyone can
access.  This is also intended only for testing, and should be removed
before moving into a production environment.

Remove test database and access to it? [Y/n]
 - Dropping test database...
 ... Success!
 - Removing privileges on test database...
 ... Success!

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n]
... Success!

Cleaning up...

All done!  If you've completed all of the above steps, your MariaDB
installation should now be secure.

Thanks for using MariaDB!
</code></pre>
<p>then we execute</p>
<pre><code class="language-bash">sudo rm /var/lib/mysql/mysql.sock
sudo ln /var/lib/mysql-mysqld1/mysql.sock /var/lib/mysql/mysql.sock
sudo mysql_secure_installation
sudo rm /var/lib/mysql/mysql.sock
</code></pre>
<p>and process as before (for when running mysql_secure_installation). At this both database instances should be secure.</p>
<h3 id="mysql-community-variant">MySQL Community Variant</h3>
<h4 id="create-and-instantiate-both-database-instances-1">Create and instantiate both database instances</h4>
<p>To set up two MySQL database instances on the one node, we will use <code>mysql_multi</code> and systemd service templates. The <code>mysql_multi</code> utility is a capability that manages multiple MySQL databases on the same node and systemd service templates manage multiple services from one configuration file.  A systemd service template is unique in that it has an <code>@</code> character before the <code>.service</code> suffix.</p>
<p>To use this multiple-instance capability, we need to create two data directories for each database instance and also replace the main MySQL configuration file, <code>/etc/my.cnf</code>, with one that includes configuration of key options for each instance. We will name our instances, <code>mysqld0</code> and <code>mysqld1</code>. We will also create specific log files for each instance.</p>
<p>We will use the directories, <code>/var/lib/mysql-mysqld0</code> and <code>/var/lib/mysql-mysqld1</code> for the data directories and <code>/var/log/mysql-mysqld0.log</code> and <code>/var/log/mysql-mysqld1.log</code> for the log directories. Note you should modify /etc/logrotate.d/mysql to manage these log files. Note also, we need to set the appropriate SELinux file context on the created directories and files.</p>
<pre><code class="language-bash">sudo mkdir /var/lib/mysql-mysqld0
sudo chown mysql:mysql /var/lib/mysql-mysqld0
sudo semanage fcontext -a -t mysqld_db_t &quot;/var/lib/mysql-mysqld0(/.*)?&quot;
sudo restorecon -Rv /var/lib/mysql-mysqld0

sudo touch /var/log/mysql-mysqld0.log
sudo chown mysql:mysql /var/log/mysql-mysqld0.log
sudo chcon --reference=/var/log/mysqld.log /var/log/mysql-mysqld0.log

sudo mkdir /var/lib/mysql-mysqld1
sudo chown mysql:mysql /var/lib/mysql-mysqld1 
sudo semanage fcontext -a -t mysqld_db_t &quot;/var/lib/mysql-mysqld1(/.*)?&quot;
sudo restorecon -Rv /var/lib/mysql-mysqld1

sudo touch /var/log/mysql-mysqld1.log
sudo chown mysql:mysql /var/log/mysql-mysqld1.log
sudo chcon --reference=/var/log/mysqld.log /var/log/mysql-mysqld1.log
</code></pre>
<p>We now initialise the our two database data directories via</p>
<pre><code class="language-bash">sudo mysql_install_db --user=mysql --datadir=/var/lib/mysql-mysqld0
sudo mysql_install_db --user=mysql --datadir=/var/lib/mysql-mysqld1
</code></pre>
<p>Disable the default database via</p>
<pre><code class="language-bash">sudo systemctl disable mysqld
</code></pre>
<p>We now modify the  MySQL configuration file to set the options for each instance. Note that we will serve <code>mysqld0</code> and <code>mysqld1</code> via TCP ports <code>3307</code> and <code>3308</code> respectively.  First backup the existing configuration file with</p>
<pre><code class="language-bash">sudo cp /etc/my.cnf /etc/my.cnf.ORIG
</code></pre>
<p>then setup <code>/etc/my.cnf</code> as per</p>
<pre><code class="language-bash">sudo bash
F=/etc/my.cnf
printf '[mysqld_multi]\n' &gt; ${F}
printf 'mysqld = /usr/bin/mysqld_safe --basedir=/usr\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '[mysqld0]\n' &gt;&gt; ${F}
printf 'port=3307\n' &gt;&gt; ${F}
printf 'mysqld = /usr/bin/mysqld_safe --basedir=/usr\n' &gt;&gt; ${F}
printf 'datadir=/var/lib/mysql-mysqld0/\n' &gt;&gt; ${F}
printf 'socket=/var/lib/mysql-mysqld0/mysql.sock\n' &gt;&gt; ${F}
printf 'pid-file=/var/run/mysqld/mysql-mysqld0.pid\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf 'log-error=/var/log/mysql-mysqld0.log\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '# Disabling symbolic-links is recommended to prevent assorted security\n' &gt;&gt; ${F}
printf '# risks\n' &gt;&gt; ${F}
printf 'symbolic-links=0\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '[mysqld1]\n' &gt;&gt; ${F}
printf 'mysqld = /usr/bin/mysqld_safe --basedir=/usr\n' &gt;&gt; ${F}
printf 'port=3308\n' &gt;&gt; ${F}
printf 'datadir=/var/lib/mysql-mysqld1/\n' &gt;&gt; ${F}
printf 'socket=/var/lib/mysql-mysqld1/mysql.sock\n' &gt;&gt; ${F}
printf 'pid-file=/var/run/mysqld/mysql-mysqld1.pid\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf 'log-error=/var/log/mysql-mysqld1.log\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '# Disabling symbolic-links is recommended to prevent assorted security risks\n' &gt;&gt; ${F}
printf 'symbolic-links=0\n' &gt;&gt; ${F}
exit # To exit the root shell
</code></pre>
<p>We also need to associate the ports with the <code>mysqld_port_t</code> SELinux context as per</p>
<pre><code class="language-bash">sudo semanage port -a -t mysqld_port_t -p tcp 3307
sudo semanage port -a -t mysqld_port_t -p tcp 3308
</code></pre>
<p>We next create the systemd service template as per</p>
<pre><code class="language-bash">sudo bash
F=/etc/systemd/system/mysqld@.service

printf '# Install in /etc/systemd/system\n' &gt; ${F}
printf '# Enable via systemctl enable mysqld@0 or systemctl enable mysqld@1\n' &gt;&gt; ${F}
printf '[Unit]\n' &gt;&gt; ${F}
printf 'Description=MySQL Multi Server for instance %%i\n' &gt;&gt; ${F}
printf 'After=syslog.target\n' &gt;&gt; ${F}
printf 'After=network.target\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '[Service]\n' &gt;&gt; ${F}
printf 'User=mysql\n' &gt;&gt; ${F}
printf 'Group=mysql\n' &gt;&gt; ${F}
printf 'Type=forking\n' &gt;&gt; ${F}
printf 'ExecStart=/usr/bin/mysqld_multi start %%i\n' &gt;&gt; ${F}
printf 'ExecStop=/usr/bin/mysqld_multi stop %%i\n' &gt;&gt; ${F}
printf 'Restart=always\n' &gt;&gt; ${F}
printf 'PrivateTmp=true\n' &gt;&gt; ${F}
printf '\n' &gt;&gt; ${F}
printf '[Install]\n' &gt;&gt; ${F}
printf 'WantedBy=multi-user.target\n' &gt;&gt; ${F}
chmod 644 ${F}
exit; # to exit the root shell
</code></pre>
<p>We next enable and start both instances via</p>
<pre><code class="language-bash">sudo systemctl enable mysqld@0
sudo systemctl enable mysqld@1
sudo systemctl start mysqld@0
sudo systemctl start mysqld@1
</code></pre>
<p>At this we should have both instances running. One should check each instance&rsquo;s log file for any errors.</p>
<h4 id="secure-each-database-instance-1">Secure each database instance</h4>
<p>We secure each database engine by running the <code>mysql_secure_installation</code> script. One should accept all defaults, which means the
only entry (aside from pressing returns) is the administrator (root) database password. Make a note of the password you use. In this case
we will use <code>Stroom5User@</code>.
The utility <code>mysql_secure_installation</code> expects to find the Linux socket file to access the database it&rsquo;s securing at <code>/var/lib/mysql/mysql.sock</code>.
Since we have used other locations, we temporarily link the real socket file to <code>/var/lib/mysql/mysql.sock</code> for each invocation of the
utility. Thus we execute</p>
<pre><code class="language-bash">sudo ln /var/lib/mysql-mysqld0/mysql.sock /var/lib/mysql/mysql.sock
sudo mysql_secure_installation
</code></pre>
<p>to see</p>
<pre><code class="language-text">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL
      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!

In order to log into MySQL to secure it, we'll need the current
password for the root user.  If you've just installed MySQL, and
you haven't set the root password yet, the password will be blank,
so you should just press enter here.

Enter current password for root (enter for none): 
OK, successfully used password, moving on...

Setting the root password ensures that nobody can log into the MySQL
root user without the proper authorisation.

Set root password? [Y/n] y
New password: &lt;__ Stroom5User@ __&gt;
Re-enter new password: &lt;__ Stroom5User@ __&gt;
Password updated successfully!
Reloading privilege tables..
 ... Success!


By default, a MySQL installation has an anonymous user, allowing anyone
to log into MySQL without having to have a user account created for
them.  This is intended only for testing, and to make the installation
go a bit smoother.  You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n] 
 ... Success!

Normally, root should only be allowed to connect from 'localhost'.  This
ensures that someone cannot guess at the root password from the network.

Disallow root login remotely? [Y/n] 
 ... Success!

By default, MySQL comes with a database named 'test' that anyone can
access.  This is also intended only for testing, and should be removed
before moving into a production environment.

Remove test database and access to it? [Y/n] 
 - Dropping test database...
ERROR 1008 (HY000) at line 1: Can't drop database 'test'; database doesn't exist
 ... Failed!  Not critical, keep moving...
 - Removing privileges on test database...
 ... Success!

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n] 
 ... Success!




All done!  If you've completed all of the above steps, your MySQL
installation should now be secure.

Thanks for using MySQL!


Cleaning up...
</code></pre>
<p>then we execute</p>
<pre><code class="language-bash">sudo rm /var/lib/mysql/mysql.sock
sudo ln /var/lib/mysql-mysqld1/mysql.sock /var/lib/mysql/mysql.sock
sudo mysql_secure_installation
sudo rm /var/lib/mysql/mysql.sock
</code></pre>
<p>and process as before (for when running mysql_secure_installation). At this both database instances should be secure.</p>
<h2 id="create-the-databases-and-enable-access-by-the-stroom-processing-users">Create the Databases and Enable access by the Stroom processing users</h2>
<p>We now create the <code>stroom</code> database within the first instance, <code>mysqld0</code> and the <code>statistics</code> database within the second
instance <code>mysqld1</code>. It does not matter which database variant used as all commands are the same for both.</p>
<p>As well as creating the databases, we also need to establish the Stroom processing users
that the Stroom processing nodes will use to access each database.
For the <code>stroom</code> database, we will use the database user <code>stroomuser</code> with a password of <code>Stroompassword1@</code> and for the <code>statistics</code> database, we will use the database user <code>stroomstats</code> with a password of <code>Stroompassword2@</code>. One identifies a processing user as <code>&lt;user&gt;@&lt;host&gt;</code> on a <code>grant</code> SQL command.</p>
<p>In the <code>stroom</code> database instance, we will grant access for</p>
<ul>
<li><code>stroomuser@localhost</code> for local access for maintenance etc.</li>
<li><code>stroomuser@stroomp00.strmdev00.org</code> for access by processing node <code>stroomp00.strmdev00.org</code></li>
<li><code>stroomuser@stroomp01.strmdev00.org</code> for access by processing node <code>stroomp01.strmdev00.org</code></li>
</ul>
<p>and in the <code>statistics</code> database instance, we will grant access for</p>
<ul>
<li><code>stroomstats@localhost</code> for local access for maintenance etc.</li>
<li><code>stroomstats@stroomp00.strmdev00.org</code> for access by processing node <code>stroomp00.strmdev00.org</code></li>
<li><code>stroomstats@stroomp01.strmdev00.org</code> for access by processing node <code>stroomp01.strmdev00.org</code></li>
</ul>
<p>Thus for the <code>stroom</code> database we execute</p>
<pre><code class="language-bash">mysql --user=root --port=3307 --socket=/var/lib/mysql-mysqld0/mysql.sock --password
</code></pre>
<p>and on entering the administrator&rsquo;s password, we arrive at the <code>MariaDB [(none)]&gt;</code> or <code>mysql&gt;</code> prompt. At this we create the database with</p>
<pre><code class="language-sql">create database stroom;
</code></pre>
<p>and then to establish the users, we execute</p>
<pre><code class="language-sql">grant all privileges on stroom.* to stroomuser@localhost identified by 'Stroompassword1@';
grant all privileges on stroom.* to stroomuser@stroomp00.strmdev00.org identified by 'Stroompassword1@';
grant all privileges on stroom.* to stroomuser@stroomp01.strmdev00.org identified by 'Stroompassword1@';
</code></pre>
<p>then</p>
<pre><code class="language-sql">quit;
</code></pre>
<p>to exit.</p>
<p>And for the <code>statistics</code> database</p>
<pre><code class="language-bash">mysql --user=root --port=3308 --socket=/var/lib/mysql-mysqld1/mysql.sock --password
</code></pre>
<p>with</p>
<pre><code class="language-sql">create database statistics;
</code></pre>
<p>and then to establish the users, we execute</p>
<pre><code class="language-sql">grant all privileges on statistics.* to stroomstats@localhost identified by 'Stroompassword2@';
grant all privileges on statistics.* to stroomstats@stroomp00.strmdev00.org identified by 'Stroompassword2@';
grant all privileges on statistics.* to stroomstats@stroomp01.strmdev00.org identified by 'Stroompassword2@';
</code></pre>
<p>then</p>
<pre><code class="language-sql">quit;
</code></pre>
<p>to exit.</p>
<p>Clearly if we need to add more processing nodes, additional <code>grant</code> commands would be used. Further, if we were installing the databases in a single node Stroom environment, we would just have the first two pairs of <code>grants</code>.</p>
<h2 id="configure-firewall">Configure Firewall</h2>
<p>Next we need to modify our firewall to allow remote access to our databases which listens on ports 3307 and 3308.
The simplest way to achieve this is with the commands</p>
<pre><code class="language-bash">sudo firewall-cmd --zone=public --add-port=3307/tcp --permanent
sudo firewall-cmd --zone=public --add-port=3308/tcp --permanent
sudo firewall-cmd --reload
sudo firewall-cmd --zone=public --list-all
</code></pre>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>


    That this allows ANY node to connect to your databases. You should give consideration to restricting this to only allowing processing node access.

</div>


<h3 id="debugging-of-mariadb-for-stroom">Debugging of Mariadb for Stroom</h3>
<p>If there is a need to debug the Mariadb database and Stroom interaction, one can turn on auditing for the Mariadb service.
To do so, log onto the relevant database as the administrative user as per</p>
<pre><code class="language-bash">mysql --user=root --port=3307 --socket=/var/lib/mysql-mysqld0/mysql.sock --password
or
mysql --user=root --port=3308 --socket=/var/lib/mysql-mysqld1/mysql.sock --password
</code></pre>
<p>and at the <code>MariaDB [(none)]&gt; </code> prompt enter</p>
<pre><code class="language-bash">install plugin server_audit SONAME 'server_audit';
set global server_audit_file_path='/var/log/mariadb/mysqld-mysqld0_server_audit.log';
or
set global server_audit_file_path='/var/log/mariadb/mysqld-mysqld1_server_audit.log';
set global server_audit_logging=ON;
set global server_audit_file_rotate_size=10485760;
install plugin SQL_ERROR_LOG soname 'sql_errlog';
quit;
</code></pre>
<p>The above will generate two log files,</p>
<ul>
<li><code>/var/log/mariadb/mysqld-mysqld0_server_audit.log</code> or <code>/var/log/mariadb/mysqld-mysqld1_server_audit.log</code> which records all commands the respective databases run. We have configured the log file will rotate at 10MB in size.</li>
<li><code>/var/lib/mysql-mysqld0/sql_errors.log</code> or <code>/var/lib/mysql-mysqld1/sql_errors.log</code> which records all erroneous SQL commands. This log file will rotate at 10MB in size. Note we cannot set this filename via the UI, but it will be appear in the data directory.</li>
</ul>
<p>All files will, by default, generate up to 9 rotated files.</p>
<p>If you wish to rotate a log file manually, log into the database as the administrative user and execute either</p>
<ul>
<li><code>set global server_audit_file_rotate_now=1;</code> to rotate the audit log file</li>
<li><code>set global sql_error_log_rotate=1;</code> to rotate the sql_errlog log file</li>
</ul>
<h3 id="initial-database-access">Initial Database Access</h3>
<p>It should be noted that if you monitor the sql_errors.log log file on a new Stooom deployment, when the Stoom Application first starts, it&rsquo;s initial access to the <code>stroom</code> database will result in the following attempted sql statements.</p>
<pre><code class="language-sql">2017-04-16 16:24:50 stroomuser[stroomuser] @ stroomp00.strmdev00.org [192.168.2.126] ERROR 1146: Table 'stroom.schema_version' doesn't exist : SELECT version FROM schema_version ORDER BY installed_rank DESC
2017-04-16 16:24:50 stroomuser[stroomuser] @ stroomp00.strmdev00.org [192.168.2.126] ERROR 1146: Table 'stroom.STROOM_VER' doesn't exist : SELECT VER_MAJ, VER_MIN, VER_PAT FROM STROOM_VER ORDER BY VER_MAJ DESC, VER_MIN DESC, VER_PAT DESC LIMIT 1
2017-04-16 16:24:50 stroomuser[stroomuser] @ stroomp00.strmdev00.org [192.168.2.126] ERROR 1146: Table 'stroom.FD' doesn't exist : SELECT ID FROM FD LIMIT 1
2017-04-16 16:24:50 stroomuser[stroomuser] @ stroomp00.strmdev00.org [192.168.2.126] ERROR 1146: Table 'stroom.FEED' doesn't exist : SELECT ID FROM FEED LIMIT 1
</code></pre>
<p>After this access the application will realise the database does not exist and it will initialise the database.</p>
<p>In the case of the <code>statistics</code> database you may note the following attempted access</p>
<pre><code class="language-sql">2017-04-16 16:25:09 stroomstats[stroomstats] @ stroomp00.strmdev00.org [192.168.2.126] ERROR 1146: Table 'statistics.schema_version' doesn't exist : SELECT version FROM schema_version ORDER BY installed_rank DESC 
</code></pre>
<p>Again, at this point the application will initialise this database.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.3.'; page-break-before: always">
    
  <h1 id="pg-86ea86569879380008d85e7b9a20e6fe">4.3 - Installation</h1>
    <div class="lead">This HOWTO is provided to assist users in setting up a number of different Stroom environments based on Centos 7.3 infrastructure.</div>
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>the user has reasonable RHEL/Centos System administration skills.</li>
<li>installations are on Centos 7.3 minimal systems (fully patched).</li>
<li>the term &rsquo;node&rsquo; is used to reference the &lsquo;host&rsquo; a service is running on.</li>
<li>the Stroom Proxy and Application software runs as user &lsquo;stroomuser&rsquo; and will be deployed in this user&rsquo;s home directory</li>
<li>data will reside in a directory tree referenced via &lsquo;/stroomdata&rsquo;. It is up to the user to provision a filesystem here, noting sub-directories of it will be NFS shared in Multi Node Stroom Deployments</li>
<li>any scripts or commands that should run are in code blocks and are designed to allow the user to cut then paste the commands onto their systems</li>
<li>in this document, when a textual screen capture is documented, data entry is identified by the data surrounded by &lsquo;&lt;<strong>&rsquo; &lsquo;</strong>&gt;&rsquo; . This excludes enter/return presses.</li>
<li>better security of password choices, networking, firewalls, data stores, etc. can and should be achieved in various ways, but these HOWTOs are just a quick means of getting a working system, so only limited security is applied</li>
<li>better configuration of the database (e.g. more memory. redundancy) should be considered in production environments</li>
<li>the use of self signed certificates is appropriate for test systems, but users should consider appropriate CA infrastructure in production environments</li>
<li>the user has access to a 






  

<span class="external-link">
  <a href="https://www.google.com/chrome" target="_blank" class="" style="" title="Chrome (external link)">
    <span>Chrome</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 web browser as Stroom is optimised for this browser.</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>This HOWTO provides guidance on a variety of simple Stroom deployments.</p>
<ul>
<li><a href="#multi-node-stroom-cluster-proxy-and-application-deployment"><strong>Multi Node Stroom Cluster (Proxy and Application)</strong></a></li>
</ul>
<p>for an environment where multiple nodes are required to handle the processing load.</p>
<ul>
<li><a href="#forwarding-stroom-proxy-deployment"><strong>Forwarding Stroom Proxy</strong></a></li>
</ul>
<p>for extensive networks where one wants to aggregate data through a proxy before sending data to the central Stroom processing systems.</p>
<ul>
<li><a href="#standalone-stroom-proxy-deployment"><strong>Standalone Stroom Proxy</strong></a></li>
</ul>
<p>for disconnected networks where collected data can be manually transferred to a Stroom processing service.</p>
<ul>
<li><a href="#addition-of-a-node-to-a-stroom-cluster-deployment"><strong>Addition of a Node to Stroom Cluster</strong></a></li>
</ul>
<p>for when one needs to add an additional node to an existing cluster.</p>
<h2 id="nodename-nomenclature">Nodename Nomenclature</h2>
<p>For simplicity sake, the nodenames used in this HOWTO are geared towards the Multi Node Stroom Cluster deployment. That is,</p>
<ul>
<li>the database nodename is <code>stroomdb0.strmdev00.org</code></li>
<li>the processing nodenames are <code>stroomp00.strmdev00.org</code>, <code>stroomp01.strmdev00.org</code>, and <code>stroomp02.strmdev00.org</code></li>
<li>the first node in our cluster, <code>stroomp00.strmdev00.org</code>, also has the CNAME <code>stroomp.strmdev00.org</code></li>
</ul>
<p>In the case of the Proxy only deployments,</p>
<ul>
<li>the forwarding Stroom proxy nodename is <code>stoomfp0.strmdev00.org</code></li>
<li>the standalone nodename will be <code>stroomp00.strmdev00.org</code></li>
</ul>
<h2 id="storage">Storage</h2>
<p>Both the Stroom Proxy and Application store data. The typical requirement is</p>
<ul>
<li>directory for Stroom proxy to store <strong>inbound data</strong> files</li>
<li>directory for Stroom application <strong>permanent data</strong> files (events, etc.)</li>
<li>directory for Stroom application <strong>index data</strong> files</li>
<li>directory for Stroom application <strong>working files</strong> (temporary files, output, etc.)</li>
</ul>
<p>Where multiple processing nodes are involved, the application&rsquo;s <strong>permanent data</strong> directories need to be accessible by all participating nodes.</p>
<p>Thus a hierarchy for a Stroom Proxy might by</p>
<ul>
<li>/stroomdata/stroom-proxy</li>
</ul>
<p>and for an Application node</p>
<ul>
<li>/stroomdata/stroom-data</li>
<li>/stroomdata/stroom-index</li>
<li>/stroomdata/stroom-working</li>
</ul>
<p>In the following examples, the storage hierarchy proposed will more suited for a multi node Stroom cluster, including the Forwarding or
Standalone proxy deployments. This is to simplify the documentation. Thus, the above structure is generalised into</p>
<ul>
<li>/stroomdata/stroom-working-p_nn_/proxy</li>
</ul>
<p>and</p>
<ul>
<li>/stroomdata/stroom-data-p_nn_</li>
<li>/stroomdata/stroom-index-p_nn_</li>
<li>/stroomdata/stroom-working-p_nn_</li>
</ul>
<p>where <em>nn</em> is a two digit node number. The reason for placing the proxy directory within the <em>Application</em> working area
will be explained later.</p>
<p>All data should be owned by the Stroom processing user. In this HOWTO, we will use <code>stroomuser</code></p>
<h2 id="multi-node-stroom-cluster-proxy-and-application-deployment">Multi Node Stroom Cluster (Proxy and Application) Deployment</h2>
<p>In this deployment we will install the database on a given node then deploy both the Stroom Proxy and Stroom Application software
to both our processing nodes. At this point we will then integrate a web service to run &lsquo;in-front&rsquo; of our Stroom software and
then perform the initial configuration of Stroom via the user interface.</p>
<h2 id="database-installation">Database Installation</h2>
<p>The Stroom capability requires access to two MySQL/MariaDB databases. The first is for persisting application configuration and metadata information, and the second is for the Stroom Statistics capability.
Instructions for installation of the Stroom databases can be found <a href="../../../docs/howtos/install/installdatabasehowto/">here</a>.
Although these instructions describe the deployment of the databases to their own node, there is no reason why one can&rsquo;t
just install them both on the first (or only) Stroom node.</p>
<h2 id="prerequisite-software-installation">Prerequisite Software Installation</h2>
<p>Certain software packages are required for either the Stroom Proxy or Stroom Application to run.</p>
<p>The core software list is</p>
<ul>
<li>java-1.8.0-openjdk</li>
<li>java-1.8.0-openjdk-devel</li>
<li>policycoreutils-python</li>
<li>unzip</li>
<li>zip</li>
<li>mariadb or mysql client</li>
</ul>
<p>Most of the required software are packages available via standard repositories and hence we can simply execute</p>
<pre><code class="language-bash">sudo yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel policycoreutils-python unzip zip
</code></pre>
<p>One has a choice of database clients. MariaDB is directly supported by Centos 7 and is simplest to install. This is done via</p>
<pre><code class="language-bash">sudo yum -y install mariadb
</code></pre>
<p>One could deploy the MySQL database software as the alternative.</p>
<p><a name="mysqlclientinstall"></a>To do this you need to install the MySQL Community repository files then install the client.
Instructions for installation of the MySQL Community repository files can be
found <a href="../../../docs/howtos/install/installdatabasehowto/#mysql-community-server-installation">here</a> or on
the 






  

<span class="external-link">
  <a href="https://dev.mysql.com/downloads/repo/yum" target="_blank" class="" style="" title="MySQL Site (external link)">
    <span>MySQL Site</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.
Once you have installed the MySQL repository files, install the client via</p>
<pre><code class="language-bash">sudo yum -y install mysql-community-client
</code></pre>
<p>Note that additional software will be required for other integration components (e.g. Apache httpd/mod_jk). This is
described in the <a href="#web-service-integration" title="Web Service Integration">Web Service Integration</a> section of this document.</p>
<p>Note also, that Standalone or Forwarding Stroom Proxy deployments do <strong>NOT</strong> need a database client deployed.</p>
<h3 id="entropy-issues-in-virtual-environments">Entropy Issues in Virtual environments</h3>
<p>Both the Stroom Application and Stroom Proxy currently run on Tomcat (Version 7) which relies on the Java SecureRandom class to provide
random values for any generated session identifiers as well as other components. In some circumstances the Java runtime can be delayed if the entropy source that is
used to initialise SecureRandom is short of entropy. The delay is caused by the Java runtime waiting on the blocking entropy souce
/dev/random to have sufficient entropy. This quite often occurs in virtual environments were there are few sources that can contribute to
a system&rsquo;s entropy.</p>
<p>To view the current available entropy on a Linux system, run the command</p>
<pre><code class="language-bash">cat /proc/sys/kernel/random/entropy_avail
</code></pre>
<p>A reasonable value would be over 2000 and a poor value would be below a few hundred.</p>
<p>If you are deploying Stroom onto systems with low available entropy, the start time for the Stroom Proxy can be as high as 5 minutes and for
the Application as high as 15 minutes.</p>
<p>One software based solution would be to install the 






  

<span class="external-link">
  <a href="http://www.issihosts.com/haveged" target="_blank" class="" style="" title="haveged (external link)">
    <span>haveged</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 service that attempts to provide an easy-to-use, unpredictable random number generator based upon an adaptation of the HAVEGE algorithm.
To install execute</p>
<pre><code class="language-bash">yum -y install haveged
systemctl enable haveged
systemctl start haveged
</code></pre>
<p>For background reading in this matter, see 






  

<span class="external-link">
  <a href="https://www.digitalocean.com/community/tutorials/how-to-setup-additional-entropy-for-cloud-servers-using-haveged" target="_blank" class="" style="" title="this reference (external link)">
    <span>this reference</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 or 






  

<span class="external-link">
  <a href="https://cwiki.apache.org/confluence/display/TOMCAT/HowTo&#43;FasterStartUp" target="_blank" class="" style="" title="this reference (external link)">
    <span>this reference</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<h2 id="storage-scenario">Storage Scenario</h2>
<p>For the purpose of this Installation HOWTO, the following sets up the storage hierarchy for a two node processing
cluster. To share our <strong>permanent data</strong> we will use NFS. Accept that the NFS deployment described here is very simple, and
in a production deployment, a <em>lot</em> more security controls should be used. Further,</p>
<p>Our hierarchy is</p>
<ul>
<li>Node: <code>stroomp00.strmdev00.org</code></li>
<li><code>/stroomdata/stroom-data-p00</code>	- location to store Stroom application data files (events, etc.) for this node</li>
<li><code>/stroomdata/stroom-index-p00</code>	- location to store Stroom application index files</li>
<li><code>/stroomdata/stroom-working-p00</code>	- location to store Stroom application working files (e.g. temporary files, output, etc.) for this node</li>
<li><code>/stroomdata/stroom-working-p00/proxy</code>	- location for Stroom proxy to store inbound data files</li>
<li>Node: <code>stroomp01.strmdev00.org</code></li>
<li><code>/stroomdata/stroom-data-p01</code>	- location to store Stroom application data files (events, etc.) for this node</li>
<li><code>/stroomdata/stroom-index-p01</code>	- location to store Stroom application index files</li>
<li><code>/stroomdata/stroom-working-p01</code>	- location to store Stroom application working files (e.g. temporary files, output, etc.) for this node</li>
<li><code>/stroomdata/stroom-working-p01/proxy</code>	- location for Stroom proxy to store inbound data files</li>
</ul>
<h4 id="creation-of-storage-hierarchy">Creation of Storage Hierarchy</h4>
<p>So, we first create processing user on all nodes as per</p>
<pre><code class="language-bash">sudo useradd --system stroomuser
</code></pre>
<p>And the relevant commands to create the above hierarchy would be</p>
<ul>
<li>Node: <code>stroomp00.strmdev00.org</code></li>
</ul>
<pre><code class="language-bash">sudo mkdir -p /stroomdata/stroom-data-p00 /stroomdata/stroom-index-p00 /stroomdata/stroom-working-p00 /stroomdata/stroom-working-p00/proxy
sudo mkdir -p /stroomdata/stroom-data-p01  # So that this node can mount stroomp01's data directory
sudo chown -R stroomuser:stroomuser /stroomdata
sudo chmod -R 750 /stroomdata
</code></pre>
<ul>
<li>Node: <code>stroomp01.strmdev00.org</code></li>
</ul>
<pre><code class="language-bash">sudo mkdir -p /stroomdata/stroom-data-p01 /stroomdata/stroom-index-p01 /stroomdata/stroom-working-p01 /stroomdata/stroom-working-p01/proxy
sudo mkdir -p /stroomdata/stroom-data-p00  # So that this node can mount stroomp00's data directory
sudo chown -R stroomuser:stroomuser /stroomdata
sudo chmod -R 750 /stroomdata
</code></pre>
<h4 id="deployment-of-nfs-to-share-stroom-storage">Deployment of NFS to share Stroom Storage</h4>
<p>We will use NFS to cross mount the <em>permanent data</em> directories. That is</p>
<ul>
<li>node <code>stroomp00.strmdev00.org</code> will mount <code>stroomp01.strmdev00.org:/stroomdata/stroom-data-p01</code> and,</li>
<li>node <code>stroomp01.strmdev00.org</code> will mount <code>stroomp00.strmdev00.org:/stroomdata/stroom-data-p00</code>.</li>
</ul>
<p>The HOWTO guide to deploy and configure NFS for our Scenario is <a href="../../../docs/howtos/install/installnfshowto/">here</a></p>
<h2 id="stroom-installation">Stroom Installation</h2>
<h3 id="pre-installation-setup">Pre-installation setup</h3>
<p>Before installing either the Stroom Proxy or Stroom Application, we need establish various files and scripts within
the Stroom Processing user&rsquo;s home directory to support the Stroom services and their persistence. This is setup is described
<a href="../../../docs/howtos/install/installprocessingusersetuphowto/">here</a>.</p>
<h3 id="stroom-proxy-installation">Stroom Proxy Installation</h3>
<p>Instructions for installation of the Stroom Proxy can be found <a href="../../../docs/howtos/install/installproxyhowto/">here</a>.</p>
<h3 id="stroom-application-installation">Stroom Application Installation</h3>
<p>Instructions for installation of the Stroom application can be found <a href="../../../docs/howtos/install/installapplicationhowto/">here</a>.</p>
<h2 id="web-service-integration">Web Service Integration</h2>
<p>One typically &lsquo;fronts&rsquo; either a Stroom Proxy or Stroom Application with a secure web service such as Apache&rsquo;s Httpd or NGINX.
In our scenario, we will use SSL to secure the web service and further, we will use Apache&rsquo;s Httpd.</p>
<p>We first need to create certificates for use by the web service. The <a href="../../../docs/howtos/install/installcertificateshowto/">following</a>
provides instructions for this. The created certificates can then be used when configuration the web service.</p>
<p>This HOWTO is designed to deploy Apache&rsquo;s httpd web service as a front end (https) (to the user) and
Apache&rsquo;s mod_jk as the interface between Apache and the Stroom tomcat applications. The instructions
to configure this can be found <a href="../../../docs/howtos/install/installhttpdhowto/">here</a>.</p>
<p>Other Web service capability can be used, for example, 






  

<span class="external-link">
  <a href="https://nginx.org" target="_blank" class="" style="" title="NGINX (external link)">
    <span>NGINX</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<h2 id="installation-validation">Installation Validation</h2>
<p>We will now check that the installation and web services integration has worked.</p>
<h3 id="sanity-firewall-check">Sanity firewall check</h3>
<p>To ensure you have the firewall correctly set up, the following command</p>
<pre><code class="language-bash">sudo firewall-cmd --reload
sudo firewall-cmd --zone=public --list-all
</code></pre>
<p>should result in</p>
<pre><code class="language-text">public (active)
  target: default
  icmp-block-inversion: no
  interfaces: enp0s3
  sources: 
  services: dhcpv6-client http https nfs ssh
  ports: 8009/tcp 9080/tcp 8080/tcp 9009/tcp
  protocols: 
  masquerade: no
  forward-ports: 
  sourceports: 
  icmp-blocks: 
  rich rules: 
</code></pre>
<h3 id="test-posting-of-data-to-the-stroom-service">Test Posting of data to the Stroom service</h3>
<p>You can test the data posting service with the command</p>
<pre><code class="language-bash">curl -k --data-binary @/etc/group &quot;https://stroomp.strmdev00.org/stroom/datafeed&quot; -H &quot;Feed:TEST-FEED-V1_0&quot; -H &quot;System:EXAMPLE_SYSTEM&quot; -H &quot;Environment:EXAMPLE_ENVIRONMENT&quot;
</code></pre>
<p>which <strong>WILL</strong> result in an error as we have not configured the Stroom Application as yet. The error should look like</p>
<pre><code class="language-html">&lt;html&gt;&lt;head&gt;&lt;title&gt;Apache Tomcat/7.0.53 - Error report&lt;/title&gt;&lt;style&gt;&lt;!--H1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} H2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} H3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} BODY {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} B {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} P {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}A {color : black;}A.name {color : black;}HR {color : #525D76;}--&gt;&lt;/style&gt; &lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 406 - Stroom Status 110 - Feed is not set to receive data - &lt;/h1&gt;&lt;HR size=&quot;1&quot; noshade=&quot;noshade&quot;&gt;&lt;p&gt;&lt;b&gt;type&lt;/b&gt; Status report&lt;/p&gt;&lt;p&gt;&lt;b&gt;message&lt;/b&gt; &lt;u&gt;Stroom Status 110 - Feed is not set to receive data - &lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;description&lt;/b&gt; &lt;u&gt;The resource identified by this request is only capable of generating responses with characteristics not acceptable according to the request &quot;accept&quot; headers.&lt;/u&gt;&lt;/p&gt;&lt;HR size=&quot;1&quot; noshade=&quot;noshade&quot;&gt;&lt;h3&gt;Apache Tomcat/7.0.53&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;
</code></pre>
<p>If you view the Stroom proxy log, <code>~/stroom-proxy/instance/logs/stroom.log</code>, on both processing nodes, you will see on one node,
the <em>datafeed.DataFeedRequestHandler</em> events running under, in this case, the <em>ajp-apr-9009-exec-1</em> thread indicating the failure</p>
<pre><code class="language-text">...
2017-01-03T03:35:47.366Z WARN  [ajp-apr-9009-exec-1] datafeed.DataFeedRequestHandler (DataFeedRequestHandler.java:131) - &quot;handleException()&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Expect=100-continue&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=39960cf9-e50b-4ae8-a5f2-449ee670d2eb&quot;,&quot;ReceivedTime=2017-01-03T03:35:46.915Z&quot;,&quot;RemoteAddress=192.168.2.220&quot;,&quot;RemoteHost=192.168.2.220&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=1051&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomp.strmdev00.org&quot;,&quot;user-agent=curl/7.19.7 (x86_64-redhat-linux-gnu) libcurl/7.19.7 NSS/3.21 Basic ECC zlib/1.2.3 libidn/1.18 libssh2/1.4.2&quot;,&quot;Stroom Status 110 - Feed is not set to receive data&quot;
2017-01-03T03:35:47.367Z ERROR [ajp-apr-9009-exec-1] zip.StroomStreamException (StroomStreamException.java:131) - sendErrorResponse() - 406 Stroom Status 110 - Feed is not set to receive data - 
2017-01-03T03:35:47.368Z INFO  [ajp-apr-9009-exec-1] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 478 ms to process (concurrentRequestCount=1) 406&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Expect=100-continue&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=39960cf9-e50b-4ae8-a5f2-449ee670d2eb&quot;,&quot;ReceivedTime=2017-01-03T03:35:46.915Z&quot;,&quot;RemoteAddress=192.168.2.220&quot;,&quot;RemoteHost=192.168.2.220&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=1051&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomp.strmdev00.org&quot;,&quot;user-agent=curl/7.19.7 (x86_64-redhat-linux-gnu) libcurl/7.19.7 NSS/3.21 Basic ECC zlib/1.2.3 libidn/1.18 libssh2/1.4.2&quot;
...
</code></pre>
<p>Further, if you execute the data posting command (<code>curl</code>) multiple times, you will see the loadbalancer working in that,
the above WARN/ERROR/INFO logs will swap between the proxy services (i.e. first error will be in stroomp00.strmdev00.org&rsquo;s
proxy log file, then second on stroomp01.strmdev00.org&rsquo;s proxy log file, then back to stroomp00.strmdev00.org and so on).</p>
<h2 id="stroom-application-configuration">Stroom Application Configuration</h2>
<p>Although we have installed our multi node Stroom cluster, we now need to configure it.
We do this via the user interface (UI).</p>
<h3 id="logging-into-the-stroom-ui-for-the-first-time">Logging into the Stroom UI for the first time</h3>
<p>To log into the UI of your newly installed Stroom instance, present the base URL to your







  

<span class="external-link">
  <a href="https://www.google.com/chrome" target="_blank" class="" style="" title="Chrome (external link)">
    <span>Chrome</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 browser. In this deployment, you should enter the URLS
<code>http://stroomp.strmdev00.org</code>, or <code>https://stroomp.strmdev00.org</code> or <code>https://stroomp.strmdev00.org/stroom</code>, noting the first URLs
should automatically direct you to the last URL.</p>
<p>If you have personal certificates loaded in your Chrome browser, you may be asked which certificate to use to authenticate yourself
to <code>stroomp.strmdev00.org:443</code>. As Stroom has not been configured to use user certificates, the choice is not relevant, just choose one
and continue.</p>
<p>Additionally, if you are using  self-signed certificates, your browser will generate an alert as per







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Chrome-NoCa-00.png" href="../../../images/HOWTOs/UI-Chrome-NoCa-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Chrome-NoCa-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Chrome-NoCa-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Self Signed Certificate Initial Warning</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
<p>To proceed you need to select the <strong>ADVANCED</strong> hyperlink to see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Chrome-NoCa-01.png" href="../../../images/HOWTOs/UI-Chrome-NoCa-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Chrome-NoCa-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Chrome-NoCa-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Self Signed Certificate Advanced Warning</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If you select the <strong>Proceed to stroomp.strmdev00.org (unsafe)</strong> hyper-link you will be presented with the standard Stroom UI login page.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-Login-00.png" href="../../../images/HOWTOs/UI-Login-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-Login-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-Login-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Login Page</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This page has two panels - <strong>About Stroom</strong> and <strong>Login</strong>.</p>
<p>In the <strong>About Stroom</strong> panel we see an introductory description of Stroom in the top left and deployment details in the bottom left of the panel. The deployment details provide</p>
<ul>
<li><code>Build Version:</code> - the build version of the Stroom application deployed</li>
<li><code>Build Date:</code> - the date the version was built</li>
<li><code>Up Date:</code> - the install date</li>
<li><code>Node Name:</code> - the node within the Stroom cluster you have connected to</li>
</ul>
<h3 id="login-with-stroom-default-administrative-user">Login with Stroom default Administrative User</h3>
<p>Each new Stroom deployment automatically creates the administrative user <code>admin</code> and this user&rsquo;s password is initially set to <code>admin</code>.
We will
<a href="../../../docs/howtos/authentication/userloginhowto/">login as this user</a>
which also validates that the database and UI is working correctly in that you can login and the password is <code>admin</code>.</p>
<h3 id="create-an-attributed-user-to-perform-configuration">Create an Attributed User to perform configuration</h3>
<p>We should configure Stroom using an <em>attributed user</em> account.
That is, we should
<a href="../../../docs/howtos/authentication/createuserhowto/">create</a>
a user, in our case it will be <code>burn</code> (the author) and once created, we login with that account then perform the initial configuration activities.
You don&rsquo;t have to do this, but it is sound security practice.</p>
<p>Once you have created the user you should
<a href="../../../docs/howtos/authentication/userlogouthowto/">log out</a>
of the <code>admin</code> account and log back in as our user <code>burn</code>.</p>
<h3 id="configure-the-volumes-for-our-stroom-deployment">Configure the Volumes for our Stroom deployment</h3>
<p>Before we can store data within Stroom we need to configure the
<a href="../../../docs/user-guide/volumes/">volumes</a>
we have allocated in our Storage hierarchy. The
<a href="../../../docs/howtos/install/installvolumeshowto/">Volume Maintenance HOWTO</a>
shows how to do this.</p>
<h3 id="configure-the-nodes-for-our-stroom-deployment">Configure the Nodes for our Stroom deployment</h3>
<p>In a Stroom cluster, nodes are expected to communicate with each other on port 8080 over http. Our
installation in a multi node environment ensures the firewall will allow this but we also need to
configure the nodes. This is achieved via the Stroom UI where we set a Cluster URL for each node.
The following <a href="../../../docs/howtos/install/installnodeshowto/">Node Configuration HOWTO</a> demonstrates how do
set the Cluster URL.</p>
<h3 id="data-stream-processing">Data Stream Processing</h3>
<p>To enable Stroom to process data, it&rsquo;s
<a href="../../../docs/user-guide/jobs/#data-processor">Data Processors</a>
need to be enabled. There are NOT enabled by default on installation. The following
<a href="../../../docs/howtos/general/taskshowto/#enable-stream-processors">section</a>
in our <a href="../../../docs/howtos/general/taskshowto/">Stroom Tasks HowTo</a> shows how to do this.</p>
<h2 id="testing-our-stroom-application-and-proxy-installation">Testing our Stroom Application and Proxy Installation</h2>
<p>To complete the installation process we will test that we can send and ingest data.</p>
<h3 id="add-a-test-feed">Add a Test Feed</h3>
<p>In order for Stroom to be able to handle various data sources, be they Apache HTTPD web access logs,
MicroSoft Windows Event logs or Squid Proxy logs, Stroom must be told what the data is when it is received.
This is achieved using
<a href="../../../docs/user-guide/feeds/">Event Feeds</a>.
Each feed has a unique name within the system.</p>
<p>To test our installation can accept and ingest data, we will
<a href="../../../docs/howtos/general/feedmanagementhowto/#creation-of-an-event-feed">create a test Event feed</a>. The &rsquo;name&rsquo; of the feed will be
<code>TEST-FEED-V1_0</code>. Note that in a production environment is is best that a well defined nomenclature is used for feed &rsquo;names&rsquo;. For our
testing purposes <code>TEST-FEED-V1_0</code> is sufficient.</p>
<h3 id="sending-test-data">Sending Test Data</h3>
<p><strong>NOTE:</strong> Before testing our new feed, we should restart both our Stroom application services so that any volume changes are
propagated. This can be achieved by simply running</p>
<pre><code class="language-bash">sudo -i -u stroomuser
bin/StopServices.sh
bin/StartServices.sh
</code></pre>
<p>on both nodes. It is suggested you first log out of Stroom, if you are currently logged in and you should monitor the Stroom
application logs to ensure it has successfully restarted. Remember to use the <code>T</code> and <code>Tp</code> bash aliases we set up.</p>
<p>For this test, we will send the contents of /etc/group to our test feed. We will also send the file from the cluster&rsquo;s database
machine. The command to send this file is</p>
<pre><code class="language-bash">curl -k --data-binary @/etc/group &quot;https://stroomp.strmdev00.org/stroom/datafeed&quot; -H &quot;Feed:TEST-FEED-V1_0&quot; -H &quot;System:EXAMPLE_SYSTEM&quot; -H &quot;Environment:EXAMPLE_ENVIRONMENT&quot;
</code></pre>
<p>We will test a number of features as part of our installation test. These are</p>
<ul>
<li>simple post of data</li>
<li>simple post of data to validate load balancing is working</li>
<li>simple post to <em>direct</em> feed interface</li>
<li>simple post to <em>direct</em> feed interface to validate load balancing is working</li>
<li>identify that the Stroom <em>Proxy Aggregation</em> is working correctly</li>
</ul>
<p>As part of our testing will check the presence of the inbound data, as files, within the proxy storage area.
Now as the proxy storage area is also the location from which the Stroom application
automatically aggregates then ingests the data stored by the proxy, we can either turn off the
<a href="../../../docs/user-guide/jobs/#proxy-aggregation">Proxy Aggregation</a> task,
or attempt to
perform our tests noting that proxy aggregation occurs every 10 minutes by default. For simplicity, we will
<a href="../../../docs/howtos/general/taskshowto/#turn-off-proxy-aggregation">turn off the <code>Proxy Aggregation</code> task</a>.</p>
<p>We can now perform out tests. Follow the steps in the <a href="../../../docs/howtos/install/installtestinghowto/#data-post-tests">Data Posting Tests</a> section
of the <a href="../../../docs/howtos/install/installtestinghowto/">Testing Stroom Installation HOWTO</a></p>
<h2 id="forwarding-stroom-proxy-deployment">Forwarding Stroom Proxy Deployment</h2>
<p>In this deployment will install a Stroom <strong>Forwarding Proxy</strong> which is designed to aggregate data posted to it for managed forwarding to
a central Stroom processing system. This scenario is assuming we are installing on the fully patch Centos 7.3 host, <code>stroomfp0.strmdev00.org</code>.
Further it assumes we have installed, configured and tested the destination Stroom system we will be forwarding to.</p>
<p>We will first deploy the Stroom Proxy then configure it as a <strong>Forwarding Proxy</strong> then integrate a web service to run &lsquo;in-front&rsquo; of
Proxy.</p>
<h2 id="prerequisite-software-installation-for-forwarding-proxy">Prerequisite Software Installation for Forwarding Proxy</h2>
<p>Certain software packages are required for the Stroom Proxy to run.</p>
<p>The core software list is</p>
<ul>
<li>java-1.8.0-openjdk</li>
<li>java-1.8.0-openjdk-devel</li>
<li>policycoreutils-python</li>
<li>unzip</li>
<li>zip</li>
</ul>
<p>Most of the required software are packages available via standard repositories and hence we can simply execute</p>
<pre><code class="language-bash">sudo yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel policycoreutils-python unzip zip
</code></pre>
<p>Note that additional software will be required for other integration components (e.g. Apache httpd/mod_jk). This is
described in the
<a href="#web-service-integration-for-forwarding-proxy" title="Web Service Integration - Forwarding proxy">Web Service Integration for Forwarding Proxy</a>
section of this document.</p>
<h2 id="forwarding-proxy-storage">Forwarding Proxy Storage</h2>
<p>Since we are a proxy that stores data sent to it and forwards it each minute we have only one directory.</p>
<ul>
<li><code>/stroomdata/stroom-working-fp0/proxy</code>    - location for Stroom proxy to store inbound data files prior to forwarding</li>
</ul>
<p>You will note that these HOWTOs use a consistent storage nomenclature for simplicity of documentations.</p>
<h3 id="creation-of-storage-for-forwarding-proxy">Creation of Storage for Forwarding Proxy</h3>
<p>We create the processing user, as per</p>
<pre><code class="language-bash">sudo useradd --system stroomuser
</code></pre>
<p>then create the storage hierarchy with the commands</p>
<pre><code class="language-bash">sudo mkdir -p /stroomdata/stroom-working-fp0/proxy
sudo chown -R stroomuser:stroomuser /stroomdata
sudo chmod -R 750 /stroomdata
</code></pre>
<h2 id="stroom-forwarding-proxy-installation">Stroom Forwarding Proxy Installation</h2>
<h3 id="pre-installation-setup-1">Pre-installation setup</h3>
<p>Before installing the Stroom Forwarding Proxy, we need establish various files and scripts within
the Stroom Processing user&rsquo;s home directory to support the Stroom services and their persistence. This is setup is described
<a href="../../../docs/howtos/install/installprocessingusersetuphowto/">here</a>. Although this setup HOWTO is orientated towards a complete Stroom Proxy
and Application installation, it does provide all the processing user setup requirements for a Stroom Proxy as well.</p>
<h3 id="stroom-forwarding-proxy-installation-1">Stroom Forwarding Proxy Installation</h3>
<p>Instructions for installation of the Stroom Proxy can be found <a href="../../../docs/howtos/install/installproxyhowto/">here</a>, noting you
should follow the steps for configuring the proxy as a <em>Forwarding</em> proxy.</p>
<h2 id="web-service-integration-for-forwarding-proxy">Web Service Integration for Forwarding Proxy</h2>
<p>One typically &lsquo;fronts&rsquo; a Stroom Proxy with a secure web service such as Apache&rsquo;s Httpd or NGINX.
In our scenario, we will use SSL to secure the web service and further, we will use Apache&rsquo;s Httpd.</p>
<p>We first need to create certificates for use by the web service. The
<a href="../../../docs/howtos/install/installcertificateshowto/">SSL Certificate Generation HOWTO</a> provides instructions for this.
The created certificates can then be used when configuration the web service. NOTE also, that for a forwarding
proxy we will need to establish Key and Trust stores as well. This is also documented in the SSL Certificate Generation HOWTO
<a href="../../../docs/howtos/install/installcertificateshowto/#stroom-proxy-to-proxy-key-and-trust-stores">here</a></p>
<p>This HOWTO is designed to deploy Apache&rsquo;s httpd web service as a front end (https) (to the user) and
Apache&rsquo;s mod_jk as the interface between Apache and the Stroom tomcat applications. The instructions
to configure this can be found <a href="../../../docs/howtos/install/installhttpdhowto/">here</a>. Please take note of where a Stroom Proxy
configuration item is different to that of a Stroom Application processing node.</p>
<p>Other Web service capability can be used, for example, 






  

<span class="external-link">
  <a href="https://nginx.org" target="_blank" class="" style="" title="NGINX (external link)">
    <span>NGINX</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<h2 id="testing-our-forwarding-proxy-installation">Testing our Forwarding Proxy Installation</h2>
<p>To complete the installation process we will test that we can send data to the forwarding proxy and that it forwards the files
it receives to the central Stroom processing system. As stated earlier, it is assumed we have installed, configured and tested the destination
central Stroom processing system and thus we will have a test <a href="../../../docs/user-guide/feeds/">Feed</a>
already established - <code>TEST-FEED-V1_0</code>.</p>
<h3 id="sending-test-data-1">Sending Test Data</h3>
<p>For this test, we will send the contents of /etc/group to our test feed - <code>TEST-FEED-V1_0</code>. It doesn&rsquo;t matter from which host we send the file from.
The command to send file is</p>
<pre><code class="language-bash">curl -k --data-binary @/etc/group &quot;https://stroomfp0.strmdev00.org/stroom/datafeed&quot; -H &quot;Feed:TEST-FEED-V1_0&quot; -H &quot;System:EXAMPLE_SYSTEM&quot; -H &quot;Environment:EXAMPLE_ENVIRONMENT&quot;
</code></pre>
<p>Before testing, it is recommended you set up to monitor the Stroom proxy logs on the central server as well as on the Forwarding Proxy server.</p>
<p>Follow the steps in the <a href="../../../docs/howtos/install/installtestinghowto/#stroom-forwarding-proxy-testing">Forwarding Proxy Data Posting Tests</a> section
of the <a href="../../../docs/howtos/install/installtestinghowto/">Testing Stroom Installation HOWTO</a></p>
<h2 id="standalone-stroom-proxy-deployment">Standalone Stroom Proxy Deployment</h2>
<p>In this deployment will install a Stroom <strong>Standalone Proxy</strong> which is designed to accept and store data posted to it for <strong>manual</strong> forwarding to
a central Stroom processing system. This scenario is assuming we are installing on the fully patch Centos 7.3 host, <code>stroomsap0.strmdev00.org</code>.</p>
<p>We will first deploy the Stroom Proxy then configure it as a <strong>Standalone Proxy</strong> then integrate a web service to run &lsquo;in-front&rsquo; of
Proxy.</p>
<h2 id="prerequisite-software-installation-for-forwarding-proxy-1">Prerequisite Software Installation for Forwarding Proxy</h2>
<p>Certain software packages are required for the Stroom Proxy to run.</p>
<p>The core software list is</p>
<ul>
<li>java-1.8.0-openjdk</li>
<li>java-1.8.0-openjdk-devel</li>
<li>policycoreutils-python</li>
<li>unzip</li>
<li>zip</li>
</ul>
<p>Most of the required software are packages available via standard repositories and hence we can simply execute</p>
<pre><code class="language-bash">sudo yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel policycoreutils-python unzip zip
</code></pre>
<p>Note that additional software will be required for other integration components (e.g. Apache httpd/mod_jk). This is
described in the
<a href="#web-service-integration-for-standalone-proxy" title="Web Service Integration - Standalone proxy">Web Service Integration for Standalone Proxy</a>
section of this document.</p>
<h2 id="standalone-proxy-storage">Standalone Proxy Storage</h2>
<p>Since we are a proxy that stores data sent to it we have only one directory.</p>
<ul>
<li><code>/stroomdata/stroom-working-sap0/proxy</code>    - location for Stroom proxy to store inbound data files</li>
</ul>
<p>You will note that these HOWTOs use a consistent storage nomenclature for simplicity of documentations.</p>
<h3 id="creation-of-storage-for-standalone-proxy">Creation of Storage for Standalone Proxy</h3>
<p>We create the processing user, as per</p>
<pre><code class="language-bash">sudo useradd --system stroomuser
</code></pre>
<p>then create the storage hierarchy with the commands</p>
<pre><code class="language-bash">sudo mkdir -p /stroomdata/stroom-working-sap0/proxy
sudo chown -R stroomuser:stroomuser /stroomdata
sudo chmod -R 750 /stroomdata
</code></pre>
<h2 id="stroom-standalone-proxy-installation">Stroom Standalone Proxy Installation</h2>
<h3 id="pre-installation-setup-2">Pre-installation setup</h3>
<p>Before installing the Stroom Standalone Proxy, we need establish various files and scripts within
the Stroom Processing user&rsquo;s home directory to support the Stroom services and their persistence. This is setup is described
<a href="../../../docs/howtos/install/installprocessingusersetuphowto/">here</a>. Although this setup HOWTO is orientated towards a complete Stroom Proxy
and Application installation, it does provide all the processing user setup requirements for a Stroom Proxy as well.</p>
<h3 id="stroom-standalone-proxy-installation-1">Stroom Standalone Proxy Installation</h3>
<p>Instructions for installation of the Stroom Proxy can be found <a href="../../../docs/howtos/install/installproxyhowto/">here</a>, noting you
should follow the steps for configuring the proxy as a  <em>Store_NoDB</em> proxy.</p>
<h2 id="web-service-integration-for-standalone-proxy">Web Service Integration for Standalone Proxy</h2>
<p>One typically &lsquo;fronts&rsquo; a Stroom Proxy with a secure web service such as Apache&rsquo;s Httpd or NGINX.
In our scenario, we will use SSL to secure the web service and further, we will use Apache&rsquo;s Httpd.</p>
<p>We first need to create certificates for use by the web service. The
<a href="../../../docs/howtos/install/installcertificateshowto/">SSL Certificate Generation HOWTO</a> provides instructions for this.
The created certificates can then be used when configuration the web service. There is no need for Trust or Key stores.</p>
<p>This HOWTO is designed to deploy Apache&rsquo;s httpd web service as a front end (https) (to the user) and
Apache&rsquo;s mod_jk as the interface between Apache and the Stroom tomcat applications. The instructions
to configure this can be found <a href="../../../docs/howtos/install/installhttpdhowto/">here</a>. Please take note of where a Stroom Proxy
configuration item is different to that of a Stroom Application processing node.</p>
<p>Other Web service capability can be used, for example, 






  

<span class="external-link">
  <a href="https://nginx.org" target="_blank" class="" style="" title="NGINX (external link)">
    <span>NGINX</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<h2 id="testing-our-standalone-proxy-installation">Testing our Standalone Proxy Installation</h2>
<p>To complete the installation process we will test that we can send data to the standalone proxy and it stores it.</p>
<h3 id="sending-test-data-2">Sending Test Data</h3>
<p>For this test, we will send the contents of /etc/group to our test feed - <code>TEST-FEED-V1_0</code>. It doesn&rsquo;t matter from which host we send the file from.
The command to send file is</p>
<pre><code class="language-bash">curl -k --data-binary @/etc/group &quot;https://stroomsap0.strmdev00.org/stroom/datafeed&quot; -H &quot;Feed:TEST-FEED-V1_0&quot; -H &quot;System:EXAMPLE_SYSTEM&quot; -H &quot;Environment:EXAMPLE_ENVIRONMENT&quot;
</code></pre>
<p>Before testing, it is recommended you set up to monitor the Standalone Proxy logs.</p>
<p>Follow the steps in the <a href="../../../docs/howtos/install/installtestinghowto/#stroom-standalone-proxy-testing">Standalone Proxy Data Posting Tests</a>
section of the <a href="../../../docs/howtos/install/installtestinghowto/">Testing Stroom Installation HOWTO</a></p>
<h2 id="addition-of-a-node-to-a-stroom-cluster-deployment">Addition of a Node to a Stroom Cluster Deployment</h2>
<p>In this deployment we will deploy both the Stroom Proxy and Stroom Application software
to a new processing node we wish to add to our cluster. Once we have deploy and configured the Stroom software, we will then integrate a web
service to run &lsquo;in-front&rsquo; of our Stroom software, and then perform the initial configuration of to add this node via the user interface. The
node we will add is <code>stroomp02.strmdev00.org</code>.</p>
<h2 id="grant-access-to-the-database-for-this-node">Grant access to the database for this node</h2>
<p>Connect to the Stroom database as the administrative (root) user, via the command</p>
<pre><code class="language-bash">sudo mysql --user=root -p
</code></pre>
<p>and at the <code>MariaDB [(none)]&gt;</code> or <code>mysql&gt; </code> prompt enter</p>
<pre><code class="language-bash">grant all privileges on stroom.* to stroomuser@stroomp02.strmdev00.org identified by 'Stroompassword1@';
quit;
</code></pre>
<h2 id="prerequisite-software-installation-1">Prerequisite Software Installation</h2>
<p>Certain software packages are required for either the Stroom Proxy or Stroom Application to run.</p>
<p>The core software list is</p>
<ul>
<li>java-1.8.0-openjdk</li>
<li>java-1.8.0-openjdk-devel</li>
<li>policycoreutils-python</li>
<li>unzip</li>
<li>zip</li>
<li>mariadb or mysql client</li>
</ul>
<p>Most of the required software are packages available via standard repositories and hence we can simply execute</p>
<pre><code class="language-bash">sudo yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel policycoreutils-python unzip zip
sudo yum -y install mariadb
</code></pre>
<p>In the above instance, the database client choice is MariaDB as it is directly supported by Centos 7. One could deploy the MySQL
database software as the alternative. If you have chosen a different database for the already deployed Stroom Cluster then you
should use that one. See <a href="#mysqlclientinstall">earlier</a> in this document on how to install the MySQL Community client.</p>
<p>Note that additional software will be required for other integration components (e.g. Apache httpd/mod_jk). This is
described in the <a href="#web-service-integration" title="Web Service Integration">Web Service Integration</a> section of this document.</p>
<h3 id="storage-scenario-1">Storage Scenario</h3>
<p>To maintain our Storage Scenario them, the scenario for this node is</p>
<ul>
<li>Node: <code>stroomp02.strmdev00.org</code></li>
<li><code>/stroomdata/stroom-data-p02</code>        - location to store Stroom application data files (events, etc.) for this node</li>
<li><code>/stroomdata/stroom-index-p02</code>       - location to store Stroom application index files</li>
<li><code>/stroomdata/stroom-working-p02</code>     - location to store Stroom application working files (e.g. tmp, output, etc.) for this node</li>
<li><code>/stroomdata/stroom-working-p02/proxy</code>       - location for Stroom proxy to store inbound data files</li>
</ul>
<h4 id="creation-of-storage-hierarchy-1">Creation of Storage Hierarchy</h4>
<p>So, we first create processing user on our new node as per</p>
<pre><code class="language-bash">sudo useradd --system stroomuser
</code></pre>
<p>then create the storage via</p>
<pre><code class="language-bash">sudo mkdir -p /stroomdata/stroom-data-p02 /stroomdata/stroom-index-p02 /stroomdata/stroom-working-p02 /stroomdata/stroom-working-p02/proxy
sudo mkdir -p /stroomdata/stroom-data-p00  # So that this node can mount stroomp00's data directory
sudo mkdir -p /stroomdata/stroom-data-p01  # So that this node can mount stroomp01's data directory
sudo chown -R stroomuser:stroomuser /stroomdata
sudo chmod -R 750 /stroomdata
</code></pre>
<p>As we need to share this new nodes <strong>permanent data</strong> directories to the existing nodes in the Cluster, we need to
create mount point directories on our existing nodes in addition to deploying NFS.</p>
<p>So we execute on</p>
<ul>
<li>Node: <code>stroomp00.strmdev00.org</code></li>
</ul>
<pre><code class="language-bash">sudo mkdir -p /stroomdata/stroom-data-p02
sudo chmod 750 /stroomdata/stroom-data-p02
sudo chown stroomuser:stroomuser /stroomdata/stroom-data-p02
</code></pre>
<p>and on</p>
<ul>
<li>Node: <code>stroomp01.strmdev00.org</code></li>
</ul>
<pre><code class="language-bash">sudo mkdir -p /stroomdata/stroom-data-p02
sudo chmod 750 /stroomdata/stroom-data-p02
sudo chown stroomuser:stroomuser /stroomdata/stroom-data-p02
</code></pre>
<h4 id="deployment-of-nfs-to-share-stroom-storage-1">Deployment of NFS to share Stroom Storage</h4>
<p>We will use NFS to cross mount the <em>permanent data</em> directories. That is</p>
<ul>
<li>node <code>stroomp00.strmdev00.org</code> will mount
<ul>
<li><code>stroomp01.strmdev00.org:/stroomdata/stroom-data-p01</code> and,</li>
<li><code>stroomp02.strmdev00.org:/stroomdata/stroom-data-p02</code> and,</li>
</ul>
</li>
<li>node <code>stroomp01.strmdev00.org</code> will mount
<ul>
<li><code>stroomp00.strmdev00.org:/stroomdata/stroom-data-p00</code> and</li>
<li><code>stroomp02.strmdev00.org:/stroomdata/stroom-data-p02</code></li>
</ul>
</li>
<li>node <code>stroomp02.strmdev00.org</code> will mount
<ul>
<li><code>stroomp00.strmdev00.org:/stroomdata/stroom-data-p00</code> and</li>
<li><code>stroomp01.strmdev00.org:/stroomdata/stroom-data-p01</code></li>
</ul>
</li>
</ul>
<p>The HOWTO guide to deploy and configure NFS for our Scenario is <a href="../../../docs/howtos/install/installnfshowto/#addition-of-another-node">here</a>.</p>
<h2 id="stroom-installation-1">Stroom Installation</h2>
<h3 id="pre-installation-setup-3">Pre-installation setup</h3>
<p>Before installing either the Stroom Proxy or Stroom Application, we need establish various files and scripts within
the Stroom Processing user&rsquo;s home directory to support the Stroom services and their persistence. This is setup is described
<a href="../../../docs/howtos/install/installprocessingusersetuphowto/">here</a>. Note you should remember to set the <strong>N</strong> bash variable
when generating the Environment Variable files to <em>02</em>.</p>
<h3 id="stroom-proxy-installation-1">Stroom Proxy Installation</h3>
<p>Instructions for installation of the Stroom Proxy can be found <a href="../../../docs/howtos/install/installproxyhowto/">here</a>. Note you
will be deploying a <em>Store</em> proxy and during the setup execution ensure you enter the appropriate values for NODE (&lsquo;stroomp02&rsquo;)
and REPO_DIR (&rsquo;/stroomdata/stroom-working-p02/proxy&rsquo;). All other values will be the same.</p>
<h3 id="stroom-application-installation-1">Stroom Application Installation</h3>
<p>Instructions for installation of the Stroom application can be found <a href="../../../docs/howtos/install/installapplicationhowto/">here</a>.
When executing the setup script ensure you enter the appropriate values for TEMP_DIR (&rsquo;/stroomdata/stroom-working-p02&rsquo;) and NODE (&lsquo;stroomp02&rsquo;).
All other values will be the same. Note also that you will not have to wait for the &lsquo;first&rsquo; node to initialise the Stroom database as
this would have already been done when you first deployed your Stroom Cluster.</p>
<h2 id="web-service-integration-1">Web Service Integration</h2>
<p>One typically &lsquo;fronts&rsquo; either a Stroom Proxy or Stroom Application with a secure web service such as Apache&rsquo;s Httpd or NGINX.
In our scenario, we will use SSL to secure the web service and further, we will use Apache&rsquo;s Httpd.</p>
<p>As we are a cluster, we use the same certificate as the other nodes. Thus we need to gain the certificate package from an existing node.</p>
<p>So, on <code>stroomp00.strmdev00.org</code>, we replicate the directory ~stroomuser/stroom-jks to our new node. That is, tar it up, copy the tar file to
stroomp02 and untar it. We can make use of the other node&rsquo;s mounted file system.</p>
<pre><code class="language-bash">sudo -i -u stroomuser
cd ~stroomuser
tar cf stroom-jks.tar stroom-jks
mv stroom-jks.tar /stroomdata/stroom-data-p02
</code></pre>
<p>then on our new node (<code>stroomp02.strmdev00.org</code>) we extract the data.</p>
<pre><code class="language-bash">sudo -i -u stroomuser
cd ~stroomuser
tar xf /stroomdata/stroom-data-p02/stroom-jks.tar &amp;&amp; rm -f /stroomdata/stroom-data-p02/stroom-jks.tar
</code></pre>
<p>Now ensure protection, ownership and SELinux context for these files by running</p>
<pre><code class="language-bash">chmod 700 ~stroomuser/stroom-jks/private ~stroomuser/stroom-jks
chown -R stroomuser:stroomuser ~stroomuser/stroom-jks
chcon -R --reference /etc/pki ~stroomuser/stroom-jks
</code></pre>
<p>This HOWTO is designed to deploy Apache&rsquo;s httpd web service as a front end (https) (to the user) and
Apache&rsquo;s mod_jk as the interface between Apache and the Stroom tomcat applications. The instructions
to configure this can be found <a href="../../../docs/howtos/install/installhttpdhowto/">here</a>.
You should pay particular attention to the section on the
<a href="../../../docs/howtos/install/installhttpdhowto/#apache-modjk-configuration">Apache Mod_JK configuration</a>
as you <strong>MUST</strong> regenerate the Mod_JK workers.properties file on the existing cluster nodes as well as generating it on our new node.</p>
<p>Other Web service capability can be used, for example, 






  

<span class="external-link">
  <a href="https://nginx.org" target="_blank" class="" style="" title="NGINX (external link)">
    <span>NGINX</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<p>Note that once you have integrated the web services for our new node, you will need to restart the Apache systemd process on the existing
two nodes that that the new Mod_JK configuration has taken place.</p>
<h2 id="installation-validation-1">Installation Validation</h2>
<p>We will now check that the installation and web services integration has worked. We do this with a simple firewall check
and <a href="#testing-our-new-node-installation" title="Integration Tests">later</a> perform complete integration tests.</p>
<h3 id="sanity-firewall-check-1">Sanity firewall check</h3>
<p>To ensure you have the firewall correctly set up, the following command</p>
<pre><code class="language-bash">sudo firewall-cmd --reload
sudo firewall-cmd --zone=public --list-all
</code></pre>
<p>should result in</p>
<pre><code class="language-text">public (active)
  target: default
  icmp-block-inversion: no
  interfaces: enp0s3
  sources: 
  services: dhcpv6-client http https nfs ssh
  ports: 8009/tcp 9080/tcp 8080/tcp 9009/tcp
  protocols: 
  masquerade: no
  forward-ports: 
  sourceports: 
  icmp-blocks: 
  rich rules: 
</code></pre>
<h2 id="stroom-application-configuration---new-node">Stroom Application Configuration - New Node</h2>
<p>We will need to configure this new node&rsquo;s <a href="../../../docs/user-guide/volumes/">volumes</a>, set it&rsquo;s Cluster URL and enable it&rsquo;s Stream Processors.
We do this by logging into the Stroom User Interface (UI) with an account with Administrator privileges. It
is recommended you use a attributed user for this activity. Once you have logged in you can configure this
new node.</p>
<h3 id="configure-the-volumes-for-our-stroom-deployment-1">Configure the Volumes for our Stroom deployment</h3>
<p>Before we can store data on this new Stroom node we need to configure it&rsquo;s
<a href="../../../docs/user-guide/volumes/">volumes</a>
we have allocated in our Storage hierarchy. The section on adding new <a href="../../../docs/user-guide/volumes/">volumes</a> in the
<a href="../../../docs/howtos/install/installvolumeshowto/#adding-new-volumes">Volume Maintenance HOWTO</a>
shows how to do this.</p>
<h3 id="configure-the-nodes-for-our-stroom-deployment-1">Configure the Nodes for our Stroom deployment</h3>
<p>In a Stroom cluster, nodes are expected to communicate with each other on port 8080 over http. Our
installation in a multi node environment ensures the firewall will allow this but we also need to
configure the new node. This is achieved via the Stroom UI where we set a Cluster URL for our node.
The section on Configuring a new node in the
<a href="../../../docs/howtos/install/installnodeshowto/#configure-new-node">Node Configuration HOWTO</a> demonstrates how do
set the Cluster URL.</p>
<h3 id="data-stream-processing-1">Data Stream Processing</h3>
<p>To enable Stroom to process data, it&rsquo;s
<a href="../../../docs/user-guide/jobs/#data-processor">Data Processors</a>
need to be enabled. There are NOT enabled by default on installation. The following
<a href="../../../docs/howtos/general/taskshowto/#enable-stream-processors-on-new-node">section</a>
in our <a href="../../../docs/howtos/general/taskshowto/">Stroom Tasks HowTo</a> shows how to do this.</p>
<h2 id="testing-our-new-node-installation">Testing our New Node Installation</h2>
<p>To complete the installation process we will test that our new node has successfully integrated into our cluster.</p>
<p>First we need to ensure we have restarted the Apache Httpd service (httpd.service) on the original nodes so that the new workers.properties
configuration files take effect.</p>
<p>We now test the node integration by running the tests we use to validate a Multi Node Stroom Cluster Deployment found
<a href="#sending-test-data">here</a> noting we should
monitor all three nodes proxy and application log files. Basically we are looking to see that this new node participates in the
load balancing for the <code>stroomp.strmdev00.org</code> cluster.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.4.'; page-break-before: always">
    
  <h1 id="pg-41b0d4ff1e99a75027ba01fe4180ef2b">4.4 - Installation of Stroom Application</h1>
    <div class="lead">This HOWTO describes the installation and initial configuration of the Stroom Application.</div>
	<h2 id="assumptions">Assumptions</h2>
<ul>
<li>the user has reasonable RHEL/Centos System administration skills</li>
<li>installation is on a fully patched minimal Centos 7.3 instance.</li>
<li>the Stroom <code>stroom</code> database has been created and resides on the host <code>stroomdb0.strmdev00.org</code> listening on port 3307.</li>
<li>the Stroom <code>stroom</code> database user is <code>stroomuser</code> with a password of <code>Stroompassword1@</code>.</li>
<li>the Stroom <code>statistics</code> database has been created and resides on the host <code>stroomdb0.strmdev00.org</code> listening on port 3308.</li>
<li>the Stroom <code>statistics</code> database user is <code>stroomuser</code> with a password of <code>Stroompassword2@</code>.</li>
<li>the application user <code>stroomuser</code> has been created</li>
<li>the user is or has deployed the two node Stroom cluster described <a href="../../../docs/howtos/install/installhowto/#storage-scenario">here</a></li>
<li>the user has set up the Stroom processing user as described <a href="../../../docs/howtos/install/installprocessingusersetuphowto/">here</a></li>
<li>the prerequisite software has been installed</li>
<li>when a screen capture is documented, data entry is identified by the data surrounded by &lsquo;&lt;<strong>&rsquo; &lsquo;</strong>&gt;&rsquo; . This excludes enter/return presses.</li>
</ul>
<h2 id="confirm-prerequisite-software-installation">Confirm Prerequisite Software Installation</h2>
<p>The following command will ensure the prerequisite software has been deployed</p>
<pre><code class="language-bash">sudo yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel policycoreutils-python unzip zip
sudo yum -y install mariadb
or
sudo yum -y install mysql-community-client
</code></pre>
<h2 id="test-database-connectivity">Test Database connectivity</h2>
<p>We need to test access to the Stroom databases on <code>stroomdb0.strmdev00.org</code>. We do this using the client <code>mysql</code> utility. We note that we
must enter the <em>stroomuser</em> user&rsquo;s password set up in the creation of the database earlier (<code>Stroompassword1@</code>) when connecting to
the <code>stroom</code> database and we must enter the <em>stroomstats</em> user&rsquo;s password (<code>Stroompassword2@</code>) when connecting to the <code>statistics</code> database.</p>
<p>We first test we can connect to the <code>stroom</code> database and then set the default database to be <code>stroom</code>.</p>
<pre><code>[burn@stroomp00 ~]$ mysql --user=stroomuser --host=stroomdb0.strmdev00.org --port=3307 --password
Enter password: &lt;__ Stroompassword1@ __&gt;
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 2
Server version: 5.5.52-MariaDB MariaDB Server

Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; use stroom;
Database changed
MariaDB [stroom]&gt; exit
Bye
[burn@stroomp00 ~]$
</code></pre>
<p>In the case of a MySQL Community deployment you will see</p>
<pre><code>[burn@stroomp00 ~]$ mysql --user=stroomuser --host=stroomdb0.strmdev00.org --port=3307 --password
Enter password: &lt;__ Stroompassword1@ __&gt;
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 9
Server version: 5.7.18 MySQL Community Server (GPL)

Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; use stroom;
Database changed
mysql&gt; quit
Bye
[burn@stroomp00 ~]$ 
</code></pre>
<p>We next test connecting to the <code>statistics</code> database and verify we can set the default database to be <code>statistics</code>.</p>
<pre><code>[burn@stroomp00 ~]$ mysql --user=stroomstats --host=stroomdb0.strmdev00.org --port=3308 --password
Enter password: &lt;__ Stroompassword2@ __&gt;
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 2
Server version: 5.5.52-MariaDB MariaDB Server

Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; use statistics;
Database changed
MariaDB [stroom]&gt; exit
Bye
[burn@stroomp00 ~]$
</code></pre>
<p>In the case of a MySQL Community deployment you will see</p>
<pre><code>[burn@stroomp00 ~]$ mysql --user=stroomstats --host=stroomdb0.strmdev00.org --port=3308 --password
Enter password:  &lt;__ Stroompassword2@ __&gt;
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 9
Server version: 5.7.18 MySQL Community Server (GPL)

Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; use statistics;
Database changed
mysql&gt; quit
Bye
[burn@stroomp00 ~]$ 
</code></pre>
<p>If there are any errors, correct them.</p>
<h2 id="get-the-software">Get the Software</h2>
<p>The following will gain the identified, in this case release <code>5.0-beta.18</code>, Stroom Application software release from github, then deploy it. You should regularly monitor the site for newer releases.</p>
<pre><code class="language-bash">sudo -i -u stroomuser
App=5.0-beta.18
wget https://github.com/gchq/stroom/releases/download/v${App}/stroom-app-distribution-${App}-bin.zip
unzip stroom-app-distribution-${App}-bin.zip
chmod 750 stroom-app
</code></pre>
<h2 id="configure-the-software">Configure the Software</h2>
<p>We install the application via</p>
<pre><code class="language-bash">stroom-app/bin/setup.sh
</code></pre>
<p>during which one is prompted for a number of configuration settings. Use the following</p>
<pre><code>TEMP_DIR should be set to '/stroomdata/stroom-working-p00' or '/stroomdata/stroom-working-p01' etc depending on the node we are installing on
NODE to be the hostname (not FQDN) of your host (i.e. 'stroomp00' or 'stroomp01' in our multi node scenario)
RACK can be ignored, just press return
PORT_PREFIX should use the default, just press return
JDBC_CLASSNAME should use the default, just press return
JDBC_URL to 'jdbc:mysql://stroomdb0.strmdev00.org:3307/stroom?useUnicode=yes&amp;characterEncoding=UTF-8'
DB_USERNAME should be our processing user, 'stroomuser'
DB_PASSWORD should be the one we set when creating the stroom database, that is 'Stroompassword1@'
JPA_DIALECT should use the default, just press return
JAVA_OPTS can use the defaults, but ensure you have sufficient memory, either change or accept the default
STROOM_STATISTICS_SQL_JDBC_CLASSNAME should use the default, just press return
STROOM_STATISTICS_SQL_JDBC_URL to 'jdbc:mysql://stroomdb0.strmdev00.org:3308/statistics?useUnicode=yes&amp;characterEncoding=UTF-8'
STROOM_STATISTICS_SQL_DB_USERNAME should be our processing user, 'stroomstats'
STROOM_STATISTICS_SQL_DB_PASSWORD should be the one we set when creating the stroom database, that is 'Stroompassword2@'
STATS_ENGINES should use the default, just press return
CONTENT_PACK_IMPORT_ENABLED should use the default, just press return
CREATE_DEFAULT_VOLUME_ON_START should use the default, just press return
</code></pre>
<p>At this point, the script will configure the application. There should be no errors, but review the output.
If you made an error then just re-run the script.</p>
<p>You will note that <strong>TEMP_DIR</strong> is the same directory we used for our <strong>STROOM_TMP</strong> environment variable when we set up the processing user scripts.
Note that if you are deploying a single node environment, where the database is also running on your Stroom node, then the <strong>JDBC_URL</strong> setting can be the default.</p>
<h2 id="start-the-application-service">Start the Application service</h2>
<p>Now we start the application. In the case of multi node Stroom deployment, we start the Stroom application on the first node in the cluster,
then <strong>wait</strong> until it has initialised the database commenced it&rsquo;s Lifecycle task. You will need to monitor the log file to see it&rsquo;s
completed initialisation.</p>
<p>So as the <code>stroomuser</code> start the application with the command</p>
<pre><code class="language-bash">stroom-app/bin/start.sh
</code></pre>
<p>Now monitor <code>stroom-app/instance/logs</code> for any errors. Initially you will see the log files <code>localhost_access_log.YYYY-MM-DD.txt</code>
and <code>catalina.out</code>. Check them for errors and correct (or post a question). The log4j warnings in <code>catalina.out</code> can be ignored.
Eventually the log file <code>stroom-app/instance/logs/stroom.log</code> will appear. Again check it for errors and then wait for the application to
be initialised. That is, wait for the Lifecycle service thread to start. This is indicated by the message</p>
<pre><code>INFO  [Thread-11] lifecycle.LifecycleServiceImpl (LifecycleServiceImpl.java:166) - Started Stroom Lifecycle service
</code></pre>
<p>The directory <code>stroom-app/instance/logs/events</code> will also appear with an empty file with
the nomenclature <code>events_YYYY-MM-DDThh:mm:ss.msecZ</code>. This is the directory for storing Stroom&rsquo;s application event logs. We will return to this
directory and it&rsquo;s content in a later HOWTO.</p>
<p>If you have a multi node configuration, then once the database has initialised, start the application service on all other nodes. Again with</p>
<pre><code class="language-bash">stroom-app/bin/start.sh
</code></pre>
<p>and then monitor the files in its <code>stroom-app/instance/logs</code> for any errors. Note that in multi node configurations,
you will see server.UpdateClusterStateTaskHandler messages in the log file of the form</p>
<pre><code>WARN  [Stroom P2 #9 - GenericServerTask] server.UpdateClusterStateTaskHandler (UpdateClusterStateTaskHandler.java:150) - discover() - unable to contact stroomp00 - No cluster call URL has been set for node: stroomp00
</code></pre>
<p>This is ok as we will establish the cluster URL&rsquo;s later.</p>
<h3 id="multi-node-firewall-provision">Multi Node Firewall Provision</h3>
<p>In the case of a multi node Stroom deployment, you will need to open certain ports to allow Tomcat to communicate to all nodes participating
in the cluster. Execute the following on all nodes. Note you will need to drop out of the <code>stroomuser</code> shell prior to execution.</p>
<pre><code class="language-bash">exit; # To drop out of the stroomuser shell

sudo firewall-cmd --zone=public --add-port=8080/tcp --permanent
sudo firewall-cmd --zone=public --add-port=9080/tcp --permanent
sudo firewall-cmd --zone=public --add-port=8009/tcp --permanent
sudo firewall-cmd --zone=public --add-port=9009/tcp --permanent
sudo firewall-cmd --reload
sudo firewall-cmd --zone=public --list-all
</code></pre>
<p>In a production environment you would improve the above firewall settings - to perhaps limit the communication to just the Stroom processing nodes.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.5.'; page-break-before: always">
    
  <h1 id="pg-13c4bed09b40651e4a0ec3326dd4d404">4.5 - Installation of Stroom Proxy</h1>
    <div class="lead">This HOWTO describes the installation and configuration of the Stroom Proxy software.</div>
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>the user has reasonable RHEL/Centos System administration skills.</li>
<li>installation is on a fully patched minimal Centos 7.3 instance.</li>
<li>the Stroom database has been created and resides on the host <code>stroomdb0.strmdev00.org</code> listening on port 3307.</li>
<li>the Stroom database user is <code>stroomuser</code> with a password of <code>Stroompassword1@</code>.</li>
<li>the application user <code>stroomuser</code> has been created.</li>
<li>the user is or has deployed the two node Stroom cluster described <a href="../../../docs/howtos/install/installhowto/#storage-scenario">here</a>.</li>
<li>the user has set up the Stroom processing user as described <a href="../../../docs/howtos/install/installprocessingusersetuphowto/">here</a>.</li>
<li>the prerequisite software has been installed.</li>
<li>when a screen capture is documented, data entry is identified by the data surrounded by &lsquo;&lt;<strong>&rsquo; &lsquo;</strong>&gt;&rsquo; . This excludes enter/return presses.</li>
</ul>
<h2 id="confirm-prerequisite-software-installation">Confirm Prerequisite Software Installation</h2>
<p>The following command will ensure the prerequisite software has been deployed</p>
<pre><code class="language-bash">sudo yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel policycoreutils-python unzip zip
sudo yum -y install mariadb
or
sudo yum -y install mysql-community-client
</code></pre>
<p>Note that we do <strong>NOT</strong> need the database client software for a Forwarding or Standalone proxy.</p>
<h2 id="get-the-software">Get the Software</h2>
<p>The following will gain the identified, in this case release <code>5.1-beta.10</code>, Stroom Application software release from github, then deploy it. You should regularly monitor the site for newer releases.</p>
<pre><code class="language-bash">sudo -i -u stroomuser
Prx=v5.1-beta.10
wget https://github.com/gchq/stroom-proxy/releases/download/${Prx}/stroom-proxy-distribution-${Prx}.zip
unzip stroom-proxy-distribution-${Prx}.zip
</code></pre>
<h2 id="configure-the-software">Configure the Software</h2>
<p>There are three different types of Stroom Proxy</p>
<ul>
<li>Store</li>
</ul>
<p>A <em>store</em> proxy accepts batches of events, as files. It will validate the batch with the database then store the batches as files in a configured directory.</p>
<ul>
<li>Store_NoDB</li>
</ul>
<p>A <em>store_nodb</em> proxy accepts batches of events, as files. It has no connectivity to the database, so it assumes all batches are valid, so it stores the batches as files in a configured directory.</p>
<ul>
<li>Forwarding</li>
</ul>
<p>A <em>forwarding</em> proxy accepts batches of events, as files. It has indirect connectivity to the database via the destination proxy, so it validates the batches then stores the batches as files in a configured directory until they are periodically forwarded to the configured destination Stroom proxy.</p>
<p>We will demonstrate the installation of each.</p>
<h3 id="store-proxy-configuration">Store Proxy Configuration</h3>
<p>In our <em>Store</em> Proxy description below, we will use the multi node deployment scenario. That is we are deploying the <em>Store</em> proxy on multiple Stroom nodes (stroomp00, stroomp01) and we have configured our storage as per the <a href="../../../docs/howtos/install/installhowto/#storage-scenario">Storage Scenario</a> which means the directories to install the inbound batches of data are <code>/stroomdata/stroom-working-p00/proxy</code> and <code>/stroomdata/stroom-working-p01/proxy</code> depending on the node.</p>
<p>To install a <em>Store</em> proxy, we run</p>
<pre><code class="language-bash">stroom-proxy/bin/setup.sh store
</code></pre>
<p>during which one is prompted for a number of configuration settings. Use the following</p>
<pre><code>NODE to be the hostname (not FQDN) of your host (i.e. 'stroomp00' or 'stroomp01' depending on the node we are installing on)
PORT_PREFIX should use the default, just press return
REPO_DIR should be set to '/stroomdata/stroom-working-p00/proxy' or '/stroomdata/stroom-working-p01/proxy' depending on the node we are installing on
REPO_FORMAT can be left as the default, just press return
JDBC_CLASSNAME should use the default, just press return
JDBC_URL should be set to 'jdbc:mysql://stroomdb0.strmdev00.org:3307/stroom'
DB_USERNAME should be our processing user, 'stroomuser'
DB_PASSWORD should be the one we set when creating the stroom database, that is 'Stroompassword1@'
JAVA_OPTS can use the defaults, but ensure you have sufficient memory, either change or accept the default
</code></pre>
<p>At this point, the script will configure the proxy. There should be no errors, but review the output.
If you make a mistake in the above, just re-run the script.</p>
<p><strong>NOTE:</strong> The selection of the <code>REPO_DIR</code> above and the setting of the <code>STROOM_TMP</code> environment variable <a href="../../../docs/howtos/install/installprocessingusersetuphowto/">earlier</a> ensure that not only inbound files are placed in the <code>REPO_DIR</code> location but the Stroom Application itself will access the same directory when it aggregates inbound data for ingest in it&rsquo;s proxy aggregation threads.</p>
<h3 id="forwarding-proxy-configuration">Forwarding Proxy Configuration</h3>
<p>In our <em>Forwarding</em> Proxy description below, we will deploy on a host named <code>stroomfp0</code> and it will store the files in <code>/stroomdata/stroom-working-fp0/proxy</code>. Remember, we are being consistent with our Storage hierarchy to make documentation and scripting simpler. Our destination host to periodically forward the files to will be <code>stroomp.strmdev00.org</code> (the CNAME for <code>stroomp00.strmdev00.org</code>).</p>
<p>To install a <em>Forwarding</em> proxy, we run</p>
<pre><code class="language-bash">stroom-proxy/bin/setup.sh forward
</code></pre>
<p>during which one is prompted for a number of configuration settings. Use the following</p>
<pre><code>NODE to be the hostname (not FQDN) of your host (i.e. 'stroomfp0' in our example)
PORT_PREFIX should use the default, just press return
REPO_DIR should be set to '/stroomdata/stroom-working-fp0/proxy' which we created earlier.
REPO_FORMAT can be left as the default, just press return
FORWARD_SERVER should be set to our stroom server. (i.e. 'stroomp.strmdev00.org' in our example)
JAVA_OPTS can use the defaults, but ensure you have sufficient memory, either change or accept the default
</code></pre>
<p>At this point, the script will configure the proxy. There should be no errors, but review the output.</p>
<h3 id="store-no-database-proxy-configuration">Store No Database Proxy Configuration</h3>
<p>In our <em>Store_NoDB</em> Proxy description below, we will deploy on a host named <code>stroomsap0</code> and it will store the files in <code>/stroomdata/stroom-working-sap0/proxy</code>. Remember, we are being consistent with our Storage hierarchy to make documentation and scripting simpler.</p>
<p>To install a <em>Store_NoDB</em> proxy, we run</p>
<pre><code class="language-bash">stroom-proxy/bin/setup.sh store_nodb
</code></pre>
<p>during which one is prompted for a number of configuration settings. Use the following</p>
<pre><code>NODE to be the hostname (not FQDN) of your host (i.e. 'stroomsap0' in our example)
PORT_PREFIX should use the default, just press return
REPO_DIR should be set to '/stroomdata/stroom-working-sap0/proxy' which we created earlier.
REPO_FORMAT can be left as the default, just press return
JAVA_OPTS can use the defaults, but ensure you have sufficient memory, either change or accept the default
</code></pre>
<p>At this point, the script will configure the proxy. There should be no errors, but review the output.</p>
<h2 id="apachemod_jk-change">Apache/Mod_JK change</h2>
<p>For all proxy deployments, if we are using Apache&rsquo;s mod_jk then we need to ensure the proxy&rsquo;s AJP connector specifies a 64K packetSize. View the file <code>stroom-proxy/instance/conf/server.xml</code> to ensure the Connector element for the AJP protocol has a packetSize attribute of <code>65536</code>. For example,</p>
<pre><code class="language-bash">grep AJP stroom-proxy/instance/conf/server.xml
</code></pre>
<p>shows</p>
<pre><code>&lt;Connector port=&quot;9009&quot; protocol=&quot;AJP/1.3&quot; connectionTimeout=&quot;20000&quot; redirectPort=&quot;8443&quot; maxThreads=&quot;200&quot; packetSize=&quot;65536&quot; /&gt;
</code></pre>
<p>This check is required for earlier releases of the Stroom Proxy. Releases since <code>v5.1-beta.4</code> have set the AJP packetSize.</p>
<h2 id="start-the-proxy-service">Start the Proxy Service</h2>
<p>We can now manually start our proxy service. Do so as the <code>stroomuser</code> with the command</p>
<pre><code class="language-bash">stroom-proxy/bin/start.sh
</code></pre>
<p>Now monitor the directory <code>stroom-proxy/instance/logs</code> for any errors. Initially you will see the log files <code>localhost_access_log.YYYY-MM-DD.txt</code> and <code>catalina.out</code>. Check them for errors and correct (or pose a question to this arena).
The context path and unknown version warnings in <code>catalina.out</code> can be ignored.</p>
<p>Eventually (about 60 seconds) the log file <code>stroom-proxy/instance/logs/stroom.log</code> will appear. Again check it for errors.
The proxy will have completely started when you see the messages</p>
<pre><code>INFO  [localhost-startStop-1] spring.StroomBeanLifeCycleReloadableContextBeanProcessor (StroomBeanLifeCycleReloadableContextBeanProcessor.java:109) - ** proxyContext 0 START COMPLETE **
</code></pre>
<p>and</p>
<pre><code>INFO  [localhost-startStop-1] spring.StroomBeanLifeCycleReloadableContextBeanProcessor (StroomBeanLifeCycleReloadableContextBeanProcessor.java:109) - ** webContext 0 START COMPLETE **
</code></pre>
<p>If you leave it for a while you will eventually see cyclic (10 minute cycle) messages of the form</p>
<pre><code>INFO  [Repository Reader Thread 1] repo.ProxyRepositoryReader (ProxyRepositoryReader.java:170) - run() - Cron Match at YYYY-MM-DD ...
</code></pre>
<p>If a proxy takes too long to start, you should read the section on <a href="../../../docs/howtos/install/installhowto/#entropy-issues-in-virtual-environments">Entropy Issues</a>.</p>
<h2 id="proxy-repository-format">Proxy Repository Format</h2>
<p>A Stroom Proxy stores inbound files in a hierarchical file system whose root is supplied during the proxy setup (<code>REPO_DIR</code>) and as files arrive they are given a <em>repository id</em> that is a one-up number starting at one (1). The files are stored in a specific <em>repository format</em>.
The default template is <code>${pathId}/${id}</code> and this pattern will produce the following output files under <code>REPO_DIR</code> for the given repository id</p>
<table>
<thead>
<tr>
<th style="text-align:right">Repository Id</th>
<th style="text-align:right">FilePath</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">000.zip</td>
</tr>
<tr>
<td style="text-align:right">100</td>
<td style="text-align:right">100.zip</td>
</tr>
<tr>
<td style="text-align:right">1000</td>
<td style="text-align:right">001/001000.zip</td>
</tr>
<tr>
<td style="text-align:right">10000</td>
<td style="text-align:right">010/010000.zip</td>
</tr>
<tr>
<td style="text-align:right">100000</td>
<td style="text-align:right">100/100000.zip</td>
</tr>
</tbody>
</table>
<p>Since version v5.1-beta.4, this template can be specified during proxy setup via the entry to the <code>Stroom Proxy Repository Format</code> prompt</p>
<pre><code>...
@@REPO_FORMAT@@ : Stroom Proxy Repository Format [${pathId}/${id}] &gt; 
...
</code></pre>
<p>The template uses replacement variables to form the file path. As indicated above, the default template is <code>${pathId}/${id}</code> where <code>${pathId}</code> is the automatically generated directory for a given <em>repository id</em> and <code>${id}</code> is the <em>repository id</em>.</p>
<p>Other replacement variables can be used to in the template including http header meta data parameters (e.g. &lsquo;${feed}&rsquo;) and time based parameters (e.g. &lsquo;${year}&rsquo;). Replacement variables that cannot be resolved will be output as &lsquo;_&rsquo;. You must ensure that all templates include the &lsquo;${id}&rsquo; replacement variable at the start of the file name, failure to do this will result in an invalid repository.</p>
<p>Available time based parameters are based on the file&rsquo;s time of processing and are zero filled (excluding <code>ms</code>).</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>year</td>
<td style="text-align:left">four digit year</td>
</tr>
<tr>
<td>month</td>
<td style="text-align:left">two digit month</td>
</tr>
<tr>
<td>day</td>
<td style="text-align:left">two digit day</td>
</tr>
<tr>
<td>hour</td>
<td style="text-align:left">two digit hour</td>
</tr>
<tr>
<td>minute</td>
<td style="text-align:left">two digit minute</td>
</tr>
<tr>
<td>second</td>
<td style="text-align:left">two digit second</td>
</tr>
<tr>
<td>millis</td>
<td style="text-align:left">three digit milliseconds value</td>
</tr>
<tr>
<td>ms</td>
<td style="text-align:left">milliseconds since Epoch value</td>
</tr>
</tbody>
</table>
<h3 id="proxy-repository-template-examples">Proxy Repository Template Examples</h3>
<p>For each of the following templates applied to a Store NoDB Proxy, the resultant proxy directory tree is shown after three posts were sent to the test feed <code>TEST-FEED-V1_0</code> and two posts to the test feed <code>FEED-NOVALUE-V9_0</code></p>
<h4 id="example-a---the-default---pathidid">Example A - The default - <code>${pathId}/${id}</code></h4>
<pre><code class="language-bash">[stroomuser@stroomsap0 ~]$ find /stroomdata/stroom-working-sap0/proxy/
/stroomdata/stroom-working-sap0/proxy/
/stroomdata/stroom-working-sap0/proxy/001.zip
/stroomdata/stroom-working-sap0/proxy/002.zip
/stroomdata/stroom-working-sap0/proxy/003.zip
/stroomdata/stroom-working-sap0/proxy/004.zip
/stroomdata/stroom-working-sap0/proxy/005.zip
[stroomuser@stroomsap0 ~]$ 
</code></pre>
<h4 id="example-b---a-feed-orientated-structure---feedyearmonthdaypathidid">Example B - A feed orientated structure - <code>${feed}/${year}/${month}/${day}/${pathId}/${id}</code></h4>
<pre><code class="language-bash">[stroomuser@stroomsap0 ~]$ find /stroomdata/stroom-working-sap0/proxy/
/stroomdata/stroom-working-sap0/proxy/
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/2017
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/2017/07
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/2017/07/23
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/2017/07/23/001.zip
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/2017/07/23/002.zip
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/2017/07/23/003.zip
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0/2017
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0/2017/07
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0/2017/07/23
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0/2017/07/23/004.zip
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0/2017/07/23/005.zip
[stroomuser@stroomsap0 ~]$ 
</code></pre>
<h4 id="example-c---a-date-orientated-structure---yearmonthdaypathidid">Example C - A date orientated structure - <code>${year}/${month}/${day}/${pathId}/${id}</code></h4>
<pre><code class="language-bash">[stroomuser@stroomsap0 ~]$ find /stroomdata/stroom-working-sap0/proxy/
/stroomdata/stroom-working-sap0/proxy/
/stroomdata/stroom-working-sap0/proxy/2017
/stroomdata/stroom-working-sap0/proxy/2017/07
/stroomdata/stroom-working-sap0/proxy/2017/07/23
/stroomdata/stroom-working-sap0/proxy/2017/07/23/001.zip
/stroomdata/stroom-working-sap0/proxy/2017/07/23/002.zip
/stroomdata/stroom-working-sap0/proxy/2017/07/23/003.zip
/stroomdata/stroom-working-sap0/proxy/2017/07/23/004.zip
/stroomdata/stroom-working-sap0/proxy/2017/07/23/005.zip
[stroomuser@stroomsap0 ~]$ 
</code></pre>
<h4 id="example-d---a-feed-orientated-structure-but-with-a-bad-parameter---feedbadparamdaypathidid">Example D - A feed orientated structure, but with a bad parameter - <code>${feed}/${badparam}/${day}/${pathId}/${id}</code></h4>
<pre><code class="language-bash">[stroomuser@stroomsap0 ~]$ find /stroomdata/stroom-working-sap0/proxy/
/stroomdata/stroom-working-sap0/proxy/
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/_
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/_/23
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/_/23/001.zip
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/_/23/002.zip
/stroomdata/stroom-working-sap0/proxy/TEST-FEED-V1_0/_/23/003.zip
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0/_
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0/_/23
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0/_/23/004.zip
/stroomdata/stroom-working-sap0/proxy/FEED-NOVALUE-V9_0/_/23/005.zip
[stroomuser@stroomsap0 ~]$ 
</code></pre>
<p>and one would also see a warning for each post in the proxy&rsquo;s log file of the form</p>
<pre><code>WARN  [ajp-apr-9009-exec-4] repo.StroomFileNameUtil (StroomFileNameUtil.java:133) - Unused variables found: [badparam]
</code></pre>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.6.'; page-break-before: always">
    
  <h1 id="pg-8f351908a29ef3b1acce233351630e06">4.6 - NFS Installation and Configuration</h1>
    <div class="lead">The following is a HOWTO to assist users in the installation and set up of NFS to support the sharing of directories in a two node Stroom cluster or add a new node to an existing cluster.</div>
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>the user has reasonable RHEL/Centos System administration skills</li>
<li>installations are on Centos 7.3 minimal systems (fully patched)</li>
<li>the user is or has deployed the example two node Stroom cluster storage hierarchy described <a href="../../../docs/howtos/install/installhowto/#storage-scenario">here</a></li>
<li>the configuration of this NFS is NOT secure. It is highly recommended to improve it&rsquo;s security in a production environment. This could include improved firewall configuration to limit NFS access, NFS4 with Kerberos etc.</li>
</ul>
<h2 id="installation-of-nfs-software">Installation of NFS software</h2>
<p>We install NFS on each node, via</p>
<pre><code class="language-bash">sudo yum -y install nfs-utils
</code></pre>
<p>and enable the relevant services, via</p>
<pre><code class="language-base">sudo systemctl enable rpcbind
sudo systemctl enable nfs-server
sudo systemctl enable nfs-lock
sudo systemctl enable nfs-idmap
sudo systemctl start rpcbind
sudo systemctl start nfs-server
sudo systemctl start nfs-lock
sudo systemctl start nfs-idmap
</code></pre>
<h2 id="configuration-of-nfs-exports">Configuration of NFS exports</h2>
<p>We now export the node&rsquo;s /stroomdata directory (in case you want to share the working directories) by configuring /etc/exports. For simplicity sake, we will allow all nodes with the hostname nomenclature of stroomp*.strmdev00.org to mount the <code>/stroomdata</code> directory. This means the same configuration applies to all nodes.</p>
<pre><code># Share Stroom data directory
/stroomdata	stroomp*.strmdev00.org(rw,sync,no_root_squash)
</code></pre>
<p>This can be achieved with the following on both nodes</p>
<pre><code class="language-bash">sudo su -c &quot;printf '# Share Stroom data directory\n' &gt;&gt; /etc/exports&quot;
sudo su -c &quot;printf '/stroomdata\tstroomp*.strmdev00.org(rw,sync,no_root_squash)\n' &gt;&gt; /etc/exports&quot;
</code></pre>
<p>On both nodes restart the NFS service to ensure the above export takes effect via</p>
<pre><code class="language-bash">sudo systemctl restart nfs-server
</code></pre>
<p>So that our nodes can offer their filesystems, we need to enable NFS access on the firewall.
This is done via</p>
<pre><code class="language-bash">sudo firewall-cmd --zone=public --add-service=nfs --permanent
sudo firewall-cmd --reload
sudo firewall-cmd --zone=public --list-all
</code></pre>
<h2 id="test-mounting">Test Mounting</h2>
<p>You should do test mounts on each node.</p>
<ul>
<li>Node: <code>stroomp00.strmdev00.org</code></li>
</ul>
<pre><code class="language-bash">sudo mount -t nfs4 stroomp01.strmdev00.org:/stroomdata/stroom-data-p01 /stroomdata/stroom-data-p01
</code></pre>
<ul>
<li>Node: <code>stroomp01.strmdev00.org</code></li>
</ul>
<pre><code class="language-bash">sudo mount -t nfs4 stroomp00.strmdev00.org:/stroomdata/stroom-data-p00 /stroomdata/stroom-data-p00
</code></pre>
<p>If you are concerned you can&rsquo;t see the mount with a <code>df</code> try a <code>df --type=nfs4 -a</code> or a <code>sudo df</code>. Irrespective, once the mounting works, make the mounts permanent by adding the following to each node&rsquo;s /etc/fstab file.</p>
<ul>
<li>Node: <code>stroomp00.strmdev00.org</code></li>
</ul>
<pre><code class="language-text">stroomp01.strmdev00.org:/stroomdata/stroom-data-p01 /stroomdata/stroom-data-p01 nfs4 soft,bg
</code></pre>
<p>achieved with</p>
<pre><code class="language-bash">sudo su -c &quot;printf 'stroomp01.strmdev00.org:/stroomdata/stroom-data-p01 /stroomdata/stroom-data-p01 nfs4 soft,bg\n' &gt;&gt; /etc/fstab&quot;
</code></pre>
<ul>
<li>Node: <code>stroomp01.strmdev00.org</code></li>
</ul>
<pre><code class="language-text">stroomp00.strmdev00.org:/stroomdata/stroom-data-p00 /stroomdata/stroom-data-p00 nfs4 soft,bg
</code></pre>
<p>achieved with</p>
<pre><code class="language-bash">sudo su -c &quot;printf 'stroomp00.strmdev00.org:/stroomdata/stroom-data-p00 /stroomdata/stroom-data-p00 nfs4 soft,bg\n' &gt;&gt; /etc/fstab&quot;
</code></pre>
<p>At this point reboot all processing nodes to ensure the directories mount automatically. You may need to give the nodes a minute to do this.</p>
<h2 id="addition-of-another-node">Addition of another Node</h2>
<p>If one needs to add another node to the cluster, lets say, <code>stroomp02.strmdev00.org</code>, on which <code>/stroomdata</code> follows the same storage hierarchy
as the existing nodes and all nodes have added mount points (directories) for this new node, you would take the following steps <em>in order</em>.</p>
<ul>
<li>
<p>Node: <code>stroomp02.strmdev00.org</code></p>
<ul>
<li>Install NFS software as <a href="../../../docs/howtos/install/installnfshowto/#installation-of-nfs-software">above</a></li>
<li>Configure the exports file as per</li>
</ul>
</li>
</ul>
<pre><code class="language-bash">sudo su -c &quot;printf '# Share Stroom data directory\n' &gt;&gt; /etc/exports&quot;
sudo su -c &quot;printf '/stroomdata\tstroomp*.strmdev00.org(rw,sync,no_root_squash)\n' &gt;&gt; /etc/exports&quot;
</code></pre>
<ul>
<li>Restart the NFS service and make the firewall enable NFS access as per</li>
</ul>
<pre><code class="language-bash">sudo systemctl restart nfs-server
sudo firewall-cmd --zone=public --add-service=nfs --permanent
sudo firewall-cmd --reload
sudo firewall-cmd --zone=public --list-all
</code></pre>
<ul>
<li>Test mount the existing node file systems</li>
</ul>
<pre><code class="language-bash">sudo mount -t nfs4 stroomp00.strmdev00.org:/stroomdata/stroom-data-p00 /stroomdata/stroom-data-p00
sudo mount -t nfs4 stroomp01.strmdev00.org:/stroomdata/stroom-data-p01 /stroomdata/stroom-data-p01
</code></pre>
<ul>
<li>Once the test mounts work, we make them permanent by adding the following to the /etc/fstab file.</li>
</ul>
<pre><code class="language-text">stroomp00.strmdev00.org:/home/stroomdata/stroom-data-p00 /home/stroomdata/stroom-data-p00 nfs4 soft,bg
stroomp01.strmdev00.org:/home/stroomdata/stroom-data-p01 /home/stroomdata/stroom-data-p01 nfs4 soft,bg
</code></pre>
<p>achieved with</p>
<pre><code class="language-bash">sudo su -c &quot;printf 'stroomp00.strmdev00.org:/stroomdata/stroom-data-p00 /stroomdata/stroom-data-p00 nfs4 soft,bg\n' &gt;&gt; /etc/fstab&quot;
sudo su -c &quot;printf 'stroomp01.strmdev00.org:/stroomdata/stroom-data-p01 /stroomdata/stroom-data-p01 nfs4 soft,bg\n' &gt;&gt; /etc/fstab&quot;
</code></pre>
<ul>
<li>
<p>Node: <code>stroomp00.strmdev00.org</code> <strong>and</strong> <code>stroomp01.strmdev00.org</code></p>
<ul>
<li>Test mount the new node&rsquo;s filesystem as per</li>
</ul>
</li>
</ul>
<pre><code class="language-bash">sudo mount -t nfs4 stroomp02.strmdev00.org:/stroomdata/stroom-data-p02 /stroomdata/stroom-data-p02
</code></pre>
<ul>
<li>Once the test mount works, make the mount permanent by adding the following to the /etc/fstab file</li>
</ul>
<pre><code class="language-text">stroomp02.strmdev00.org:/stroomdata/stroom-data-p02 /stroomdata/stroom-data-p02 nfs4 soft,bg
</code></pre>
<p>achieved with</p>
<pre><code class="language-bash">sudo su -c &quot;printf 'stroomp02.strmdev00.org:/stroomdata/stroom-data-p02 /stroomdata/stroom-data-p02 nfs4 soft,bg\n' &gt;&gt; /etc/fstab&quot;
</code></pre>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.7.'; page-break-before: always">
    
  <h1 id="pg-e1902c7f9911560579e1b0418879914b">4.7 - Node Cluster URL Setup</h1>
    <div class="lead">Configuring Stroom cluster URLs</div>
	<p>In a Stroom cluster, <a href="../../../docs/user-guide/nodes/">Nodes</a> are expected to communicate with each other on port 8080 over http. To facilitate this, we need to set each node&rsquo;s Cluster URL and the following demonstrates this process.</p>
<h2 id="assumptions">Assumptions</h2>
<ul>
<li>an account with the <code>Administrator</code> Application <a href="../../../docs/user-guide/roles/">Permission</a> is currently logged in.</li>
<li>we have a multi node Stroom cluster with two nodes, <code>stroomp00</code> and <code>stroomp01</code></li>
<li>appropriate firewall configurations have been made</li>
<li>in the scenario of adding a new node to our multi node deployment, the node added will be <code>stroomp02</code></li>
</ul>
<h2 id="configure-two-nodes">Configure Two Nodes</h2>
<p>To configure the nodes, move to the <code>Monitoring</code> item of the <strong>Main Menu</strong> and select it to bring up the <code>Monitoring</code> sub-menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-MonitoringSubmenu-00.png" href="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-MonitoringSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Monitoring sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then move down and select the <code>Nodes</code> sub-item to be presented with the <code>Nodes</code> configuration tab as seen below.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeClusterSetup-01.png" href="../../../images/HOWTOs/UI-NodeClusterSetup-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeClusterSetup-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeClusterSetup-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Node Management - management tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>To set <code>stroomp00</code>&rsquo;s Cluster URL, move the it&rsquo;s line in the display and select it. It will be highlighted.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeClusterSetup-02.png" href="../../../images/HOWTOs/UI-NodeClusterSetup-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeClusterSetup-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeClusterSetup-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Node Management - select first node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Then move the cursor to the <em>Edit Node</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/edit.svg" 
    title="Edit" 
    alt="edit.svg">


 in the top left of
the <code>Nodes</code> tab and select it. On selection the <code>Edit Node</code> configuration window will be displayed and into
the <strong>Cluster URL:</strong> entry box, enter the first node&rsquo;s URL of <code>http://stroomp00.strmdev00.org:8080/stroom/clustercall.rpc</code></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeClusterSetup-03.png" href="../../../images/HOWTOs/UI-NodeClusterSetup-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeClusterSetup-03.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeClusterSetup-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Node Management - set clustercall url for first node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 at which we see the <em>Cluster URL</em> has been set for the first node as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeClusterSetup-04.png" href="../../../images/HOWTOs/UI-NodeClusterSetup-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeClusterSetup-04.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeClusterSetup-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Node Management - set clustercall url on first node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We next select the second node</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeClusterSetup-05.png" href="../../../images/HOWTOs/UI-NodeClusterSetup-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeClusterSetup-05.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeClusterSetup-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Node Management - select second node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then move the cursor to the <em>Edit Node</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/edit.svg" 
    title="Edit" 
    alt="edit.svg">


 in the top left of
the <code>Nodes</code> tab and select it. On selection the <code>Edit Node</code> configuration window will be displayed and into
the <strong>Cluster URL:</strong> entry box, enter the second node&rsquo;s URL of <code>http://stroomp01.strmdev00.org:8080/stroom/clustercall.rpc</code></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeClusterSetup-06.png" href="../../../images/HOWTOs/UI-NodeClusterSetup-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeClusterSetup-06.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeClusterSetup-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Node Management - set clustercall url for second node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button.</p>
<p>At this we will see both nodes have the <strong>Cluster URLs</strong> set.</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeClusterSetup-07.png" href="../../../images/HOWTOs/UI-NodeClusterSetup-07.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeClusterSetup-07.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeClusterSetup-07.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Node Management - both nodes setup</figcaption>
      </div>
      
    </figure>
  </a>
</div>
.</p>
<p>You may need to press the <em>Refresh</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


 found at top left of <code>Nodes</code> configuration tab, until both nodes show healthy pings.</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeClusterSetup-08.png" href="../../../images/HOWTOs/UI-NodeClusterSetup-08.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeClusterSetup-08.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeClusterSetup-08.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Node Management - both nodes ping</figcaption>
      </div>
      
    </figure>
  </a>
</div>
.</p>
<p>If you do not get ping results for each node, then they are not configured correctly. In that situation,
review all log files and processes that you have performed.</p>
<p>Once you have set the Cluster URLs of each node you should also set the <em>master assignment priority</em> for each node to
be different to all of the others. In the image above both have been assigned equal priority - <code>1</code>. We will
change <code>stroomp00</code> to have a different priority - <code>3</code>. You should note that the node with the highest
priority gains the <code>Master</code> node status.</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-NodeClusterSetup-09.png" href="../../../images/HOWTOs/UI-NodeClusterSetup-09.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-NodeClusterSetup-09.png" style="max-width: fit-content" alt="images/HOWTOs/UI-NodeClusterSetup-09.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Node Management - set node priorities</figcaption>
      </div>
      
    </figure>
  </a>
</div>
.</p>
<h2 id="configure-new-node">Configure New Node</h2>
<p>When one expands a Multi Node Stroom cluster deployment, after the installation of the Stroom Proxy and Application software and services on
the new node, one has to configure the new node&rsquo;s Cluster URL.</p>
<p>To configure the new node, move to the <code>Monitoring</code> item of the <strong>Main Menu</strong> and select it to bring up the <code>Monitoring</code> sub-menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-MonitoringSubmenu-00.png" href="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-MonitoringSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-MonitoringSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Monitoring sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then move down and select the <code>Nodes</code> sub-item to be presented with the <code>Nodes</code> configuration tab as seen below.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddNewNode-00.png" href="../../../images/HOWTOs/UI-AddNewNode-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddNewNode-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddNewNode-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New Node Management - management tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>To set <code>stroomp02</code>&rsquo;s Cluster URL, move the it&rsquo;s line in the display and select it. It will be highlighted.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddNewNode-01.png" href="../../../images/HOWTOs/UI-AddNewNode-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddNewNode-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddNewNode-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Node Management - select new node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Then move the cursor to the <em>Edit Node</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/edit.svg" 
    title="Edit" 
    alt="edit.svg">


 in the top left
of the <code>Nodes</code> tab and select it. On selection the <code>Edit Node</code> configuration window will be displayed
and into the <strong>Cluster URL:</strong> entry box, enter the first node&rsquo;s URL of <code>http://stroomp02.strmdev00.org:8080/stroom/clustercall.rpc</code></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddNewNode-02.png" href="../../../images/HOWTOs/UI-AddNewNode-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddNewNode-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddNewNode-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New Node Management - set clustercall url for new node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button at which we see the <em>Cluster URL</em> has been set for the first node as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddNewNode-03.png" href="../../../images/HOWTOs/UI-AddNewNode-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddNewNode-03.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddNewNode-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New Node Management - set clustercall url on new node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You need to press the <em>Refresh</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


 found at top left of <code>Nodes</code> configuration tab, until the new node shows a healthy ping.</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddNewNode-04.png" href="../../../images/HOWTOs/UI-AddNewNode-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddNewNode-04.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddNewNode-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New Node Management - all nodes ping</figcaption>
      </div>
      
    </figure>
  </a>
</div>
.</p>
<p>If you do not get a ping results for the new node, then it is not configured correctly. In that situation, review all log files
and processes that you have performed.</p>
<p>Once you have set the Cluster URL you should also set the <em>master assignment priority</em> for each node to
be different to all of the others. In the image above both <code>stroomp01</code> and the new node, <code>stroomp02</code>, have been
assigned equal priority - <code>1</code>. We will change <code>stroomp01</code> to have a different priority - <code>2</code>. You should note that the node
with the highest priority maintains the <code>Master</code> node status.</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-AddNewNode-05.png" href="../../../images/HOWTOs/UI-AddNewNode-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-AddNewNode-05.png" style="max-width: fit-content" alt="images/HOWTOs/UI-AddNewNode-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI New Node Management - set node priorities</figcaption>
      </div>
      
    </figure>
  </a>
</div>
.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.8.'; page-break-before: always">
    
  <h1 id="pg-2cd81f535c13c52b322e27141321700f">4.8 - Processing User setup</h1>
    <div class="lead">This HOWTO demonstrates how to set up various files and scripts that the Stroom processing user requires.</div>
	<h2 id="assumptions">Assumptions</h2>
<ul>
<li>the user has reasonable RHEL/Centos System administration skills</li>
<li>installation is on a fully patched minimal Centos 7.3 instance.</li>
<li>the application user <code>stroomuser</code> has been created</li>
<li>the user is deploying for either</li>
<li>the example two node Stroom cluster whose storage is described <a href="../../../docs/howtos/install/installhowto/#storage-scenario">here</a></li>
<li>a simple Forwarding or Standalone Proxy</li>
<li>adding a node to an existing Stroom cluster</li>
</ul>
<h2 id="set-up-the-stroom-processing-users-environment">Set up the Stroom processing user&rsquo;s environment</h2>
<p>To automate the running of a Stroom Proxy or Application service under out Stroom processing user, <code>stroomuser</code>, there are a number of configuration files and scripts we need to deploy.</p>
<p>We first become the stroomuser</p>
<pre><code class="language-bash">sudo -i -u stroomuser
</code></pre>
<h3 id="environment-variable-files">Environment Variable files</h3>
<p>When either a Stroom Proxy or Application starts, it needs predefined environment variables. We set these up in the <code>stroomuser</code> home directory.
We need two files for this. The first is for the Stroom processes themselves and the second is for the Stroom systemd service we deploy. The
difference is that for the Stroom processes, we need to <code>export</code> the environment variables where as the Stroom systemd service file just needs to read them.</p>
<p>The JAVA_HOME and PATH variables are to support Java running the Tomcat instances.
The STROOM_TMP variable is set to a working area for the Stroom Application to use. The application accesses this environment variable internally
via the ${stroom_tmp} context variable. Note that we only need the STROOM_TMP variable for Stroom Application deployments, so one
could remove it from the files for a Forwarding or Standalone proxy deployment.</p>
<p>With respect to the working area, we will make use of the <a href="../../../docs/howtos/install/installhowto/#storage-scenario">Storage Scenario</a> we have defined and hence use the directory <code>/stroomdata/stroom-working-p_nn_</code> where <em>nn</em> is the hostname node number (i.e 00 for host stroomp00, 01 for host stroomp01, etc).</p>
<p>So, for the first node, <em>00</em>, we run</p>
<pre><code class="language-bash">N=00
F=~/env.sh
printf '# Environment variables for Stroom services\n' &gt; ${F}
printf 'export JAVA_HOME=/usr/lib/jvm/java-1.8.0\n' &gt;&gt; ${F}
printf 'export PATH=${JAVA_HOME}/bin:${PATH}\n' &gt;&gt; ${F}
printf 'export STROOM_TMP=/stroomdata/stroom-working-p%s\n' ${N} &gt;&gt; ${F}
chmod 640 ${F}

F=~/env_service.sh
printf '# Environment variables for Stroom services, executed out of systemd service\n' &gt; ${F}
printf 'JAVA_HOME=/usr/lib/jvm/java-1.8.0\n' &gt;&gt; ${F}
printf 'PATH=${JAVA_HOME}/bin:${PATH}\n' &gt;&gt; ${F}
printf 'STROOM_TMP=/stroomdata/stroom-working-p%s\n' ${N} &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<p>then we can change the <strong>N</strong> variable on each successive node and run the above.</p>
<p>Alternately, for a Stroom Forwarding or Standalone proxy, the following would be sufficient</p>
<pre><code class="language-bash">F=~/env.sh
printf '# Environment variables for Stroom services\n' &gt; ${F}
printf 'export JAVA_HOME=/usr/lib/jvm/java-1.8.0\n' &gt;&gt; ${F}
printf 'export PATH=${JAVA_HOME}/bin:${PATH}\n' &gt;&gt; ${F}
chmod 640 ${F}

F=~/env_service.sh
printf '# Environment variables for Stroom services, executed out of systemd service\n' &gt; ${F}
printf 'JAVA_HOME=/usr/lib/jvm/java-1.8.0\n' &gt;&gt; ${F}
printf 'PATH=${JAVA_HOME}/bin:${PATH}\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<p>And we integrate the environment into our bash instantiation script as well as setting up useful bash functions. This is the same for all nodes.
Note that the <code>T</code> and <code>Tp</code> aliases are always installed whether they are of use of not. IE a Standalone or Forwarding Stroom Proxy could make
no use of the <code>T</code> shell alias.</p>
<pre><code class="language-bash">F=~/.bashrc
printf '. ~/env.sh\n\n' &gt;&gt; ${F}
printf '# Simple functions to support Stroom\n' &gt;&gt; ${F}
printf '# T - continually monitor (tail) the Stroom application log\n'  &gt;&gt; ${F}
printf '# Tp - continually monitor (tail) the Stroom proxy log\n'  &gt;&gt; ${F}
printf 'function T {\n  tail --follow=name ~/stroom-app/instance/logs/stroom.log\n}\n' &gt;&gt; ${F}
printf 'function Tp {\n  tail --follow=name ~/stroom-proxy/instance/logs/stroom.log\n}\n' &gt;&gt; ${F}
</code></pre>
<p>And test it has set up correctly</p>
<pre><code class="language-bash">. ./.bashrc
which java
</code></pre>
<p>which should return <code>/usr/lib/jvm/java-1.8.0/bin/java</code></p>
<h3 id="establish-simple-startstop-scripts">Establish Simple Start/Stop Scripts</h3>
<p>We create some simple start/stop scripts that start, or stop, all the available Stroom services. At this point, it&rsquo;s just the Stroom application and proxy.</p>
<pre><code class="language-bash">if [ ! -d ~/bin ]; then mkdir ~/bin; fi
F=~/bin/StartServices.sh
printf '#!/bin/bash\n' &gt; ${F}
printf '# Start all Stroom services\n' &gt;&gt; ${F}
printf '# Set list of services\n' &gt;&gt; ${F}
printf 'Services=&quot;stroom-proxy stroom-app&quot;\n' &gt;&gt; ${F}
printf 'for service in ${Services}; do\n' &gt;&gt; ${F}
printf '  if [ -f ${service}/bin/start.sh ]; then\n' &gt;&gt; ${F}
printf '    bash ${service}/bin/start.sh\n' &gt;&gt; ${F}
printf '  fi\n' &gt;&gt; ${F}
printf 'done\n' &gt;&gt; ${F}
chmod 750 ${F}

F=~/bin/StopServices.sh
printf '#!/bin/bash\n' &gt; ${F}
printf '# Stop all Stroom services\n' &gt;&gt; ${F}
printf '# Set list of services\n' &gt;&gt; ${F}
printf 'Services=&quot;stroom-proxy stroom-app&quot;\n' &gt;&gt; ${F}
printf 'for service in ${Services}; do\n' &gt;&gt; ${F}
printf '  if [ -f ${service}/bin/stop.sh ]; then\n' &gt;&gt; ${F}
printf '    bash ${service}/bin/stop.sh\n' &gt;&gt; ${F}
printf '  fi\n' &gt;&gt; ${F}
printf 'done\n' &gt;&gt; ${F}
chmod 750 ${F}
</code></pre>
<p>Although one can modify the above for Stroom Forwarding or Standalone Proxy deployments, there is no issue if you use the same scripts.</p>
<h2 id="establish-and-deploy-systemd-services">Establish and Deploy Systemd services</h2>
<h3 id="processing-or-proxy-node">Processing or Proxy node</h3>
<p>For a standard Stroom Processing or Proxy nodes, we can use the following service script.
(Noting this is done as root)</p>
<pre><code class="language-bash">sudo bash
F=/etc/systemd/system/stroom-services.service
printf '# Install in /etc/systemd/system\n' &gt; ${F}
printf '# Enable via systemctl enable stroom-services.service\n\n' &gt;&gt; ${F}
printf '[Unit]\n' &gt;&gt; ${F}
printf '# Who we are\n' &gt;&gt; ${F}
printf 'Description=Stroom Service\n' &gt;&gt; ${F}
printf '# We want the network and httpd up before us\n' &gt;&gt; ${F}
printf 'Requires=network-online.target httpd.service\n' &gt;&gt; ${F}
printf 'After= httpd.service network-online.target\n\n' &gt;&gt; ${F}
printf '[Service]\n' &gt;&gt; ${F}
printf '# Source our environment file so the Stroom service start/stop scripts work\n' &gt;&gt; ${F}
printf 'EnvironmentFile=/home/stroomuser/env_service.sh\n' &gt;&gt; ${F}
printf 'Type=oneshot\n' &gt;&gt; ${F}
printf 'ExecStart=/bin/su --login stroomuser /home/stroomuser/bin/StartServices.sh\n' &gt;&gt; ${F}
printf 'ExecStop=/bin/su --login stroomuser /home/stroomuser/bin/StopServices.sh\n' &gt;&gt; ${F}
printf 'RemainAfterExit=yes\n\n' &gt;&gt; ${F}
printf '[Install]\n' &gt;&gt; ${F}
printf 'WantedBy=multi-user.target\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<h3 id="single-node-scenario-with-local-database">Single Node Scenario with local database</h3>
<p>Should you only have a deployment where the database is on a processing node, use the following service script. The only
difference is the Stroom dependency on the database. The database dependency below is for the MariaDB database. If you had
installed the MySQL Community database, then replace <code>mariadb.service</code> with <code>mysqld.service</code>.
(Noting this is done as root)</p>
<pre><code class="language-bash">sudo bash
F=/etc/systemd/system/stroom-services.service
printf '# Install in /etc/systemd/system\n' &gt; ${F}
printf '# Enable via systemctl enable stroom-services.service\n\n' &gt;&gt; ${F}
printf '[Unit]\n' &gt;&gt; ${F}
printf '# Who we are\n' &gt;&gt; ${F}
printf 'Description=Stroom Service\n' &gt;&gt; ${F}
printf '# We want the network, httpd and Database up before us\n' &gt;&gt; ${F}
printf 'Requires=network-online.target httpd.service mariadb.service\n' &gt;&gt; ${F}
printf 'After=mariadb.service httpd.service network-online.target\n\n' &gt;&gt; ${F}
printf '[Service]\n' &gt;&gt; ${F}
printf '# Source our environment file so the Stroom service start/stop scripts work\n' &gt;&gt; ${F}
printf 'EnvironmentFile=/home/stroomuser/env_service.sh\n' &gt;&gt; ${F}
printf 'Type=oneshot\n' &gt;&gt; ${F}
printf 'ExecStart=/bin/su --login stroomuser /home/stroomuser/bin/StartServices.sh\n' &gt;&gt; ${F}
printf 'ExecStop=/bin/su --login stroomuser /home/stroomuser/bin/StopServices.sh\n' &gt;&gt; ${F}
printf 'RemainAfterExit=yes\n\n' &gt;&gt; ${F}
printf '[Install]\n' &gt;&gt; ${F}
printf 'WantedBy=multi-user.target\n' &gt;&gt; ${F}
chmod 640 ${F}
</code></pre>
<h3 id="enable-the-service">Enable the service</h3>
<p>Now we enable the Stroom service, but we <strong>DO NOT</strong> start it as we will manually start the Stroom services as part of
the installation process.</p>
<pre><code class="language-bash">systemctl enable stroom-services.service
</code></pre>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.9.'; page-break-before: always">
    
  <h1 id="pg-15073cc8313abe2f3ac870d7650fdf59">4.9 - SSL Certificate Generation</h1>
    <div class="lead">A HOWTO to assist users in setting up various SSL Certificates to support a Web interface to Stroom.</div>
	<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ul>
<li>the user has reasonable RHEL/Centos System administration skills</li>
<li>installations are on Centos 7.3 minimal systems (fully patched)</li>
<li>either a Stroom Proxy or Stroom Application has already been deployed</li>
<li>processing node names are &lsquo;stroomp00.strmdev00.org&rsquo; and &lsquo;stroomp01.strmdev00.org&rsquo;</li>
<li>the first node, &lsquo;stroomp00.strmdev00.org&rsquo; also has a CNAME &lsquo;stroomp.strmdev00.org&rsquo;</li>
<li>in the scenario of a Stroom Forwarding Proxy, the node name is &lsquo;stroomfp0.strmdev00.org&rsquo;</li>
<li>in the scenario of a Stroom Standalone Proxy, the node name is &lsquo;stroomsap0.strmdev00.org&rsquo;</li>
<li>stroom runs as user &lsquo;stroomuser&rsquo;</li>
<li>the use of self signed certificates is appropriate for test systems, but users should consider appropriate CA infrastructure in production environments</li>
<li>in this document, when a screen capture is documented, data entry is identified by the data surrounded by &lsquo;&lt;<strong>&rsquo; &lsquo;</strong>&gt;&rsquo; . This excludes enter/return presses.</li>
</ul>
<h2 id="create-certificates">Create certificates</h2>
<p>The first step is to establish a self signed certificate for our Stroom service. If you have a certificate server, then certainly gain an
appropriately signed certificate. For this HOWTO, we will stay with a self signed solution and hence no certificate authorities are
involved. If you are deploying a cluster, then you will only have one certificate for all nodes. We achieve this by setting up an
alias for the first node in the cluster and then use that alias for addressing the cluster. That is, we have set up a
CNAME, <code>stroomp.strmdev00.org</code> for <code>stroomp00.strmdev00.org</code>. This means within the web service we deploy, the ServerName will be <code>stroomp.strmdev00.org</code>
on each node. Since it&rsquo;s one certificate we only need to set it up on one node then deploy the certificate key files to other nodes.</p>
<p>As the certificates will be stored in the <code>stroomuser's</code> home directory, we become the stroom user</p>
<pre><code class="language-bash">sudo -i -u stroomuser
</code></pre>
<h3 id="use-host-variable">Use host variable</h3>
<p>To make things simpler in the following bash extracts, we establish the bash variable <code>H</code> to be used in filename generation. The variable name
is set to the name of the host (or cluster alias) your are deploying the certificates on. In our multi node HOWTO example we are using, we
would use the host CNAME <code>stroomp</code>.  Thus we execute</p>
<pre><code class="language-bash">export H=stroomp
</code></pre>
<p>Note in our the Stroom Forwarding Proxy HOWTO we would use the name <code>stroomfp0</code>. In the case of our Standalone Proxy we would use <code>stroomsap0</code>.</p>
<p>We set up a directory to house our certificates via</p>
<pre><code class="language-bash">cd ~stroomuser
rm -rf stroom-jks
mkdir -p stroom-jks stroom-jks/public stroom-jks/private
cd stroom-jks
</code></pre>
<p>Create a server key for Stroom service (enter a password when prompted for both initial and verification prompts)</p>
<pre><code class="language-bash">openssl genrsa -des3 -out private/$H.key 2048
</code></pre>
<p>as per</p>
<pre><code>Generating RSA private key, 2048 bit long modulus
.................................................................+++
...............................................+++
e is 65537 (0x10001)
Enter pass phrase for private/stroomp.key: &lt;__ENTER_SERVER_KEY_PASSWORD__&gt;
Verifying - Enter pass phrase for private/stroomp.key: &lt;__ENTER_SERVER_KEY_PASSWORD__&gt;
</code></pre>
<p>Create a signing request. The two important prompts are the password and Common Name. All the rest can use the defaults offered.
The requested password is for the server key and you should use the host (or cluster alias) your are deploying the certificates on for
the Common Name. In the output below we will assume a multi node cluster certificate is being generated, so will use <code>stroomp.strmdev00.org</code>.</p>
<pre><code class="language-bash">openssl req -sha256 -new -key private/$H.key -out $H.csr
</code></pre>
<p>as per</p>
<pre><code>Enter pass phrase for private/stroomp.key: &lt;__ENTER_SERVER_KEY_PASSWORD__&gt;
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [XX]:
State or Province Name (full name) []:
Locality Name (eg, city) [Default City]:
Organization Name (eg, company) [Default Company Ltd]:
Organizational Unit Name (eg, section) []:
Common Name (eg, your name or your server's hostname) []:&lt;__ stroomp.strmdev00.org __&gt; 
Email Address []:

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:
An optional company name []:
</code></pre>
<p>We now self sign the certificate (again enter the server key password)</p>
<pre><code class="language-bash">openssl x509 -req -sha256 -days 720 -in $H.csr -signkey private/$H.key -out public/$H.crt
</code></pre>
<p>as per</p>
<pre><code>Signature ok
subject=/C=XX/L=Default City/O=Default Company Ltd/CN=stroomp.strmdev00.org
Getting Private key
Enter pass phrase for private/stroomp.key: &lt;__ENTER_SERVER_KEY_PASSWORD__&gt;
</code></pre>
<p>and noting the <code>subject</code> will change depending on the host name used when generating the signing request.</p>
<p>Create insecure version of private key for Apache autoboot (you will again need to enter the server key password)</p>
<pre><code class="language-bash">openssl rsa -in private/$H.key -out private/$H.key.insecure
</code></pre>
<p>as per</p>
<pre><code>Enter pass phrase for private/stroomp.key: &lt;__ENTER_SERVER_KEY_PASSWORD__&gt;
writing RSA key
</code></pre>
<p>and then move the insecure keys as appropriate</p>
<pre><code class="language-bash">mv private/$H.key private/$H.key.secure
chmod 600 private/$H.key.secure
mv private/$H.key.insecure private/$H.key
</code></pre>
<p>We have now completed the creation of our certificates and keys.</p>
<h3 id="replication-of-keys-directory-to-other-nodes">Replication of Keys Directory to other nodes</h3>
<p>If you are deploying a multi node Stroom cluster, then you would replicate the directory ~stroomuser/stroom-jks to each node in the cluster. That is,
tar it up, copy the tar file to the other node(s) then untar it. We can make use of the other node&rsquo;s mounted file system for this process.
That is one could execute the commands on the first node, where we created the certificates</p>
<pre><code class="language-bash">cd ~stroomuser
tar cf stroom-jks.tar stroom-jks
mv stroom-jks.tar /stroomdata/stroom-data-p01
</code></pre>
<p>then on the another node, say <code>stroomp01.strmdev00.org</code>, as the stroomuser we extract the data.</p>
<pre><code class="language-bash">sudo -i -u stroomuser
cd ~stroomuser
tar xf /stroomdata/stroom-data-p01/stroom-jks.tar &amp;&amp; rm -f /stroomdata/stroom-data-p01/stroom-jks.tar
</code></pre>
<h3 id="protection-ownership-and-selinux-context">Protection, Ownership and SELinux Context</h3>
<p>Now ensure protection, ownership and SELinux context for these key files on <strong>ALL</strong> nodes via</p>
<pre><code class="language-bash">chmod 700 ~stroomuser/stroom-jks/private ~stroomuser/stroom-jks
chown -R stroomuser:stroomuser ~stroomuser/stroom-jks
chcon -R --reference /etc/pki ~stroomuser/stroom-jks
</code></pre>
<h2 id="stroom-proxy-to-proxy-key-and-trust-stores">Stroom Proxy to Proxy Key and Trust Stores</h2>
<p>In order for a Stroom Forwarding Proxy to communicate to a central Stroom proxy over https, the JVM running the forwarding proxy needs
relevant keystores set up.</p>
<p>One would set up a Stroom&rsquo;s forwarding proxy SSL certificate as per <a href="#create-certificates">above</a>, with the change that the
hostname would be different. That is, in the initial setup, we would set the hostname variable <code>H</code> to be the hostname of the forwarding
proxy. Lets say it is <code>stroomfp0</code> thus we would set</p>
<pre><code class="language-bash">export H=stroomfp0
</code></pre>
<p>and then proceed as <a href="#use-host-variable">above</a>.</p>
<p>Note that you also need the public key of the central Stroom server you will be connecting to. For the following, we will assume
the central Stroom proxy is the <em>stroomp.strmdev00.org</em> server and it&rsquo;s public key is stored in the file <code>stroomp.crt</code>. We will store
this file on the forwarding proxy in <code>~stroomuser/stroom-jks/public/stroomp.crt</code>.</p>
<p>So once you have created the forwarding proxy server&rsquo;s SSL keys and have deployed the central proxy&rsquo;s public key, we next
need to convert the proxy server&rsquo;s SSL keys into DER format. This is done by executing the following.</p>
<pre><code class="language-bash">cd ~stroomuser/stroom-jks
export H=stroomfp0
export S=stroomp
rm -f ${H}_k.jks ${S}_t.jks
H_k=${H}
S_k=${S}
# Convert public key
openssl x509 -in public/$H.crt -inform PERM -out public/$H.crt.der -outform DER
</code></pre>
<p>When you convert the local server&rsquo;s private key, you will be prompted for the server key password.</p>
<pre><code class="language-bash"># Convert the local server's Private key
openssl pkcs8 -topk8 -nocrypt -in private/$H.key.secure -inform PEM -out private/$H.key.der -outform DER
</code></pre>
<p>as per</p>
<pre><code>Enter pass phrase for private/stroomfp0.key.secure: &lt;__ENTER_SERVER_KEY_PASSWORD__&gt;
</code></pre>
<p>We now import these keys into our Key Store. As part of the Stroom Proxy release, an Import Keystore application has been provisioned. We identify where it&rsquo;s found with the command</p>
<pre><code class="language-bash">find ~stroomuser/*proxy -name 'stroom*util*.jar' -print | head -1
</code></pre>
<p>which should return <em>/home/stroomuser/stroom-proxy/lib/stroom-proxy-util-v5.1-beta.10.jar</em> or similar depending on the release version.
To make execution simpler, we set this as a shell variable as per</p>
<pre><code class="language-bash">Stroom_UTIL_JAR=`find ~/*proxy -name 'stroom*util*.jar' -print | head -1`
</code></pre>
<p>We now create the keystore and import the proxy&rsquo;s server key</p>
<pre><code class="language-bash">java -cp ${Stroom_UTIL_JAR} stroom.util.cert.ImportKey keystore=${H}_k.jks keypass=$H alias=$H keyfile=private/$H.key.der certfile=public/$H.crt.der
</code></pre>
<p>as per</p>
<pre><code>One certificate, no chain
</code></pre>
<p>We now import the destination server&rsquo;s public key</p>
<pre><code class="language-bash">keytool -import -noprompt -alias ${S} -file public/${S}.crt -keystore ${S}_k.jks -storepass ${S}
</code></pre>
<p>as per</p>
<pre><code>Certificate was added to keystore
</code></pre>
<p>We now add the key and trust store location and password arguments to our Stroom proxy environment files.</p>
<pre><code class="language-bash">PWD=`pwd`
echo &quot;export JAVA_OPTS=\&quot;-Djavax.net.ssl.trustStore=${PWD}/${S}_k.jks -Djavax.net.ssl.trustStorePassword=${S} -Djavax.net.ssl.keyStore=${PWD}/${H}_k.jks -Djavax.net.ssl.keyStorePassword=${H}\&quot;&quot; &gt;&gt; ~/env.sh
echo &quot;JAVA_OPTS=\&quot;-Djavax.net.ssl.trustStore=${PWD}/${S}_k.jks -Djavax.net.ssl.trustStorePassword=${S} -Djavax.net.ssl.keyStore=${PWD}/${H}_k.jks -Djavax.net.ssl.keyStorePassword=${H}\&quot;&quot; &gt;&gt; ~/env_service.sh
</code></pre>
<p>At this point you should restart the proxy service. Using the commands</p>
<pre><code class="language-bash">cd ~stroomuser
source ./env.sh
stroom-proxy/bin/stop.sh
stroom-proxy/bin/start.sh
</code></pre>
<p>then check the logs to ensure it started correctly.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.10.'; page-break-before: always">
    
  <h1 id="pg-e9a18d235554418fd3d74b4db41248ae">4.10 - Testing Stroom Installation</h1>
    <div class="lead">This HOWTO will demonstrate various ways to test that your Stroom installation has been successful.</div>
	<h2 id="assumptions">Assumptions</h2>
<ul>
<li>Stroom Single or Multi Node Cluster Testing</li>
<li>the <a href="../../../docs/howtos/install/installhowto/#multi-node-stroom-cluster-proxy-and-application-deployment">Multi Node Stroom Cluster (Proxy and Application)</a> has been deployed</li>
<li>a <a href="../../../docs/howtos/install/installhowto/#add-a-test-feed">Test Feed</a>, <code>TEST-FEED-V1_0</code> has been added</li>
<li>Proxy aggregation has been turned off on all Stroom <em>Store</em> Proxies</li>
<li>the Stroom Proxy Repository Format (<code>REPO_FORMAT</code>) chosen was the default - <code>${pathId}/${id</code></li>
<li>Stroom Forwarding Proxy Testing</li>
<li>the <a href="../../../docs/howtos/install/installhowto/#multi-node-stroom-cluster-proxy-and-application-deployment">Multi Node Stroom Cluster (Proxy and Application)</a> has been deployed</li>
<li>the <a href="../../../docs/howtos/install/installhowto/#forwarding-stroom-proxy-deployment">Stroom Forwarding Proxy</a> has been deployed</li>
<li>a <a href="../../../docs/howtos/install/installhowto/#add-a-test-feed">Test Feed</a>, <code>TEST-FEED-V1_0</code> has been added</li>
<li>the Stroom Proxy Repository Format (<code>REPO_FORMAT</code>) chosen was the default - <code>${pathId}/${id</code></li>
<li>Stroom Standalone Proxy Testing</li>
<li>the <a href="../../../docs/howtos/install/installhowto/#standalone-stroom-proxy-deployment">Stroom Standalone Proxy</a> has been deployed</li>
<li>the Stroom Proxy Repository Format (<code>REPO_FORMAT</code>) chosen was the default - <code>${pathId}/${id</code></li>
</ul>
<h2 id="stroom-single-or-multi-node-cluster-testing">Stroom Single or Multi Node Cluster Testing</h2>
<h3 id="data-post-tests">Data Post Tests</h3>
<h4 id="simple-post-tests">Simple Post tests</h4>
<p>These tests are to ensure the Stroom <em>Store</em> proxy and it&rsquo;s connection to the database is working along with the Apache mod_jk loadbalancer.
We will send a file to the load balanced <code>stroomp.strmdev00.org</code> node (really <code>stroomp00.strmdev00.org</code>) and each time we send the file,
it&rsquo;s receipt should be managed by alternate proxy nodes. As a number of elements can effect load balancing, it is not always guaranteed
to alternate every time but for the most part it will.</p>
<p>Perform the following</p>
<ul>
<li>Log onto the Stroom database node (stroomdb0.strmdev00.org) as any user.</li>
<li>Log onto both Stroom nodes and become the <code>stroomuser</code> and monitor each node&rsquo;s Stroom proxy service using the <code>Tp</code> bash macro. That is, on each node, run</li>
</ul>
<pre><code class="language-bash">sudo -i -u stroomuser
Tp
</code></pre>
<p>You will note events of the form from
<code>stroomp00.strmdev00.org</code>:</p>
<pre><code class="language-text">...
2017-01-14T06:22:26.672Z INFO  [ProxyProperties refresh thread 0] datafeed.ProxyHandlerFactory$1 (ProxyHandlerFactory.java:96) - refreshThread() - Started
2017-01-14T06:30:00.993Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-14T06:30:00.993Z
2017-01-14T06:40:00.245Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-14T06:40:00.245Z
</code></pre>
<p>and from <code>stroomp01.strmdev00.org</code>:</p>
<pre><code class="language-text">...
2017-01-14T06:22:26.828Z INFO  [ProxyProperties refresh thread 0] datafeed.ProxyHandlerFactory$1 (ProxyHandlerFactory.java:96) - refreshThread() - Started
2017-01-14T06:30:00.066Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-14T06:30:00.066Z
2017-01-14T06:40:00.318Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-14T06:40:00.318Z
</code></pre>
<ul>
<li>On the Stroom database node, execute the command</li>
</ul>
<pre><code class="language-bash">curl -k --data-binary @/etc/group &quot;https://stroomp.strmdev00.org/stroom/datafeed&quot; -H &quot;Feed:TEST-FEED-V1_0&quot; -H &quot;System:EXAMPLE_SYSTEM&quot; -H &quot;Environment:EXAMPLE_ENVIRONMENT&quot;
</code></pre>
<p>If you are monitoring the proxy log of <code>stroomp00.strmdev00.org</code> you would see two new logs indicating the successful arrival of the file</p>
<pre><code class="language-text">2017-01-14T06:46:06.411Z INFO  [ajp-apr-9009-exec-1] handler.LogRequestHandler (LogRequestHandler.java:37) - log() - guid=54dc0da2-f35c-4dc2-8a98-448415ffc76b,feed=TEST-FEED-V1_0,system=EXAMPLE_SYSTEM,environment=EXAMPLE_ENVIRONMENT,remotehost=192.168.2.144,remoteaddress=192.168.2.144
2017-01-14T06:46:06.449Z INFO  [ajp-apr-9009-exec-1] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 571 ms to process (concurrentRequestCount=1) 200&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=54dc0da2-f35c-4dc2-8a98-448415ffc76b&quot;,&quot;ReceivedTime=2017-01-14T06:46:05.883Z&quot;,&quot;RemoteAddress=192.168.2.144&quot;,&quot;RemoteHost=192.168.2.144&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=527&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomp.strmdev00.org&quot;,&quot;user-agent=curl/7.29.0&quot;
</code></pre>
<ul>
<li>On the Stroom database node, again execute the command</li>
</ul>
<pre><code class="language-bash">curl -k --data-binary @/etc/group &quot;https://stroomp.strmdev00.org/stroom/datafeed&quot; -H &quot;Feed:TEST-FEED-V1_0&quot; -H &quot;System:EXAMPLE_SYSTEM&quot; -H &quot;Environment:EXAMPLE_ENVIRONMENT&quot;
</code></pre>
<p>If you are monitoring the proxy log of <code>stroomp01.strmdev00.org</code> you should see a new log. As foreshadowed, we didn&rsquo;t as the time delay resulted
in the first node getting the file. That is <code>stroomp00.strmdev00.org</code> log file gained the two entries</p>
<pre><code class="language-text">2017-01-14T06:47:26.642Z INFO  [ajp-apr-9009-exec-2] handler.LogRequestHandler (LogRequestHandler.java:37) - log() - guid=941d2904-734f-4764-9ccf-4124b94a56f6,feed=TEST-FEED-V1_0,system=EXAMPLE_SYSTEM,environment=EXAMPLE_ENVIRONMENT,remotehost=192.168.2.144,remoteaddress=192.168.2.144
2017-01-14T06:47:26.645Z INFO  [ajp-apr-9009-exec-2] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 174 ms to process (concurrentRequestCount=1) 200&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=941d2904-734f-4764-9ccf-4124b94a56f6&quot;,&quot;ReceivedTime=2017-01-14T06:47:26.470Z&quot;,&quot;RemoteAddress=192.168.2.144&quot;,&quot;RemoteHost=192.168.2.144&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=527&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomp.strmdev00.org&quot;,&quot;user-agent=curl/7.29.0&quot;
</code></pre>
<ul>
<li>Again on the database node, execute the command and this time we see that node <code>stroomp01.strmdev00.org</code> received the file as per</li>
</ul>
<pre><code class="language-text">2017-01-14T06:47:30.782Z INFO  [ajp-apr-9009-exec-1] handler.LogRequestHandler (LogRequestHandler.java:37) - log() - guid=2cef6e23-b0e6-4d75-8374-cca7caf66e15,feed=TEST-FEED-V1_0,system=EXAMPLE_SYSTEM,environment=EXAMPLE_ENVIRONMENT,remotehost=192.168.2.144,remoteaddress=192.168.2.144
2017-01-14T06:47:30.816Z INFO  [ajp-apr-9009-exec-1] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 593 ms to process (concurrentRequestCount=1) 200&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=2cef6e23-b0e6-4d75-8374-cca7caf66e15&quot;,&quot;ReceivedTime=2017-01-14T06:47:30.238Z&quot;,&quot;RemoteAddress=192.168.2.144&quot;,&quot;RemoteHost=192.168.2.144&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=527&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomp.strmdev00.org&quot;,&quot;user-agent=curl/7.29.0&quot;
</code></pre>
<ul>
<li>Running the curl post command in quick succession shows the loadbalancer working &hellip; four executions result in seeing our pair of logs appearing on alternate proxies.</li>
</ul>
<p><code>stroomp00</code>:</p>
<pre><code class="language-text">2017-01-14T06:52:09.815Z INFO  [ajp-apr-9009-exec-3] handler.LogRequestHandler (LogRequestHandler.java:37) - log() - guid=bf0bc38c-3533-4d5c-9ddf-5d30c0302787,feed=TEST-FEED-V1_0,system=EXAMPLE_SYSTEM,environment=EXAMPLE_ENVIRONMENT,remotehost=192.168.2.144,remoteaddress=192.168.2.144
2017-01-14T06:52:09.817Z INFO  [ajp-apr-9009-exec-3] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 262 ms to process (concurrentRequestCount=1) 200&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=bf0bc38c-3533-4d5c-9ddf-5d30c0302787&quot;,&quot;ReceivedTime=2017-01-14T06:52:09.555Z&quot;,&quot;RemoteAddress=192.168.2.144&quot;,&quot;RemoteHost=192.168.2.144&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=527&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomp.strmdev00.org&quot;,&quot;user-agent=curl/7.29.0&quot;
</code></pre>
<p><code>stroomp01</code>:</p>
<pre><code class="language-text">2017-01-14T06:52:11.139Z INFO  [ajp-apr-9009-exec-2] handler.LogRequestHandler (LogRequestHandler.java:37) - log() - guid=1088fdd8-6869-489f-8baf-948891363734,feed=TEST-FEED-V1_0,system=EXAMPLE_SYSTEM,environment=EXAMPLE_ENVIRONMENT,remotehost=192.168.2.144,remoteaddress=192.168.2.144
2017-01-14T06:52:11.150Z INFO  [ajp-apr-9009-exec-2] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 289 ms to process (concurrentRequestCount=1) 200&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=1088fdd8-6869-489f-8baf-948891363734&quot;,&quot;ReceivedTime=2017-01-14T06:52:10.861Z&quot;,&quot;RemoteAddress=192.168.2.144&quot;,&quot;RemoteHost=192.168.2.144&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=527&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomp.strmdev00.org&quot;,&quot;user-agent=curl/7.29.0&quot;
</code></pre>
<p><code>stroomp00</code>:</p>
<pre><code class="language-text">2017-01-14T06:52:12.284Z INFO  [ajp-apr-9009-exec-4] handler.LogRequestHandler (LogRequestHandler.java:37) - log() - guid=def94a4a-cf78-4c4d-9261-343663f7f79a,feed=TEST-FEED-V1_0,system=EXAMPLE_SYSTEM,environment=EXAMPLE_ENVIRONMENT,remotehost=192.168.2.144,remoteaddress=192.168.2.144
2017-01-14T06:52:12.289Z INFO  [ajp-apr-9009-exec-4] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 5.0 ms to process (concurrentRequestCount=1) 200&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=def94a4a-cf78-4c4d-9261-343663f7f79a&quot;,&quot;ReceivedTime=2017-01-14T06:52:12.284Z&quot;,&quot;RemoteAddress=192.168.2.144&quot;,&quot;RemoteHost=192.168.2.144&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=527&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomp.strmdev00.org&quot;,&quot;user-agent=curl/7.29.0&quot;
</code></pre>
<p><code>stroomp01</code>:</p>
<pre><code class="language-text">2017-01-14T06:52:13.374Z INFO  [ajp-apr-9009-exec-3] handler.LogRequestHandler (LogRequestHandler.java:37) - log() - guid=55dda4c9-2c76-43c8-9b48-dcdb3a1f459b,feed=TEST-FEED-V1_0,system=EXAMPLE_SYSTEM,environment=EXAMPLE_ENVIRONMENT,remotehost=192.168.2.144,remoteaddress=192.168.2.144
2017-01-14T06:52:13.378Z INFO  [ajp-apr-9009-exec-3] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 3.0 ms to process (concurrentRequestCount=1) 200&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=55dda4c9-2c76-43c8-9b48-dcdb3a1f459b&quot;,&quot;ReceivedTime=2017-01-14T06:52:13.374Z&quot;,&quot;RemoteAddress=192.168.2.144&quot;,&quot;RemoteHost=192.168.2.144&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=527&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomp.strmdev00.org&quot;,&quot;user-agent=curl/7.29.0&quot;
</code></pre>
<p>At this point we will see what the proxies have received.</p>
<ul>
<li>On each node run the command</li>
</ul>
<pre><code class="language-bash">ls -l /stroomdata/stroom-working*/proxy
</code></pre>
<p>On <code>stroomp00</code> we see</p>
<pre><code class="language-text">[stroomuser@stroomp00 ~]$ ls -l /stroomdata/stroom-working*/proxy
total 16
-rw-rw-r--. 1 stroomuser stroomuser 785 Jan 14 17:46 001.zip
-rw-rw-r--. 1 stroomuser stroomuser 783 Jan 14 17:47 002.zip
-rw-rw-r--. 1 stroomuser stroomuser 784 Jan 14 17:52 003.zip
-rw-rw-r--. 1 stroomuser stroomuser 783 Jan 14 17:52 004.zip
[stroomuser@stroomp00 ~]$
</code></pre>
<p>and on <code>stroomp01</code> we see</p>
<pre><code class="language-text">[stroomuser@stroomp01 ~]$ ls -l /stroomdata/stroom-working*/proxy
total 12
-rw-rw-r--. 1 stroomuser stroomuser 785 Jan 14 17:47 001.zip
-rw-rw-r--. 1 stroomuser stroomuser 783 Jan 14 17:52 002.zip
-rw-rw-r--. 1 stroomuser stroomuser 784 Jan 14 17:52 003.zip
[stroomuser@stroomp01 ~]$
</code></pre>
<p>which corresponds to the seven posts of data and the associated events in the proxy logs. To see the contents of one of these files we execute on either node, the command</p>
<pre><code class="language-bash">unzip -c /stroomdata/stroom-working*/proxy/001.zip
</code></pre>
<p>to see</p>
<pre><code class="language-text">Archive:  /stroomdata/stroom-working-p00/proxy/001.zip
  inflating: 001.dat
root:x:0:
bin:x:1:
daemon:x:2:
sys:x:3:
adm:x:4:
tty:x:5:
disk:x:6:
lp:x:7:
mem:x:8:
kmem:x:9:
wheel:x:10:burn
cdrom:x:11:
mail:x:12:postfix
man:x:15:
dialout:x:18:
floppy:x:19:
games:x:20:
tape:x:30:
video:x:39:
ftp:x:50:
lock:x:54:
audio:x:63:
nobody:x:99:
users:x:100:
utmp:x:22:
utempter:x:35:
input:x:999:
systemd-journal:x:190:
systemd-bus-proxy:x:998:
systemd-network:x:192:
dbus:x:81:
polkitd:x:997:
ssh_keys:x:996:
dip:x:40:
tss:x:59:
sshd:x:74:
postdrop:x:90:
postfix:x:89:
chrony:x:995:
burn:x:1000:burn
mysql:x:27:

  inflating: 001.meta
content-type:application/x-www-form-urlencoded
Environment:EXAMPLE_ENVIRONMENT
Feed:TEST-FEED-V1_0
GUID:54dc0da2-f35c-4dc2-8a98-448415ffc76b
host:stroomp.strmdev00.org
ReceivedTime:2017-01-14T06:46:05.883Z
RemoteAddress:192.168.2.144
RemoteHost:192.168.2.144
StreamSize:527
System:EXAMPLE_SYSTEM
user-agent:curl/7.29.0

[stroomuser@stroomp00 ~]$
</code></pre>
<p>Checking the /etc/group file on <code>stroomdb0.strmdev00.org</code> confirms the above contents. For the present, ignore
the metadata file present in the zip archive.</p>
<p>If you execute the same command on the other files, all that changes is the value of the <em>ReceivedTime:</em> attribute in the <code>.meta</code> file.</p>
<p>For those curious about the file size differences, this is a function of the compression process within the proxy.
Using <code>stroomp01</code>&rsquo;s files and extracting them manually and renaming them results in the six files</p>
<pre><code class="language-text">[stroomuser@stroomp01 xx]$ ls -l
total 24
-rw-rw-r--. 1 stroomuser stroomuser 527 Jan 14 17:47 A_001.dat
-rw-rw-r--. 1 stroomuser stroomuser 321 Jan 14 17:47 A_001.meta
-rw-rw-r--. 1 stroomuser stroomuser 527 Jan 14 17:52 B_001.dat
-rw-rw-r--. 1 stroomuser stroomuser 321 Jan 14 17:52 B_001.meta
-rw-rw-r--. 1 stroomuser stroomuser 527 Jan 14 17:52 C_001.dat
-rw-rw-r--. 1 stroomuser stroomuser 321 Jan 14 17:52 C_001.meta
[stroomuser@stroomp01 xx]$ cmp A_001.dat B_001.dat
[stroomuser@stroomp01 xx]$ cmp B_001.dat C_001.dat
[stroomuser@stroomp01 xx]$ 
</code></pre>
<p>We have effectively tested the receipt of our data and the load balancing of the Apache mod_jk installation.</p>
<h4 id="simple-direct-post-tests">Simple Direct Post tests</h4>
<p>In this test we will use the direct feed interface of the Stroom application, rather than sending data via the proxy.
One would normally use this interface for time sensitive data which shouldn&rsquo;t aggregate in a proxy waiting for
the Stroom application to collect it. In this situation we use the command</p>
<pre><code class="language-bash">curl -k --data-binary @/etc/group &quot;https://stroomp.strmdev00.org/stroom/datafeeddirect&quot; -H &quot;Feed:TEST-FEED-V1_0&quot; -H &quot;System:EXAMPLE_SYSTEM&quot; -H &quot;Environment:EXAMPLE_ENVIRONMENT&quot;
</code></pre>
<p>To prepare for this test, we monitor the Stroom application log using the <code>T</code> bash alias on each node. So on each node run the command</p>
<pre><code class="language-bash">sudo -i -u stroomuser
T
</code></pre>
<p>On each node you should see <em>LifecyleTask</em> events, for example,</p>
<pre><code class="language-text">2017-01-14T07:42:08.281Z INFO  [Stroom P2 #7 - LifecycleTask] spring.StroomBeanMethodExecutable (StroomBeanMethodExecutable.java:47) - Executing nodeStatusExecutor.exec
2017-01-14T07:42:18.284Z INFO  [Stroom P2 #2 - LifecycleTask] spring.StroomBeanMethodExecutable (StroomBeanMethodExecutable.java:47) - Executing SQLStatisticEventStore.evict
2017-01-14T07:42:18.284Z INFO  [Stroom P2 #10 - LifecycleTask] spring.StroomBeanMethodExecutable (StroomBeanMethodExecutable.java:47) - Executing activeQueriesManager.evictExpiredElements
2017-01-14T07:42:18.285Z INFO  [Stroom P2 #7 - LifecycleTask] spring.StroomBeanMethodExecutable (StroomBeanMethodExecutable.java:47) - Executing distributedTaskFetcher.execute
</code></pre>
<p>To perform the test, on the database node, run the posting command a number of times in rapid succession. This will result
in  <em>server.DataFeedServiceImpl</em> events in both log files. The Stroom application log is quite busy, you may have to look for these logs.</p>
<p>In the following we needed to execute the posting command three times before seeing the data arrive on both nodes. Looking at the arrival
times, the file turned up on the second node twice before appearing on the first node.
<code>strooomp00:</code></p>
<pre><code class="language-text">2017-01-14T07:43:09.394Z INFO  [ajp-apr-8009-exec-6] server.DataFeedServiceImpl (DataFeedServiceImpl.java:133) - handleRequest response 200 - 0 - OK
</code></pre>
<p>and on <code>stroomp01:</code></p>
<pre><code class="language-text">2017-01-14T07:43:05.614Z INFO  [ajp-apr-8009-exec-1] server.DataFeedServiceImpl (DataFeedServiceImpl.java:133) - handleRequest response 200 - 0 - OK
2017-01-14T07:43:06.821Z INFO  [ajp-apr-8009-exec-2] server.DataFeedServiceImpl (DataFeedServiceImpl.java:133) - handleRequest response 200 - 0 - OK
</code></pre>
<p>To confirm this data arrived, we need to view the <strong>Data</strong> pane of our <code>TEST-FEED-V1_0</code> tab. To do this, log onto the Stroom UI then
move the cursor to the <code>TEST-FEED-V1_0</code> entry in the <code>Explorer</code> tab and select the item with a left click</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-TestDirectFeed-00.png" href="../../../images/HOWTOs/UI-TestDirectFeed-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-TestDirectFeed-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-TestDirectFeed-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Test Feed - Open Feed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and double click on the entry to see our <code>TEST-FEED-V1_0</code> tab.</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-TestDirectFeed-01.png" href="../../../images/HOWTOs/UI-TestDirectFeed-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-TestDirectFeed-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-TestDirectFeed-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Test Feed - Opened Feed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

and it is noted that we are viewing the Feed&rsquo;s attributes as we can see the <strong>Setting</strong> hyper-link highlighted.
As we want to see the Data we have received for this feed, move the cursor to the <strong>Data</strong> hyper-link and select it to see







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-TestDirectFeed-02.png" href="../../../images/HOWTOs/UI-TestDirectFeed-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-TestDirectFeed-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-TestDirectFeed-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Test Feed - Opened Feed view Data</figcaption>
      </div>
      
    </figure>
  </a>
</div>
.</p>
<p>These three entries correspond to the three posts we performed.</p>
<p>We have successfully tested direct posting to a Stroom feed and that the Apache mod_jk loadbalancer also works for this posting method.</p>
<h4 id="test-proxy-aggregation-is-working">Test Proxy Aggregation is Working</h4>
<p>To test that the Proxy Aggregation is working,
we need to <a href="../../../docs/howtos/general/taskshowto/#turn-on-proxy-aggregation">enable</a> on each node.</p>
<p>By enabling the Proxy Aggregation process, both nodes immediately performed the task as indicated by each node&rsquo;s Stroom application logs as per
<code>stroomp00:</code></p>
<pre><code class="language-text">2017-01-14T07:58:58.752Z INFO  [Stroom P2 #3 - LifecycleTask] server.ProxyAggregationExecutor (ProxyAggregationExecutor.java:138) - exec() - started
2017-01-14T07:58:58.937Z INFO  [Stroom P2 #2 - GenericServerTask] server.ProxyAggregationExecutor$2 (ProxyAggregationExecutor.java:203) - processFeedFiles() - Started TEST-FEED-V1_0 (4 Files)
2017-01-14T07:58:59.045Z INFO  [Stroom P2 #2 - GenericServerTask] server.ProxyAggregationExecutor$2 (ProxyAggregationExecutor.java:265) - processFeedFiles() - Completed TEST-FEED-V1_0 in 108 ms
2017-01-14T07:58:59.101Z INFO  [Stroom P2 #3 - LifecycleTask] server.ProxyAggregationExecutor (ProxyAggregationExecutor.java:152) - exec() - completedin 349 ms
</code></pre>
<p>and <code>stroomp01:</code></p>
<pre><code class="language-text">2017-01-14T07:59:16.687Z INFO  [Stroom P2 #10 - LifecycleTask] server.ProxyAggregationExecutor (ProxyAggregationExecutor.java:138) - exec() - started
2017-01-14T07:59:16.799Z INFO  [Stroom P2 #5 - GenericServerTask] server.ProxyAggregationExecutor$2 (ProxyAggregationExecutor.java:203) - processFeedFiles() - Started TEST-FEED-V1_0 (3 Files)
2017-01-14T07:59:16.909Z INFO  [Stroom P2 #5 - GenericServerTask] server.ProxyAggregationExecutor$2 (ProxyAggregationExecutor.java:265) - processFeedFiles() - Completed TEST-FEED-V1_0 in 110 ms
2017-01-14T07:59:16.997Z INFO  [Stroom P2 #10 - LifecycleTask] server.ProxyAggregationExecutor (ProxyAggregationExecutor.java:152) - exec() - completed in 310 ms
</code></pre>
<p>And on refreshing the top pane of the <code>TEST-FEED-V1_0</code> tab we see that two more <em>batches</em> of data have arrived.</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-TestProxyAggregation-01.png" href="../../../images/HOWTOs/UI-TestProxyAggregation-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-TestProxyAggregation-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-TestProxyAggregation-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Test Feed - Proxy Aggregated data arrival</figcaption>
      </div>
      
    </figure>
  </a>
</div>
.</p>
<p>This demonstrates that Proxy Aggregation is working.</p>
<h2 id="stroom-forwarding-proxy-testing">Stroom Forwarding Proxy Testing</h2>
<h3 id="data-post-tests-1">Data Post Tests</h3>
<h4 id="simple-post-tests-1">Simple Post tests</h4>
<p>This test is to ensure the Stroom <em>Forwarding</em> proxy and it&rsquo;s connection to the central Stroom Processing system is working.</p>
<p>We will send a file to our <em>Forwarding</em> proxy (<code>stroomfp0.strmdev00.org</code>) and monitor this nodes&rsquo; proxy log files as well as all the
destination nodes proxy log files. The reason for monitoring all the destination system&rsquo;s proxy log files is that the destination system is
probably load balancing and hence the forwarded file may turn up on any of the destination nodes.</p>
<p>Perform the following</p>
<ul>
<li>Log onto any host where you will perform the <code>curl</code> post</li>
<li>Monitor all proxy log files</li>
<li>Log onto the Forwarding Proxy node and become the <code>stroomuser</code> and monitor the Stroom proxy service using the <code>Tp</code> bash macro.</li>
<li>Log onto the destination Stroom nodes and become the <code>stroomuser</code> and monitor each node&rsquo;s Stroom proxy service using the <code>Tp</code> bash macro. That is, on each node, run</li>
</ul>
<pre><code class="language-bash">sudo -i -u stroomuser
Tp
</code></pre>
<ul>
<li>On the &lsquo;posting&rsquo; node, run the command</li>
</ul>
<pre><code class="language-bash">curl -k --data-binary @/etc/group &quot;https://stroomfp0.strmdev00.org/stroom/datafeed&quot; -H &quot;Feed:TEST-FEED-V1_0&quot; -H &quot;System:EXAMPLE_SYSTEM&quot; -H &quot;Environment:EXAMPLE_ENVIRONMENT&quot;
</code></pre>
<p>In the Stroom Forwarding proxy log, <code>~/stroom-proxy/instance/logs/stroom.log</code>, you will see the arrival of the
file as per the <em>datafeed.DataFeedRequestHandler$1</em> event running under, in this case, the <em>ajp-apr-9009-exec-1</em> thread.</p>
<pre><code class="language-text">...
2017-01-01T23:17:00.240Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-01T23:17:00.240Z
2017-01-01T23:18:00.275Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-01T23:18:00.275Z
2017-01-01T23:18:12.367Z INFO  [ajp-apr-9009-exec-1] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 782 ms to process (concurrentRequestCount=1) 200&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Expect=100-continue&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=9601198e-98db-4cae-8b71-9404722ef1f9&quot;,&quot;ReceivedTime=2017-01-01T23:18:11.588Z&quot;,&quot;RemoteAddress=192.168.2.220&quot;,&quot;RemoteHost=192.168.2.220&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=1051&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomfp0.strmdev00.org&quot;,&quot;user-agent=curl/7.19.7 (x86_64-redhat-linux-gnu) libcurl/7.19.7 NSS/3.21 Basic ECC zlib/1.2.3 libidn/1.18 libssh2/1.4.2&quot;
</code></pre>
<p>And then at the next
periodic interval (60 second intervals) this file will be forwarded to the main stroom proxy
server <code>stroomp.strmdev00.org</code> as shown by the <em>handler.ForwardRequestHandler</em> events running under the <em>pool-10-thread-2</em> thread.</p>
<pre><code class="language-text">2017-01-01T23:19:00.304Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-01T23:19:00.304Z
2017-01-01T23:19:00.586Z INFO  [pool-10-thread-2] handler.ForwardRequestHandler (ForwardRequestHandler.java:109) - handleHeader() - https://stroomp00.strmdev00.org/stroom/datafeed Sending request {ReceivedPath=stroomfp0.strmdev00.org, Feed=TEST-FEED-V1_0, Compression=ZIP}
2017-01-01T23:19:00.990Z INFO  [pool-10-thread-2] handler.ForwardRequestHandler (ForwardRequestHandler.java:89) - handleFooter() - b5722ead-714b-411b-a09f-901fb8b20389 took 403 ms to forward 1.4 kB response 200 - {ReceivedPath=stroomfp0.strmdev00.org, Feed=TEST-FEED-V1_0, GUID=b5722ead-714b-411b-a09f-901fb8b20389, Compression=ZIP}
2017-01-01T23:20:00.064Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-01T23:20:00.064Z
...
</code></pre>
<p>On one of the central processing nodes, when the file is send by the Forwarding Proxy, you will see the file&rsquo;s arrival as per
the <em>datafeed.DataFeedRequestHandler$1</em> event in the <em>ajp-apr-9009-exec-3</em> thread.</p>
<pre><code class="language-text">...
2017-01-01T23:00:00.236Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-01T23:00:00.236Z
2017-01-01T23:10:00.473Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-01T23:10:00.473Z
2017-01-01T23:19:00.787Z INFO  [ajp-apr-9009-exec-3] handler.LogRequestHandler (LogRequestHandler.java:37) - log() - guid=b5722ead-714b-411b-a09f-901fb8b20389,feed=TEST-FEED-V1_0,system=null,environment=null,remotehost=null,remoteaddress=null
2017-01-01T23:19:00.981Z INFO  [ajp-apr-9009-exec-3] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 196 ms to process (concurrentRequestCount=1) 200&quot;,&quot;Cache-Control=no-cache&quot;,&quot;Compression=ZIP&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=b5722ead-714b-411b-a09f-901fb8b20389&quot;,&quot;ReceivedPath=stroomfp0.strmdev00.org&quot;,&quot;Transfer-Encoding=chunked&quot;,&quot;accept=text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2&quot;,&quot;connection=keep-alive&quot;,&quot;content-type=application/audit&quot;,&quot;host=stroomp00.strmdev00.org&quot;,&quot;pragma=no-cache&quot;,&quot;user-agent=Java/1.8.0_111&quot;
2017-01-01T23:20:00.771Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-01T23:20:00.771Z
...
</code></pre>
<h2 id="stroom-standalone-proxy-testing">Stroom Standalone Proxy Testing</h2>
<h3 id="data-post-tests-2">Data Post Tests</h3>
<h4 id="simple-post-tests-2">Simple Post tests</h4>
<p>This test is to ensure the Stroom <em>Store NODB</em> or <em>Standalone</em> proxy is working.</p>
<p>We will send a file to our <em>Standalone</em> proxy (<code>stroomsap0.strmdev00.org</code>) and monitor this nodes&rsquo; proxy log files as well the directory the
received files are meant to be stored in.</p>
<p>Perform the following</p>
<ul>
<li>Log onto any host where you will perform the <code>curl</code> post</li>
<li>Log onto the Standalone Proxy node and become the <code>stroomuser</code> and monitor the Stroom proxy service using the <code>Tp</code> bash macro. That is run</li>
</ul>
<pre><code class="language-bash">sudo -i -u stroomuser
Tp
</code></pre>
<ul>
<li>On the &lsquo;posting&rsquo; node, run the command</li>
</ul>
<pre><code class="language-bash">curl -k --data-binary @/etc/group &quot;https://stroomsap0.strmdev00.org/stroom/datafeed&quot; -H &quot;Feed:TEST-FEED-V1_0&quot; -H &quot;System:EXAMPLE_SYSTEM&quot; -H &quot;Environment:EXAMPLE_ENVIRONMENT&quot;
</code></pre>
<p>In the stroom proxy log, <code>~/stroom-proxy/instance/logs/stroom.log</code>, you will see the arrival of the file via both the <em>handler.LogRequestHandler</em> and  <em>datafeed.DataFeedRequestHandler$1</em> events running under, in this case, the <em>ajp-apr-9009-exec-1</em> thread.</p>
<pre><code class="language-text">...
2017-01-02T02:10:00.325Z INFO  [Repository Reader Thread 1] handler.ProxyRepositoryReader (ProxyRepositoryReader.java:143) - run() - Cron Match at 2017-01-02T02:10:00.325Z
2017-01-02T02:11:34.501Z INFO  [ajp-apr-9009-exec-1] handler.LogRequestHandler (LogRequestHandler.java:37) - log() - guid=ebd11215-7d4c-4be6-a524-358015e2ac38,feed=TEST-FEED-V1_0,system=EXAMPLE_SYSTEM,environment=EXAMPLE_ENVIRONMENT,remotehost=192.168.2.220,remoteaddress=192.168.2.220
2017-01-02T02:11:34.528Z INFO  [ajp-apr-9009-exec-1] datafeed.DataFeedRequestHandler$1 (DataFeedRequestHandler.java:104) - &quot;doPost() - Took 33 ms to process (concurrentRequestCount=1) 200&quot;,&quot;Environment=EXAMPLE_ENVIRONMENT&quot;,&quot;Expect=100-continue&quot;,&quot;Feed=TEST-FEED-V1_0&quot;,&quot;GUID=ebd11215-7d4c-4be6-a524-358015e2ac38&quot;,&quot;ReceivedTime=2017-01-02T02:11:34.501Z&quot;,&quot;RemoteAddress=192.168.2.220&quot;,&quot;RemoteHost=192.168.2.220&quot;,&quot;System=EXAMPLE_SYSTEM&quot;,&quot;accept=*/*&quot;,&quot;content-length=1051&quot;,&quot;content-type=application/x-www-form-urlencoded&quot;,&quot;host=stroomsap0.strmdev00.org&quot;,&quot;user-agent=curl/7.19.7 (x86_64-redhat-linux-gnu) libcurl/7.19.7 NSS/3.21 Basic ECC zlib/1.2.3 libidn/1.18 libssh2/1.4.2&quot;
...
</code></pre>
<p>Further, if you check the proxy&rsquo;s storage directory, you will see the file <code>001.zip</code>. The file names number upwards from 001.</p>
<pre><code class="language-bash">ls -l /stroomdata/stroom-working-sap0/proxy
</code></pre>
<p>shows</p>
<pre><code class="language-text">[stroomuser@stroomsap0 ~]$ ls -l /stroomdata/stroom-working-sap0/proxy
total 4
-rw-rw-r--. 1 stroomuser stroomuser 1107 Jan  2 13:11 001.zip
[stroomuser@stroomsap0 ~]$ 
</code></pre>
<p>On viewing the contents of this file we see both a <code>.dat</code> and <code>.meta</code> file.</p>
<pre><code class="language-text">[stroomuser@stroomsap0 ~]$ (cd /stroomdata/stroom-working-sap0/proxy; unzip 001.zip)
Archive:  001.zip
  inflating: 001.dat                 
  inflating: 001.meta                
[stroomuser@stroomsap0 ~]$
</code></pre>
<p>The <code>.dat</code> file holds the content of the file we posted - <code>/etc/group</code>.</p>
<pre><code class="language-text">[stroomuser@stroomsap0 ~]$ (cd /stroomdata/stroom-working-sap0/proxy; head -5 001.dat)
root:x:0:
bin:x:1:bin,daemon
daemon:x:2:bin,daemon
sys:x:3:bin,adm
adm:x:4:adm,daemon
[stroomuser@stroomsap0 ~]$ 
</code></pre>
<p>The <code>.meta</code> file is generated by the proxy and holds information about the posted file</p>
<pre><code class="language-text">[stroomuser@stroomsap0 ~]$ (cd /stroomdata/stroom-working-sap0/proxy; cat 001.meta)
content-type:application/x-www-form-urlencoded
Environment:EXAMPLE_ENVIRONMENT
Feed:TEST-FEED-V1_0
GUID:ebd11215-7d4c-4be6-a524-358015e2ac38
host:stroomsap0.strmdev00.org
ReceivedTime:2017-01-02T02:11:34.501Z
RemoteAddress:192.168.2.220
RemoteHost:192.168.2.220
StreamSize:1051
System:EXAMPLE_SYSTEM
user-agent:curl/7.19.7 (x86_64-redhat-linux-gnu) libcurl/7.19.7 NSS/3.21 Basic ECC zlib/1.2.3 libidn/1.18 libssh2/1.4.2
[stroomuser@stroomsap0 ~]$ (cd /stroomdata/stroom-working-sap0/proxy; rm 001.meta 001.dat)
[stroomuser@stroomsap0 ~]$ 
</code></pre>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '4.11.'; page-break-before: always">
    
  <h1 id="pg-2ef6500b50bd5b10b788f5f28d20bfbe">4.11 - Volume Maintenance</h1>
    <div class="lead">How to maintain Stroom&rsquo;s data and index volumes.</div>
	<p>Stroom stores data in <a href="../../../docs/user-guide/volumes/">volumes</a>.
These are the logical link to the Storage hierarchy we setup on the operating system.
This HOWTO will demonstrate how one first sets up volumes and also how to add additional volumes if one expanded an existing Stroom cluster.</p>
<h2 id="assumptions">Assumptions</h2>
<ul>
<li>an account with the <code>Administrator</code> Application <a href="../../../docs/user-guide/roles/">Permission</a> is currently logged in.</li>
<li>we will add volumes as per the Multi Node Stroom deployment Storage hierarchy</li>
</ul>
<h2 id="configure-the-volumes">Configure the Volumes</h2>
<p>We need to configure the volumes for Stroom. The follow demonstrates adding the volumes for two nodes, but demonstrates the process for a single node
deployment as well the volume maintenance needed when expanding a Multi Node Cluster when adding in a new node.</p>
<p>To configure the volumes, move to the <code>Tools</code> item of the <strong>Main Menu</strong> and select it to bring up the <code>Tools</code> sub-menu.







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ToolsSubmenu-00.png" href="../../../images/HOWTOs/UI-ToolsSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ToolsSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ToolsSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Tools sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
<p>then move down and select the <code>Volumes</code> sub-item to be presented with the <code>Volumes</code> configuration window as seen below.







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-01.png" href="../../../images/HOWTOs/UI-ManageVolumes-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Volumes - configuration window</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
<p>The attributes we see for each volume are</p>
<ul>
<li>Node - the processing node the volume resides on (this is just the node name entered when configuration the Stroom application)</li>
<li>Path - the path to the volume</li>
<li>Volume Type - The type of volume</li>
<li>Public - to indicate that all nodes would access this volume</li>
<li>Private - to indicate that only the local node will access this volume</li>
<li>Stream Status</li>
<li>Active - to store data within the volume</li>
<li>Inactive - to <strong>NOT</strong> store data within the volume</li>
<li>Closed - had stored data within the volume, but now no more data can be stored</li>
<li>Index Status</li>
<li>Active - to store index data within the volume</li>
<li>Inactive - to <strong>NOT</strong> store index data within the volume</li>
<li>Closed - had stored index data within the volume, but now no more index data can be stored</li>
<li>Usage Date - the date and time the volume was last used</li>
<li>Limit - the maximum amount of data the system will store on the volume</li>
<li>Used - the amount of data in use on the volume</li>
<li>Free - the amount of available storage on the volume</li>
<li>Use% - the usage percentage</li>
</ul>
<p>If you are setting up Stroom for the first time and you had accepted the default for the <strong>CREATE_DEFAULT_VOLUME_ON_START</strong> configuration option (<em>true</em>) when
configuring the Stroom service application, you will see two default volumes have already been created. Had you set this option to <em>false</em> then the window would be empty.</p>
<h4 id="add-volumes">Add Volumes</h4>
<p>Now from our two node Stroom Cluster example, our storage hierarchy was</p>
<ul>
<li>Node: <code>stroomp00.strmdev00.org</code></li>
<li><code>/stroomdata/stroom-data-p00</code>        - location to store Stroom application data files (events, etc.) for this node</li>
<li><code>/stroomdata/stroom-index-p00</code>       - location to store Stroom application index files</li>
<li><code>/stroomdata/stroom-working-p00</code>     - location to store Stroom application working files (e.g. temporary files, output, etc.) for this node</li>
<li><code>/stroomdata/stroom-working-p00/proxy</code>       - location for Stroom proxy to store inbound data files</li>
<li>Node: <code>stroomp01.strmdev00.org</code></li>
<li><code>/stroomdata/stroom-data-p01</code>        - location to store Stroom application data files (events, etc.) for this node</li>
<li><code>/stroomdata/stroom-index-p01</code>       - location to store Stroom application index files</li>
<li><code>/stroomdata/stroom-working-p01</code>     - location to store Stroom application working files (e.g. temporary files, output, etc.) for this node</li>
<li><code>/stroomdata/stroom-working-p01/proxy</code>       - location for Stroom proxy to store inbound data files</li>
</ul>
<p>From this we need to create four volumes. On <code>stroomp00.strmdev00.org</code> we create</p>
<ul>
<li><code>/stroomdata/stroom-data-p00</code>        - location to store Stroom application data files (events, etc.) for this node</li>
<li><code>/stroomdata/stroom-index-p00</code>       - location to store Stroom application index files</li>
</ul>
<p>and on <code>stroomp01.strmdev00.org</code> we create</p>
<ul>
<li><code>/stroomdata/stroom-data-p01</code>        - location to store Stroom application data files (events, etc.) for this node</li>
<li><code>/stroomdata/stroom-index-p01</code>       - location to store Stroom application index files</li>
</ul>
<p>So the first step to configure a volume is to move the cursor to the <em>New</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add" 
    alt="add.svg">


 in the top left of
the <code>Volumes</code> window and select it. This will bring up the <code>Add Volume</code> configuration window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-02.png" href="../../../images/HOWTOs/UI-ManageVolumes-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Add Volume - Volume configuration window</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As you can see, the entry box titles reflect the attributes of a volume. So we will add the first
nodes <em>data</em> volume</p>
<ul>
<li><code>/stroomdata/stroom-data-p00</code>        - location to store Stroom application data files (events, etc.) for this node
for node <code>stroomp00</code>.</li>
</ul>
<p>If you move the the <em>Node</em> drop down entry box and select it you will be presented with a choice of available
nodes - in this case <code>stroomp00</code> and <code>stroomp01</code> as we have a two node cluster with these node names.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-03.png" href="../../../images/HOWTOs/UI-ManageVolumes-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-03.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Add Volume - select node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>By selecting the node <code>stroomp00</code> we see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-04.png" href="../../../images/HOWTOs/UI-ManageVolumes-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-04.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Add Volume - selected node</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>To configure the rest of the attributes for this volume, we:</p>
<ul>
<li>enter the <em>Path</em> to our first node&rsquo;s <em>data</em> volume</li>
<li>select a <em>Volume Type</em> of <em>Public</em> as this is a data volume we want all nodes to access</li>
<li>select a <em>Stream Status</em> of <em>Active</em> to indicate we want to store data on it</li>
<li>select an <em>Index Status</em> of <em>Inactive</em> as we do <strong>NOT</strong> want index data stored on it</li>
<li>set a <em>Limit</em> of 12GB for allowed storage</li>
</ul>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-05.png" href="../../../images/HOWTOs/UI-ManageVolumes-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-05.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Add Volume - adding first data volume</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and on selection of the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 we see the changes in the <code>Volumes</code> configuration window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-06.png" href="../../../images/HOWTOs/UI-ManageVolumes-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-06.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Add Volume - added first data volume</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We next add the first node&rsquo;s index volume, as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-07.png" href="../../../images/HOWTOs/UI-ManageVolumes-07.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-07.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-07.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Add Volume - adding first index volume</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>And after adding the second node&rsquo;s volumes we are finally presented with our configured volumes</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-08.png" href="../../../images/HOWTOs/UI-ManageVolumes-08.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-08.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-08.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Add Volume - all volumes added</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h4 id="delete-default-volumes">Delete Default Volumes</h4>
<p>We now need to deal with our default volumes. We want to delete them.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-09.png" href="../../../images/HOWTOs/UI-ManageVolumes-09.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-09.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-09.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Delete Default - display default</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>So we move the cursor to the first volume&rsquo;s line (<em>stroomp00 /home/stroomuser/stroom-app/volumes/defaultindexVolume</em> &hellip;) and select the line then move the cursor to the  <em>Delete</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/delete.svg" 
    title="Delete" 
    alt="delete.svg">


 in the top left of the <code>Volumes</code> window and select it. On selection you will be given a confirmation request</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-10.png" href="../../../images/HOWTOs/UI-ManageVolumes-10.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-10.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-10.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Delete Default - confirm deletion</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>at which we press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button to see the first default volume has been deleted</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-11.png" href="../../../images/HOWTOs/UI-ManageVolumes-11.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-11.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-11.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Delete Default - first volume deleted</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and after we select then delete the second default volume( <em>stroomp00 /home/stroomuser/stroom-app/volumes/defaultStreamVolume</em> &hellip;), we are left with</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageVolumes-12.png" href="../../../images/HOWTOs/UI-ManageVolumes-12.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageVolumes-12.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageVolumes-12.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Delete Default - all deleted</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this one can close the <code>Volumes</code> configuration window by pressing the 



<span class="stroom-button" title="Close button" >
  <span class="stroom-button-text">Close</span>
</span>
 button.</p>
<p><strong>NOTE</strong>: At the time of writing there is an issue regarding volumes</p>
<h5 id="stroom-github-issue-84---">Stroom Github Issue 84  -</h5>
<p>Due to 






  

<span class="external-link">
  <a href="https://github.com/gchq/stroom/issues/84" target="_blank" class="" style="" title="Issue 84 (external link)">
    <span>Issue 84</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
, if we delete volumes in a multi node environment, the deletion is not propagated to all other nodes in a cluster.
Thus if we attempted to use the volumes we would get a database error.
The current <em>workaround</em> is to restart all the Stroom applications which will cause a reload of all volume information.
This <strong>MUST</strong> be done before sending any data to your multi-node Stroom cluster.</p>
<h2 id="adding-new-volumes">Adding new Volumes</h2>
<p>When one expands a Multi Node Stroom cluster deployment, after the installation of the Stroom Proxy and Application software and services on the new node,
one has to configure the new volumes that are on the new node. The following demonstrates this assuming we are adding</p>
<ul>
<li>the new node is <code>stroomp02</code></li>
<li>the storage hierarchy for this node is</li>
<li><code>/stroomdata/stroom-data-p02</code>        - location to store Stroom application data files (events, etc.) for this node</li>
<li><code>/stroomdata/stroom-index-p02</code>       - location to store Stroom application index files</li>
<li><code>/stroomdata/stroom-working-p02</code>     - location to store Stroom application working files (e.g. tmp, output, etc.) for this node</li>
<li><code>/stroomdata/stroom-working-p02/proxy</code>       - location for Stroom proxy to store inbound data files</li>
</ul>
<p>From this we need to create two volumes on <code>stroomp02</code></p>
<ul>
<li><code>/stroomdata/stroom-data-p02</code>        - location to store Stroom application data files (events, etc.) for this node</li>
<li><code>/stroomdata/stroom-index-p02</code>       - location to store Stroom application index files</li>
</ul>
<p>To configure the volumes, move to the <code>Tools</code> item of the <strong>Main Menu</strong> and select it to bring up the <code>Tools</code> sub-menu.







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ToolsSubmenu-00.png" href="../../../images/HOWTOs/UI-ToolsSubmenu-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ToolsSubmenu-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ToolsSubmenu-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Tools sub-menu</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
<p>then move down and select the <code>Volumes</code> sub-item to be presented with the <code>Volumes</code> configuration window as.
We then move the cursor to the <em>New</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add" 
    alt="add.svg">



in the top left of the <code>Volumes</code> window and select it.
This will bring up the <code>Add Volume</code> configuration window where we select our volume&rsquo;s node <code>stroomp02</code>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageNewVolume-00.png" href="../../../images/HOWTOs/UI-ManageNewVolume-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageNewVolume-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageNewVolume-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Volumes - New Node configuration window start data volume</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We select this node and then configure the rest of the attributes for this <em>data</em> volume</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageNewVolume-01.png" href="../../../images/HOWTOs/UI-ManageNewVolume-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageNewVolume-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageNewVolume-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Volumes - New Node configuration window data volume</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press the 



<span class="stroom-button" title="title button" >
  <span class="stroom-button-text">title</span>
</span>
 button.</p>
<p>We then add another volume for the <em>index</em> volume for this node with attributes as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageNewVolume-02.png" href="../../../images/HOWTOs/UI-ManageNewVolume-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageNewVolume-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageNewVolume-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Volumes - New Node configuration window index volume added</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>And on pressing the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button we see our two new volumes for this node have been added.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-ManageNewVolume-03.png" href="../../../images/HOWTOs/UI-ManageNewVolume-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-ManageNewVolume-03.png" style="max-width: fit-content" alt="images/HOWTOs/UI-ManageNewVolume-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Volumes - New Node configuration window volumes added</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this one can close the <code>Volumes</code> configuration window by pressing the 



<span class="stroom-button" title="Close button" >
  <span class="stroom-button-text">Close</span>
</span>
 button.</p>

</div>




    
	
  

    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '5.'; page-break-before: always">
    
  <h1 id="pg-e7fffeb5cb3e8aec39005a5ceae1fc8b">5 - Event Feeds</h1>
    
	
</div>




    
      
  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '5.1.'; ">
    
  <h1 id="pg-5fc7c4e24c9ba560fe48c8b7d7bd2717">5.1 - Writing an XSLT Translation</h1>
    <div class="lead">This HOWTO will take you through the production of an XSLT for a feed, including issues such as event filtering, common errors and testing.</div>
	<!-- Created with Stroom v6.1-beta.16 -->

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">See Also</h4>


    <p><a href="../../../docs/howtos/eventfeeds/processinghowto/">HOWTO - Event Processing</a></p>


</div>


<h2 id="introduction">Introduction</h2>
<p>This document is intended to explain how and why to produce a translation within stroom and how the translation fits into the overall processing within stroom.
It is intended for use by the developers/admins of client systems that want to send data to stroom and need to transform their events into event-logging XML format.
It&rsquo;s not intended as an XSLT tutorial so a basic XSLT knowledge must be assumed.
The document will contain potentially useful XSLT fragments to show how certain processing activities can be carried out.
As with most programming languages, there are likely to be multiple ways of producing the same end result with different degrees of complexity and efficiency.
Examples here may not be the best for all situations but do reflect experience built up from many previous translation jobs.</p>
<p>The document should be read in conjunction with other online stroom documentation, in particular <a href="../../../docs/howtos/eventfeeds/processinghowto/">Event Processing</a>.</p>
<h2 id="translation-overview">Translation Overview</h2>
<p>The translation process for raw logs is a multi-stage process defined by the processing pipeline:</p>
<h3 id="parser">Parser</h3>
<p>The parser takes raw data and converts it into an intermediate XML document format.
This is only required if source data is not already within an XML document.
There are various standard parsers available (although not all may be available on a default stroom build) to cover the majority of standard source formats such as CSV, TSV, CSV with header row and XML fragments.</p>
<p>The language used within the parser is defined within an XML schema located at <code>XML Schemas / data-splitter / data-splitter v3.0</code> within the tree browser.
The data splitter schema may have been provided as part of the core schemas content pack.
It is not present in a vanilla stroom.
The language can be quite complex so if non-standard format logs are being parsed, it may be worth speaking to your stroom sysadmin team to at least get an initial parser configured for your data.</p>
<p>Stroom also has a built-in parser for JSON fragments.
This can be set either by using the 








  
  








<span class="pipeline-element" title="combinedParser" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/text.svg" 
    title="combinedParser" 
    alt="text.svg">
  <span>combinedParser</span>
</span>
 and setting the <code>type</code> property to JSON or preferably by just using the 








  
  








<span class="pipeline-element" title="jsonParser" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/json.svg" 
    title="jsonParser" 
    alt="json.svg">
  <span>jsonParser</span>
</span>
.</p>
<p>The parser has several minor limitations.
The most significant is that it&rsquo;s unable to deal with records that are interleaved.
This occasionally happens within multi-line syslog records where a syslog server receives the first x lines of record A followed by the first y lines of record B, then the rest of record A and finally the rest of record B (or the start of record C etc).
If data is likely to arrive like this then some sort of pre-processing within the source system would be necessary to ensure that each record is a contiguous block before being forwarded to stroom.</p>
<p>The other main limitation of the parser is actually its flexibility.
If forwarding large streams to stroom and one or more regexes within the parser have been written inefficiently or incorrectly then it&rsquo;s quite possible for the parser to try to read the entire stream in one go rather than a single record or part of a record.
This will slow down the overall processing and may even cause memory issues in the worst cases.
This is one of the reasons why the stroom team would prefer to be involved in the production of any non-standard parsers as mentioned above.</p>
<h3 id="xslt">XSLT</h3>
<p>The actual translation takes the XML document produced by the parser and converts it to a new XML document format in what&rsquo;s known as &ldquo;stroom schema format&rdquo;.
The current latest schema is documented at <code>XML Schemas / event-logging / event-logging v3.5.2</code> within the tree browser.
The version is likely to change over time so you should aim to use the latest non-beta version.</p>
<h3 id="other-pipeline-elements">Other Pipeline Elements</h3>
<p>The pipeline functionality is flexible in that multiple XSLTs may be used in sequence to add decoration (e.g. Job Title, Grade, Employee type etc. from an HR reference database), schema validation and other business-related tasks.
However, this is outside the scope of this document and pipelines should not be altered unless agreed with the stroom sysadmins.
As an example, we&rsquo;ve seen instances of people removing schema validation tasks from a pipeline so that processing appears to occur without error.
In practice, this just breaks things further down the processing chain.</p>
<h2 id="translation-basics">Translation Basics</h2>
<p>Assuming you have a simple pipeline containing a working parser and an empty XSLT, the output of the parser will look something like this:</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;records
    xmlns=&quot;records:2&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;records:2 file://records-v2.0.xsd&quot;
    version=&quot;2.0&quot;&gt;
  &lt;record&gt;
    &lt;data value=&quot;2022-04-06 15:45:38.737&quot; /&gt;
    &lt;data value=&quot;fakeuser2&quot; /&gt;
    &lt;data value=&quot;192.168.0.1&quot; /&gt;
    &lt;data value=&quot;1000011&quot; /&gt;
    &lt;data value=&quot;200&quot; /&gt;
    &lt;data value=&quot;Query success&quot; /&gt;
    &lt;data value=&quot;1&quot; /&gt;
  &lt;/record&gt;
&lt;/records&gt;
</code></pre>
<p>The data nodes within the <strong>record</strong> node will differ as it&rsquo;s possible to have nested data nodes as well as named data nodes, but for a non-JSON and non-XML fragment source data format, the top-level structure will be similar.</p>
<p>The XSLT needed to recognise and start processing the above example data needs to do several things.
The following initial XSLT provides the minimum required function:</p>









  







  
  


<div class="code-block code-toolbar">
  <pre 
     class="line-numbers language-xml" 
     
     data-start="1"  ><code class="language-xml">&lt;?xml version=&#34;1.1&#34; encoding=&#34;UTF-8&#34; ?&gt;
&lt;xsl:stylesheet
    xpath-default-namespace=&#34;records:2&#34; 
    xmlns=&#34;event-logging:3&#34; 
    xmlns:stroom=&#34;stroom&#34;
    xmlns:xsl=&#34;http://www.w3.org/1999/XSL/Transform&#34;
    xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
    version=&#34;2.0&#34;&gt;

  &lt;xsl:template match=&#34;records&#34;&gt;
    &lt;Events
        xsi:schemaLocation=&#34;event-logging:3 file://event-logging-v3.5.2.xsd&#34; Version=&#34;3.5.2&#34;&gt;
      &lt;xsl:apply-templates /&gt;
    &lt;/Events&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match=&#34;record&#34;&gt;
    &lt;Event&gt;
      ...
    &lt;/Event&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;</code></pre>
</div>

<p>The following lists the necessary functions of the XSLT, along with the line numbers where they&rsquo;re implemented in the above example:</p>
<ul>
<li>Match the source namespace - <code>line 3</code>;</li>
<li>Specify the output namespace - <code>lines 4, 12</code>;</li>
<li>Specify the namespace for any functions - <code>lines 5-8</code>;</li>
<li>Match the top-level <strong>records</strong> node - <code>line 10</code>;</li>
<li>Provide any output in stroom schema format - <code>lines 11, 14, 18-20</code>;</li>
<li>Individually match subsequent <strong>record</strong> nodes - <code>line 17</code>.</li>
</ul>
<p>This XSLT will generate the following output data:</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Events
    xmlns=&quot;event-logging:3&quot;
    xmlns:stroom=&quot;stroom&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.5.2.xsd&quot;
    Version=&quot;3.5.2&quot;&gt;
  &lt;Event&gt;
    ...
  &lt;/Event&gt;
  ...
&lt;Events&gt;
</code></pre>
<p>It&rsquo;s normally best to get this part of the XSLT correctly stepping before getting any further into the code.</p>
<p>Similarly for JSON fragments, the output of the parser will look like:</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;map xmlns=&quot;http://www.w3.org/2013/XSL/json&quot;&gt;
  &lt;map&gt;
    &lt;string key=&quot;version&quot;&gt;0&lt;/string&gt;
    &lt;string key=&quot;id&quot;&gt;2801bbff-fafa-4427-32b5-d38068d3de73&lt;/string&gt;
    &lt;string key=&quot;detail-type&quot;&gt;xyz_event&lt;/string&gt;
    &lt;string key=&quot;source&quot;&gt;my.host.here&lt;/string&gt;
    &lt;string key=&quot;account&quot;&gt;223592823261&lt;/string&gt;
    &lt;string key=&quot;time&quot;&gt;2022-02-15T11:01:36Z&lt;/string&gt;
    &lt;array key=&quot;resources&quot; /&gt;
    &lt;map key=&quot;detail&quot;&gt;
      &lt;number key=&quot;id&quot;&gt;1644922894335&lt;/number&gt;
      &lt;string key=&quot;userId&quot;&gt;testuser&lt;/string&gt;
    &lt;/map&gt;
  &lt;/map&gt;
&lt;/map&gt;
</code></pre>
<p>The following initial XSLT will carry out the same tasks as before:</p>









  







  
  


<div class="code-block code-toolbar">
  <pre 
     class="line-numbers language-xml" 
     
     data-start="1"  ><code class="language-xml">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;
&lt;xsl:stylesheet
    xpath-default-namespace=&#34;http://www.w3.org/2013/XSL/json&#34;
    xmlns=&#34;event-logging:3&#34;
    xmlns:stroom=&#34;stroom&#34;
    xmlns:xsl=&#34;http://www.w3.org/1999/XSL/Transform&#34;
    xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
    version=&#34;2.0&#34;&gt;

  &lt;xsl:template match=&#34;/map&#34;&gt;
    &lt;Events
        xsi:schemaLocation=&#34;event-logging:3 file://event-logging-v3.5.2.xsd&#34; Version=&#34;3.5.2&#34;&gt;
      &lt;xsl:apply-templates /&gt;
    &lt;/Events&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match=&#34;/map/map&#34;&gt;
    &lt;Event&gt;
      ...
    &lt;/Event&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;</code></pre>
</div>

<p>The necessary functions of the XSLT, along with the line numbers where they&rsquo;re implemented in the above example as before:</p>
<ul>
<li>Match the source namespace - <code>line 3</code>;</li>
<li>Specify the output namespace - <code>lines 4, 12</code>;</li>
<li>Specify the namespace for any functions - <code>lines 5-8</code>;</li>
<li>Match the top-level <strong>/map</strong> node - <code>line 10</code>;</li>
<li>Provide any output in stroom schema format - <code>lines 11, 14, 18-20</code>;</li>
<li>Individually match subsequent <strong>/map/map</strong> nodes - <code>line 17</code>.</li>
</ul>
<p>This XSLT will generate the following output data which is identical to the previous output:</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Events
    xmlns=&quot;event-logging:3&quot;
    xmlns:stroom=&quot;stroom&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.5.2.xsd&quot;
    Version=&quot;3.5.2&quot;&gt;
  &lt;Event&gt;
    ...
  &lt;/Event&gt;
  ...
&lt;Events&gt;
</code></pre>
<p>Once the initial XSLT is correct, it&rsquo;s a fairly simple matter to populate the correct nodes using standard XSLT functions and a knowledge of XPaths.</p>
<h2 id="extending-the-translation-to-populate-specific-nodes">Extending the Translation to Populate Specific Nodes</h2>
<p>The above examples of <code>&lt;xsl:apply-templates match=&quot;...&quot;/&gt;</code> for an Event all point to a specific path within the XML document - often at <code>/records/record/</code> or at <code>/map/map/</code>.
XPath references to nodes further down inside the record should normally be made relative to this node.</p>
<p>Depending on the output format from the parser, there are two ways of referencing a field to populate an output node.</p>
<p>If the intermedia XML is of the following format:</p>
<pre><code class="language-xml">&lt;record&gt;
  &lt;data value=&quot;2022-04-06 15:45:38.737&quot; /&gt;
  &lt;data value=&quot;fakeuser2&quot; /&gt;
  &lt;data value=&quot;192.168.0.1&quot; /&gt;
  ...
&lt;/record&gt;
</code></pre>
<p>Then the developer needs to understand which field contains what data and then to reference based upon the index, e.g:</p>
<pre><code class="language-xml">&lt;IPAddress&gt;
  &lt;xsl:value-of select=&quot;data[3]/@value&quot;/&gt;
&lt;/IPAddress&gt;
</code></pre>
<p>However, if the intermediate XML is of this format:</p>
<pre><code class="language-xml">&lt;record&gt;
  &lt;data name=&quot;time&quot; value=&quot;2022-04-06 15:45:38.737&quot; /&gt;
  &lt;data name=&quot;user&quot; value=&quot;fakeuser2&quot; /&gt;
  &lt;data name=&quot;ip&quot; value=&quot;192.168.0.1&quot; /&gt;
  ...
&lt;/record&gt;
</code></pre>
<p>Then, although the first method is still acceptable, it&rsquo;s easier and safer to reference by @name:</p>
<pre><code class="language-xml">&lt;IPAddress&gt;
  &lt;xsl:value-of select=&quot;data[@name='ip']/@value&quot;/&gt;
&lt;/IPAddress&gt;
</code></pre>
<p>This second method also has the advantage that if the field positions differ for different event types, the names will hopefully stay the same, saving the need to add <code>if TypeA then do X, if TypeB then do Y, ...</code> code into the XSLT.</p>
<p>More complex field references are likely to be required at times, particularly for data that&rsquo;s been converted using the internal JSON parser.
Assuming source data of:</p>
<pre><code class="language-xml">&lt;map&gt;
  &lt;string key=&quot;version&quot;&gt;0&lt;/string&gt;
  ...
  &lt;array key=&quot;resources&quot; /&gt;
  &lt;map key=&quot;detail&quot;&gt;
    &lt;number key=&quot;id&quot;&gt;1644922894335&lt;/number&gt;
    &lt;string key=&quot;userId&quot;&gt;testuser&lt;/string&gt;
  &lt;/map&gt;
&lt;/map&gt;
</code></pre>
<p>Then selecting the id field requires something like:</p>
<pre><code class="language-xml">&lt;xsl:value-of select=&quot;map[@key='detail']/number[@key='id']&quot;/&gt;
</code></pre>
<p>It&rsquo;s important at this stage to have a reasonable understanding of which fields in the source data provide what detail in terms of stroom schema values, which fields can be ignored and which can be used but modified to control the flow of the translation.
For example - there may be an IP address within the log, but is it of the device itself or of the client?
It&rsquo;s normally best to start with several examples of each event type requiring translation to ensure that fields are translated correctly.</p>
<h2 id="structuring-the-xslt">Structuring the XSLT</h2>
<p>There are many different ways of structuring the overall XSLT and it&rsquo;s ultimately for the developer to decide the best way based upon the requirements of their own data.
However, the following points should be noted:</p>
<ul>
<li>When working on e.g a CreateDocument event, it&rsquo;s far easier to edit a 10-line template named <strong>CreateDocument</strong> than lines 841-850 of a template named <strong>MainTemplate</strong>.
Therefore, keep each template relatively small and helpfully named.</li>
<li>Both the logic and XPaths required for EventTime and EventSource are normally common to all or most events for a given log.
Therefore, it usually makes sense to have a common EventTime and EventSource template for all event types rather than a duplicate of this code for each event type.</li>
<li>If code needs to be repeated in multiple templates, then it&rsquo;s often simpler to move that code into a separate template and call it from multiple places.
This is often used for e.g. adding an Outcome node for multiple failed event types.</li>
<li>Use comments within the XSLT even when the code appears obvious.
If nothing else, a comment field will ensure a newline prior to the comment once auto-formatted.
This allows the end of one template and the start of the next template to be differentiated more easily if each template is prefixed by something like <code>&lt;!-- Template for EventDetail --&gt;</code>.
Comments are also useful for anybody who needs to fix your code several years later when you&rsquo;ve moved on to far more interesting work.</li>
<li>For most feeds, the main development work is within the EventDetail node.
This will normally contain a lot of code effectively doing <code>if CreateDocument do X; if DeleteFile do Y; if SuccessfulLogin do Z; ...</code>.
From experience, the following type of XSLT is normally the easiest to write and to follow:</li>
</ul>
<pre><code class="language-xml">  &lt;!-- Event Detail template --&gt;
  &lt;xsl:template name=&quot;EventDetail&quot;&gt;
    &lt;xsl:variable name=&quot;typeId&quot; select=&quot;...&quot;/&gt;
      &lt;EventDetail&gt;
        &lt;xsl:choose&gt;
          &lt;xsl:when test=&quot;$typeId='A'&quot;&gt;
            &lt;xsl:call-template name=&quot;Logon&quot;/&gt;
          &lt;/xsl:when&gt;
          &lt;xsl:when test=&quot;$typeId='B'&quot;&gt;
            &lt;xsl:call-template name=&quot;CreateDoc&quot;/&gt;
          &lt;/xsl:when&gt;
          ...
        &lt;/xsl:choose&gt;
      &lt;/EventDetail&gt;
    &lt;/xsl:template&gt;
</code></pre>
<ul>
<li>If in the above example, the various values of <code>$typeId</code> are sufficiently descriptive to use as text values then the <strong>TypeId</strong> node can be implemented prior to the <code>&lt;xsl:choose&gt;</code> to avoid specifying it once in each child template.</li>
<li>It&rsquo;s common for systems to generate <code>Create/Delete/View/Modify/...</code> events against a range of different <code>Document/File/Email/Object/...</code> types.
Rather than looking at events such as <code>CreateDocument/DeleteFile/...</code> and creating a template for each, it&rsquo;s often simpler to work in two stages.
Firstly create templates for the <code>Create/Delete/...</code>  types within <code>EventDetail</code> and then from each of these templates, call another template which then checks and calls the relevant object template.</li>
<li>It&rsquo;s also sometimes possible to take the above multi-step process further and use a common template for Create/Delete/View.
The following code assumes that the variable <code>${evttype}</code> is a valid schema action such as <code>Create/Delete/View</code>.
Whilst it can be used to produce more compact XSLT code, it tends to lose readability and makes extending the code for additional types more difficult.
The inner <code>&lt;xsl:choose&gt;</code> can even be simplified again by populating an <code>&lt;xsl:element&gt;</code> with <code>{objType}</code> to make the code even more compact and more difficult to follow.
There may occasionally be times when this sort of thing is useful but care should be taken to use it sparingly and provide plenty of comments.</li>
</ul>
<pre><code class="language-xml">  &lt;xsl:variable name=&quot;evttype&quot; select=&quot;...&quot;/&gt;
  &lt;xsl:element name=&quot;${evttype}&quot;&gt;
    &lt;xsl:choose&gt;
      &lt;xsl:when test=&quot;objType='Document'&quot;&gt;
        &lt;xsl:call-template name=&quot;Document&quot;/&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;objType='File'&quot;&gt;
        &lt;xsl:call-template name=&quot;File&quot;/&gt;
      &lt;/xsl:when&gt;
      ...
    &lt;/xsl:choose&gt;
  &lt;/xsl:element&gt;
</code></pre>
<p>There are always exceptions to the above advice.
If a feed will only ever contain e.g. successful logins then it may be easier to create the entire event within a single template, for example.
But if there&rsquo;s ever a possibility of e.g. logon failures, logoffs or anything else in the future then it&rsquo;s safer to structure the XSLT into separate templates.</p>
<h2 id="filtering-wantedunwanted-event-types">Filtering Wanted/Unwanted Event Types</h2>
<p>It&rsquo;s common that not all received events are required to be translated.  Depending upon the data being received and the auditing requirements that have been set against the source system, there are several ways to filter the events.</p>
<h3 id="remove-unwanted-events">Remove Unwanted Events</h3>
<p>The first method is best to use when the majority of event types are to be translated and only a few types, such as debug messages are to be dropped.
Consider the code fragment from earlier:</p>
<pre><code class="language-xml">&lt;xsl:template match=&quot;record&quot;&gt;
  &lt;Event&gt;
    ...
  &lt;/Event&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>This will create an Event node for every source record.
However, if we replace this with something like:</p>
<pre><code class="language-xml">&lt;xsl:template match=&quot;record[data[@name='logLevel' and @value='DEBUG']]&quot;/&gt;

&lt;xsl:template match=&quot;record[data[@name='msgType'
                                 and (@value='drop1' or @value='drop2')
                                ]]&quot;/&gt;

&lt;xsl:template match=&quot;record&quot;&gt;
  &lt;Event&gt;
    ...
  &lt;/Event&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>This will filter out all DEBUG messages and messages where the msgType is either “drop1&quot; or “drop2&quot;.
All other messages will result in an Event being generated.</p>
<p>This method is often not suited to systems where the full set of message types isn&rsquo;t known prior to translation development, such as for closed source software where the full set of possible messages isn&rsquo;t already known.
If an unexpected message type appears in the logs then it&rsquo;s likely that the translation won&rsquo;t know how to deal with it and may either make incorrect assumptions about it or fail to produce a schema-compliant output.</p>
<h3 id="translate-wanted-events">Translate Wanted Events</h3>
<p>This is the opposite of the previous method and the XSLT just ignores anything that it&rsquo;s not expecting.
This method is best used where only a few event types are of interest such as the scenario of translation logons/logoffs from a vast range of possible types.</p>
<p>For this, we&rsquo;d use something like:</p>
<pre><code class="language-xml">&lt;xsl:template match=&quot;record[data[@name='msgType'
                                   and (@value='logon' or @value='logoff')
                                  ]]&quot;&gt;
  &lt;Event&gt;
    ...
  &lt;/Event&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match=&quot;text()&quot;/&gt;
</code></pre>
<p>The final line stops the XSLT outputting a sequence of unformatted text nodes for any unmatched event types when an <code>&lt;xsl:apply-templates/&gt;</code> is used elsewhere within the XSLT.
It isn&rsquo;t always needed but does no harm if present.</p>
<p>This method starts to become messy and difficult to understand if a large number of wanted types are to be matched.</p>
<h3 id="advanced-removal-method-with-optional-warnings">Advanced Removal Method (With Optional Warnings)</h3>
<p>Where the full list of event types isn&rsquo;t known or may expand over time, the best method may be to filter out the definite unwanted events and handle anything unexpected as well as the known and wanted events.
This would use code similar to before to drop the specific unwanted types but handle everything else including unknown types:</p>
<pre><code class="language-xml">&lt;xsl:template match=&quot;record[data[@name='logLevel' and @value='DEBUG']]&quot;/&gt;
...
&lt;xsl:template match=&quot;record[data[@name='msgType'
                                   and (@value='drop1' or @value='drop2')
                                  ]]&quot;/&gt;

&lt;xsl:template match=&quot;record&quot;&gt;
  &lt;Event&gt;
    ...
  &lt;/Event&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>However, the XSLT must then be able to handle unknown arbitrary event types.
In practice, most systems provide a consistent format for logging the “who/where/when&quot; and it&rsquo;s only the “what&quot; that differs between event types.
Therefore, it&rsquo;s usually possible to add something like this into the XSLT:</p>
<pre><code class="language-xml">&lt;EventDetail&gt;
  &lt;xsl:choose&gt;
    &lt;xsl:when test=&quot;$evtType='1'&quot;&gt;
      ...
    &lt;/xsl:when&gt;
    ...
    &lt;xsl:when test=&quot;$evtType='n'&quot;&gt;
      ...
    &lt;/xsl:when&gt;
    &lt;!-- Unknown event type --&gt;
    &lt;xsl:otherwise&gt;
      &lt;Unknown&gt;
        &lt;xsl:value-of select=&quot;stroom:log(‘WARN',concat('Unexpected Event Type - ', $evtType))&quot;/&gt;
        ...
      &lt;/Unknown&gt;
    &lt;/xsl:otherwise&gt;
&lt;/EventDetail&gt;
</code></pre>
<p>This will create an Event of type <code>Unknown</code>.
The Unknown node is only able to contain data name/value pairs and it should be simple to extract these directly from the intermediate XML using an <code>&lt;xsl:for-each&gt;</code>.
This will allow the attributes from the source event to populate the output event for later analysis but will also generate an error stream of level <strong>WARN</strong> which will record the event type.
Looking through these error streams will allow the developer to see which unexpected events have appeared then either filter them out within a top-level <code>&lt;xsl:template match=&quot;record[data[@name='...' and @value='...']]&quot;/&gt;</code> statement or to produce an additional <code>&lt;xsl:when&gt;</code> within the EventDetail node to translate the type correctly.</p>
<h2 id="common-mistakes">Common Mistakes</h2>
<h3 id="performance-issues">Performance Issues</h3>
<p>The way that the code is written can affect its overall performance.
This may not matter for low-volume logs but can greatly affect processing time for higher volumes.
Consider the following example:</p>
<pre><code class="language-xml">&lt;!-- Event Detail template --&gt;
&lt;xsl:template name=&quot;EventDetail&quot;&gt;
  &lt;xsl:variable name=&quot;X&quot; select=&quot;...&quot;/&gt;
  &lt;xsl:variable name=&quot;Y&quot; select=&quot;...&quot;/&gt;
  &lt;xsl:variable name=&quot;Z&quot; select=&quot;...&quot;/&gt;

  &lt;EventDetail&gt;
    &lt;xsl:choose&gt;
      &lt;xsl:when test=&quot;$X='A' and $Y='foo' and matches($Z,'blah.*blah')&quot;&gt;
        &lt;xsl:call-template name=&quot;AAA&quot;/&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$X='B' or $Z='ABC'&quot;&gt;
        &lt;xsl:call-template name=&quot;BBB&quot;/&gt;
      &lt;/xsl:when&gt;
      ...
      &lt;xsl:otherwise&gt;
        &lt;xsl:call-template name=&quot;ZZZ&quot;/&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/EventDetail&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>If none of the <code>&lt;xsl:when&gt;</code> choices match, particularly if there are many of them or their logic is complex then it&rsquo;ll take a significant time to reach the <code>&lt;xsl:otherwise&gt;</code> element.
If this is by far the most common type of source data (i.e. none of the specific <code>&lt;xsl:when&gt;</code> elements is expected to match very often) then the XSLT will be slow and inefficient.
It&rsquo;s therefore better to list the most common examples first, if known.</p>
<p>It&rsquo;s also usually better to have a hierarchy of smaller numbers of options within an <code>&lt;xsl:choose&gt;</code>.
So rather than the above code, the following is likely to be more efficient:</p>
<pre><code class="language-xml">&lt;xsl:choose&gt;
  &lt;xsl:when test=&quot;$X='A'&quot;&gt;
    &lt;xsl:choose&gt;
      &lt;xsl:when test=&quot;$Y='foo'&quot;&gt;
        &lt;xsl:choose&gt;
          &lt;xsl:when test=&quot;matches($Z,'blah.*blah')&quot;&gt;
            &lt;xsl:call-template name=&quot;AAA&quot;/&gt;
          &lt;/xsl:when&gt;
          &lt;xsl:otherwise&gt;
            ...
          &lt;/xsl:otherwise&gt;
        &lt;/xsl:choose&gt;
      &lt;/xsl:when&gt;
      ...
    &lt;/xsl:choose&gt;
    ...
  &lt;/xsl:when&gt;
  ...
&lt;/xsl:choose&gt;
</code></pre>
<p>Whilst this code looks more complex, it&rsquo;s far more efficient to carry out a shorter sequence of checks, each based upon the result of the previous check, rather than a single consecutive list of checks where the data may only match the final check.</p>
<p>Where possible, the most commonly appearing choices in the source data should be dealt with first to avoid running through multiple <code>&lt;xsl:when&gt;</code> statements.</p>
<h3 id="stepping-works-fine-but-errors-whilst-processing">Stepping Works Fine But Errors Whilst Processing</h3>
<p>When data is being stepped, it&rsquo;s only ever fed to the XSLT as a single event, whilst a pipeline is able to process multiple events within a single input stream.
This apparently minor difference sometimes results in obscure errors if the translation has incorrect XPaths specified.
Taking the following input data example:</p>
<pre><code class="language-xml">&lt;TopLevelNode&gt;
  &lt;EventNode&gt;
    &lt;Field1&gt;1&lt;/Field1&gt;
    ...
  &lt;/EventNode&gt;
  &lt;EventNode&gt;
    &lt;Field1&gt;2&lt;/Field1&gt;
    ...
  &lt;/EventNode&gt;
  ...
  &lt;EventNode&gt;
    &lt;Field1&gt;n&lt;/Field1&gt;
    ...
  &lt;/EventNode&gt;
&lt;/TopLevelNode&gt;
</code></pre>
<p>If an XSLT is stepped, all XPaths will be relative to <code>&lt;EventNode&gt;</code>.
To extract the value of Field1, you&rsquo;d use something similar to <code>&lt;xsl:value-of select=&quot;Field1&quot;/&gt;</code>.
The following examples would also work in stepping mode or when there was only ever one Event per input stream:</p>
<pre><code class="language-xml">&lt;xsl:value-of select=&quot;//Field1&quot;/&gt;
&lt;xsl:value-of select=&quot;../EventNode/Field1&quot;/&gt;
&lt;xsl:value-of select=&quot;../*/Field1&quot;/&gt;
&lt;xsl:value-of select=&quot;/TopLevelNode/EventNode/Field1&quot;/&gt;
</code></pre>
<p>However, if there&rsquo;s ever a stream with multiple event nodes, the output from pipeline processing would be a sequence of the Field1 node values i.e. <code>12...n</code> for each event.
Whilst it&rsquo;s easy to spot the issues in these basic examples, it&rsquo;s harder to see in more complex structures.
It&rsquo;s also worth mentioning that just because your test data only ever has a single event per stream, there&rsquo;s nothing to say it&rsquo;ll stay this way when operational or when the next version of the software is installed on the source system, so you should always guard against using XPaths that go to the root of the tree.</p>
<h2 id="unexpected-data-values-causing-schema-validation-errors">Unexpected Data Values Causing Schema Validation Errors</h2>
<p>A source system may provide a log containing an IP address.
All works fine for a while with the following code fragment:</p>
<pre><code class="language-xml">&lt;Client&gt;
  &lt;IPAddress&gt;
    &lt;xsl:value-of select=&quot;$ipAddress&quot;/&gt;
  &lt;/IPAddress&gt;
&lt;/Client&gt;
</code></pre>
<p>However, let&rsquo;s assume that in certain circumstances (e.g. when accessed locally rather than over a network) the system provides a value of <code>localhost</code> or something else that&rsquo;s not an IP address.
Whilst the majority of schema values are of type <code>string</code>, there are still many that are limited in character set in some way.
The most common is probably IPAddress and it must match a fairly complex regex to be valid.
In this instance, the translation will still succeed but any schema validation elements within the pipeline will throw an error and stop the invalid event (not just the invalid element) from being output within the Events stream.
Without the event in the stream, it&rsquo;s not indexable or searchable so is effectively dropped by the system.</p>
<p>To resolve this issue, the XSLT should be aware of the possibility of invalid input using something like the following:</p>
<pre><code class="language-xml">&lt;Client&gt;
  &lt;xsl:choose&gt;
    &lt;xsl:when test=&quot;matches($ipAddress,'^[.0-9]+$')&quot;&gt;
      &lt;IPAddress&gt;
        &lt;xsl:value-of select=&quot;$ipAddress&quot;/&gt;
      &lt;/IPAddress&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;HostName&gt;
        &lt;xsl:value-of select=&quot;$ipAddress&quot;/&gt;
      &lt;/HostName&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/Client&gt;
</code></pre>
<p>This would need to be modified slightly for IPv6 and also wouldn&rsquo;t catch obvious errors such as <code>999.1..8888</code> but if we can assume that the source will generate either a valid IP address or a valid hostname then the events will at least be available within the output stream.</p>
<h2 id="testing-the-translation">Testing the Translation</h2>
<p>When stepping a stream with more than a few events in it, it&rsquo;s possible to filter the stepping rather than just moving to first/previous/next/last.
In the bottom right hand corner of the bottom right hand pane within the XSLT tab, there&rsquo;s a small <em>filter</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/filter.svg" 
    title="Filter" 
    alt="filter.svg">


 that&rsquo;s often not spotted.
The icon will be <strong>grey</strong> if no filter is set or <strong>green</strong> if set.
Opening this filter gives choices such as:</p>
<ul>
<li>Jump to error</li>
<li>Jump to empty/non-empty output</li>
<li>Jump to specific XPath exists/contains/equals/unique</li>
</ul>
<p>Each of these options can be used to move directly to the next/previous event that matches one of these attributes.</p>
<p>A filter on e.g. the 








  
  










<span class="pipeline-element" title="xsltFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="xsltFilter" 
    alt="xslt.svg">
  <span>xsltFilter</span>
</span>
 will still be active even if viewing the 








  
  








<span class="pipeline-element" title="dsParser" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/text.svg" 
    title="dsParser" 
    alt="text.svg">
  <span>dsParser</span>
</span>
 or any other pipeline entry, although the filter that&rsquo;s present in the parser step will not show any values.
This may cause confusion if you lose track of which filters have been set on which steps.</p>
<p>Filters can be entered for multiple pipeline elements, e.g. Empty output in translationFilter and Error in schemaFilter.
In this example, all empty outputs AND schema errors will be seen, effectively providing an OR of the filters.</p>
<p>The XPath syntax is fairly flexible.
If looking for specific TypeId values, the shortcut of <code>//TypeId</code> will work just as well as <code>/Events/Event/EventDetail/TypeId</code>, for example.</p>
<p>Using filters will allow a developer to find a wide range of types of records far quicker than stepping through a large file of events.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '5.2.'; page-break-before: always">
    
  <h1 id="pg-388147b082f84379beb8941e0b22eb4c">5.2 - Apache HTTPD Event Feed</h1>
    <div class="lead">The following will take you through the process of creating an Event Feed in Stroom.</div>
	<!-- Created with Stroom v6.1-beta.16 -->

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">See Also</h4>


    <p><a href="../../../docs/howtos/general/enablingprocessorshowto/">HOWTO - Enabling Processors for a Pipeline</a></p>


</div>


<h2 id="introduction">Introduction</h2>
<p>The following will take you through the process of creating an Event Feed in Stroom.</p>
<p>In this example, the logs are in a well-defined, line based, text format so we will use a Data Splitter parser to transform the logs into simple record-based XML and then a XSLT translation to normalise them into the Event schema.</p>
<p>A separate document will describe the method of automating the storage of normalised events for this feed.
Further, we will not Decorate these events.
Again, Event Decoration is described in another document.</p>
<h2 id="event-log-source">Event Log Source</h2>
<p>For this example, we will use logs from an Apache HTTPD Web server.
In fact, the web server in front of Stroom v5 and earlier.</p>
<p>To get the optimal information from the Apache HTTPD access logs, we define our log format based on an extension of the BlackBox format.
The format is described and defined below.
This is an extract from a httpd configuration file (/etc/httpd/conf/httpd.conf)</p>






<div class="text-file card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="">

  <div class="card-body px-0 pt-2 pb-0">
    
    <pre><code class="language-text">
# Stroom - Black Box Auditing configuration
#
# %a - Client IP address (not hostname (%h) to ensure ip address only)
# When logging the remote host, it is important to log the client IP address, not the
# hostname. We do this with the '%a' directive. Even if HostnameLookups are turned on,
# using '%a' will only record the IP address. For the purposes of BlackBox formats,
# reversed DNS should not be trusted

# %{REMOTE_PORT}e - Client source port
# Logging the client source TCP port can provide some useful network data and can help
# one associate a single client with multiple requests.
# If two clients from the same IP address make simultaneous connections, the 'common log'
# file format cannot distinguish between those clients. Otherwise, if the client uses
# keep-alives, then every hit made from a single TCP session will be associated by the same
# client port number.
# The port information can indicate how many connections our server is handling at once,
# which may help in tuning server TCP/OP settings. It will also identify which client ports
# are legitimate requests if the administrator is examining a possible SYN-attack against a
# server.
# Note we are using the REMOTE_PORT environment variable. Environment variables only come
# into play when mod_cgi or mod_cgid is handling the request.

# %X - Connection status (use %c for Apache 1.3)
# The connection status directive tells us detailed information about the client connection.
# It returns one of three flags:
# x if the client aborted the connection before completion,
# + if the client has indicated that it will use keep-alives (and request additional URLS),
# - if the connection will be closed after the event
# Keep-Alive is a HTTP 1.1. directive that informs a web server that a client can request multiple
# files during the same connection. This way a client doesn't need to go through the overhead
# of re-establishing a TCP connection to retrieve a new file.

# %t - time - or [%{%d/%b/%Y:%T}t.%{msec_frac}t %{%z}t] for Apache 2.4
# The %t directive records the time that the request started.
# NOTE: When deployed on an Apache 2.4, or better, environment, you should use
# strftime format in order to get microsecond resolution.

# %l - remote logname

# %u - username [in quotes]
# The remote user (from auth; This may be bogus if the return status (%s) is 401
# for non-ssl services)
# For SSL services, user names need to be delivered as DNs to deliver PKI user details
# in full. To pass through PKI certificate properties in the correct form you need to
# add the following directives to your Apache configuration:
#   SSLUserName SSL_CLIENT_S_DN
#   SSLOptions +StdEnvVars
# If you cannot, then use %{SSL_CLIENT_S_DN}x in place of %u and use blackboxSSLUser
# LogFormat nickname

# %r - first line of text sent by web client [in quotes]
# This is the first line of text send by the web client, which includes the request
# method, the full URL, and the HTTP protocol.

# %s - status code before any redirection
# This is the status code of the original request.

# %&gt;s - status code after any redirection has taken place
# This is the final status code of the request, after any internal redirections may
# have taken place.

# %D - time in microseconds to handle the request
# This is the number of microseconds the server took to handle the request in microseconds

# %I - incoming bytes
# This is the bytes received, include request and headers. It cannot, by definition be zero.

# %O - outgoing bytes
# This is the size in bytes of the outgoing data, including HTTP headers. It cannot, by
# definition be zero.

# %B - outgoing content bytes
# This is the size in bytes of the outgoing data, EXCLUDING HTTP headers. Unlike %b, which
# records '-' for zero bytes transferred, %B will record '0'.

# %{Referer}i - Referrer HTTP Request Header [in quotes]
# This is typically the URL of the page that made the request. If linked from
# e-mail or direct entry this value will be empty. Note, this can be spoofed
# or turned off

# %{User-Agent}i - User agent HTTP Request Header [in quotes]
# This is the identifying information the client (browser) reports about itself.
# It can be spoofed or turned off

# %V - the server name according to the UseCannonicalName setting
# This identifies the virtual host in a multi host webservice

# %p - the canonical port of the server servicing the request

# Define a variation of the Black Box logs
#
# Note, you only need to use the 'blackboxSSLUser' nickname if you cannot set the
# following directives for any SSL configurations
# SSLUserName SSL_CLIENT_S_DN
# SSLOptions +StdEnvVars
# You will also note the variation for no logio module. The logio module supports
# the %I and %O formatting directive
#
&lt;IfModule mod_logio.c&gt;
   LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;../../&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxUser
   LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN../../&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxSSLUser
&lt;/IfModule&gt;
&lt;IfModule !mod_logio.c&gt;
   LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;../../&quot;%r\&quot; %s/%&gt;s %D 0/0/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/$p&quot; blackboxUser
   LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN../../&quot;%r\&quot; %s/%&gt;s %D 0/0/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/$p&quot; blackboxSSLUser
&lt;/IfModule&gt;


</code></pre>


    <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
    <div class="card-text" style="font-size: smaller; text-align: center;">
      
      <span class="" style="font-size: smaller">Apache BlackBox Auditing Configuration</span>
      
      (
      <a href="../../../files/HOWTOs/EventFeeds/CreateApacheHTTPDEventFeed/ApacheHTTPDAuditConfig.txt" class="" style="font-size: smaller">Download ApacheHTTPDAuditConfig.txt</a>
      <i class="external-link-icon fas fa-file-download fa-sm text-secondary" title="External link"></i>
      )
    </div>
  </div>
</div>

<p>As Stroom can use PKI for login, you can configure Stroom’s Apache to make use of the blackboxSSLUser log format.
A sample set of logs in this format appear below.</p>






<div class="text-file card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="">

  <div class="card-body px-0 pt-2 pb-0">
    
    <pre><code class="language-text">192.168.4.220/61801 - [18/Jan/2020:12:39:04 -0800] - &quot;/C=USA/ST=CA/L=Los Angeles/O=Default Company Ltd/CN=Burn Frank (burn)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 21221 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.4.220/61854 - [18/Jan/2020:12:40:04 -0800] - &quot;/C=USA/ST=CA/L=Los Angeles/O=Default Company Ltd/CN=Burn Frank (burn)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 7889 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.4.220/61909 - [18/Jan/2020:12:41:04 -0800] - &quot;/C=USA/ST=CA/L=Los Angeles/O=Default Company Ltd/CN=Burn Frank (burn)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 6901 2389/3796/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.4.220/61962 - [18/Jan/2020:12:42:04 -0800] - &quot;/C=USA/ST=CA/L=Los Angeles/O=Default Company Ltd/CN=Burn Frank (burn)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 11219 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.8.151/62015 - [18/Jan/2020:12:43:04 +1100] - &quot;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 4265 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.8.151/62092 - [18/Jan/2020:12:44:04 +1100] - &quot;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 9791 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.8.151/62147 - [18/Jan/2020:12:44:10 +1100] - &quot;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 9791 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.8.151/62147 - [18/Jan/2020:12:44:20 +1100] - &quot;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 11509 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.8.151/62202 - [18/Jan/2020:12:44:21 +1100] - &quot;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 4627 2389/3796/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.8.151/62294 - [18/Jan/2020:12:44:21 +1100] - &quot;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 12367 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.8.151/62349 - [18/Jan/2020:12:44:25 +1100] - &quot;/C=AUS/ST=NSW/L=Sydney/O=Default Company Ltd/CN=Max Bergman (maxb)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 12765 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.234.9/62429 - [18/Jan/2020:12:50:06 +0000] - &quot;/C=GBR/ST=GLOUCESTERSHIRE/L=Bristol/O=Default Company Ltd/CN=Kostas Kosta (kk)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 12245 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.234.9/62429 - [18/Jan/2020:12:50:04 +0000] - &quot;/C=GBR/ST=GLOUCESTERSHIRE/L=Bristol/O=Default Company Ltd/CN=Kostas Kosta (kk)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 12245 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.234.9/62495 - [18/Jan/2020:12:51:04 +0000] - &quot;/C=GBR/ST=GLOUCESTERSHIRE/L=Bristol/O=Default Company Ltd/CN=Kostas Kosta (kk)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 4327 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.234.9/62549 - [18/Jan/2020:12:52:04 +0000] - &quot;/C=GBR/ST=GLOUCESTERSHIRE/L=Bristol/O=Default Company Ltd/CN=Kostas Kosta (kk)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 7148 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443
192.168.234.9/62626 - [18/Jan/2020:12:52:06 +0000] - &quot;/C=GBR/ST=GLOUCESTERSHIRE/L=Bristol/O=Default Company Ltd/CN=Kostas Kosta (kk)&quot; &quot;POST /stroom/stroom/dispatch.rpc HTTP/1.1&quot; 200/200 11386 2289/415/14 &quot;https://stroomnode00.strmdev00.org/stroom/&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; stroomnode00.strmdev00.org/443

</code></pre>


    <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
    <div class="card-text" style="font-size: smaller; text-align: center;">
      
      <span class="" style="font-size: smaller">Apache BlackBox sample log</span>
      
      (
      <a href="../../../files/HOWTOs/EventFeeds/CreateApacheHTTPDEventFeed/sampleApacheBlackBox.log" class="" style="font-size: smaller">Download sampleApacheBlackBox.log</a>
      <i class="external-link-icon fas fa-file-download fa-sm text-secondary" title="External link"></i>
      )
    </div>
  </div>
</div>

<p>Save a copy of this data to your local environment for use later in this HOWTO.
Save this file as a text document with ANSI encoding.</p>
<h2 id="create-the-feed-and-its-pipeline">Create the Feed and its Pipeline</h2>
<p>To reflect the source of these Accounting Logs, we will name our feed and its pipeline Apache-SSLBlackBox-V2.0-EVENTS and it will be stored in the system group Apache HTTPD under the main system group - <code>Event Sources</code>.</p>
<h3 id="create-system-group">Create System Group</h3>
<p>To create the system group Apache  HTTPD, navigate to the <em>Event Sources/Infrastructure/WebServer</em> system group within the Explorer pane (if this system group structure does not already exist in your Stroom instance then refer to the <strong>HOWTO Stroom Explorer Management</strong> for guidance).
Left click to highlight the
<em>WebServer</em> system group then right click to bring up the object context menu.
Navigate to the <em>New</em> icon, then the <em>Folder</em> icon to reveal the <em>New Folder</em> selection window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-00.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-00.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Navigate Explorer</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>In the New Folder window enter Apache HTTPD into the <strong>Name:</strong> text entry box.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-01.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-01.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Create System Group</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The click on 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 at which point you will be presented with the Apache HTTPD system group configuration tab.
Also note, the <em>WebServer</em> system group within the Explorer pane has automatically expanded to display the <code>Apache HTTPD</code> system group.</p>
<p>Close the Apache HTTPD system group configuration tab by clicking on the close item icon on the right-hand side of the tab 







  







  <span class="stroom-tab stroom-tab-active" title="Folder tab - 'Apache HTTPD'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Folder.svg" 
      title="Apache HTTPD" 
      alt="Folder.svg">
    <span class="stroom-tab-name">Apache HTTPD</span>
    <span class="stroom-tab-cross">×</span>
  </span>


.</p>
<p>We now need to create, in order</p>
<ul>
<li>the Feed,</li>
<li>the Text Parser,</li>
<li>the Translation and finally,</li>
<li>the Pipeline.</li>
</ul>
<h3 id="create-feed">Create Feed</h3>
<p>Within the Explorer pane, and having selected the Apache HTTPD group, right click to bring up object context menu.
Navigate to New, Feed</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-03.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-03.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Apache Create Feed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Select the Feed icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Feed.svg" 
    title="Feed" 
    alt="document/Feed.svg">


, when the <strong>New Feed</strong> selection window comes up, ensure the <code>Apache HTTPD</code> system group is selected or navigate to it.
Then enter the name of the feed, Apache-SSLBlackBox-V2.0-EVENTS, into the <strong>Name:</strong> text entry box the press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.</p>
<p>It should be noted that the default Stroom FeedName pattern will not accept this name.
One needs to modify the <code>stroom.feedNamePattern</code> stroom property to change the default pattern to <code>^[a-zA-Z0-9_-\.]{3,}$</code>.
See the <a href="../../../docs/howtos/administration/systemproperties/">HOWTO on System Properties</a> document to see how to make this change.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-04.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-04.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Feed dialog</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this point you will be presented with the new feed&rsquo;s configuration tab and the feed&rsquo;s Explorer object will automatically appear in the Explorer pane within the <code>Apache HTTPD</code> system group.</p>
<p>Select the <em>Settings</em> tab on the feed&rsquo;s configuration tab.
Enter an appropriate description into the <strong>Description:</strong> text entry box, for instance:</p>
<p>&ldquo;Apache HTTPD events for BlackBox Version 2.0.  These events are from a Secure service  (https).&rdquo;</p>
<p>In the <strong>Classification:</strong> text entry box, enter a Classification of the data that the event feed will contain - that is the classification or sensitivity of the accounting log’s content itself.</p>
<p>As this is not a Reference Feed, leave the <strong>Reference Feed:</strong> check box unchecked.</p>
<p>We leave the <strong>Feed Status:</strong> at <em>Receive</em>.</p>
<p>We leave the <strong>Stream Type:</strong> as <em>Raw Events</em> as this we will be sending batches (streams) of raw event logs.</p>
<p>We leave the <strong>Data Encoding:</strong> as UTF-8 as the raw logs are in this form.</p>
<p>We leave the <strong>Context Encoding:</strong> as UTF-8 as there no context events for this feed.</p>
<p>We leave the <strong>Retention Period:</strong> at <em>Forever</em> as we do not want to delete the raw logs.</p>
<p>This results in</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-05.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-05.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Feed tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Save the feed by clicking on the save icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


.</p>
<h3 id="create-text-converter">Create Text Converter</h3>
<p>Within the Explorer pane, and having selected the <code>Apache HTTPD</code> system group, right click to bring up object context menu, then select:</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/TextConverter.svg" 
    title="Text converter" 
    alt="document/TextConverter.svg">


 <em>Text Converter</em></p>
<p>When the <strong>New Text Converter</strong></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-07.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-07.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-07.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-07.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Text Converter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>selection window comes up enter the name of the feed, Apache-SSLBlackBox-V2.0-EVENTS, into the <strong>Name:</strong> text entry box then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.
At this point you will be presented with the new text converter&rsquo;s configuration tab.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-08.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-08.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-08.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-08.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Text Converter configuration tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Enter an appropriate description into the <strong>Description:</strong> text entry box, for instance</p>
<p>&ldquo;Apache HTTPD events for BlackBox Version 2.0 - text converter.
See Conversion for complete documentation.&rdquo;</p>
<p>Set the <strong>Converter Type:</strong> to be Data Splitter from drop down menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-09.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-09.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-09.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-09.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Text Converter configuration settings</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Save the text converter by clicking on the save icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


.</p>
<h3 id="create-xslt-translation">Create XSLT Translation</h3>
<p>Within the Explorer pane, and having selected the <code>Apache HTTPD</code> system group, right click to bring up object context menu, then select:</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/XSLT.svg" 
    title="Xslt" 
    alt="document/XSLT.svg">


 <em>XSLT</em></p>
<p>When the <strong>New XSLT</strong> selection window comes up,</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-11.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-11.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-11.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-11.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New XSLT</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>enter the name of the feed, Apache-SSLBlackBox-V2.0-EVENTS, into the <strong>Name:</strong> text entry box then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.
At this point you will be presented with the new XSLT&rsquo;s configuration tab.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-12.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-12.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-12.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-12.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New XSLT tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Enter an appropriate description into the <strong>Description:</strong> text entry box, for instance</p>
<p>&ldquo;Apache HTTPD events for  BlackBox Version 2.0  - translation.
See Translation for complete documentation.&rdquo;</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-13.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-13.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-13.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-13.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New XSLT settings</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Save the XSLT by clicking on the save 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 icon.</p>
<h3 id="create-pipeline">Create Pipeline</h3>
<p>In the process of creating this pipeline we have assumed that the  <strong>Template Pipeline</strong> content pack has been loaded, so that we can <em>Inherit</em> a pipeline structure from this content pack and configure it to support this specific feed.</p>
<p>Within the Explorer pane, and having selected the Apache HTTPD system group, right click to bring up object context menu, then select:</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Pipeline.svg" 
    title="Pipeline" 
    alt="document/Pipeline.svg">


 <em>Pipeline</em></p>
<p>When the <strong>New Pipeline</strong> selection window comes up, navigate to, then select the Apache HTTPD system group and then enter the name of the pipeline, Apache-SSLBlackBox-V2.0-EVENTS
into the <strong>Name:</strong> text entry box then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.
At this you will be presented with the new pipeline’s configuration tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-15.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-15.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-15.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-15.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As usual, enter an appropriate <strong>Description:</strong></p>
<p>&ldquo;Apache HTTPD events for BlackBox Version 2.0  - pipeline.
This pipeline uses the standard event pipeline to store the events in the Event Store.&rdquo;</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-16.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-16.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-16.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-16.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline settings</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Save the pipeline by clicking on the save icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


.</p>
<p>We now need to select the structure this pipeline will use.
We need to move from the <strong>Settings</strong> sub-item on the pipeline configuration tab to the <strong>Structure</strong> sub-item.
This is done by clicking on the <strong>Structure</strong> link, at which we see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-17.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-17.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-17.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-17.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline Structure</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Next we will choose an Event Data pipeline.
This is done by inheriting it from a defined set of Template Pipelines.
To do this, click on the menu selection icon  to the right of the Inherit From: text display box.</p>
<p>When the <strong>Choose item</strong></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-18.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-18.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-18.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-18.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline inherited from</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>selection window appears, select from the <code>Template Pipelines</code> system group.
In this instance, as our input data is text, we select (left click) the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Pipeline.svg" 
    title="Pipeline" 
    alt="Document/Pipeline.svg">


 <em>Event Data (Text)</em> pipeline</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-19.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-19.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-19.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-19.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline inherited selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.
At this we see the inherited pipeline structure of</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-20.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-20.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-20.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-20.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline inherited structure</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>For the purpose of this HOWTO, we are only interested in two of the eleven (11) elements in this pipeline</p>
<ul>
<li>the Text Converter labelled <em>dsParser</em></li>
<li>the XSLT Translation labelled <em>translationFilter</em></li>
</ul>
<p>We now need to associate our Text Converter and Translation with the pipeline so that we can pass raw events (logs) through our pipeline in order to save them in the Event Store.</p>
<p>To associate the Text Converter, select the Text Converter icon, to display.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-21.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-21.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-21.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-21.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline associate textconverter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now identify to the <strong>Property</strong> pane (the middle pane of the pipeline configuration tab), then and double click on the <em>textConverter</em> Property Name to display the <strong>Edit
Property</strong> selection window that allows you to edit the given property</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-22.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-22.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-22.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-22.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline textconverter association</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We leave the Property <strong>Source:</strong> as Inherit but we need to change the Property <strong>Value:</strong> from <em>None</em> to be our newly created Apache-SSLBlackBox-V2.0-EVENTS Text Converter.</p>
<p>To do this, position the cursor over the menu selection icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/assorted/popup.png" 
    title="Menu selection" 
    alt="assorted/popup.png">


 to the right of the <strong>Value:</strong> text display box and click to select.
Navigate to the <code>Apache HTTPD</code> system group then select the Apache-SSLBlackBox-V2.0-EVENTS text Converter</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-23.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-23.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-23.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-23.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline textconverter association</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.
At this we will see the Property <em>Value</em> set</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-24.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-24.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-24.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-24.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline textconverter association</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Again press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to finish editing this property and we see that the <em>textConverter</em> Property has been set to <strong>Apache-SSLBlackBox-V2.0-EVENTS</strong></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-25.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-25.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-25.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-25.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline textconverter association</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We perform the same actions to associate the translation.</p>
<p>First, we select the translation Filter’s 








  
  










<span class="pipeline-element" title="translationFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="translationFilter" 
    alt="xslt.svg">
  <span>translationFilter</span>
</span>
 element and then within translation Filter’s <strong>Property</strong> pane we double click on the <em>xslt</em> Property Name to bring up the <strong>Property Editor</strong>.
As before, bring up the <strong>Choose item</strong> selection window, navigate to the <code>Apache HTTPD</code> system group and select the
Apache-SSLBlackBox-V2.0-EVENTS xslt Translation.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-26.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-26.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-26.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-26.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline Translation association</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We leave the remaining properties in the translation Filter’s <strong>Property</strong> pane at their default values.
The result is the assignment of our translation to the <em>xslt</em> Property.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-27.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-27.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-27.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-27.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline Translation association</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>For the moment, we will not associate a decoration filter.</p>
<p>Save the pipeline by clicking on its 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 icon.</p>
<h3 id="manually-load-raw-event-test-data">Manually load Raw Event test data</h3>
<p>Having established the pipeline, we can now start authoring our text converter and translation.
The first step is to load some Raw Event test data.
Previously in the <strong>Event Log Source</strong> of this HOWTO you saved a copy of the file <em>sampleApacheBlackBox.log</em> to your local environment.
It contains only a few events as the content is consistently formatted.
We could feed the test data by posting the file to Stroom’s accounting/datafeed url, but for this example we will manually load the file.
Once developed, raw data is posted to the web service.</p>
<p>Select the 













  <span class="stroom-tab " title="Feed tab - 'ApacheHHTPDFeed'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Feed.svg" 
      title="ApacheHHTPDFeed" 
      alt="Feed.svg">
    <span class="stroom-tab-name">ApacheHHTPDFeed</span>
    <span class="stroom-tab-cross">×</span>
  </span>


 tab and select the <strong>Data</strong> sub-tab to display</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-29.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-29.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-29.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-29.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Data Loading</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This window is divided into three panes.</p>
<p>The top pane displays the <em>Stream Table</em>, which is a table of the latest streams that belong to the feed (clearly it’s empty).</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-30.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-30.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-30.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-30.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Data Loading - Stream Table</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note that a Raw Event <em>stream</em> is made up of data from a single file of data or aggregation of multiple data files and also meta-data associated with the data file(s).
For example, file names, file size, etc.</p>
<p>The middle pane displays a <em>Specific</em> feed and any linked streams.
To display a <em>Specific</em> feed, you select it from the <em>Stream Table</em> above.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-31.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-31.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-31.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-31.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Data Loading - Specific Stream</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The bottom pane displays the selected stream’s data or meta-data.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-32.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-32.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-32.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-32.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Data Loading - Data/Metadata</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note the Upload icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/upload.svg" 
    title="Upload" 
    alt="upload.svg">


 in the top left of the Stream table pane.
On clicking the Upload icon, we are presented with the data <strong>Upload</strong> selection window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-33.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-33.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-33.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-33.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Data Loading - Upload Data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As stated earlier, raw event data is normally posted as a file to the Stroom web server.
As part of this posting action, a set of well-defined HTTP <em>extra headers</em> are sent as part of the post.
These headers, in the form of key value pairs, provide additional context associated with the system sending the logs.
These standard headers become Stroom <em>feed attributes</em> available to the Stroom translation.
Common attributes are</p>
<ul>
<li>System - the name of the System providing the logs</li>
<li>Environment - the environment of the system (Production, Quality Assurance, Reference, Development)</li>
<li>Feed - the feedname itself</li>
<li>MyHost - the fully qualified domain name of the system sending the logs</li>
<li>MyIPaddress - the IP address of the system sending the logs</li>
<li>MyNameServer - the name server the system resolves names through</li>
</ul>
<p>Since our translation will want these feed attributes, we will set them in the Meta Data text entry box of the <strong>Upload</strong> selection window.
Note we can skip <em>Feed</em> as this will automatically be assigned correctly as part of the upload action (setting it to Apache-SSLBlackBox-V2.0-EVENTS obviously).
Our <strong>Meta Data:</strong> will have</p>
<ul>
<li>System:LinuxWebServer</li>
<li>Environment:Production</li>
<li>MyHost:stroomnode00.strmdev00.org</li>
<li>MyIPaddress:192.168.2.245</li>
<li>MyNameServer:192.168.2.254</li>
</ul>
<p>We select a <strong>Stream Type:</strong> of <em>Raw Events</em> as this data is for an <em>Event Feed</em>.
As this is not a <em>Reference Feed</em> we ignore the <strong>Effective:</strong> entry box (a date/time selector).</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-34.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-34.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-34.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-34.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload Data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We now click the <strong>Choose File</strong> button, then navigate to the location of the raw log file you downloaded earlier, <em>sampleApacheBlackBox.log</em></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-35.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-35.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-35.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-35.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload Data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then click <strong>Open</strong> to return to the <strong>Upload</strong> selection window where we can then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to perform the upload.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-36.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-36.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-36.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-36.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload Data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>An Alert dialog window is presented 






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-37.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-37.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-37.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-37.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Alert</figcaption>
      </div>
      
    </figure>
  </a>
</div>
  which should be <strong>closed</strong>.</p>
<p>The stream we have just loaded will now be displayed in the  <em>Streams Table</em> pane.
Note that the <em>Specific Stream</em>
and <em>Data/Meta-data</em> panes are still blank.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-38.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-38.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-38.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-38.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Data Loading - Streams Table</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we select the stream by clicking anywhere along its line, the stream is highlighted and the <em>Specific Stream</em> and Data/Meta-data_ panes now display data.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-39.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-39.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-39.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-39.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Data Loading - Streams Table</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The <em>Specific Stream</em> pane only displays the Raw Event stream and the <em>Data/Meta-data</em> pane displays the content of the log file just uploaded (the <strong>Data</strong> link).
If we were to click on the <strong>Meta</strong> link at the top of the <em>Data/Meta-data</em> pane, the log data is replaced by this stream’s meta-data.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-40.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-40.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-40.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-40.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Data Loading - Meta-data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note that, in addition to the feed attributes we set, the upload process added additional feed attributes of</p>
<ul>
<li>Feed - the feed name</li>
<li>ReceivedTime - the time the feed was received by Stroom</li>
<li>RemoteFile - the name of the file loaded</li>
<li>StreamSize - the size, in bytes, of the loaded data within the stream</li>
<li>user-agent - the user agent used to present the stream to Stroom - in this case, the Stroom user Interface</li>
</ul>
<p>We now have data that will allow us to develop our text converter and translation.</p>
<h3 id="step-data-through-pipeline---source">Step data through Pipeline - Source</h3>
<p>We now need to step our data through the pipeline.</p>
<p>To do this, set the check-box on the <em>Specific Stream</em> pane and we note that the previously grayed out action icons (









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/process.svg" 
    title="Process" 
    alt="process.svg">


 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/delete.svg" 
    title="Delete" 
    alt="delete.svg">


 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/download.svg" 
    title="Download" 
    alt="download.svg">


) are now enabled.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-43.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-43.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-43.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-43.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Select Stream to Step</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We now want to step our data through the first element of the pipeline, the Text Converter.
We enter Stepping Mode by pressing the stepping button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/stepping.svg" 
    title="Stepping" 
    alt="stepping.svg">


 found at the bottom right corner of the <em>Data/Meta-data</em> pane.</p>
<p>We will then be requested to choose a pipeline to step with, at which, you should navigate to the Apache-SSLBlackBox-V2.0-EVENTS pipeline as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-44.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-44.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-44.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-44.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Select pipeline to Step</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.</p>
<p>At this point, we enter the pipeline Stepping tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-45.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-45.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-45.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-45.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Stepping tab - Source</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>which, initially displays the Raw Event data from our stream.
This is the Source display for the Event Pipeline.</p>
<h3 id="step-data-through-pipeline---text-converter">Step data through Pipeline - Text Converter</h3>
<p>We click on the 








  
  








<span class="pipeline-element" title="dsParser" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/text.svg" 
    title="dsParser" 
    alt="text.svg">
  <span>dsParser</span>
</span>
 element to enter the Text Converter stepping window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-46.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-46.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-46.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-46.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Stepping tab - Text Converter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This <em>stepping</em> tab is divided into three sub-panes.
The top one is the Text Converter editor and it will allow you to edit the text conversion.
The bottom left window displays the <em>input</em> to the Text Converter.
The bottom right window displays the <em>output</em> from the Text Converter for the given input.</p>
<p>We also note an error indicator - that of an error in the editor pane as indicated by the black back-grounded x and rectangular black boxes to the right of the editor’s scroll bar.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-47.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-47.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-47.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-47.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Stepping tab - Error</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>In essence, this means that we have no text converter to pass the Raw Event data through.</p>
<p>To correct this, we will author our text converter using the Data Splitter <em>language</em>.
Normally this is done incrementally to more easily develop the parser.
The minimum text converter contains</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;dataSplitter xmlns=&quot;data-splitter:3&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;data-splitter:3 file://data-splitter-v3.0.1.xsd&quot; version=&quot;3.0&quot;&gt;
    &lt;split  delimiter=&quot;\n&quot;&gt;
        &lt;group&gt;
            &lt;regex pattern=&quot;^(.*)$&quot;&gt;
                &lt;data name=&quot;rest&quot; value=&quot;$1&quot; /&gt;
            &lt;/regex&gt;
        &lt;/group&gt;
    &lt;/split&gt;
&lt;/dataSplitter&gt;
</code></pre>
<p>If we now press the Step First 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/fast-backward-green.svg" 
    title="Step first" 
    alt="fast-backward-green.svg">


 icon the error will disappear and the stepping window will show.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-48.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-48.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-48.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-48.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Stepping tab - Text Converter Simple A</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As we can see, the first line of our Raw Event is displayed in the <em>input</em> pane and the <em>output</em> window holds the converted XML output where we just have a single <em>data</em> element with a <em>name</em> attribute of <em>rest</em> and a <em>value</em> attribute of the complete raw event as our regular expression matched the entire line.</p>
<p>The next incremental step in the parser, would be to <em>parse out</em> additional <em>data</em> elements.
For example, in this next iteration we extract the client ip address, the client port and hold the rest of the Event in the rest data element.</p>
<p>With the text converter containing</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;dataSplitter xmlns=&quot;data-splitter:3&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;data-splitter:3 file://data-splitter-v3.0.1.xsd&quot; version=&quot;3.0&quot;&gt;
    &lt;split  delimiter=&quot;\n&quot;&gt;
        &lt;group&gt;
            &lt;regex pattern=&quot;^([^/]+)/([^  ]+) (.*)$&quot;&gt;
                &lt;data name=&quot;clientip&quot;  value=&quot;$1&quot; /&gt;
                &lt;data name=&quot;clientport&quot;  value=&quot;$2&quot; /&gt;
                &lt;data name=&quot;rest&quot; value=&quot;$3&quot; /&gt;
            &lt;/regex&gt;
        &lt;/group&gt;
    &lt;/split&gt;
&lt;/dataSplitter&gt;
</code></pre>
<p>and a click on the Refresh Current Step 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh" 
    alt="refresh-green.svg">


 icon we will see the <em>output</em> pane contain</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-49.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-49.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-49.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-49.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Text Converter Simple B</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We continue this incremental parsing until we have our complete parser.</p>
<p>The following is our complete Text Converter which generates xml records as defined by the Stroom <strong>records v3.0</strong> schema.</p>






<div class="text-file card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="">

  <div class="card-body px-0 pt-2 pb-0">
    
    <pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;dataSplitter 
    xmlns=&quot;data-splitter:3&quot; 
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
    xsi:schemaLocation=&quot;data-splitter:3 file://data-splitter-v3.0.1.xsd&quot; 
    version=&quot;3.0&quot;&gt;

&lt;!-- CLASSIFICATION: UNCLASSIFIED --&gt;

&lt;!-- Release History:
Release 20131001, 1 Oct 2013 - Initial release 

General Notes: 
This data splitter takes audit events for the Stroom variant of the Black Box Apache Auditing.

Event Format: The following is extracted from the Configuration settings for the Stroom variant of the Black Box Apache Auditing format.

#  Stroom - Black  Box  Auditing configuration
#
#  %a  - Client  IP address  (not  hostname (%h) to ensure ip address only)
#  When  logging the remote host,  it is important to log the client  IP address, not the
#  hostname. We do   this  with the '%a' directive.  Even  if HostnameLookups  are turned on,
#  using '%a' will  only record the IP address.  For the purposes of BlackBox formats,
#  reversed DNS should not  be trusted

#  %{REMOTE_PORT}e  - Client source port
#  Logging the client  source TCP  port  can provide some   useful  network data and can help
#  one associate a single client  with multiple requests.
#  If two   clients from the  same IP address  make   simultaneous connections, the 'common  log'
#  file format cannot distinguish  between those  clients. Otherwise, if  the client uses
#  keep-alives, then every hit  made   from a single  TCP  session will  be associated  by   the  same
#  client  port number.
#  The   port information can indicate  how  many   connections our server is  handling at  once,
#  which may  help in tuning server TCP/OP   settings. It will also identify which client ports
#  are legitimate requests if  the administrator is examining a possible  SYN-attack against  a
#  server.
#  Note we  are using the REMOTE_PORT  environment variable. Environment variables  only come
#  into play when   mod_cgi or  mod_cgid is  handling the request.

#  %X   - Connection status  (use %c  for  Apache 1.3)
#  The   connection status  directive  tells us detailed  information about the client  connection.
#  It returns  one of three flags:
#  x  if the client aborted the connection before completion,
#  +  if  the client has indicated that it will  use keep-alives (and request additional  URLS),
#  - if the connection will  be closed after  the event
#  Keep-Alive is a HTTP 1.1.  directive  that  informs a web  server that  a client  can request multiple
#  files during the  same connection.  This way  a client  doesn't need to go   through the  overhead
#  of re-establishing  a TCP  connection to retrieve  a new  file.

#  %t  - time - or  [%{%d/%b/%Y:%T}t.%{msec_frac}t %{%z}t] for  Apache 2.4
#  The   %t  directive  records the time that  the request started.
#  NOTE:  When  deployed on   an  Apache 2.4, or better,  environment, you   should use
#  strftime  format in  order  to  get  microsecond resolution.

#  %l  - remote logname
#

#  %u - username [in quotes]
#  The   remote user  (from auth;  This may  be bogus if the return status  (%s) is  401
#  for non-ssl services)
#  For SSL  services,  user names need to  be delivered  as DNs  to deliver PKI   user details
#  in full.  To  pass through PKI   certificate  properties in the correct form you   need to
#  add the following directives  to your  Apache configuration:
#  SSLUserName   SSL_CLIENT_S_DN
#  SSLOptions +StdEnvVars
#  If you   cannot,  then use %{SSL_CLIENT_S_DN}x   in place of %u and use  blackboxSSLUser
#  LogFormat nickname

#  %r  - first  line of text sent by   web  client [in quotes]
#  This is the first  line of text send by   the web  client, which includes the request
#  method, the  full URL,  and the  HTTP protocol.

#  %s  - status  code before any redirection
#  This is  the status  code of the original request.

#  %&gt;s  - status  code after  any redirection  has taken place
#  This is  the final  status  code of the request, after  any internal  redirections  may
#  have taken  place.

#  %D   - time in  microseconds to handle the request
#  This is the  number of microseconds the  server  took to  handle the  request  in  microseconds

#  %I  - incoming bytes
#  This is  the bytes received, include request and headers. It  cannot, by   definition be zero.

#  %O   - outgoing bytes
#  This is  the size in bytes of the outgoing data,  including HTTP headers. It  cannot,  by
#  definition be zero.

#  %B  - outgoing content bytes
#  This is  the size in bytes of the outgoing data,  EXCLUDING  HTTP headers.  Unlike %b,   which
#  records '-' for zero bytes transferred,  %B  will record '0'.

#  %{Referer}i - Referrer HTTP Request  Header [in quotes]
#  This is  typically the URL of the page that  made   the request.  If  linked from
#  e-mail or direct  entry this  value will be empty. Note, this  can be spoofed
#  or turned off

#  %{User-Agent}i - User agent HTTP Request  Header [in quotes]
#  This is  the identifying information the client  (browser) reports about itself.
#  It can be spoofed or  turned  off
 
#  %V   - the server name   according to the UseCannonicalName setting
#  This identifies  the virtual  host in a multi host webservice

#  %p - the canonical port of the server servicing the request

#  Define a variation  of the Black Box  logs
#
#  Note, you   only need to  use the  'blackboxSSLUser' nickname if you cannot set  the
#  following directives  for any SSL  configurations
#  SSLUserName   SSL_CLIENT_S_DN
#  SSLOptions +StdEnvVars
#  You  will also note the variation for no   logio  module. The   logio  module supports
#  the %I  and %O   formatting directive
#

&lt;IfModule mod_logio.c&gt; 
LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%u\&quot; \&quot;%r\&quot; %s/%&gt;s %D I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxUser 
LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN}x\&quot; \&quot;%r\&quot; %s/%&gt;s %D %I/%O/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/%p&quot; blackboxSSLUser 
&lt;/IfModule&gt; 
&lt;IfModule !mod_logio.c&gt; 
LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%u\&quot; \&quot;%r\&quot; %s/%&gt;s %D 0/0/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/$p&quot; blackboxUser 
LogFormat &quot;%a/%{REMOTE_PORT}e %X %t %l \&quot;%{SSL_CLIENT_S_DN}x\&quot; \&quot;%r\&quot; %s/%&gt;s %D 0/0/%B \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %V/$p&quot; blackboxSSLUser 
&lt;/IfModule&gt; 
--&gt;

&lt;!--  Match line --&gt;
&lt;split  delimiter=&quot;\n&quot;&gt;
    &lt;group&gt;
        &lt;regex pattern=&quot;^([^/]+)/([^ ]+) ([^ ]+) \[([^\]]+)] ([^ ]+) &amp;#34;([^&amp;#34;]+)&amp;#34; &amp;#34;([^&amp;#34;]+)&amp;#34; (\d+)/(\d+) (\d+) ([^/]+)/([^/]+)/(\d+) &amp;#34;([^&amp;#34;]+)&amp;#34; &amp;#34;([^&amp;#34;]+)&amp;#34; ([^/]+)/([^ ]+)&quot;&gt;
            &lt;data name=&quot;clientip&quot;  value=&quot;$1&quot; /&gt;
            &lt;data name=&quot;clientport&quot;  value=&quot;$2&quot; /&gt;
            &lt;data name=&quot;constatus&quot; value=&quot;$3&quot; /&gt;
            &lt;data  name=&quot;time&quot; value=&quot;$4&quot;  /&gt;
            &lt;data  name=&quot;remotelname&quot; value=&quot;$5&quot;  /&gt;
            &lt;data  name=&quot;user&quot; value=&quot;$6&quot; /&gt;
            &lt;data  name=&quot;url&quot; value=&quot;$7&quot;&gt;
                &lt;group value=&quot;$7&quot; ignoreErrors=&quot;true&quot;&gt;
                &lt;!-- 
                Special case the &quot;GET  /&quot; url string as opposed to  the  more standard  &quot;method url protocol/protocol_version&quot;.
                Also special  case a url  of &quot;-&quot;  which occurs  on   some   errors  (eg 408)
                --&gt;
                    &lt;regex pattern=&quot;^-$&quot;&gt;
                        &lt;data  name=&quot;url&quot; value=&quot;error&quot; /&gt;
                    &lt;/regex&gt;
                    &lt;regex pattern=&quot;^([^ ]+) (/)$&quot;&gt;
                        &lt;data  name=&quot;httpMethod&quot; value=&quot;$1&quot;  /&gt;
                        &lt;data  name=&quot;url&quot; value=&quot;$2&quot; /&gt;
                    &lt;/regex&gt;
                    &lt;regex pattern=&quot;^([^ ]+) ([^  ]+) ([^ /]*)/([^  ]*)&quot;&gt;
                        &lt;data  name=&quot;httpMethod&quot; value=&quot;$1&quot;  /&gt;
                        &lt;data  name=&quot;url&quot; value=&quot;$2&quot; /&gt;
                        &lt;data  name=&quot;protocol&quot; value=&quot;$3&quot; /&gt;
                        &lt;data  name=&quot;version&quot; value=&quot;$4&quot; /&gt;
                    &lt;/regex&gt;
                &lt;/group&gt;
            &lt;/data&gt;
            &lt;data  name=&quot;responseB&quot; value=&quot;$8&quot;  /&gt;
            &lt;data  name=&quot;response&quot; value=&quot;$9&quot; /&gt;
            &lt;data  name=&quot;timeM&quot; value=&quot;$10&quot; /&gt;
            &lt;data  name=&quot;bytesIn&quot; value=&quot;$11&quot; /&gt;
            &lt;data  name=&quot;bytesOut&quot; value=&quot;$12&quot;  /&gt;
            &lt;data  name=&quot;bytesOutContent&quot; value=&quot;$13&quot; /&gt;
            &lt;data name=&quot;referer&quot;  value=&quot;$14&quot; /&gt;
            &lt;data  name=&quot;userAgent&quot; value=&quot;$15&quot;  /&gt;
            &lt;data  name=&quot;vserver&quot; value=&quot;$16&quot; /&gt;
            &lt;data name=&quot;vserverport&quot;  value=&quot;$17&quot; /&gt;
        &lt;/regex&gt;
    &lt;/group&gt;
&lt;/split&gt;
&lt;/dataSplitter&gt;

</code></pre>


    <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
    <div class="card-text" style="font-size: smaller; text-align: center;">
      
      <span class="" style="font-size: smaller">ApacheHTTPD BlackBox - Data Splitter</span>
      
      (
      <a href="../../../files/HOWTOs/EventFeeds/CreateApacheHTTPDEventFeed/ApacheHTTPDBlackBox-DataSplitter.txt" class="" style="font-size: smaller">Download ApacheHTTPDBlackBox-DataSplitter.txt</a>
      <i class="external-link-icon fas fa-file-download fa-sm text-secondary" title="External link"></i>
      )
    </div>
  </div>
</div>

<p>If we now press the Step First 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/fast-backward-green.svg" 
    title="Step first" 
    alt="fast-backward-green.svg">


 icon we will see the complete parsed record</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-50.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-50.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-50.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-50.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Stepping tab - Text Converter Complete</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we click on the Step Forward 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step forward" 
    alt="step-forward-green.svg">


 icon we will see the next event displayed in both the <em>input</em> and <em>output</em> panes.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-51.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-51.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-51.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-51.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Stepping tab - Text Converter Complete second event</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>we click on the Step Last 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/fast-forward-green.svg" 
    title="Step last" 
    alt="fast-forward-green.svg">


 icon we will see the last event displayed in both the <em>input</em> and <em>output</em> panes.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-52.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-52.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-52.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-52.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Stepping tab - Text Converter Complete last event</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You should take note of the stepping key that has been displayed in each stepping window. The stepping key are the numbers enclosed in square brackets e.g. [7556:1:16] found in the top right-hand side of the stepping window next to the stepping icons</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-53.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-53.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-53.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-53.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Stepping tab - Stepping Key</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The form of these keys is [ streamId &lsquo;:&rsquo; subStreamId &lsquo;:&rsquo; recordNo]</p>
<p>where</p>
<ul>
<li><strong>streamId</strong> - is the stream ID and won’t change when stepping through the selected stream.</li>
<li><strong>subStreamId</strong> - is the sub stream ID. When Stroom processes event streams it aggregates multiple input files and this is the file number.</li>
<li><strong>recordNo</strong> - is the record number within the sub stream.</li>
</ul>
<p>One can double click on either the <strong>subStreamId</strong> or <strong>recordNo</strong> numbers and enter a new number. This allows you to ‘step’ around a stream rather than just relying on first, previous, next and last movement.</p>
<p>Note, you should now Save 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 your edited Text Converter.</p>
<h3 id="step-data-through-pipeline---translation">Step data through Pipeline - Translation</h3>
<p>To start authoring the xslt Translation Filter, press the 








  
  










<span class="pipeline-element" title="translationFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="translationFilter" 
    alt="xslt.svg">
  <span>translationFilter</span>
</span>
 element which steps us to the xsl Translation Filter pane.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-54.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-54.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-54.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-54.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Stepping tab - Translation Initial</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As for the <em>Text Converter</em> stepping tab, this tab is divided into three sub-panes. The top one is the xslt translation editor and it will allow you to edit the xslt translation. The bottom left window displays the <em>input</em> to the xslt translation (which is the output from the <em>Text Converter</em>). The bottom right window displays the <em>output</em> from the xslt Translation filter for the given input.</p>
<p>We now click on the pipeline Step Forward button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step forward" 
    alt="step-forward-green.svg">


 to single step the Text Converter <em>records</em> element data through our xslt Translation. We see no change as an empty translation will just perform a copy of the input data.</p>
<p>To correct this, we will author our xslt translation. Like the Data Splitter this is also authored incrementally. A minimum xslt translation might contain</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet 
    xpath-default-namespace=&quot;records:2&quot; 
    xmlns=&quot;event-logging:3&quot; 
    xmlns:stroom=&quot;stroom&quot; 
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; 
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
    xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; 
    version=&quot;3.0&quot;&gt;

  &lt;!-- Ingest the records tree --&gt;
  &lt;xsl:template match=&quot;records&quot;&gt;
    &lt;Events xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.2.3.xsd&quot; Version=&quot;3.2.3&quot;&gt;
        &lt;xsl:apply-templates /&gt;
    &lt;/Events&gt;
  &lt;/xsl:template&gt;

    &lt;!-- Only generate events if we have an url on input --&gt;
    &lt;xsl:template match=&quot;record[data[@name = 'url']]&quot;&gt;
        &lt;Event&gt;
            &lt;xsl:apply-templates select=&quot;.&quot; mode=&quot;eventTime&quot; /&gt;
            &lt;xsl:apply-templates select=&quot;.&quot; mode=&quot;eventSource&quot; /&gt;
            &lt;xsl:apply-templates select=&quot;.&quot; mode=&quot;eventDetail&quot; /&gt;
        &lt;/Event&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match=&quot;node()&quot;  mode=&quot;eventTime&quot;&gt;
        &lt;EventTime&gt;
            &lt;TimeCreated/&gt;
        &lt;/EventTime&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match=&quot;node()&quot;  mode=&quot;eventSource&quot;&gt;
        &lt;EventSource&gt;
            &lt;System&gt;
                &lt;Name  /&gt;
                &lt;Environment /&gt;
            &lt;/System&gt;
            &lt;Generator /&gt;
            &lt;Device /&gt;
            &lt;Client /&gt;
            &lt;Server /&gt;
            &lt;User&gt;
                &lt;Id /&gt;
            &lt;/User&gt;
        &lt;/EventSource&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match=&quot;node()&quot;  mode=&quot;eventDetail&quot;&gt;
        &lt;EventDetail&gt;
            &lt;TypeId&gt;SendToWebService&lt;/TypeId&gt;
            &lt;Description /&gt;
            &lt;Classification /&gt;
            &lt;Send /&gt;
        &lt;/EventDetail&gt;
    &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-55.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-55.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-55.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-55.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Translation Minimal</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Clearly this doesn’t generate useful events. Our first iterative change might be to generate the TimeCreated element value. The change would be</p>
<pre><code class="language-xml">    &lt;xsl:template match=&quot;node()&quot; mode=&quot;eventTime&quot;&gt;
        &lt;EventTime&gt;
          &lt;TimeCreated&gt;
             &lt;xsl:value-of select=&quot;stroom:format-date(data[@name = 'time']/@value, 'dd/MMM/yyyy:HH:mm:ss XX')&quot; /&gt; 
          &lt;/TimeCreated&gt;
        &lt;/EventTime&gt;
    &lt;/xsl:template&gt;
</code></pre>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-56.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-56.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-56.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-56.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Translation Minimal+</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Adding in the EventSource elements (without ANY error checking!) as per</p>
<pre><code class="language-xml">    &lt;xsl:template match=&quot;node()&quot;  mode=&quot;eventSource&quot;&gt;
        &lt;EventSource&gt;
            &lt;System&gt;
              &lt;Name&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('System')&quot;  /&gt;
              &lt;/Name&gt;
              &lt;Environment&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('Environment')&quot;  /&gt;
              &lt;/Environment&gt;
            &lt;/System&gt;
            &lt;Generator&gt;Apache  HTTPD&lt;/Generator&gt;
            &lt;Device&gt;
              &lt;HostName&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('MyHost')&quot;  /&gt;
              &lt;/HostName&gt;
              &lt;IPAddress&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('MyIPAddress')&quot;  /&gt;
              &lt;/IPAddress&gt;
            &lt;/Device&gt;
            &lt;Client&gt;
              &lt;IPAddress&gt;
                &lt;xsl:value-of select=&quot;data[@name =  'clientip']/@value&quot;  /&gt;
              &lt;/IPAddress&gt;
              &lt;Port&gt;
                &lt;xsl:value-of select=&quot;data[@name =  'clientport']/@value&quot;  /&gt;
              &lt;/Port&gt;
            &lt;/Client&gt;
            &lt;Server&gt;
              &lt;HostName&gt;
                &lt;xsl:value-of select=&quot;data[@name =  'vserver']/@value&quot;  /&gt;
              &lt;/HostName&gt;
              &lt;Port&gt;
                &lt;xsl:value-of select=&quot;data[@name =  'vserverport']/@value&quot;  /&gt;
              &lt;/Port&gt;
            &lt;/Server&gt;
            &lt;User&gt;
              &lt;Id&gt;
                &lt;xsl:value-of select=&quot;data[@name='user']/@value&quot; /&gt;
              &lt;/Id&gt;
            &lt;/User&gt;
        &lt;/EventSource&gt;
    &lt;/xsl:template&gt;
</code></pre>
<p>And after a Refresh Current Step 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh" 
    alt="refresh-green.svg">


 we see our output event ‘grow’ to</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-57.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-57.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-57.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-57.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Translation Minimal++</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We now complete our translation by expanding the <em>EventDetail</em> elements to have the completed translation of (again with limited error checking and non-existent documentation!)</p>






<div class="text-file card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="">

  <div class="card-body px-0 pt-2 pb-0">
    
    <pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet 
    xpath-default-namespace=&quot;records:2&quot; 
    xmlns=&quot;event-logging:3&quot; 
    xmlns:stroom=&quot;stroom&quot; 
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; 
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
    xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; 
    version=&quot;3.0&quot;&gt;

  &lt;!-- Ingest the records tree --&gt;
  &lt;xsl:template match=&quot;records&quot;&gt;
    &lt;Events xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.2.3.xsd&quot; Version=&quot;3.2.3&quot;&gt;
        &lt;xsl:apply-templates /&gt;
    &lt;/Events&gt;
  &lt;/xsl:template&gt;

    &lt;!-- Only generate events if we have an url on input --&gt;
    &lt;xsl:template match=&quot;record[data[@name = 'url']]&quot;&gt;
        &lt;Event&gt;
            &lt;xsl:apply-templates select=&quot;.&quot; mode=&quot;eventTime&quot; /&gt;
            &lt;xsl:apply-templates select=&quot;.&quot; mode=&quot;eventSource&quot; /&gt;
            &lt;xsl:apply-templates select=&quot;.&quot; mode=&quot;eventDetail&quot; /&gt;
        &lt;/Event&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match=&quot;node()&quot; mode=&quot;eventTime&quot;&gt;
        &lt;EventTime&gt;
          &lt;TimeCreated&gt;
             &lt;xsl:value-of select=&quot;stroom:format-date(data[@name = 'time']/@value, 'dd/MMM/yyyy:HH:mm:ss XX')&quot; /&gt; 
          &lt;/TimeCreated&gt;
        &lt;/EventTime&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match=&quot;node()&quot;  mode=&quot;eventSource&quot;&gt;
        &lt;EventSource&gt;
            &lt;System&gt;
              &lt;Name&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('System')&quot;  /&gt;
              &lt;/Name&gt;
              &lt;Environment&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('Environment')&quot;  /&gt;
              &lt;/Environment&gt;
            &lt;/System&gt;
            &lt;Generator&gt;Apache  HTTPD&lt;/Generator&gt;
            &lt;Device&gt;
              &lt;HostName&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('MyHost')&quot;  /&gt;
              &lt;/HostName&gt;
              &lt;IPAddress&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('MyIPAddress')&quot;  /&gt;
              &lt;/IPAddress&gt;
            &lt;/Device&gt;
            &lt;Client&gt;
              &lt;IPAddress&gt;
                &lt;xsl:value-of select=&quot;data[@name =  'clientip']/@value&quot;  /&gt;
              &lt;/IPAddress&gt;
              &lt;Port&gt;
                &lt;xsl:value-of select=&quot;data[@name =  'clientport']/@value&quot;  /&gt;
              &lt;/Port&gt;
            &lt;/Client&gt;
            &lt;Server&gt;
              &lt;HostName&gt;
                &lt;xsl:value-of select=&quot;data[@name =  'vserver']/@value&quot;  /&gt;
              &lt;/HostName&gt;
              &lt;Port&gt;
                &lt;xsl:value-of select=&quot;data[@name =  'vserverport']/@value&quot;  /&gt;
              &lt;/Port&gt;
            &lt;/Server&gt;
            &lt;User&gt;
              &lt;Id&gt;
                &lt;xsl:value-of select=&quot;data[@name='user']/@value&quot; /&gt;
              &lt;/Id&gt;
            &lt;/User&gt;
        &lt;/EventSource&gt;
    &lt;/xsl:template&gt;


    &lt;!-- --&gt;
    &lt;xsl:template match=&quot;node()&quot;  mode=&quot;eventDetail&quot;&gt;
        &lt;EventDetail&gt;
          &lt;TypeId&gt;SendToWebService&lt;/TypeId&gt;
          &lt;Description&gt;Send/Access data to Web Service&lt;/Description&gt;
          &lt;Classification&gt;
            &lt;Text&gt;UNCLASSIFIED&lt;/Text&gt;
          &lt;/Classification&gt;
          &lt;Send&gt;
            &lt;Source&gt;
              &lt;Device&gt;
                &lt;IPAddress&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'clientip']/@value&quot;/&gt;
                &lt;/IPAddress&gt;
                &lt;Port&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'vserverport']/@value&quot;/&gt;
                &lt;/Port&gt;
              &lt;/Device&gt;
            &lt;/Source&gt;
            &lt;Destination&gt;
              &lt;Device&gt;
                &lt;HostName&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'vserver']/@value&quot;/&gt;
                &lt;/HostName&gt;
                &lt;Port&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'vserverport']/@value&quot;/&gt;
                &lt;/Port&gt;
              &lt;/Device&gt;
            &lt;/Destination&gt;
            &lt;Payload&gt;
              &lt;Resource&gt;
                &lt;URL&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'url']/@value&quot;/&gt;
                &lt;/URL&gt;
                &lt;Referrer&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'referer']/@value&quot;/&gt;
                &lt;/Referrer&gt;
                &lt;HTTPMethod&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'url']/data[@name = 'httpMethod']/@value&quot;/&gt;
                &lt;/HTTPMethod&gt;
                &lt;HTTPVersion&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'url']/data[@name = 'version']/@value&quot;/&gt;
                &lt;/HTTPVersion&gt;
                &lt;UserAgent&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'userAgent']/@value&quot;/&gt;
                &lt;/UserAgent&gt;
                &lt;InboundSize&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'bytesIn']/@value&quot;/&gt;
                &lt;/InboundSize&gt;
                &lt;OutboundSize&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'bytesOut']/@value&quot;/&gt;
                &lt;/OutboundSize&gt;
                &lt;OutboundContentSize&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'bytesOutContent']/@value&quot;/&gt;
                &lt;/OutboundContentSize&gt;
                &lt;RequestTime&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'timeM']/@value&quot;/&gt;
                &lt;/RequestTime&gt;
                &lt;ConnectionStatus&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'constatus']/@value&quot;/&gt;
                &lt;/ConnectionStatus&gt;
                &lt;InitialResponseCode&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'responseB']/@value&quot;/&gt;
                &lt;/InitialResponseCode&gt;
                &lt;ResponseCode&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'response']/@value&quot;/&gt;
                &lt;/ResponseCode&gt;
                &lt;Data Name=&quot;Protocol&quot;&gt;
                  &lt;xsl:attribute select=&quot;data[@name = 'url']/data[@name = 'protocol']/@value&quot; name=&quot;Value&quot;/&gt;
                &lt;/Data&gt;
              &lt;/Resource&gt;
            &lt;/Payload&gt;
            &lt;!-- Normally our translation at this point would contain an &lt;Outcome&gt; attribute.
            Since all our sample data includes only successful outcomes we have ommitted the &lt;Outcome&gt; attribute 
            in the translation to minimise complexity--&gt;
          &lt;/Send&gt;
        &lt;/EventDetail&gt;
    &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;

</code></pre>


    <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
    <div class="card-text" style="font-size: smaller; text-align: center;">
      
      <span class="" style="font-size: smaller">Apache BlackBox Translation XSLT</span>
      
      (
      <a href="../../../files/HOWTOs/EventFeeds/CreateApacheHTTPDEventFeed/ApacheHTTPDBlackBox-TranslationXSLT.txt" class="" style="font-size: smaller">Download ApacheHTTPDBlackBox-TranslationXSLT.txt</a>
      <i class="external-link-icon fas fa-file-download fa-sm text-secondary" title="External link"></i>
      )
    </div>
  </div>
</div>

<p>And after a Refresh Current Step 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh" 
    alt="refresh-green.svg">


 we see the completed <code>&lt;EventDetail&gt;</code> section of our output event</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-ApacheHttpEventFeed-58.png" href="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-58.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-ApacheHttpEventFeed-58.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-ApacheHttpEventFeed-58.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Translation Complete</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note, you should now Save 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 your edited xslt Translation.</p>
<p>We have completed the translation and have completed developing our Apache-SSLBlackBox-V2.0-EVENTS event feed.</p>
<p>At this point, this event feed is set up to accept Raw Event data, but it will not automatically process the raw data and hence it will not place events into the Event Store. To have Stroom automatically process Raw Event streams, you will need to enable Processors for this pipeline.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '5.3.'; page-break-before: always">
    
  <h1 id="pg-656f55bea6a3f201557a536fbbd05b1a">5.3 - Event Processing</h1>
    <div class="lead">This HOWTO is provided to assist users in setting up Stroom to process inbound raw event logs and transform them into the Stroom Event Logging XML Schema.</div>
	<!-- Created with Stroom v6.1-beta.16 -->
<h2 id="introduction">Introduction</h2>
<p>This HOWTO is provided to assist users in setting up Stroom to process inbound raw event logs and transform them into the Stroom Event Logging XML Schema.</p>
<p>This HOWTO will demonstrate the process by which an Event Processing pipeline for a given Event Source is developed and deployed.</p>
<p>The sample event source used will be based on BlueCoat Proxy logs.
An extract of BlueCoat logs were sourced from 






  

<span class="external-link">
  <a href="http://log-sharing.dreamhosters.com" target="_blank" class="" style="" title="log-sharing.dreamhosters.com (external link)">
    <span>log-sharing.dreamhosters.com</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 (a Public Security Log Sharing Site) but modified to add sample user attribution.</p>
<p>Template pipelines are being used to simplify the establishment of this processing pipeline.</p>
<p>The sample BlueCoat Proxy log will be transformed into an intermediate simple XML key value pair structure, then into the 






  

<span class="external-link">
  <a href="https://github.com/gchq/event-logging-schema" target="_blank" class="" style="" title="Stroom Event Logging XML Schema (external link)">
    <span>Stroom Event Logging XML Schema</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 format.</p>
<h2 id="assumptions">Assumptions</h2>
<p>The following assumptions are used in this document.</p>
<ol>
<li>The user successfully deployed Stroom</li>
<li>The following Stroom content packages have been installed:
<ul>
<li>Template Pipelines</li>
<li>XML Schemas</li>
</ul>
</li>
</ol>
<h2 id="event-source">Event Source</h2>
<p>As mentioned, we will use BlueCoat Proxy logs as a sample event source.
Although BlueCoat logs can be customised, the default is to use the W2C Extended Log File Format (ELF).
Our sample data set looks like</p>






<div class="text-file card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="">

  <div class="card-body px-0 pt-2 pb-0">
    
    <pre><code class="language-text">#Software: SGOS 3.2.4.28
#Version: 1.0
#Date: 2005-04-27 20:57:09
#Fields: date time time-taken c-ip sc-status s-action sc-bytes cs-bytes cs-method cs-uri-scheme cs-host cs-uri-path cs-uri-query cs-username s-hierarchy s-supplier-name rs(Content-Type) cs(User-Agent) sc-filter-result sc-filter-category x-virus-id s-ip s-sitename x-virus-details x-icap-error-code x-icap-error-details
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 2 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 2 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 51 45.14.4.127 200 TCP_NC_MISS 926 1104 GET http images.google.com /imgres ?imgurl=http://www.bettercomponents.be/images/linux-logo.gif&amp;imgrefurl=http://www.bettercomponents.be/index.php%253FcPath%253D96&amp;h=360&amp;w=327&amp;sz=132&amp;tbnid=UKfPlBMXgToJ:&amp;tbnh=117&amp;tbnw=106&amp;hl=en&amp;prev=/images%253Fq%253Dlinux%252Blogo%2526hl%253Den%2526lr%253D&amp;frame=small sally DIRECT images.google.com text/html &quot;Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en) AppleWebKit/312.1 (KHTML, like Gecko) Safari/312&quot; PROXIED Hacking/Proxy%20Avoidance - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 2 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 2 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 2 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 98 45.14.3.52 200 TCP_HIT 14258 321 GET http www.cedardalechurch.ca /birdscp2.gif - brad DIRECT 209.135.103.13 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 2 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 2717 45.110.2.82 200 TCP_NC_MISS 3926 1051 GET http www.inmobus.com /wcm/isocket/iSocket.cfm ?requestURL=http://www.inmobus.com/wcm/html/../isocket/image_manager_search.cfm?dsn=InmobusWCM&amp;projectid=26&amp;SetModule=WCM&amp;iSocketAction=response&amp;responseContainer=leftTopDiv george DIRECT www.inmobus.com text/html;%20charset=UTF-8 &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 47 45.14.4.127 200 TCP_NC_MISS 2620 926 GET http images.google.com /images ?q=tbn:UKfPlBMXgToJ:http://www.bettercomponents.be/images/linux-logo.gif jane DIRECT images.google.com image/jpeg &quot;Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en) AppleWebKit/312.1 (KHTML, like Gecko) Safari/312&quot; PROXIED Hacking/Proxy%20Avoidance - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:12 1 45.110.2.82 200 TCP_HIT 941 729 GET http www.inmobus.com /wcm/assets/images/imagefileicon.gif - george DIRECT 38.112.92.20 image/gif &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; PROXIED none - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:13 139 45.112.2.73 207 TCP_NC_MISS 819 418 PROPFIND http idisk.mac.com /patrickarnold/Public/Show - bill DIRECT idisk.mac.com text/xml;charset=utf-8 &quot;WebDAVFS/1.2.7 (01278000) Darwin/7.8.0 (Power Macintosh)&quot; PROXIED Computers/Internet - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:13 2 45.106.2.66 200 TCP_HIT 559 348 GET http aim-charts.pf.aol.com / ?action=aim&amp;fields=snpghlocvAa&amp;syms=INDEX:COMPX,INDEX:INDU,INDEX:INX,TWX sally DIRECT 205.188.136.217 text/plain &quot;AIM/30 (Mozilla 1.24b; Windows; I; 32-bit)&quot; PROXIED Web%20Communications - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:13 9638 45.106.3.71 200 TCP_NC_MISS 46052 1921 POST http home.silverstar.com /cgi-bin/mailman.cgi - carol DIRECT home.silverstar.com text/html &quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6) Gecko/20050317 Firefox/1.0.2&quot; PROXIED Computers/Internet - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:16:13 173 45.112.2.73 207 TCP_NC_MISS 647 436 PROPFIND http idisk.mac.com /patrickarnold/Public/Show/nuvio_05_what.swf - bill DIRECT idisk.mac.com text/xml;charset=utf-8 &quot;WebDAVFS/1.2.7 (01278000) Darwin/7.8.0 (Power Macintosh)&quot; PROXIED Computers/Internet - 192.16.170.42 SG-HTTP-Service - none -
2005-05-04 17:17:26 495 45.108.2.100 401 TCP_NC_MISS 1007 99884 PUT http idisk.mac.com /fayray_account_transfer_holding_area_for_pictures_to_homepage_temporary/Documents/85bT9bmviawEbbBb4Sie/Image-2743371ABCC011D9.jpg - - DIRECT idisk.mac.com text/html;charset=iso-8859-1 &quot;DotMacKit/1.1 (10.4.0; iPho)&quot; PROXIED Computers/Internet - 192.16.170.42 SG-HTTP-Service - none -

</code></pre>


    <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
    <div class="card-text" style="font-size: smaller; text-align: center;">
      
      <span class="" style="font-size: smaller">Sample BlueCoat logs</span>
      
      (
      <a href="../../../files/HOWTOs/EventFeeds/ProcessingHowTo/sampleBluecoat.log" class="" style="font-size: smaller">Download sampleBluecoat.log</a>
      <i class="external-link-icon fas fa-file-download fa-sm text-secondary" title="External link"></i>
      )
    </div>
  </div>
</div>

<p>Later in this HOWTO, one will be required to upload this file.
If you save this file now, ensure the file is saved
as a text document with ANSI encoding.</p>
<h2 id="establish-the-processing-pipeline">Establish the Processing Pipeline</h2>
<p>We will create the components that make up the processing pipeline for transforming these raw logs into the Stroom Event Logging XML Schema.
They will be placed a folder appropriately named <strong>BlueCoat</strong> in the path <strong>System/Event Sources/Proxy</strong>.
See <a href="../../../docs/howtos/general/feedmanagementhowto/#create-folder-for-specific-event-source">Folder Creation</a> for details on creating such a folder.</p>
<p>There will be four components</p>
<ul>
<li>the Event Feed to group the BlueCoat log files</li>
<li>the Text Converter to convert the BlueCoat raw logs files into simple XML</li>
<li>the XSLT Translation to translate the simple XML formed by the Text Converter into the Stroom Event Logging XML form, and</li>
<li>the Processing pipeline which manages how the processing is performed.</li>
</ul>
<p>All components will have the same Name <strong>BlueCoat-Proxy-V1.0-EVENTS</strong>.
It should be noted that the default Stroom FeedName pattern will not accept this name.
One needs to modify the <code>stroom.feedNamePattern</code> stroom property to change the default pattern to <code>^[a-zA-Z0-9_-\.]{3,}$</code>.
See the <a href="../../../docs/howtos/administration/systemproperties/">HOWTO on System Properties</a> docment to see how to make this change.</p>
<h3 id="create-the-event-feed">Create the Event Feed</h3>
<p>We first select (with a <em>left click</em>) the <strong>System/Event Sources/Proxy/BlueCoat</strong> folder in the <code>Explorer</code> tab then <em>right click</em> and select:</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Feed.svg" 
    title="Feed" 
    alt="document/Feed.svg">


 <em>Feed</em></p>
<p>This will open the <code>New Feed</code> configuration window into which we enter <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> into the <code>Name:</code> entry box</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-00.png" href="../../../images/HOWTOs/UI-FeedProcessing-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-00.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New feed configuration window enter name</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to see the new Event Feed tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-01.png" href="../../../images/HOWTOs/UI-FeedProcessing-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-01.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New feed tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and it&rsquo;s corresponding reference in the <code>Explorer</code> display.</p>
<p>The configuration items for a Event Feed are</p>
<ul>
<li><em>Description</em> - a description of the feed</li>
<li><em>Classification</em> - the classification or sensitivity of the Event Feed data</li>
<li><em>Reference Feed Flag</em> - to indicate if this is a <code>Reference Feed</code> or not</li>
<li><em>Feed Status</em> - which indicates if we accept data, reject it or silently drop it</li>
<li><em>Stream Type</em> - to indicate if the <code>Feed</code> contains raw log data or reference data</li>
<li><em>Data Encoding</em> - the character encoding of the data being sent to the <code>Feed</code></li>
<li><em>Context Encoding</em> - the character encoding of context data associated with this <code>Feed</code></li>
<li><em>Retention Period</em> - the amount of time to retain the Event data</li>
</ul>
<p>In our example, we will set the above to</p>
<ul>
<li><em>Description</em> - <em>BlueCoat Proxy log data sent in W2C Extended Log File Format (ELFF)</em></li>
<li><em>Classification</em> - We will leave this blank</li>
<li><em>Reference Feed Flag</em> - We leave the check-box unchecked as this is not a <em>Reference Feed</em></li>
<li><em>Feed Status</em> - We set to <em>Receive</em></li>
<li><em>Stream Type</em> - We set to <em>Raw Events</em> as we will be sending batches (streams) of raw event logs</li>
<li><em>Data Encoding</em> - We leave at the default of <em>UTF-8</em> as this is the proposed character encoding</li>
<li><em>Context Encoding</em> - We leave at the default of <em>UTF-8</em> as there are no Context Events for this Feed</li>
<li><em>Retention Period</em> - We leave at <em>Forever</em> was we do not want to delete any collected BlueCoat event data.</li>
</ul>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-02.png" href="../../../images/HOWTOs/UI-FeedProcessing-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-02.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New feed tab configuration</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>One should note that the <code>Feed</code> tab 







  



  





  <span class="stroom-tab stroom-tab-active" title="Feed tab - 'BlueCoat-Proxy-V1.0-EVENTS'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Feed.svg" 
      title="BlueCoat-Proxy-V1.0-EVENTS" 
      alt="Feed.svg">
    <span class="stroom-tab-name">* BlueCoat-Proxy-V1.0-EVENTS</span>
    <span class="stroom-tab-cross">×</span>
  </span>


 has been marked as having unsaved changes.
This is indicated by the asterisk character <code>*</code> between the <em>Feed</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Feed.svg" 
    title="Feed" 
    alt="document/Feed.svg">


 and the name of the feed <strong>BlueCoat-Proxy-V1.0-EVENTS</strong>.</p>
<p>We can save the changes to our feed by pressing the <em>Save</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 in the top left of the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> tab.
At this point one should notice two things, the first is that the asterisk
has disappeared from the <code>Feed</code> tab and the the second is that the <em>Save</em> icon 






  




  <img 
    class="stroom-icon stroom-icon-disabled" 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 is now disabled.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-03.png" href="../../../images/HOWTOs/UI-FeedProcessing-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-03.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New feed tab saved</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h3 id="create-the-text-converter">Create the Text Converter</h3>
<p>We now create the Text Converter for this <code>Feed</code> in a similar fashion to the <code>Event Feed</code>.
We first select (with a <em>left click</em>) the <strong>System/Event Sources/Proxy/BlueCoat</strong> folder in the <code>Explorer</code> tab then <em>right click</em> and select</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/TextConverter.svg" 
    title="Text converter" 
    alt="document/TextConverter.svg">


 <em>Text Converter</em></p>
<p>Enter <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> into the <code>Name:</code> entry box and press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 which results in the creation of the Text Converter tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-04.png" href="../../../images/HOWTOs/UI-FeedProcessing-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-04.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New TextConverter tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and it&rsquo;s corresponding reference in the <code>Explorer</code> display.</p>
<p>We set the configuration for this <code>Text Converter</code> to be</p>
<ul>
<li>Description - <em>Simple XML transform for BlueCoat Proxy log data sent in W2C Extended Log File Format (ELFF)</em></li>
<li>Converter Type - We set to <em>Data Splitter</em> was we will be using the Stroom Data Splitter facility to convert the raw log data into simple XML.</li>
</ul>
<p>Again, press the <em>Save</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 to save the configuration items.</p>
<h3 id="create-the-xslt-translation">Create the XSLT Translation</h3>
<p>We now create the XSLT translation for this <code>Feed</code> in a similar fashion to the <code>Event Feed</code> or <code>Text Converter</code>.
We first select (with a <em>left click</em>) the <strong>System/Event Sources/Proxy/BlueCoat</strong> folder in the <code>Explorer</code> tab then <em>right click</em> and select:</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/XSLT.svg" 
    title="Xslt" 
    alt="document/XSLT.svg">


 <em>XSLT</em></p>
<p>Enter <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> into the <code>Name:</code> entry box and press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 which results in the creation of the XSLT Translation tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-05.png" href="../../../images/HOWTOs/UI-FeedProcessing-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-05.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New Translation tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and it&rsquo;s corresponding reference in the <code>Explorer</code> display.</p>
<p>We set the configuration for this <code>XSLT Translation</code> to be</p>
<ul>
<li>Description - <em>Transform simple XML of BlueCoat Proxy log data into Stroom Event Logging XML form</em></li>
</ul>
<p>Again, press the <em>Save</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 to save the configuration items.</p>
<h3 id="create-the-pipeline">Create the Pipeline</h3>
<p>We now create the Pipeline for this <code>Feed</code> in a similar fashion to the <code>Event Feed</code>, <code>Text Converter</code> or <code>XSLT Translation</code>.
We first select (with a <em>left click</em>) the <strong>System/Event Sources/Proxy/BlueCoat</strong> folder in the <code>Explorer</code> tab then <em>right click</em> and select:</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Pipeline.svg" 
    title="Pipeline" 
    alt="document/Pipeline.svg">


 <em>Pipeline</em></p>
<p>Enter <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> into the <code>Name:</code> entry box and press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 which results in the creation of the Pipeline tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-06.png" href="../../../images/HOWTOs/UI-FeedProcessing-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-06.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - New Pipeline tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and it&rsquo;s corresponding reference in the <code>Explorer</code> display.</p>
<p>We set the configuration for this <code>Pipeline</code> to be</p>
<ul>
<li>Description - <em>Processing of XML of BlueCoat Proxy log data into Stroom Event Logging XML</em></li>
<li>Type - We leave as <em>Event Data</em> as this is an <em>Event Data</em> pipeline</li>
</ul>
<h3 id="configure-pipeline-structure">Configure Pipeline Structure</h3>
<p>We now need to configure the <em>Structure</em> of this <code>Pipeline</code>.</p>
<p>We do this by selecting the <code>Structure</code> hyper-link of the *<em>BlueCoat-Proxy-V1.0-EVENTS</em> <code>Pipeline</code> tab.</p>
<p>At this we see the <code>Pipeline Structure</code> configuration tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-07.png" href="../../../images/HOWTOs/UI-FeedProcessing-07.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-07.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-07.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As noted in the Assumptions at the start, we have loaded the <strong>Template Pipeline</strong> content pack, so that we can <em>Inherit</em> a pipeline structure from this content pack and configure it to support this specific feed.</p>
<p>We find a template by selecting the <strong>Inherit From:</strong> <em>None</em> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/assorted/popup.png" 
    title="Menu selection" 
    alt="assorted/popup.png">


 entry box to reveal a <strong>Choose Item</strong> configuration item window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-08.png" href="../../../images/HOWTOs/UI-FeedProcessing-08.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-08.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-08.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - Inherit</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Select the <strong>Template Pipelines</strong> folder by pressing the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/tree-closed.svg" 
    title="Open tree branch" 
    alt="tree-closed.svg">


 icon to the left of the folder to reveal the choice of available templates.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-09.png" href="../../../images/HOWTOs/UI-FeedProcessing-09.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-09.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-09.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - Templates</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>For our BlueCoat feed we will select the <code>Event Data (Text)</code> template.
This is done by moving the cursor to the relevant line and select via a <em>left click</em></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-10.png" href="../../../images/HOWTOs/UI-FeedProcessing-10.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-10.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-10.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - Template Selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then pressing 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to see the inherited pipeline structure</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-11.png" href="../../../images/HOWTOs/UI-FeedProcessing-11.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-11.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-11.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - Template Selected</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h3 id="configure-pipeline-elements">Configure Pipeline Elements</h3>
<p>For the purpose of this HOWTO, we are only interested in two of the eleven (11) elements in this pipeline</p>
<ul>
<li>the Text Converter labeled <em>dsParser</em></li>
<li>the XSLT Translation labeled <em>translationFilter</em></li>
</ul>
<p>We need to assign our BlueCoat-Proxy-V1.0-EVENTS Text Converter and XSLT Translation to these elements respectively.</p>
<h4 id="text-converter-configuration">Text Converter Configuration</h4>
<p>We do this by first selecting (<em>left click</em>) the <em>dsParser</em> element at which we see the <em>Property</em> sub-window displayed</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-12.png" href="../../../images/HOWTOs/UI-FeedProcessing-12.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-12.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-12.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - dsParser</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We then select (<em>left click</em>) the <em>textConverter</em> <strong>Property Name</strong></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-13.png" href="../../../images/HOWTOs/UI-FeedProcessing-13.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-13.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-13.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - dsParser selected Property</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press the <code>Edit Property</code> button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/edit.svg" 
    title="Edit" 
    alt="edit.svg">


.
At this, the <code>Edit Property</code> configuration window is displayed.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-14.png" href="../../../images/HOWTOs/UI-FeedProcessing-14.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-14.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-14.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - dsParser Edit Property</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We select the <strong>Value:</strong> <em>None</em> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/assorted/popup.png" 
    title="Menu selection" 
    alt="assorted/popup.png">


 entry box labeled to reveal a <strong>Choose Item</strong> configuration item window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-15.png" href="../../../images/HOWTOs/UI-FeedProcessing-15.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-15.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-15.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - dsParser Edit Property choose item</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We traverse the folder structure until we can select the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Text Converter</code> as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-16.png" href="../../../images/HOWTOs/UI-FeedProcessing-16.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-16.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-16.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - dsParser Edit Property chosen item</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and then press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to see that the Property <strong>Value:</strong> has been selected.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-17.png" href="../../../images/HOWTOs/UI-FeedProcessing-17.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-17.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-17.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - dsParser set Property chosen item</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and pressing the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button of the <code>Edit Property</code> configuration window results in the pipelines <code>dsParser</code> property being set.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-18.png" href="../../../images/HOWTOs/UI-FeedProcessing-18.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-18.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-18.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - dsParser set Property</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h4 id="xslt-translation-configuration">XSLT Translation Configuration</h4>
<p>We do this by first selecting (<em>left click</em>) the <em>translationFilter</em> element at which we see the <em>Property</em> sub-window displayed</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-19.png" href="../../../images/HOWTOs/UI-FeedProcessing-19.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-19.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-19.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - translationFilter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We then select (<em>left click</em>) the <em>xslt</em> <strong>Property Name</strong></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-20.png" href="../../../images/HOWTOs/UI-FeedProcessing-20.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-20.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-20.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - xslt selected Property</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and following the same steps as for the Text Converter property selection, we assign the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>XSLT Translation</code> to the <code>xslt</code> property.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-21.png" href="../../../images/HOWTOs/UI-FeedProcessing-21.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-21.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-21.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Pipeline Structure tab - xslt selected Property</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this point, we save these changes by pressing the <em>Save</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


.</p>
<h2 id="authoring-the-translation">Authoring the Translation</h2>
<p>We are now ready to author the translation.
Close all tabs except for the <strong>Welcome</strong> and <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Feed</code> tabs.</p>
<p>On the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Feed</code> tab, select the <strong>Data</strong> hyper-link to be presented with the <strong>Data</strong> pane of our tab.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-22.png" href="../../../images/HOWTOs/UI-FeedProcessing-22.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-22.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-22.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Data Pane</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Although we can post our test data set to this feed, we will manually upload it via the <strong>Data</strong> pane.
To do this we press the Upload button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/upload.svg" 
    title="Upload" 
    alt="upload.svg">


 in the top <strong>Data</strong> pane to display the <code>Upload</code> configuration window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-23.png" href="../../../images/HOWTOs/UI-FeedProcessing-23.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-23.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-23.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Data Pane Upload</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>In a <em>Production</em> situation, where we would post log files to Stroom, we would include certain HTTP Header variables that, as we shall see, will be used
as part of the translation.
These header variables typically provide situational awareness of the source system sending the events.</p>
<p>For our purposes we set the following HTTP Header variables</p>
<pre><code class="language-text">Environment:Development
LogFileName:sampleBluecoat.log
MyHost:&quot;somenode.strmdev00.org&quot;
MyIPaddress:&quot;192.168.2.220 192.168.122.1&quot;
MyMeta:&quot;FQDN:somenode.strmdev00.org\nipaddress:192.168.2.220\nipaddress_eth0:192.168.2.220\nipaddress_lo:127.0.0.1\nipaddress_virbr0:192.168.122.1\n&quot;
MyNameServer:&quot;gateway.strmdev00.org.&quot;
MyTZ:+1000
Shar256:056f0d196ffb4bc6c5f3898962f1708886bb48e2f20a81fb93f561f4d16cb2aa
System:Site http://log-sharing.dreamhosters.com/ Bluecoat Logs
Version:V1.0
</code></pre>
<p>These are set by entering them into the <strong>Meta Data:</strong> entry box.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-24b.png" href="../../../images/HOWTOs/UI-FeedProcessing-24b.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-24b.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-24b.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Data Pane Upload Metadata</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Having done this we select a <strong>Stream Type:</strong> of <code>Raw Events</code></p>
<p>We leave the <strong>Effective:</strong> entry box empty as this stream of raw event logs does not have an <code>Effective Date</code> (only Reference Feeds set this).</p>
<p>And we choose our file <code>sampleBluecoat.log</code>, by clicking on the <code>Browse</code> button in the <strong>File:</strong> entry box, which brings up the brower&rsquo;s standard file upload selection window.
Having selected our file, we see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-24.png" href="../../../images/HOWTOs/UI-FeedProcessing-24.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-24.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-24.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Data Pane Upload Complete</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>On pressing 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 and <code>Alert</code> pop-up window is presented indicating the file was uploaded</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-25.png" href="../../../images/HOWTOs/UI-FeedProcessing-25.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-25.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-25.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Data Pane Upload Complete Verify</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Again press 



<span class="stroom-button" title="Close button" >
  <span class="stroom-button-text">Close</span>
</span>
 to show that the data has been uploaded as a Stream into the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> Event Feed.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-26.png" href="../../../images/HOWTOs/UI-FeedProcessing-26.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-26.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-26.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Data Pane Show Batch</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The top pane holds a table of the latest streams that pertain to the feed.
We see the one item which is the stream we uploaded.
If we select it, we see that a stream summary is also displayed in the centre pane (which shows details of the <em>specific</em> selected feed and associated streams.
We also see that the bottom pane displays the data associated with the selected item.
In this case, the first lines of content from the BlueCoat sample log file.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-27.png" href="../../../images/HOWTOs/UI-FeedProcessing-27.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-27.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-27.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Data Pane Show Data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we were to select the <strong>Meta</strong> hyper-link of the lower pane, one would see the metadata Stroom records for this Stream of data.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-28.png" href="../../../images/HOWTOs/UI-FeedProcessing-28.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-28.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-28.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - MetaData Pane Show Data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You should see all the HTTP variables we set as part of the Upload step as well as some that Stroom has automatically set.</p>
<p>We now switch back to the <strong>Data</strong> hyper-link before we start to develop the actual translation.</p>
<h3 id="stepping-the-pipeline">Stepping the Pipeline</h3>
<p>We will now author the two translation components of the pipeline, the data splitter that will transform our lines of BlueCoat data into a simple xml format and then the XSLT translation that will take this simple xml format and translate it into appropriate Stroom Event Logging XML form.</p>
<p>We start by ensuring our <code>Raw Events</code> Data stream is selected and we press the <code>Enter Stepping Mode</code> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/stepping.svg" 
    title="Stepping" 
    alt="stepping.svg">


 button on the lower right hand side of the bottom <code>Stream Data</code> pane.</p>
<p>You will be prompted to select a pipeline to step with.
Choose the <code>BlueCoat-Proxy-V1.0-EVENTS</code> pipeline</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-29.png" href="../../../images/HOWTOs/UI-FeedProcessing-29.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-29.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-29.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping Choose Pipeline</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.</p>
<h3 id="stepping-the-pipeline---source">Stepping the Pipeline - Source</h3>
<p>You will be presented with the <code>Source</code> element of the pipeline that shows our selected stream&rsquo;s raw data.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-30.png" href="../../../images/HOWTOs/UI-FeedProcessing-30.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-30.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-30.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping Source Element</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We see two panes here.</p>
<p>The top pane displays the Pipeline structure with <code>Source</code> selected (we could refer to this as the <em>stepping pane</em>) and it also displays a <em>step indicator</em> (three colon separated numbers enclosed in square brackets initially the numbers are dashes i.e. <code>[-:-:-]</code> as we have yet to step) and a set of green <em>Stepping Actions</em>.
The step indicator and Stepping Actions allows one the <em>step through</em> a log file, selecting data event by event (an event is typically a line, but some events can be multi-line).</p>
<p>The bottom pane displays the first page (up to 100 lines) of data along with a set of blue <em>Data Selection Actions</em>.
The Data Selection Actions are used to step through the source data 100 lines at a time.
When multiple source log files have been aggregated into a single stream, two <em>Data Selection Actions</em> control buttons will be offered.
The right hand one will allow a user to step though the source data as before, but the left hand set of control buttons allows one to step between files from the aggregated event log files.</p>
<h3 id="stepping-the-pipeline---dsparser">Stepping the Pipeline - dsParser</h3>
<p>We now select the <code>dsParser</code> pipeline element that results in the window below</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-31.png" href="../../../images/HOWTOs/UI-FeedProcessing-31.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-31.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-31.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping dsParser Element</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This window is made up of four panes.</p>
<p>The top pane remains the same - a display of the pipeline structure and the <em>step indicator</em> and green <em>Stepping Actions</em>.</p>
<p>The next pane down is the editing pane for the Text Converter.
This pane is used to edit the text converter that converts our <em>line based</em> BlueCoat Proxy logs into a XML format.
We make use of the Stroom Data Splitter facility to perform this transformation.
See <a href="../../../docs/user-guide/data-splitter/">here</a> for complete details on the data splitter.</p>
<p>The lower two panes are the <em>input</em> and <em>output</em> displays for the text converter.</p>
<p>The authoring of this data splitter translation is outside the scope of this HOWTO.
It is recommended that one reads up on the <a href="../../../docs/user-guide/data-splitter/">Data Splitter</a> and review the various samples found in the Stroom Context packs published, or the Pull Requests of 






  

<span class="external-link">
  <a href="https://github.com/gchq/stroom-content" target="_blank" class="" style="" title="github.com/gchq/stroom-content (external link)">
    <span>github.com/gchq/stroom-content</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<p>For the purpose of this HOWTO, the Datasplitter appears below.
The author believes the comments should support the understanding of the transformation.</p>






<div class="text-file card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="">

  <div class="card-body px-0 pt-2 pb-0">
    
    <pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;dataSplitter 
    bufferSize=&quot;5000000&quot; 
    xmlns=&quot;data-splitter:3&quot; 
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
    xsi:schemaLocation=&quot;data-splitter:3 file://data-splitter-v3.0.xsd&quot; 
    version=&quot;3.0&quot; 
    ignoreErrors=&quot;true&quot;&gt;

  &lt;!-- 
  This datasplitter gains the Software and and Proxy version strings along with the log field names from the comments section of the log file.
  That is from the lines ...
  
  #Software: SGOS 3.2.4.28
  #Version: 1.0
  #Date: 2005-04-27 20:57:09
  #Fields: date time time-taken c-ip sc-status s-action sc-bytes cs-bytes cs-method ... x-icap-error-code x-icap-error-details
  
  We use the Field values as the header for the subsequent log fields
  --&gt;
  
  &lt;!-- Match the software comment line and save it in _bc_software --&gt;
  &lt;regex id=&quot;software&quot; pattern=&quot;^#Software: (.+) ?\n*&quot;&gt;
    &lt;data name=&quot;_bc_software&quot; value=&quot;$1&quot; /&gt;
  &lt;/regex&gt;
    &lt;!-- Match the version comment line and save it in _bc_version --&gt;

  &lt;regex id=&quot;version&quot; pattern=&quot;^#Version: (.+) ?\n*&quot;&gt;
    &lt;data name=&quot;_bc_version&quot; value=&quot;$1&quot; /&gt;
  &lt;/regex&gt;

  &lt;!-- Match against a Fields: header comment and save all the field names in a headings --&gt;
  
  &lt;regex id=&quot;heading&quot; pattern=&quot;^#Fields: (.+) ?\n*&quot;&gt;
    &lt;group value=&quot;$1&quot;&gt;
      &lt;regex pattern=&quot;^(\S+) ?\n*&quot;&gt;
        &lt;var id=&quot;headings&quot; /&gt;
      &lt;/regex&gt;
    &lt;/group&gt;
  &lt;/regex&gt;

  &lt;!-- Skip all other comment lines --&gt;
  &lt;regex pattern=&quot;^#.+\n*&quot;&gt;
    &lt;var id=&quot;ignorea&quot; /&gt;
  &lt;/regex&gt;

  &lt;!-- We now match all other lines, applying the headings captured at the start of the file to each field value --&gt;
  
  &lt;regex id=&quot;body&quot; pattern=&quot;^[^#].+\n*&quot;&gt;
    &lt;group&gt;
      &lt;regex pattern=&quot;^&amp;#34;([^&amp;#34;]*)&amp;#34; ?\n*&quot;&gt;
        &lt;data name=&quot;$headings$1&quot; value=&quot;$1&quot; /&gt;
      &lt;/regex&gt;
      &lt;regex pattern=&quot;^([^ ]+) *\n*&quot;&gt;
        &lt;data name=&quot;$headings$1&quot; value=&quot;$1&quot; /&gt;
      &lt;/regex&gt;
    &lt;/group&gt;
  &lt;/regex&gt;

  &lt;!-- --&gt;
&lt;/dataSplitter&gt;

</code></pre>


    <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
    <div class="card-text" style="font-size: smaller; text-align: center;">
      
      <span class="" style="font-size: smaller">BlueCoat dataspliter</span>
      
      (
      <a href="../../../files/HOWTOs/EventFeeds/ProcessingHowTo/BlueCoat.ds" class="" style="font-size: smaller">Download BlueCoat.ds</a>
      <i class="external-link-icon fas fa-file-download fa-sm text-secondary" title="External link"></i>
      )
    </div>
  </div>
</div>

<p>It should be entered into the Text Converter&rsquo;s editing pane as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-32.png" href="../../../images/HOWTOs/UI-FeedProcessing-32.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-32.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-32.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping dsParser textConverter code</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As mentioned earlier, to <em>step</em> the translation, one uses the green  <em>Stepping Actions</em>.</p>
<p>The actions are</p>
<ul>
<li>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/fast-backward-green.svg" 
    title="Step First" 
    alt="fast-backward-green.svg">


 - progress the transformation to the first line of the translation input</li>
<li>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-backward-green.svg" 
    title="Step back" 
    alt="step-backward-green.svg">


 - progress the transformation one step backward</li>
<li>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step forward" 
    alt="step-forward-green.svg">


 - progress the transformation one step forward</li>
<li>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/fast-forward-green.svg" 
    title="Step last" 
    alt="fast-forward-green.svg">


 - progress the transformation to the end of the translation input</li>
<li>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh step" 
    alt="refresh-green.svg">


 - refresh the transformation based on the current translation input</li>
</ul>
<p>So, if one was to press the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step forward" 
    alt="step-forward-green.svg">


 <em>stepping action</em> we would be presented with</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-33.png" href="../../../images/HOWTOs/UI-FeedProcessing-33.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-33.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-33.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping dsParser textConverter 1</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We see that the <em>input</em> pane has the first line of input from our sample file and the <em>output</em> pane has an XML <strong>record</strong> structure where we have defined a <strong>data</strong> element with the <em>name</em> attribute of <em>bc_software</em> and it&rsquo;s <em>value</em> attribute of <em>SGOS 3.2.4.28</em>.
The definition of the <strong>record</strong> structure can be found in the <strong>System/XML Schemas/records</strong> folder.</p>
<p>This is the result of the code in our editor</p>
<pre><code class="language-xml">&lt;!-- Match the software comment line and save it in _bc_software --&gt;
&lt;regex id=&quot;software&quot; pattern=&quot;^#Software: (.+) ?\n*&quot;&gt;
  &lt;data name=&quot;_bc_software&quot; value=&quot;$1&quot; /&gt;
&lt;/regex&gt;
</code></pre>
<p>If one presses the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step forward" 
    alt="step-forward-green.svg">


 <em>stepping action</em> again, we see that we have moved to the second line of the input file with the resultant output of a <strong>data</strong> element with the <em>name</em> attribute of <em>bc_version</em> and it&rsquo;s <em>value</em> attribute of <em>1.0</em>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-34.png" href="../../../images/HOWTOs/UI-FeedProcessing-34.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-34.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-34.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping dsParser textConverter 2</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Stepping forward once more causes the translation to ignore the Date comment line, define a Data Splitter $headings variable from the Fields comment line and transform the first line of actual event data.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-35.png" href="../../../images/HOWTOs/UI-FeedProcessing-35.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-35.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-35.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping dsParser textConverter 3</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We see that a <code>&lt;record&gt;</code> element has been formed with multiple key value pair <code>&lt;data&gt;</code> elements where the <em>name</em> attribute is the key and the <em>value</em> attribute the value.
You will note that the keys have been taken from the Fields comment line which where placed in the $headings variable.</p>
<p>You should also take note that the <em>stepping indicator</em> has been incrementing the last number, so at this point it is displaying <code>[1:1:3]</code>.</p>
<p>The general form of this <em>indicator</em> is</p>
<pre><code class="language-text">'[' streamId ':' subStreamId ':' recordNo ']'
</code></pre>
<p>where</p>
<ul>
<li><strong>streamId</strong> - is the stream ID and won&rsquo;t change when stepping through the selected stream,</li>
<li><strong>subStreamId</strong> - is the sub stream ID.
When Stroom aggregates multiple event sources for a feed, it aggregates multiple input files and this is, in effect, the file number.</li>
<li><strong>recordNo</strong> - is the record number within the sub stream.</li>
</ul>
<p>One can double click on either the <strong>subStreamId</strong> or <strong>recordNo</strong> entry and enter a new value.
This allows you to <em>jump</em> around a stream rather than just relying on first, previous, next and last movements.</p>
<p>Hovering the mouse over the <em>stepping indicator</em> will change the cursor to a <code>hand pointer</code>.
Selecting (by a left click) the <code>recordNo</code> will allow you to edit it&rsquo;s value (and the other values for that matter).
You will see the display change from</p>
<p>






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-36.png" href="../../../images/HOWTOs/UI-FeedProcessing-36.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-36.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-36.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping Indicator 1</figcaption>
      </div>
      
    </figure>
  </a>
</div>

to







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-37.png" href="../../../images/HOWTOs/UI-FeedProcessing-37.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-37.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-37.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping Indicator 2</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
<p>If we change the record number from <strong>3</strong> to <strong>12</strong> then either press Enter or press the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh" 
    alt="refresh-green.svg">


 action we see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-38.png" href="../../../images/HOWTOs/UI-FeedProcessing-38.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-38.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-38.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping Indicator 3</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and note that a new record has been processed in the <em>input</em> and <em>output</em> panes.
Further, if one steps back to the <code>Source</code> element of the pipeline to view the raw source file, we see that the highlighted <strong>current</strong> line is the 12th line of processed data.
It is the 10th actual bluecoat event, but remember the #Software, #Version lines are considered as processed data (2+10 = 12).
Also noted that the #Date and #Fields lines are not considered processed data, and hence do not contribute to the <strong>recordNo</strong> value.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-39.png" href="../../../images/HOWTOs/UI-FeedProcessing-39.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-39.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-39.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping Indicator 4</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we select the <code>dsParser</code> pipeline element then press the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/fast-forward-green.svg" 
    title="Step last" 
    alt="fast-forward-green.svg">


 action we see the <code>recordNo</code> jump to 31 which is the last processed line of our sample log file.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-40.png" href="../../../images/HOWTOs/UI-FeedProcessing-40.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-40.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-40.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping Indicator 5</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h3 id="stepping-the-pipeline---translationfilter">Stepping the Pipeline - translationFilter</h3>
<p>We now select the <code>translationFilter</code> pipeline element that results in</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-41.png" href="../../../images/HOWTOs/UI-FeedProcessing-41.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-41.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-41.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping translationFilter Element</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As for the <code>dsParser</code>, this window is made up of four panes.</p>
<p>The top pane remains the same - a display of the pipeline structure and the <em>step indicator</em> and green <em>Stepping Actions</em>.</p>
<p>The next pane down is the editing pane for the Translation Filter.
This pane is used to edit an <em>xslt</em> translation that converts our simple key value pair <code>&lt;records&gt;</code> XML structure into another XML form.</p>
<p>The lower two panes are the <em>input</em> and <em>output</em> displays for the xslt translation.
You will note that the <em>input</em> and <em>output</em> displays are identical for a null xslt translation is effectively a direct copy.</p>
<p>In this HOWTO we will transform the <code>&lt;records&gt;</code> XML structure into the <em>GCHQ Stroom Event Logging XML Schema</em> form which is documented 






  

<span class="external-link">
  <a href="https://github.com/gchq/event-logging-schema" target="_blank" class="" style="" title="here (external link)">
    <span>here</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<p>The authoring of this xslt translation is outside the scope of this HOWTO, as is the use of the Stroom XML Schema.
It is recommended that one reads up on <a href="../../../docs/user-guide/pipelines/xslt/">XSLT Conversion</a> and the 






  

<span class="external-link">
  <a href="https://github.com/gchq/event-logging-schema" target="_blank" class="" style="" title="Stroom Event Logging XML Schema (external link)">
    <span>Stroom Event Logging XML Schema</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 and review the various samples found in the Stroom Context packs published, or the Pull Requests of 






  

<span class="external-link">
  <a href="https://github.com/gchq/stroom-content" target="_blank" class="" style="" title="https://github.com/gchq/stroom-content (external link)">
    <span>https://github.com/gchq/stroom-content</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<p>We will build the translation in steps.
We enter an initial portion of our xslt transformation that just consumes the <code>Software</code> and <code>Version</code> key values and converts the <code>date</code> and <code>time</code> values (which are in UTC) into the <code>EventTime/TimeCreated</code> element.
This code segment is</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet
    xpath-default-namespace=&quot;records:2&quot;
    xmlns=&quot;event-logging:3&quot;
    xmlns:stroom=&quot;stroom&quot; 
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;
    version=&quot;3.0&quot;&gt;

  &lt;!-- Bluecoat Proxy logs in W2C Extended Log File Format (ELF) --&gt;

  &lt;!-- Ingest the record key value pair elements --&gt;
  &lt;xsl:template match=&quot;records&quot;&gt;
    &lt;Events xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.2.4.xsd&quot; Version=&quot;3.2.4&quot;&gt;
      &lt;xsl:apply-templates /&gt;
    &lt;/Events&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Main record template for single event --&gt;
  &lt;xsl:template match=&quot;record&quot;&gt;
    &lt;xsl:choose&gt;

      &lt;!-- Store the Software and Version information of the Bluecoat log file for use 
      in the Event Source elements which are processed later --&gt;
      &lt;xsl:when test=&quot;data[@name='_bc_software']&quot;&gt;
        &lt;xsl:value-of select=&quot;stroom:put('_bc_software', data[@name='_bc_software']/@value)&quot; /&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;data[@name='_bc_version']&quot;&gt;
        &lt;xsl:value-of select=&quot;stroom:put('_bc_version', data[@name='_bc_version']/@value)&quot; /&gt;
      &lt;/xsl:when&gt;

      &lt;!-- Process the event logs --&gt;
      &lt;xsl:otherwise&gt;
        &lt;Event&gt;
          &lt;xsl:call-template name=&quot;event_time&quot; /&gt;
        &lt;/Event&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Time --&gt;
  &lt;xsl:template name=&quot;event_time&quot;&gt;
    &lt;EventTime&gt;
      &lt;TimeCreated&gt;
        &lt;xsl:value-of select=&quot;concat(data[@name = 'date']/@value,'T',data[@name='time']/@value,'.000Z')&quot; /&gt;
      &lt;/TimeCreated&gt;
    &lt;/EventTime&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>After entering this translation and pressing the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh" 
    alt="refresh-green.svg">


 action shows the display</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-42.png" href="../../../images/HOWTOs/UI-FeedProcessing-42.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-42.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-42.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping XSLT Translation 1</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note that this is the 31st record, so if we were to jump to the first record using the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/fast-backward-green.svg" 
    title="Step first" 
    alt="fast-backward-green.svg">


 action, we see that the <em>input</em> and <em>output</em> change appropriately.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-43.png" href="../../../images/HOWTOs/UI-FeedProcessing-43.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-43.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-43.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping XSLT Translation 2</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>You will note that there is no <code>Event</code> element in the <em>output</em> pane as the <em>record</em> template in our xslt translation above is only storing the input&rsquo;s key value (_bc_software&rsquo;s value).</p>
<p>Further note that the <strong>BlueCoat_Proxy-V1.0-EVENTS</strong> tab 







  



  





  <span class="stroom-tab stroom-tab-active" title="Stepping tab - 'BlueCoat_Proxy-V1.0-EVENTS'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/stepping.svg" 
      title="BlueCoat_Proxy-V1.0-EVENTS" 
      alt="../stepping.svg">
    <span class="stroom-tab-name">* BlueCoat_Proxy-V1.0-EVENTS</span>
    <span class="stroom-tab-cross">×</span>
  </span>


 has a <em>star</em> in front of it and also the <em>Save</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 is highlighted.
This indicates that a component of the pipeline needs to be saved.
In this case, the XSLT translation.</p>
<p>By pressing the <em>Save</em> icon, you will save the XSLT translation as it currently stands and both the <em>star</em> will be removed from the tab 







  







  <span class="stroom-tab stroom-tab-active" title="Stepping tab - 'BlueCoat_Proxy-V1.0-EVENTS'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/stepping.svg" 
      title="BlueCoat_Proxy-V1.0-EVENTS" 
      alt="../stepping.svg">
    <span class="stroom-tab-name">BlueCoat_Proxy-V1.0-EVENTS</span>
    <span class="stroom-tab-cross">×</span>
  </span>


and the <em>Save</em> icon 






  




  <img 
    class="stroom-icon stroom-icon-disabled" 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


will no longer be highlighted.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-45.png" href="../../../images/HOWTOs/UI-FeedProcessing-45.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-45.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-45.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping XSLT Translation 4</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We next extend out translation by authoring a <strong>event_source</strong> template to form an appropriate Stroom Event Logging <code>EventSource</code> element structure.
Thus our translation now is</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet
    xpath-default-namespace=&quot;records:2&quot; 
    xmlns=&quot;event-logging:3&quot; 
    xmlns:stroom=&quot;stroom&quot;
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; 
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
    xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; 
    version=&quot;3.0&quot;&gt;

  &lt;!-- Bluecoat Proxy logs in W2C Extended Log File Format (ELF) --&gt;

  &lt;!-- Ingest the record key value pair elements --&gt;
  &lt;xsl:template match=&quot;records&quot;&gt;
    &lt;Events xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.2.4.xsd&quot; Version=&quot;3.2.4&quot;&gt;
      &lt;xsl:apply-templates /&gt;
    &lt;/Events&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Main record template for single event --&gt;
  &lt;xsl:template match=&quot;record&quot;&gt;
    &lt;xsl:choose&gt;

      &lt;!-- Store the Software and Version information of the Bluecoat log file for use in
      the Event Source elements which are processed later --&gt;
      &lt;xsl:when test=&quot;data[@name='_bc_software']&quot;&gt;
        &lt;xsl:value-of select=&quot;stroom:put('_bc_software', data[@name='_bc_software']/@value)&quot; /&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;data[@name='_bc_version']&quot;&gt;
        &lt;xsl:value-of select=&quot;stroom:put('_bc_version', data[@name='_bc_version']/@value)&quot; /&gt;
      &lt;/xsl:when&gt;

      &lt;!-- Process the event logs --&gt;
      &lt;xsl:otherwise&gt;
        &lt;Event&gt;
          &lt;xsl:call-template name=&quot;event_time&quot; /&gt;
          &lt;xsl:call-template name=&quot;event_source&quot; /&gt;
        &lt;/Event&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Time --&gt;
  &lt;xsl:template name=&quot;event_time&quot;&gt;
    &lt;EventTime&gt;
      &lt;TimeCreated&gt;
        &lt;xsl:value-of select=&quot;concat(data[@name = 'date']/@value,'T',data[@name='time']/@value,'.000Z')&quot; /&gt;
      &lt;/TimeCreated&gt;
    &lt;/EventTime&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Template for event source--&gt;
  &lt;xsl:template name=&quot;event_source&quot;&gt;

    &lt;!--
    We extract some situational awareness information that the posting script includes when posting the event data 
    --&gt;
    &lt;xsl:variable name=&quot;_mymeta&quot; select=&quot;translate(stroom:meta('MyMeta'),'&amp;quot;', '')&quot; /&gt;

    &lt;!-- Form the EventSource node --&gt;
    &lt;EventSource&gt;
      &lt;System&gt;
        &lt;Name&gt;
          &lt;xsl:value-of select=&quot;stroom:meta('System')&quot; /&gt;
        &lt;/Name&gt;
        &lt;Environment&gt;
          &lt;xsl:value-of select=&quot;stroom:meta('Environment')&quot; /&gt;
        &lt;/Environment&gt;
      &lt;/System&gt;
      &lt;Generator&gt;
        &lt;xsl:variable name=&quot;gen&quot;&gt;
          &lt;xsl:if test=&quot;stroom:get('_bc_software')&quot;&gt;
            &lt;xsl:value-of select=&quot;concat(' Software: ', stroom:get('_bc_software'))&quot; /&gt;
          &lt;/xsl:if&gt;
          &lt;xsl:if test=&quot;stroom:get('_bc_version')&quot;&gt;
            &lt;xsl:value-of select=&quot;concat(' Version: ', stroom:get('_bc_version'))&quot; /&gt;
          &lt;/xsl:if&gt;
        &lt;/xsl:variable&gt;
        &lt;xsl:value-of select=&quot;concat('Bluecoat', $gen)&quot; /&gt;
      &lt;/Generator&gt;
      &lt;xsl:if test=&quot;data[@name='s-computername'] or data[@name='s-ip']&quot;&gt;
        &lt;Device&gt;
          &lt;xsl:if test=&quot;data[@name='s-computername']&quot;&gt;
            &lt;Name&gt;
              &lt;xsl:value-of select=&quot;data[@name='s-computername']/@value&quot; /&gt;
            &lt;/Name&gt;
          &lt;/xsl:if&gt;
          &lt;xsl:if test=&quot;data[@name='s-ip']&quot;&gt;
            &lt;IPAddress&gt;
              &lt;xsl:value-of select=&quot; data[@name='s-ip']/@value&quot; /&gt;
            &lt;/IPAddress&gt;
          &lt;/xsl:if&gt;
          &lt;xsl:if test=&quot;data[@name='s-sitename']&quot;&gt;
            &lt;Data Name=&quot;ServiceType&quot; Value=&quot;{data[@name='s-sitename']/@value}&quot; /&gt;
          &lt;/xsl:if&gt;
        &lt;/Device&gt;
      &lt;/xsl:if&gt;

      &lt;!-- --&gt;
      &lt;Client&gt;
        &lt;xsl:if test=&quot;data[@name='c-ip']/@value != '-'&quot;&gt;
          &lt;IPAddress&gt;
            &lt;xsl:value-of select=&quot;data[@name='c-ip']/@value&quot; /&gt;
          &lt;/IPAddress&gt;
        &lt;/xsl:if&gt;

        &lt;!-- Remote Port Number --&gt;
        &lt;xsl:if test=&quot;data[@name='c-port']/@value !='-'&quot;&gt;
          &lt;Port&gt;
            &lt;xsl:value-of select=&quot;data[@name='c-port']/@value&quot; /&gt;
          &lt;/Port&gt;
        &lt;/xsl:if&gt;
      &lt;/Client&gt;

      &lt;!-- --&gt;
      &lt;Server&gt;
        &lt;HostName&gt;
          &lt;xsl:value-of select=&quot;data[@name='cs-host']/@value&quot; /&gt;
        &lt;/HostName&gt;
      &lt;/Server&gt;

      &lt;!-- --&gt;
      &lt;xsl:variable name=&quot;user&quot;&gt;
        &lt;xsl:value-of select=&quot;data[@name='cs-user']/@value&quot; /&gt;
        &lt;xsl:value-of select=&quot;data[@name='cs-username']/@value&quot; /&gt;
        &lt;xsl:value-of select=&quot;data[@name='cs-userdn']/@value&quot; /&gt;
      &lt;/xsl:variable&gt;
      &lt;xsl:if test=&quot;$user !='-'&quot;&gt;
        &lt;User&gt;
          &lt;Id&gt;
            &lt;xsl:value-of select=&quot;$user&quot; /&gt;
          &lt;/Id&gt;
        &lt;/User&gt;
      &lt;/xsl:if&gt;
      &lt;Data Name=&quot;MyMeta&quot;&gt;
        &lt;xsl:attribute name=&quot;Value&quot; select=&quot;$_mymeta&quot; /&gt;
      &lt;/Data&gt;
    &lt;/EventSource&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>Stepping to the 3 record (the first real data record in our sample log) will reveal that our <em>output</em> pane has gained an <code>EventSource</code> element.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-46.png" href="../../../images/HOWTOs/UI-FeedProcessing-46.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-46.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-46.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping XSLT Translation 5</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note also, that our <em>Save</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 is also highlighted, so we should at some point save the extensions to our translation.</p>
<p>The complete translation now follows.</p>






<div class="text-file card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="">

  <div class="card-body px-0 pt-2 pb-0">
    
    <pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet 
    xpath-default-namespace=&quot;records:2&quot; 
    xmlns=&quot;event-logging:3&quot; 
    xmlns:stroom=&quot;stroom&quot; 
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; 
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
    xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; 
    version=&quot;3.0&quot;&gt;

  &lt;!-- Bluecoat Proxy logs in W2C Extended Log File Format (ELF) --&gt;

  &lt;!-- Ingest the record key value pair elements --&gt;
  &lt;xsl:template match=&quot;records&quot;&gt;
    &lt;Events xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.2.4.xsd&quot; Version=&quot;3.2.4&quot;&gt;
      &lt;xsl:apply-templates /&gt;
    &lt;/Events&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Main record template for single event --&gt;
  &lt;xsl:template match=&quot;record&quot;&gt;
    &lt;xsl:choose&gt;

      &lt;!-- Store the Software and Version information of the Bluecoat log file for use in the Event
      Source elements which are processed later --&gt;
      &lt;xsl:when test=&quot;data[@name='_bc_software']&quot;&gt;
        &lt;xsl:value-of select=&quot;stroom:put('_bc_software', data[@name='_bc_software']/@value)&quot; /&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;data[@name='_bc_version']&quot;&gt;
        &lt;xsl:value-of select=&quot;stroom:put('_bc_version', data[@name='_bc_version']/@value)&quot; /&gt;
      &lt;/xsl:when&gt;

      &lt;!-- Process the event logs --&gt;
      &lt;xsl:otherwise&gt;
        &lt;Event&gt;
          &lt;xsl:call-template name=&quot;event_time&quot; /&gt;
          &lt;xsl:call-template name=&quot;event_source&quot; /&gt;
          &lt;xsl:call-template name=&quot;event_detail&quot; /&gt;
        &lt;/Event&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Time --&gt;
  &lt;xsl:template name=&quot;event_time&quot;&gt;
    &lt;EventTime&gt;
      &lt;TimeCreated&gt;
        &lt;xsl:value-of select=&quot;concat(data[@name = 'date']/@value,'T',data[@name='time']/@value,'.000Z')&quot; /&gt;
      &lt;/TimeCreated&gt;
    &lt;/EventTime&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Template for event source--&gt;
  &lt;xsl:template name=&quot;event_source&quot;&gt;

    &lt;!-- We extract some situational awareness information that the posting script includes when
      posting the event data --&gt;
    &lt;xsl:variable name=&quot;_mymeta&quot; select=&quot;translate(stroom:meta('MyMeta'),'&amp;quot;', '')&quot; /&gt;

    &lt;!-- Form the EventSource node --&gt;
    &lt;EventSource&gt;
      &lt;System&gt;
        &lt;Name&gt;
          &lt;xsl:value-of select=&quot;stroom:meta('System')&quot; /&gt;
        &lt;/Name&gt;
        &lt;Environment&gt;
          &lt;xsl:value-of select=&quot;stroom:meta('Environment')&quot; /&gt;
        &lt;/Environment&gt;
      &lt;/System&gt;
      &lt;Generator&gt;
        &lt;xsl:variable name=&quot;gen&quot;&gt;
          &lt;xsl:if test=&quot;stroom:get('_bc_software')&quot;&gt;
            &lt;xsl:value-of select=&quot;concat(' Software: ', stroom:get('_bc_software'))&quot; /&gt;
          &lt;/xsl:if&gt;
          &lt;xsl:if test=&quot;stroom:get('_bc_version')&quot;&gt;
            &lt;xsl:value-of select=&quot;concat(' Version: ', stroom:get('_bc_version'))&quot; /&gt;
          &lt;/xsl:if&gt;
        &lt;/xsl:variable&gt;
        &lt;xsl:value-of select=&quot;concat('Bluecoat', $gen)&quot; /&gt;
      &lt;/Generator&gt;
      &lt;xsl:if test=&quot;data[@name='s-computername'] or data[@name='s-ip']&quot;&gt;
        &lt;Device&gt;
          &lt;xsl:if test=&quot;data[@name='s-computername']&quot;&gt;
            &lt;Name&gt;
              &lt;xsl:value-of select=&quot;data[@name='s-computername']/@value&quot; /&gt;
            &lt;/Name&gt;
          &lt;/xsl:if&gt;
          &lt;xsl:if test=&quot;data[@name='s-ip']&quot;&gt;
            &lt;IPAddress&gt;
              &lt;xsl:value-of select=&quot; data[@name='s-ip']/@value&quot; /&gt;
            &lt;/IPAddress&gt;
          &lt;/xsl:if&gt;
          &lt;xsl:if test=&quot;data[@name='s-sitename']&quot;&gt;
            &lt;Data Name=&quot;ServiceType&quot; Value=&quot;{data[@name='s-sitename']/@value}&quot; /&gt;
          &lt;/xsl:if&gt;
        &lt;/Device&gt;
      &lt;/xsl:if&gt;

      &lt;!-- --&gt;
      &lt;Client&gt;
        &lt;xsl:if test=&quot;data[@name='c-ip']/@value != '-'&quot;&gt;
          &lt;IPAddress&gt;
            &lt;xsl:value-of select=&quot;data[@name='c-ip']/@value&quot; /&gt;
          &lt;/IPAddress&gt;
        &lt;/xsl:if&gt;

        &lt;!-- Remote Port Number --&gt;
        &lt;xsl:if test=&quot;data[@name='c-port']/@value !='-'&quot;&gt;
          &lt;Port&gt;
            &lt;xsl:value-of select=&quot;data[@name='c-port']/@value&quot; /&gt;
          &lt;/Port&gt;
        &lt;/xsl:if&gt;
      &lt;/Client&gt;

      &lt;!-- --&gt;
      &lt;Server&gt;
        &lt;HostName&gt;
          &lt;xsl:value-of select=&quot;data[@name='cs-host']/@value&quot; /&gt;
        &lt;/HostName&gt;
      &lt;/Server&gt;

      &lt;!-- --&gt;
      &lt;xsl:variable name=&quot;user&quot;&gt;
        &lt;xsl:value-of select=&quot;data[@name='cs-user']/@value&quot; /&gt;
        &lt;xsl:value-of select=&quot;data[@name='cs-username']/@value&quot; /&gt;
        &lt;xsl:value-of select=&quot;data[@name='cs-userdn']/@value&quot; /&gt;
      &lt;/xsl:variable&gt;
      &lt;xsl:if test=&quot;$user !='-'&quot;&gt;
        &lt;User&gt;
          &lt;Id&gt;
            &lt;xsl:value-of select=&quot;$user&quot; /&gt;
          &lt;/Id&gt;
        &lt;/User&gt;
      &lt;/xsl:if&gt;
      &lt;Data Name=&quot;MyMeta&quot;&gt;
        &lt;xsl:attribute name=&quot;Value&quot; select=&quot;$_mymeta&quot; /&gt;
      &lt;/Data&gt;
    &lt;/EventSource&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Event detail --&gt;
  &lt;xsl:template name=&quot;event_detail&quot;&gt;
    &lt;EventDetail&gt;

      &lt;!--
        We model Proxy events as either Receive or Send events depending on the method.
      
        We make use of the Receive/Send sub-elements Source/Destination to map
        the Client/Destination Proxy values and the Payload sub-element to map
        the URL and other details of the activity. If we have a query, we model
        it as a Criteria
      --&gt;
      &lt;TypeId&gt;
        &lt;xsl:value-of select=&quot;concat('Bluecoat-', data[@name='cs-method']/@value, '-', data[@name='cs-uri-scheme']/@value)&quot; /&gt;
        &lt;xsl:if test=&quot;data[@name='cs-uri-query']/@value != '-'&quot;&gt;-Query&lt;/xsl:if&gt;
      &lt;/TypeId&gt;
      &lt;xsl:choose&gt;
        &lt;xsl:when test=&quot;matches(data[@name='cs-method']/@value, 'GET|OPTIONS|HEAD')&quot;&gt;
          &lt;Description&gt;Receipt of information from a Resource via Proxy&lt;/Description&gt;
          &lt;Receive&gt;
            &lt;xsl:call-template name=&quot;setupParticipants&quot; /&gt;
            &lt;xsl:call-template name=&quot;setPayload&quot; /&gt;
            &lt;xsl:call-template name=&quot;setOutcome&quot; /&gt;
          &lt;/Receive&gt;
        &lt;/xsl:when&gt;
        &lt;xsl:otherwise&gt;
          &lt;Description&gt;Transmission of information to a Resource via Proxy&lt;/Description&gt;
          &lt;Send&gt;
            &lt;xsl:call-template name=&quot;setupParticipants&quot; /&gt;
            &lt;xsl:call-template name=&quot;setPayload&quot; /&gt;
            &lt;xsl:call-template name=&quot;setOutcome&quot; /&gt;
          &lt;/Send&gt;
        &lt;/xsl:otherwise&gt;
      &lt;/xsl:choose&gt;
    &lt;/EventDetail&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Establish the Source and Destination nodes --&gt;
  &lt;xsl:template name=&quot;setupParticipants&quot;&gt;
    &lt;Source&gt;
      &lt;Device&gt;
        &lt;xsl:if test=&quot;data[@name='c-ip']/@value != '-'&quot;&gt;
          &lt;IPAddress&gt;
            &lt;xsl:value-of select=&quot;data[@name='c-ip']/@value&quot; /&gt;
          &lt;/IPAddress&gt;
        &lt;/xsl:if&gt;

        &lt;!-- Remote Port Number --&gt;
        &lt;xsl:if test=&quot;data[@name='c-port']/@value !='-'&quot;&gt;
          &lt;Port&gt;
            &lt;xsl:value-of select=&quot;data[@name='c-port']/@value&quot; /&gt;
          &lt;/Port&gt;
        &lt;/xsl:if&gt;
      &lt;/Device&gt;
    &lt;/Source&gt;
    &lt;Destination&gt;
      &lt;Device&gt;
        &lt;HostName&gt;
          &lt;xsl:value-of select=&quot;data[@name='cs-host']/@value&quot; /&gt;
        &lt;/HostName&gt;
      &lt;/Device&gt;
    &lt;/Destination&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Define the Payload node --&gt;
  &lt;xsl:template name=&quot;setPayload&quot;&gt;
    &lt;Payload&gt;
      &lt;xsl:if test=&quot;data[@name='cs-uri-query']/@value != '-'&quot;&gt;
        &lt;Criteria&gt;
          &lt;DataSources&gt;
            &lt;DataSource&gt;
              &lt;xsl:value-of select=&quot;concat(data[@name='cs-uri-scheme']/@value, '://', data[@name='cs-host']/@value)&quot; /&gt;
              &lt;xsl:if test=&quot;data[@name='cs-uri-path']/@value != '/'&quot;&gt;
                &lt;xsl:value-of select=&quot;data[@name='cs-uri-path']/@value&quot; /&gt;
              &lt;/xsl:if&gt;
            &lt;/DataSource&gt;
          &lt;/DataSources&gt;
          &lt;Query&gt;
            &lt;Raw&gt;
              &lt;xsl:value-of select=&quot;data[@name='cs-uri-query']/@value&quot; /&gt;
            &lt;/Raw&gt;
          &lt;/Query&gt;
        &lt;/Criteria&gt;
      &lt;/xsl:if&gt;
      &lt;Resource&gt;

        &lt;!-- Check for auth groups the URL belongs to --&gt;
        &lt;xsl:variable name=&quot;authgroups&quot;&gt;
          &lt;xsl:value-of select=&quot;data[@name='cs-auth-group']/@value&quot; /&gt;
          &lt;xsl:if test=&quot;exists(data[@name='cs-auth-group']) and exists(data[@name='cs-auth-groups'])&quot;&gt;,&lt;/xsl:if&gt;
          &lt;xsl:value-of select=&quot;data[@name='cs-auth-groups']/@value&quot; /&gt;
        &lt;/xsl:variable&gt;
        &lt;xsl:choose&gt;
          &lt;xsl:when test=&quot;contains($authgroups, ',')&quot;&gt;
            &lt;Groups&gt;
              &lt;xsl:for-each select=&quot;tokenize($authgroups, ',')&quot;&gt;
                &lt;Group&gt;
                  &lt;Id&gt;
                    &lt;xsl:value-of select=&quot;.&quot; /&gt;
                  &lt;/Id&gt;
                &lt;/Group&gt;
              &lt;/xsl:for-each&gt;
            &lt;/Groups&gt;
          &lt;/xsl:when&gt;
          &lt;xsl:when test=&quot;$authgroups != '-' and $authgroups != ''&quot;&gt;
            &lt;Groups&gt;
              &lt;Group&gt;
                &lt;Id&gt;
                  &lt;xsl:value-of select=&quot;$authgroups&quot; /&gt;
                &lt;/Id&gt;
              &lt;/Group&gt;
            &lt;/Groups&gt;
          &lt;/xsl:when&gt;
        &lt;/xsl:choose&gt;

        &lt;!-- Re-form the URL --&gt;
        &lt;URL&gt;
          &lt;xsl:value-of select=&quot;concat(data[@name='cs-uri-scheme']/@value, '://', data[@name='cs-host']/@value)&quot; /&gt;
          &lt;xsl:if test=&quot;data[@name='cs-uri-path']/@value != '/'&quot;&gt;
            &lt;xsl:value-of select=&quot;data[@name='cs-uri-path']/@value&quot; /&gt;
          &lt;/xsl:if&gt;
        &lt;/URL&gt;
        &lt;HTTPMethod&gt;
          &lt;xsl:value-of select=&quot;data[@name='cs-method']/@value&quot; /&gt;
        &lt;/HTTPMethod&gt;
        &lt;xsl:if test=&quot;data[@name='cs(User-Agent)']/@value !='-'&quot;&gt;
          &lt;UserAgent&gt;
            &lt;xsl:value-of select=&quot;data[@name='cs(User-Agent)']/@value&quot; /&gt;
          &lt;/UserAgent&gt;
        &lt;/xsl:if&gt;

        &lt;!-- Inbound activity --&gt;
        &lt;xsl:if test=&quot;data[@name='sc-bytes']/@value !='-'&quot;&gt;
          &lt;InboundSize&gt;
            &lt;xsl:value-of select=&quot;data[@name='sc-bytes']/@value&quot; /&gt;
          &lt;/InboundSize&gt;
        &lt;/xsl:if&gt;
        &lt;xsl:if test=&quot;data[@name='sc-bodylength']/@value !='-'&quot;&gt;
          &lt;InboundContentSize&gt;
            &lt;xsl:value-of select=&quot;data[@name='sc-bodylength']/@value&quot; /&gt;
          &lt;/InboundContentSize&gt;
        &lt;/xsl:if&gt;

        &lt;!-- Outbound activity --&gt;
        &lt;xsl:if test=&quot;data[@name='cs-bytes']/@value !='-'&quot;&gt;
          &lt;OutboundSize&gt;
            &lt;xsl:value-of select=&quot;data[@name='cs-bytes']/@value&quot; /&gt;
          &lt;/OutboundSize&gt;
        &lt;/xsl:if&gt;
        &lt;xsl:if test=&quot;data[@name='cs-bodylength']/@value !='-'&quot;&gt;
          &lt;OutboundContentSize&gt;
            &lt;xsl:value-of select=&quot;data[@name='cs-bodylength']/@value&quot; /&gt;
          &lt;/OutboundContentSize&gt;
        &lt;/xsl:if&gt;

        &lt;!-- Miscellaneous --&gt;
        &lt;RequestTime&gt;
          &lt;xsl:value-of select=&quot;data[@name='time-taken']/@value&quot; /&gt;
        &lt;/RequestTime&gt;
        &lt;ResponseCode&gt;
          &lt;xsl:value-of select=&quot;data[@name='sc-status']/@value&quot; /&gt;
        &lt;/ResponseCode&gt;
        &lt;xsl:if test=&quot;data[@name='rs(Content-Type)']/@value != '-'&quot;&gt;
          &lt;MimeType&gt;
            &lt;xsl:value-of select=&quot;data[@name='rs(Content-Type)']/@value&quot; /&gt;
          &lt;/MimeType&gt;
        &lt;/xsl:if&gt;
        &lt;xsl:if test=&quot;data[@name='cs-categories']/@value != 'none' or data[@name='sc-filter-category']/@value != 'none'&quot;&gt;
          &lt;Category&gt;
            &lt;xsl:value-of select=&quot;data[@name='cs-categories']/@value&quot; /&gt;
            &lt;xsl:value-of select=&quot;data[@name='sc-filter-category']/@value&quot; /&gt;
          &lt;/Category&gt;
        &lt;/xsl:if&gt;

        &lt;!-- Take up other items as data elements --&gt;
        &lt;xsl:apply-templates select=&quot;data[@name='s-action']&quot; /&gt;
        &lt;xsl:apply-templates select=&quot;data[@name='cs-uri-scheme']&quot; /&gt;
        &lt;xsl:apply-templates select=&quot;data[@name='s-hierarchy']&quot; /&gt;
        &lt;xsl:apply-templates select=&quot;data[@name='sc-filter-result']&quot; /&gt;
        &lt;xsl:apply-templates select=&quot;data[@name='x-virus-id']&quot; /&gt;
        &lt;xsl:apply-templates select=&quot;data[@name='x-virus-details']&quot; /&gt;
        &lt;xsl:apply-templates select=&quot;data[@name='x-icap-error-code']&quot; /&gt;
        &lt;xsl:apply-templates select=&quot;data[@name='x-icap-error-details']&quot; /&gt;
      &lt;/Resource&gt;
    &lt;/Payload&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Generic Data capture template so we capture all other Bluecoat objects not already consumed --&gt;
  &lt;xsl:template match=&quot;data&quot;&gt;
    &lt;xsl:if test=&quot;@value != '-'&quot;&gt;
      &lt;Data Name=&quot;{@name}&quot; Value=&quot;{@value}&quot; /&gt;
    &lt;/xsl:if&gt;
  &lt;/xsl:template&gt;

  &lt;!-- 
         Set up the Outcome node.
  
  We only set an Outcome for an error state. The absence of an Outcome infers success
  --&gt;
  &lt;xsl:template name=&quot;setOutcome&quot;&gt;
    &lt;xsl:choose&gt;

      &lt;!-- Favour squid specific errors first --&gt;
      &lt;xsl:when test=&quot;data[@name='sc-status']/@value &gt; 500&quot;&gt;
        &lt;Outcome&gt;
          &lt;Success&gt;false&lt;/Success&gt;
          &lt;Description&gt;
            &lt;xsl:call-template name=&quot;responseCodeDesc&quot;&gt;
              &lt;xsl:with-param name=&quot;code&quot; select=&quot;data[@name='sc-status']/@value&quot; /&gt;
            &lt;/xsl:call-template&gt;
          &lt;/Description&gt;
        &lt;/Outcome&gt;
      &lt;/xsl:when&gt;

      &lt;!-- Now check for 'normal' errors --&gt;
      &lt;xsl:when test=&quot;tCliStatus &gt; 400&quot;&gt;
        &lt;Outcome&gt;
          &lt;Success&gt;false&lt;/Success&gt;
          &lt;Description&gt;
            &lt;xsl:call-template name=&quot;responseCodeDesc&quot;&gt;
              &lt;xsl:with-param name=&quot;code&quot; select=&quot;data[@name='sc-status']/@value&quot; /&gt;
            &lt;/xsl:call-template&gt;
          &lt;/Description&gt;
        &lt;/Outcome&gt;
      &lt;/xsl:when&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Response Code map to Descriptions --&gt;
  &lt;xsl:template name=&quot;responseCodeDesc&quot;&gt;
    &lt;xsl:param name=&quot;code&quot; /&gt;
    &lt;xsl:choose&gt;

      &lt;!-- Informational --&gt;
      &lt;xsl:when test=&quot;$code = 100&quot;&gt;Continue&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 101&quot;&gt;Switching Protocols&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 102&quot;&gt;Processing&lt;/xsl:when&gt;

      &lt;!-- Successful Transaction --&gt;
      &lt;xsl:when test=&quot;$code = 200&quot;&gt;OK&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 201&quot;&gt;Created&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 202&quot;&gt;Accepted&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 203&quot;&gt;Non-Authoritative Information&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 204&quot;&gt;No Content&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 205&quot;&gt;Reset Content&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 206&quot;&gt;Partial Content&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 207&quot;&gt;Multi Status&lt;/xsl:when&gt;

      &lt;!-- Redirection --&gt;
      &lt;xsl:when test=&quot;$code = 300&quot;&gt;Multiple Choices&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 301&quot;&gt;Moved Permanently&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 302&quot;&gt;Moved Temporarily&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 303&quot;&gt;See Other&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 304&quot;&gt;Not Modified&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 305&quot;&gt;Use Proxy&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 307&quot;&gt;Temporary Redirect&lt;/xsl:when&gt;

      &lt;!-- Client Error --&gt;
      &lt;xsl:when test=&quot;$code = 400&quot;&gt;Bad Request&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 401&quot;&gt;Unauthorized&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 402&quot;&gt;Payment Required&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 403&quot;&gt;Forbidden&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 404&quot;&gt;Not Found&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 405&quot;&gt;Method Not Allowed&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 406&quot;&gt;Not Acceptable&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 407&quot;&gt;Proxy Authentication Required&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 408&quot;&gt;Request Timeout&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 409&quot;&gt;Conflict&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 410&quot;&gt;Gone&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 411&quot;&gt;Length Required&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 412&quot;&gt;Precondition Failed&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 413&quot;&gt;Request Entity Too Large&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 414&quot;&gt;Request URI Too Large&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 415&quot;&gt;Unsupported Media Type&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 416&quot;&gt;Request Range Not Satisfiable&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 417&quot;&gt;Expectation Failed&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 422&quot;&gt;Unprocessable Entity&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 424&quot;&gt;Locked/Failed Dependency&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 433&quot;&gt;Unprocessable Entity&lt;/xsl:when&gt;

      &lt;!-- Server Error --&gt;
      &lt;xsl:when test=&quot;$code = 500&quot;&gt;Internal Server Error&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 501&quot;&gt;Not Implemented&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 502&quot;&gt;Bad Gateway&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 503&quot;&gt;Service Unavailable&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 504&quot;&gt;Gateway Timeout&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 505&quot;&gt;HTTP Version Not Supported&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 507&quot;&gt;Insufficient Storage&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 600&quot;&gt;Squid: header parsing error&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 601&quot;&gt;Squid: header size overflow detected while parsing/roundcube: software configuration error&lt;/xsl:when&gt;
      &lt;xsl:when test=&quot;$code = 603&quot;&gt;roundcube: invalid authorization&lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:value-of select=&quot;concat('Unknown Code:', $code)&quot; /&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;

</code></pre>


    <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
    <div class="card-text" style="font-size: smaller; text-align: center;">
      
      <span class="" style="font-size: smaller">BlueCoat XSLT Translation</span>
      
      (
      <a href="../../../files/HOWTOs/EventFeeds/ProcessingHowTo/BlueCoat.xslt" class="" style="font-size: smaller">Download BlueCoat.xslt</a>
      <i class="external-link-icon fas fa-file-download fa-sm text-secondary" title="External link"></i>
      )
    </div>
  </div>
</div>

<p>Refreshing the current event will show the <em>output</em> pane contains</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Events 
    xmlns=&quot;event-logging:3&quot; 
    xmlns:stroom=&quot;stroom&quot; 
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
    xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; 
    xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.2.4.xsd&quot; 
    Version=&quot;3.2.4&quot;&gt;
  &lt;Event&gt;
    &lt;EventTime&gt;
      &lt;TimeCreated&gt;2005-05-04T17:16:12.000Z&lt;/TimeCreated&gt;
    &lt;/EventTime&gt;
    &lt;EventSource&gt;
      &lt;System&gt;
        &lt;Name&gt;Site http://log-sharing.dreamhosters.com/ Bluecoat Logs&lt;/Name&gt;
        &lt;Environment&gt;Development&lt;/Environment&gt;
      &lt;/System&gt;
      &lt;Generator&gt;Bluecoat Software: SGOS 3.2.4.28 Version: 1.0&lt;/Generator&gt;
      &lt;Device&gt;
        &lt;IPAddress&gt;192.16.170.42&lt;/IPAddress&gt;
        &lt;Data Name=&quot;ServiceType&quot; Value=&quot;SG-HTTP-Service&quot; /&gt;
      &lt;/Device&gt;
      &lt;Client&gt;
        &lt;IPAddress&gt;45.110.2.82&lt;/IPAddress&gt;
      &lt;/Client&gt;
      &lt;Server&gt;
        &lt;HostName&gt;www.inmobus.com&lt;/HostName&gt;
      &lt;/Server&gt;
      &lt;User&gt;
        &lt;Id&gt;george&lt;/Id&gt;
      &lt;/User&gt;
      &lt;Data Name=&quot;MyMeta&quot; Value=&quot;FQDN:somenode.strmdev00.org\nipaddress:192.168.2.220\nipaddress_eth0:192.168.2.220\nipaddress_lo:127.0.0.1\nipaddress_virbr0:192.168.122.1\n&quot; /&gt;
    &lt;/EventSource&gt;
    &lt;EventDetail&gt;
      &lt;TypeId&gt;Bluecoat-GET-http&lt;/TypeId&gt;
      &lt;Description&gt;Receipt of information from a Resource via Proxy&lt;/Description&gt;
      &lt;Receive&gt;
        &lt;Source&gt;
          &lt;Device&gt;
            &lt;IPAddress&gt;45.110.2.82&lt;/IPAddress&gt;
          &lt;/Device&gt;
        &lt;/Source&gt;
        &lt;Destination&gt;
          &lt;Device&gt;
            &lt;HostName&gt;www.inmobus.com&lt;/HostName&gt;
          &lt;/Device&gt;
        &lt;/Destination&gt;
        &lt;Payload&gt;
          &lt;Resource&gt;
            &lt;URL&gt;http://www.inmobus.com/wcm/assets/images/imagefileicon.gif&lt;/URL&gt;
            &lt;HTTPMethod&gt;GET&lt;/HTTPMethod&gt;
            &lt;UserAgent&gt;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&lt;/UserAgent&gt;
            &lt;InboundSize&gt;941&lt;/InboundSize&gt;
            &lt;OutboundSize&gt;729&lt;/OutboundSize&gt;
            &lt;RequestTime&gt;1&lt;/RequestTime&gt;
            &lt;ResponseCode&gt;200&lt;/ResponseCode&gt;
            &lt;MimeType&gt;image/gif&lt;/MimeType&gt;
            &lt;Data Name=&quot;s-action&quot; Value=&quot;TCP_HIT&quot; /&gt;
            &lt;Data Name=&quot;cs-uri-scheme&quot; Value=&quot;http&quot; /&gt;
            &lt;Data Name=&quot;s-hierarchy&quot; Value=&quot;DIRECT&quot; /&gt;
            &lt;Data Name=&quot;sc-filter-result&quot; Value=&quot;PROXIED&quot; /&gt;
            &lt;Data Name=&quot;x-icap-error-code&quot; Value=&quot;none&quot; /&gt;
          &lt;/Resource&gt;
        &lt;/Payload&gt;
      &lt;/Receive&gt;
    &lt;/EventDetail&gt;
  &lt;/Event&gt;
&lt;/Events&gt;
</code></pre>
<p>for the given input</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;records xmlns=&quot;records:2&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;records:2 file://records-v2.0.xsd&quot; version=&quot;2.0&quot;&gt;
  &lt;record&gt;
    &lt;data name=&quot;date&quot; value=&quot;2005-05-04&quot; /&gt;
    &lt;data name=&quot;time&quot; value=&quot;17:16:12&quot; /&gt;
    &lt;data name=&quot;time-taken&quot; value=&quot;1&quot; /&gt;
    &lt;data name=&quot;c-ip&quot; value=&quot;45.110.2.82&quot; /&gt;
    &lt;data name=&quot;sc-status&quot; value=&quot;200&quot; /&gt;
    &lt;data name=&quot;s-action&quot; value=&quot;TCP_HIT&quot; /&gt;
    &lt;data name=&quot;sc-bytes&quot; value=&quot;941&quot; /&gt;
    &lt;data name=&quot;cs-bytes&quot; value=&quot;729&quot; /&gt;
    &lt;data name=&quot;cs-method&quot; value=&quot;GET&quot; /&gt;
    &lt;data name=&quot;cs-uri-scheme&quot; value=&quot;http&quot; /&gt;
    &lt;data name=&quot;cs-host&quot; value=&quot;www.inmobus.com&quot; /&gt;
    &lt;data name=&quot;cs-uri-path&quot; value=&quot;/wcm/assets/images/imagefileicon.gif&quot; /&gt;
    &lt;data name=&quot;cs-uri-query&quot; value=&quot;-&quot; /&gt;
    &lt;data name=&quot;cs-username&quot; value=&quot;george&quot; /&gt;
    &lt;data name=&quot;s-hierarchy&quot; value=&quot;DIRECT&quot; /&gt;
    &lt;data name=&quot;s-supplier-name&quot; value=&quot;38.112.92.20&quot; /&gt;
    &lt;data name=&quot;rs(Content-Type)&quot; value=&quot;image/gif&quot; /&gt;
    &lt;data name=&quot;cs(User-Agent)&quot; value=&quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)&quot; /&gt;
    &lt;data name=&quot;sc-filter-result&quot; value=&quot;PROXIED&quot; /&gt;
    &lt;data name=&quot;sc-filter-category&quot; value=&quot;none&quot; /&gt;
    &lt;data name=&quot;x-virus-id&quot; value=&quot;-&quot; /&gt;
    &lt;data name=&quot;s-ip&quot; value=&quot;192.16.170.42&quot; /&gt;
    &lt;data name=&quot;s-sitename&quot; value=&quot;SG-HTTP-Service&quot; /&gt;
    &lt;data name=&quot;x-virus-details&quot; value=&quot;-&quot; /&gt;
    &lt;data name=&quot;x-icap-error-code&quot; value=&quot;none&quot; /&gt;
    &lt;data name=&quot;x-icap-error-details&quot; value=&quot;-&quot; /&gt;
  &lt;/record&gt;
&lt;/records&gt;
</code></pre>
<p>Do not forget to Save 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 the translation as we are complete.</p>
<h3 id="schema-validation">Schema Validation</h3>
<p>One last point, validating the use of the Stroom Event Logging Schema is performed in the <code>schemaFilter</code> component of the pipeline.
Had our translation resulted in a malformed Event, this pipeline component displays any errors.
In the screen below, we have purposely changed the <code>EventTime/TimeCreated</code> element to be <code>EventTime/TimeCreatd</code>.
If one selects the <code>schemaFilter</code> component and then Refresh 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh step" 
    alt="refresh-green.svg">


 the current step, we will see that</p>
<ul>
<li>
<p>there is an error as indicated by a square <strong>Red</strong> box 









  <img 
    class="stroom-icon " 
    src="../../../images/HOWTOs/icons/errorIndicator.png" 
    title="Error indicator" 
    alt="../HOWTOs/icons/errorIndicator.png">


 in the top right hand corner</p>
</li>
<li>
<p>there is a <strong>Red</strong> rectangle line indicator mark 









  <img 
    class="stroom-icon " 
    src="../../../images/HOWTOs/icons/errorLine.png" 
    title="Error line indicator" 
    alt="../HOWTOs/icons/errorLine.png">


 on the right hand side in the display slide bar</p>
</li>
<li>
<p>there is a <strong>Red</strong> error marker 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/error.svg" 
    title="Error" 
    alt="error.svg">


 in the left hand gutter.</p>
</li>
</ul>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-47.png" href="../../../images/HOWTOs/UI-FeedProcessing-47.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-47.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-47.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping XSLT Translation 6</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Hovering over the error marker 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/error.svg" 
    title="Error" 
    alt="error.svg">


 on the left hand side will bring a pop-up describing the error.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-48.png" href="../../../images/HOWTOs/UI-FeedProcessing-48.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-48.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-48.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping XSLT Translation 7</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this point, close the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> stepping tab, acknowledging you do not want to save your errant changes</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-49.png" href="../../../images/HOWTOs/UI-FeedProcessing-49.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-49.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-49.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Create Feed - Translation - Stepping XSLT Translation 8</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>by pressing the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button.</p>
<h2 id="automated-processing">Automated Processing</h2>
<p>Now that we have authored our translation, we want to enable Stroom to automatically process streams of raw event log data as it arrives.
We do this by configuring a <code>Processor</code> in the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>pipeline</code>.</p>
<h3 id="adding-a-pipeline-processor">Adding a Pipeline Processor</h3>
<p>Open the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>pipeline</code> by selecting it (<em>double left click</em>) in the <code>Explorer</code> display to show</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-50.png" href="../../../images/HOWTOs/UI-FeedProcessing-50.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-50.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-50.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>To configure a Processor we select the <code>Processors</code> hyper-link of the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Pipeline</code> tab to reveal</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-51.png" href="../../../images/HOWTOs/UI-FeedProcessing-51.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-51.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-51.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Processors table</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We add a Processor by pressing the add processor button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add processor" 
    alt="add.svg">


 in the top left hand corner.
At this you will be presented with an <code>Add Filter</code> configuration window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-52.png" href="../../../images/HOWTOs/UI-FeedProcessing-52.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-52.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-52.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Add Filter 1</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As we wish to create a Processor that will automatically process all <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> feed <code>Raw Events</code> we will select the BlueCoat-Proxy-V1.0-EVENTS <code>Feed</code> and Raw Event <code>Stream Type</code>.</p>
<p>To select the feed, we press the <code>Edit</code> button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/edit.svg" 
    title="Edit" 
    alt="edit.svg">


.
At this, the <code>Choose Feeds To Include And Exclude</code> configuration window is displayed.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-53.png" href="../../../images/HOWTOs/UI-FeedProcessing-53.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-53.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-53.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Add Filter 2</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As we need to <code>Include</code> the BlueCoat-Proxy-V1.0-EVENTS <code>Feed</code> in our selection, press the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add" 
    alt="add.svg">


 button in the <code>Include:</code> pane of the window to be presented with a <code>Choose Item</code> configuration window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-54.png" href="../../../images/HOWTOs/UI-FeedProcessing-54.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-54.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-54.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Add Filter 3</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Navigate to the <strong>Event Sources/Proxy/BlueCoat</strong> folder and select the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Feed</code></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-55.png" href="../../../images/HOWTOs/UI-FeedProcessing-55.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-55.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-55.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Add Filter 4</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button to select and see that the feed is included.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-56.png" href="../../../images/HOWTOs/UI-FeedProcessing-56.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-56.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-56.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Add Filter 5</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Again press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button to close the <code>Choose Feeds To Include And Exclude</code> window to show that we have selected our feed in the <code>Feeds:</code> selection pane of the <code>Add Filter</code> configuration window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-57.png" href="../../../images/HOWTOs/UI-FeedProcessing-57.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-57.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-57.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Add Filter 6</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We now need to select our <code>Stream Type</code>.
Press the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add" 
    alt="add.svg">


 button in the <code>Stream Types:</code> pane of the window to be presented with a <code>Add Stream Type</code> window with a <code>Stream Type:</code> selection drop down.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-58.png" href="../../../images/HOWTOs/UI-FeedProcessing-58.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-58.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-58.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Add Filter 7</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We select (<em>left click</em>) the drop down selection to display the types of Stream we can choose</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-59.png" href="../../../images/HOWTOs/UI-FeedProcessing-59.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-59.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-59.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Add Filter 8</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and as we are selecting <code>Raw Events</code> we select that item then press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button at which we see that our <code>Add Filter</code> configuration window displays</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-60.png" href="../../../images/HOWTOs/UI-FeedProcessing-60.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-60.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-60.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Add Filter 9</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As we have selected our filter items, press the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button to display our configured Processors.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-61.png" href="../../../images/HOWTOs/UI-FeedProcessing-61.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-61.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-61.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We now see our display is divided into two panes.
The Processors table pane at the top and the specific Processor pane below.
In our case, our filter selection has left the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> <code>Filter</code> selected in the Processors table</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-62.png" href="../../../images/HOWTOs/UI-FeedProcessing-62.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-62.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-62.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors - Selected Processor</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and the specific filter&rsquo;s details in the bottom pane.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-63.png" href="../../../images/HOWTOs/UI-FeedProcessing-63.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-63.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-63.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors - Selected Processor Detail</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The column entries in the Processors Table pane describe</p>
<ul>
<li>Pipeline - the name of the Processor pipeline (









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/filter.svg" 
    title="Filter" 
    alt="filter.svg">


)</li>
<li>Tracker Ms - the last time the tracker updated</li>
<li>Tracker % - the percentage of available streams completed</li>
<li>Last Poll Age - the last time the processor found new streams to process</li>
<li>Task Count - the number of processor tasks currently running</li>
<li>Priority - the queue scheduling priority of task submission to available stream processors</li>
<li>Streams - the number of streams that have been processed (includes currently running streams)</li>
<li>Events - ??</li>
<li>Status - the status of the processor.</li>
<li>Normally empty if the number of stream is open-ended.</li>
<li>If only are subset of streams were chosen (e.g. a time range in the filter) then the status will be <em>Complete</em></li>
<li>Enabled - check box to indicate the processor is enabled</li>
</ul>
<p>We now need only <code>Enable</code> both the pipeline Processor and the pipeline Filter for automatic processing to occur.
We do this by selecting both check boxes in the <code>Enabled</code> column.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-64.png" href="../../../images/HOWTOs/UI-FeedProcessing-64.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-64.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-64.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors - Enable Processor</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we refresh our Processor table by pressing the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


 button in the top right hand corner, we will see that more table entries have been filled in.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-65.png" href="../../../images/HOWTOs/UI-FeedProcessing-65.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-65.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-65.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors - Enable Processor Result</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We see that the tracker last updated at <em>2018-07-14T04:00:35.289Z</em>, the percentage complete is <em>100</em> (we only had one stream after all), the last time active streams were checked for was <em>2.3</em> minutes ago, there are no tasks running and that <em>1</em> stream has completed.
Note that the <code>Status</code> column is blank as we have an <em>open ended</em> filter in that the processor will continue to select and process any new stream of <code>Raw Events</code> coming into the <strong>BlueCoat-Proxy-V1.0-EVENTS</strong> feed.</p>
<p>If we return to the <em>BlueCoat-Proxy-V1.0-EVENTS</em>* <code>Feed</code> tab, ensuring the <strong>Data</strong> hyper-link is selected and then refresh (









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


) the top pane that holds the summary of the latest Feed streams</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-66.png" href="../../../images/HOWTOs/UI-FeedProcessing-66.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-66.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-66.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors - Feed Display</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We see a new entry in the table.
The columns display</p>
<ul>
<li>Created - The time the stream was created.</li>
<li>Type - The type of stream.
Our new entry has a type of &lsquo;Events&rsquo; as we have processed our <code>Raw Events</code> data.</li>
<li>Feed - The name of the stream&rsquo;s feed</li>
<li>Pipeline - The name of the pipeline involved in the generation of the stream</li>
<li>Raw - The size in bytes of the raw stream data</li>
<li>Disk - The size in bytes of the raw stream data when stored in compressed form on the disk</li>
<li>Read - The number of records read by a pipeline</li>
<li>Write - The number of records (events) written by a pipeline.
In this case the difference is that we did not generate events for the <code>Software</code> or <code>Version</code> records we read.</li>
<li>Fatal - The number of fatal errors the pipeline encountered when processing this stream</li>
<li>Error - The number of errors the pipeline encountered when processing this stream</li>
<li>Warn - The number of warnings the pipeline encountered when processing this stream</li>
<li>Info - The number of informational alerts the pipeline encountered when processing this stream</li>
<li>Retention - The retention period for this stream of data</li>
</ul>
<p>If we also refresh (









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


) the specific feed pane (middle) we again see a new entry of the <code>Events</code> <em>Type</em></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-67.png" href="../../../images/HOWTOs/UI-FeedProcessing-67.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-67.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-67.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors - Specific Feed Display</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we select (<em>left click</em>) on the <code>Events</code> <em>Type</em> in either pane, we will see that the data pane displays the first event in the <em>GCHQ Stroom Event Logging XML Schema</em> form.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-68.png" href="../../../images/HOWTOs/UI-FeedProcessing-68.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-68.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-68.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors - Event Display</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We can now send a file of BlueCoat Proxy logs to our Stroom instance from a Linux host using <em>curl</em> command and see how Stroom will automatically processes the file.
Use the command</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">curl \
-k \
--data-binary @sampleBluecoat.log \
https://stroomp.strmdev00.org/stroom/datafeed \
-H&#34;Feed:BlueCoat-Proxy-V1.0-EVENTS&#34; \
-H&#34;Environment:Development&#34; \
-H&#34;LogFileName:sampleBluecoat.log&#34; \
-H&#34;MyHost:\&#34;somenode.strmdev00.org\&#34;&#34; \
-H&#34;MyIPaddress:\&#34;192.168.2.220 192.168.122.1\&#34;&#34; \
-H&#34;System:Site http://log-sharing.dreamhosters.com/ Bluecoat Logs&#34; \
-H&#34;Version:V1.0&#34;</code></pre>
</div>

<p>After Stroom&rsquo;s Proxy aggregation has occurred, we will see that the new file posted via <em>curl</em> has been loaded into Stroom as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-69.png" href="../../../images/HOWTOs/UI-FeedProcessing-69.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-69.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-69.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors - New Posted Stream</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and this new <em>Raw Event</em> stream is automatically processed a few seconds later as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-70.png" href="../../../images/HOWTOs/UI-FeedProcessing-70.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-70.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-70.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors - New Posted Stream Processed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We note that since we have used the same sample file again, the Stream sizes and record counts are the same.</p>
<p>If we switch to the <code>Processors</code> tab of the pipeline we see that the Tracker timestamp has changed and the number of Streams processed has increased.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/UI-FeedProcessing-71.png" href="../../../images/HOWTOs/UI-FeedProcessing-71.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/UI-FeedProcessing-71.png" style="max-width: fit-content" alt="images/HOWTOs/UI-FeedProcessing-71.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI Enable Processing - Configured Processors - New Posted Stream Processors</figcaption>
      </div>
      
    </figure>
  </a>
</div>


</div>




    
	
  

    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '6.'; page-break-before: always">
    
  <h1 id="pg-87a637151168d6d82c881ea18b31af35">6 - Reference Feeds</h1>
    
	
</div>




    
      
  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '6.1.'; ">
    
  <h1 id="pg-4d7d330b5f12d891a26573075b19d451">6.1 - Use a Reference Feed</h1>
    <div class="lead">How to use a reference data feed to perform temporal lookups to enrich events.</div>
	<!-- Created with Stroom v6.1-beta.16  -->

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">See Also</h4>


    <p><a href="../../../docs/howtos/referencefeeds/createsimplereferencefeed/">HOWTO - Creating a Simple Reference Feed</a></p>


</div>


<h2 id="introduction">Introduction</h2>
<p>Reference feeds are temporal stores of reference data that a translation can look up to enhance an Event with additional data.
For example, rather than storing a person’s full name and phone number in every event, we can just store their user id and, based on this value, look up the associated user data and decorate the event.
In the description below, we will make use of the <code>GeoHost-V1.0-REFERENCE</code> reference feed defined in separate HOWTO document.</p>
<h2 id="using-a-reference-feed">Using a Reference Feed</h2>
<p>To use a Reference Feed, one uses the Stroom xslt function stroom:lookup().
This function is found within the xml namespace xmlns:stroom=&ldquo;stroom&rdquo;.</p>
<p>The lookup function has two mandatory arguments and three optional as per</p>
<ul>
<li><em>lookup(String map, String key)</em> Look up a reference data map using the period start time</li>
<li><em>lookup(String map, String key, String time)</em> Look up a reference data map using a specified time, e.g. the event time</li>
<li><em>lookup(String map, String key, String time, Boolean ignoreWarnings)</em> Look up a reference data map using a specified time, e.g. the event time, and ignore any warnings generated by a failed lookup</li>
<li><em>lookup(String map, String key, String time, Boolean ignoreWarnings, Boolean trace)</em> Look up a reference data map using a specified time, e.g. the event time, ignore any warnings generated by a failed lookup and get trace information for the path taken to resolve the lookup.</li>
</ul>
<p>Let&rsquo;s say, we have the Event fragment</p>
<pre><code class="language-xml">&lt;Event&gt;
    &lt;EventTime&gt;
      &lt;TimeCreated&gt;2020-01-18T20:39:04.000Z&lt;/TimeCreated&gt;
    &lt;/EventTime&gt;
    &lt;EventSource&gt;
      &lt;System&gt;
        &lt;Name&gt;LinuxWebServer&lt;/Name&gt;
        &lt;Environment&gt;Production&lt;/Environment&gt;
      &lt;/System&gt;
      &lt;Generator&gt;Apache  HTTPD&lt;/Generator&gt;
      &lt;Device&gt;
        &lt;HostName&gt;stroomnode00.strmdev00.org&lt;/HostName&gt;
        &lt;IPAddress&gt;192.168.2.245&lt;/IPAddress&gt;
      &lt;/Device&gt;
      &lt;Client&gt;
        &lt;IPAddress&gt;192.168.4.220&lt;/IPAddress&gt;
        &lt;Port&gt;61801&lt;/Port&gt;
      &lt;/Client&gt;
      &lt;Server&gt;
        &lt;HostName&gt;stroomnode00.strmdev00.org&lt;/HostName&gt;
        &lt;Port&gt;443&lt;/Port&gt;
      &lt;/Server&gt;
    ...
    &lt;/EventSource&gt;
</code></pre>
<p>then the following XSLT would lookup our <code>GeoHost-V1.0-REFERENCE</code> Reference map to find the FQDN of our client</p>
<pre><code class="language-xml">&lt;xsl:variable name=&quot;chost&quot; select=&quot;stroom:lookup('IP_TO_FQDN', data[@name = 'clientip']/@value)&quot; /&gt; 
</code></pre>
<p>And the XSLT to find the IP Address for our Server would be</p>
<pre><code class="language-xml">&lt;xsl:variable name=&quot;sipaddr&quot; select=&quot;stroom:lookup('FQDN_TO_IP', data[@name = 'vserver']/@value)&quot;  /&gt;
</code></pre>
<p>In practice, one would also pass the time element as well as setting ignoreWarnings to true(). i.e.</p>
<pre><code class="language-xml">&lt;xsl:variable name=&quot;chost&quot; select=&quot;stroom:lookup('IP_TO_FQDN', data[@name = 'clientip']/@value, $formattedDate, true())&quot;  /&gt;
...
&lt;xsl:variable name=&quot;sipaddr&quot; select=&quot;stroom:lookup('FQDN_TO_IP',  data[@name = 'vserver']/@value, $formattedDate, true())&quot;  /&gt;
</code></pre>
<h2 id="modifying-an-event-feed-to-use-a-reference-feed">Modifying an Event Feed to use a Reference Feed</h2>
<p>We will now modify an Event feed to have it lookup our <code>GeoHost-V1.0-REFERENCE</code> reference maps to add additional information to the event.
The feed for this exercise is the <code>Apache-SSL-BlackBox-V2.0-EVENTS</code> event feed which processes Apache HTTPD SSL logs which make use of a variation on the BlackBox log format.
We will step through a Raw Event stream and modify the translation directly.
This way, we see the changes directly.</p>
<p>Using the Explorer pane’s <em>Quick Filter</em>, entry box, we will find the Apache feed.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-00.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-00.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Explorer pane Quick Filter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>First, select the <em>Quick Filter</em> text entry box and type Apache (the Quick Filter is case insensitive).
At this you will see the Explorer pane system group structure reduce down to just the <code>Event Sources</code>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-01.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-01.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Explorer pane Quick Filter -reduced structure</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The Explorer pane will display any resources that match our <code>Apache</code> string.
Double clicking on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Feed.svg" 
    title="Feed" 
    alt="document/Feed.svg">


 <em>Apache-SSL-BlackBox-V2.0-EVENTS</em> Feed will select it, and bring up the Feed’s tab in the main window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-03.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-03.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Explorer pane Quick Filter -selected feed displayed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We click on the tab’s Data sub-item and then select the most recent Raw Events stream.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-04.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-04.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Select specific raw event stream</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now, select the check box on the Raw Events stream in the Specific Stream (middle) pane.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-05.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-05.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Selected stream check box</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note that, when we check the box, we see that the Process, Delete and Download icons (









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/process.svg" 
    title="Process" 
    alt="process.svg">


 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/delete.svg" 
    title="Delete" 
    alt="delete.svg">


 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/download.svg" 
    title="Download" 
    alt="download.svg">


) are enabled.</p>
<p>We enter Stepping Mode by pressing the stepping button found at the bottom right corner of the Data/Meta-data pane.
You will then be requested to choose a pipeline to step with, with the selection already pre-selected</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-07.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-07.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-07.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-07.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Stepping pipeline selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This auto pre-selection is a simple pattern matching action by Stroom.
Press <strong>OK</strong> to start the stepping which displays the pipeline stepping tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-08.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-08.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-08.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-08.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Stepping pipeline source display</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Select the 








  
  










<span class="pipeline-element" title="translationFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="translationFilter" 
    alt="xslt.svg">
  <span>translationFilter</span>
</span>
 element to reveal the translation we plan to modify.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-09.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-09.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-09.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-09.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Stepping pipeline xslt translation filter selected</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>To bring up the first event from the stream, press the Step Forward button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step forward" 
    alt="step-forward-green.svg">


 to show</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-10.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-10.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-10.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-10.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Stepping pipeline - first event</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We scroll the translation pane to show the XSLT segment that deals with the <Client> and <Server> elements</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-11.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-11.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-11.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-11.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Stepping pipeline Client/Server code</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and also scroll the translation output pane to display the <Client> and <Server> elements</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-12.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-12.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-12.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-12.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Stepping pipeline translation output pane</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We modify the Client xslt segment to change</p>
<pre><code class="language-xml">    &lt;Client&gt;
        &lt;IPAddress&gt;
            &lt;xsl:value-of select=&quot;data[@name =  'clientip']/@value&quot;  /&gt;
        &lt;/IPAddress&gt;
        &lt;Port&gt;
            &lt;xsl:value-of select=&quot;data[@name =  'clientport']/@value&quot;  /&gt;
        &lt;/Port&gt;
    &lt;/Client&gt;
</code></pre>
<p>to</p>
<pre><code class="language-xml">    &lt;Client&gt;
        &lt;xsl:variable name=&quot;chost&quot; select=&quot;stroom:lookup('IP_TO_FQDN', data[@name = 'clientip']/@value)&quot; /&gt;
        &lt;xsl:if  test=&quot;$chost&quot;&gt;&quot;
            &lt;HostName&gt;
                &lt;xsl:value-of  select=&quot;$chost&quot; /&gt;
            &lt;/HostName&gt;
        &lt;/xsl:if&gt;
            &lt;IPAddress&gt;
                &lt;xsl:value-of select=&quot;data[@name =  'clientip']/@value&quot;  /&gt;
            &lt;/IPAddress&gt;
        &lt;xsl:if test=&quot;data[@name =  'clientport']/@value !='-'&quot;&gt;
            &lt;Port&gt;
                &lt;xsl:value-of select=&quot;data[@name =  'clientport']/@value&quot;  /&gt;
            &lt;/Port&gt;
        &lt;/xsl:if&gt;
    &lt;/Client&gt;
</code></pre>
<p>and then we press the Refresh Current Step icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh" 
    alt="refresh-green.svg">


.</p>
<p>BUT NOTHING CHANGES !!!</p>
<p>Not quite, you will note in the top right of the translation pane some <strong>yellow</strong> boxes.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-13.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-13.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-13.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-13.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Stepping pipeline warning</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If you click on the top square box, you will see the WARN: 1 selection window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-14.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-14.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-14.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-14.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Stepping pipeline WARN:1</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Clicking on the yellow rectangle box below the yellow square box, the translation pane will automatically scroll back to the top of the translation and show the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/alert.svg" 
    title="Alert" 
    alt="alert.svg">


 icon.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-16.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-16.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-16.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-16.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Stepping pipeline Warning</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Clicking on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/alert.svg" 
    title="Alert" 
    alt="alert.svg">


 icon will reveal the actual warning message.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-17.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-17.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-17.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-17.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Stepping pipeline Warning message</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The problem is that, the pipeline cannot find the Reference.
To allow a pipeline to find reference feeds, we need to modify the translation parameters within the pipeline.
The pipeline for this Event feed is called <code>APACHE-SSLBlack-Box-V2.0-EVENTS</code>.
Open this pipeline by double clicking on its entry in the Explorer window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-18.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-18.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-18.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-18.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Launch Pipeline</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then switch to the <strong>Structure</strong> sub-item</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-19.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-19.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-19.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-19.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Pipeline display structure</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and then select the 








  
  










<span class="pipeline-element" title="translationFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="translationFilter" 
    alt="xslt.svg">
  <span>translationFilter</span>
</span>
 element to reveal</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-20.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-20.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-20.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-20.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Pipeline translationFilter structure</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The top pane shows the pipeline, in this case, the selected translation filter 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="Xslt" 
    alt="pipeline/xslt.svg">


 element of the pipeline.
The middle pane shows the <em>Properties</em> for this element - we see that it has an <strong>xslt</strong> property of the <code>APACHE-BlackBoxV2.0-EVENTS</code> translation.
The bottom pane is the one we are interested in.
In the case of translation Filters, this pane allows one to associate Reference streams with the translation Filter.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-21.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-21.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-21.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-21.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - New Reference selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>So, to associate our <code>GeoHost-V1.0-REFERENCE</code> reference feed with this translation filter, click on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add" 
    alt="add.svg">


 New  Reference icon to bring up the <em>New Pipeline Reference</em> selection window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-22.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-22.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-22.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-22.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - New Pipeline Reference</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>For <strong>Pipeline:</strong> use the menu selector 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/assorted/popup.png" 
    title="Menu selection" 
    alt="assorted/popup.png">


 and choose the Reference Loader pipeline and then press <strong>OK</strong></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-23.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-23.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-23.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-23.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Choose Pipeline</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>For <strong>Feed:</strong>, navigate to the reference feed we want, that is the <code>GeoHost-V1.0-REFERENCE</code> reference feed and press <strong>OK</strong></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-24.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-24.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-24.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-24.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Pipeline translationFilter Feed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>And finally, for <strong>Stream Type:</strong> choose Reference from the drop-down menu</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-25.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-25.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-25.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-25.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Pipeline translationFilter Stream Type</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press <strong>OK</strong> to save the new reference.
We now see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-26.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-26.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-26.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-26.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Pipeline translationFilter - Configured</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Save these pipeline changes by pressing the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 icon in the top left then switch back to the APACHE-SSLBlackBox-V2.0-EVENTS stepping tab.</p>
<p>Pressing the Refresh Current Step 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh" 
    alt="refresh-green.svg">


 icon will remove the warning and we now note that the output pane now shows the <code>&lt;Client/HostName&gt;</code> element.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-27.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-27.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-27.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-27.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - output pane with Client/HostName element</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>To complete the translation, we will add reference lookups for the <code>&lt;Server/HostName&gt;</code> element and we will also add <code>&lt;Location&gt;</code> elements to both the <code>&lt;Client&gt;</code> and <code>&lt;Server&gt;</code> elements.</p>
<p>The completed code segment looks like</p>
<pre><code class="language-xml">    ...

    &lt;!-- Set some variables to enable lookup functionality  --&gt;
    &lt;xsl:variable name=&quot;formattedDate&quot; select=&quot;stroom:format-date(data[@name =  'time']/@value, 'dd/MMM/yyyy:HH:mm:ss XX')&quot; /&gt;

    &lt;!--  For Version 2.0 of Apache  audit we  have the virtual  server,  so this  will be our server --&gt;
    &lt;xsl:variable name=&quot;vServer&quot; select=&quot;data[@name  =  'vserver']/@value&quot;  /&gt;
    &lt;xsl:variable name=&quot;vServerPort&quot; select=&quot;data[@name =  'vserverport']/@value&quot;  /&gt;

    ...
 
    &lt;!-- --&gt;
    &lt;Client&gt;
    &lt;!--  See if we  can get the client  HostName from  the given IP address --&gt;
    &lt;xsl:variable name=&quot;chost&quot; select=&quot;stroom:lookup('IP_TO_FQDN',data[@name  =  'host']/@value, $formattedDate, true())&quot;  /&gt;
        &lt;xsl:if  test=&quot;$chost&quot;&gt;
        &lt;HostName&gt;
            &lt;xsl:value-of  select=&quot;$chost&quot; /&gt;
        &lt;/HostName&gt;
        &lt;/xsl:if&gt;
        &lt;IPAddress&gt;
            &lt;xsl:value-of select=&quot;data[@name =  'clientip']/@value&quot;  /&gt;
        &lt;/IPAddress&gt;
        &lt;xsl:if test=&quot;data[@name =  'clientport']/@value !='-'&quot;&gt;
        &lt;Port&gt;
            &lt;xsl:value-of select=&quot;data[@name =  'clientport']/@value&quot;  /&gt;
        &lt;/Port&gt;
        &lt;/xsl:if&gt;

    &lt;!--  See if we  can get the client  Location for the client  FQDN if we  have it --&gt;
    &lt;xsl:variable name=&quot;cloc&quot; select=&quot;stroom:lookup('FQDN_TO_LOC', $chost,  $formattedDate, true())&quot;  /&gt;
        &lt;xsl:if  test=&quot;$chost != '' and $cloc&quot;&gt;
        &lt;xsl:copy-of select=&quot;$cloc&quot;  /&gt;
        &lt;/xsl:if&gt;
    &lt;/Client&gt;

    &lt;!-- --&gt;
    &lt;Server&gt;
        &lt;HostName&gt;
            &lt;xsl:value-of  select=&quot;$vServer&quot; /&gt;
        &lt;/HostName&gt;

    &lt;!--  See if we  can get  the  service  IPAddress --&gt;
    &lt;xsl:variable name=&quot;sipaddr&quot; select=&quot;stroom:lookup('FQDN_TO_IP',$vServer, $formattedDate,  true())&quot;  /&gt;
        &lt;xsl:if  test=&quot;$sipaddr&quot;&gt;
        &lt;IPAddress&gt;
            &lt;xsl:value-of  select=&quot;$sipaddr&quot; /&gt;
        &lt;/IPAddress&gt;
        &lt;/xsl:if&gt;

    &lt;!--  Server Port Number   --&gt;
        &lt;xsl:if test=&quot;$vServerPort !='-'&quot;&gt;
        &lt;Port&gt;
            &lt;xsl:value-of  select=&quot;$vServerPort&quot; /&gt;
        &lt;/Port&gt;
        &lt;/xsl:if&gt;

    &lt;!--  See if we  can get the Server location --&gt;
    &lt;xsl:variable name=&quot;sloc&quot;  select=&quot;stroom:lookup('FQDN_TO_LOC', $vServer, $formattedDate, true())&quot;  /&gt;
        &lt;xsl:if  test=&quot;$sloc&quot;&gt;
            &lt;xsl:copy-of select=&quot;$sloc&quot;  /&gt;
        &lt;/xsl:if&gt;
    &lt;/Server&gt;

</code></pre>
<p>Once the above modifications have been made to the XSLT, save these by pressing the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 icon in the top left corner of the pane.</p>
<p>Note the use of the fourth Boolean ignoreWarnings argument in the lookups.
We set this to true() as we may not always have the item in the reference map we want and Warnings consume space in the Stroom store file system.</p>
<p>Thus, the fragment from the output pane for our first event shows</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-28.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-28.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-28.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-28.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - output pane - first event</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and the fragment from the output pane for our last event of this stream shows</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-29.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-29.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-29.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-29.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - output pane - last event</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This is the XSLT Translation.






<div class="text-file card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="">

  <div class="card-body px-0 pt-2 pb-0">
    
    <pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet xpath-default-namespace=&quot;records:2&quot; xmlns=&quot;event-logging:3&quot; xmlns:stroom=&quot;stroom&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;3.0&quot;&gt;

  &lt;!-- Ingest the records tree --&gt;
  &lt;xsl:template match=&quot;records&quot;&gt;
    &lt;Events xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.2.3.xsd&quot; Version=&quot;3.2.3&quot;&gt;
        &lt;xsl:apply-templates /&gt;
    &lt;/Events&gt;
  &lt;/xsl:template&gt;

    &lt;!-- Only generate events if we have an url on input --&gt;
    &lt;xsl:template match=&quot;record[data[@name = 'url']]&quot;&gt;
        &lt;Event&gt;
            &lt;xsl:apply-templates select=&quot;.&quot; mode=&quot;eventTime&quot; /&gt;
            &lt;xsl:apply-templates select=&quot;.&quot; mode=&quot;eventSource&quot; /&gt;
            &lt;xsl:apply-templates select=&quot;.&quot; mode=&quot;eventDetail&quot; /&gt;
        &lt;/Event&gt;
    &lt;/xsl:template&gt;


    &lt;xsl:template match=&quot;node()&quot;  mode=&quot;eventTime&quot;&gt;
        &lt;EventTime&gt;
            &lt;TimeCreated&gt;
              &lt;xsl:value-of select=&quot;stroom:format-date(data[@name = 'time']/@value, 'dd/MMM/yyyy:HH:mm:ss XX')&quot; /&gt;
            &lt;/TimeCreated&gt;
        &lt;/EventTime&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match=&quot;node()&quot;  mode=&quot;eventSource&quot;&gt;
      &lt;!-- Set some variables to enable lookup functionality  --&gt;
      &lt;xsl:variable name=&quot;formattedDate&quot; select=&quot;stroom:format-date(data[@name =  'time']/@value, 'dd/MMM/yyyy:HH:mm:ss XX')&quot; /&gt;
      &lt;!--  For Version 2.0 of Apache  audit we  have the virtual  server,  so this  will be our server --&gt;
      &lt;xsl:variable name=&quot;vServer&quot; select=&quot;data[@name  =  'vserver']/@value&quot;  /&gt;
      &lt;xsl:variable name=&quot;vServerPort&quot; select=&quot;data[@name =  'vserverport']/@value&quot;  /&gt;
        &lt;EventSource&gt;
            &lt;System&gt;
              &lt;Name&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('System')&quot;  /&gt;
              &lt;/Name&gt;
              &lt;Environment&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('Environment')&quot;  /&gt;
              &lt;/Environment&gt;
            &lt;/System&gt;
            &lt;Generator&gt;Apache  HTTPD&lt;/Generator&gt;
            &lt;Device&gt;
              &lt;HostName&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('MyHost')&quot;  /&gt;
              &lt;/HostName&gt;
              &lt;IPAddress&gt;
                &lt;xsl:value-of select=&quot;stroom:feed-attribute('MyIPAddress')&quot;  /&gt;
              &lt;/IPAddress&gt;
            &lt;/Device&gt;
            &lt;Client&gt;
              &lt;xsl:variable name=&quot;chost&quot; select=&quot;stroom:lookup('IP_TO_FQDN', data[@name = 'clientip']/@value, $formattedDate, true())&quot; /&gt;
              &lt;xsl:if  test=&quot;$chost&quot;&gt;
                &lt;HostName&gt;
                    &lt;xsl:value-of  select=&quot;$chost&quot; /&gt;
                &lt;/HostName&gt;
              &lt;/xsl:if&gt;
                &lt;IPAddress&gt;
                    &lt;xsl:value-of select=&quot;data[@name =  'clientip']/@value&quot;  /&gt;
                &lt;/IPAddress&gt;
              &lt;xsl:if test=&quot;data[@name =  'clientport']/@value !='-'&quot;&gt;
                &lt;Port&gt;
                    &lt;xsl:value-of select=&quot;data[@name =  'clientport']/@value&quot;  /&gt;
                &lt;/Port&gt;
              &lt;/xsl:if&gt;
              &lt;xsl:variable name=&quot;cloc&quot; select=&quot;stroom:lookup('FQDN_TO_LOC', $chost,  $formattedDate, true())&quot;  /&gt;
              &lt;xsl:if  test=&quot;$chost != '' and $cloc&quot;&gt;
                &lt;xsl:copy-of select=&quot;$cloc&quot;  /&gt;
              &lt;/xsl:if&gt;
            &lt;/Client&gt;
            &lt;Server&gt;
                &lt;HostName&gt;
                    &lt;xsl:value-of  select=&quot;$vServer&quot; /&gt;
                &lt;/HostName&gt;
            &lt;!--  See if we  can get  the  service  IPAddress --&gt;
            &lt;xsl:variable name=&quot;sipaddr&quot; select=&quot;stroom:lookup('FQDN_TO_IP',$vServer, $formattedDate,  true())&quot;  /&gt;
            &lt;xsl:if  test=&quot;$sipaddr&quot;&gt;
                &lt;IPAddress&gt;
                    &lt;xsl:value-of  select=&quot;$sipaddr&quot; /&gt;
                &lt;/IPAddress&gt;
            &lt;/xsl:if&gt;
            &lt;!--  Server Port Number   --&gt;
            &lt;xsl:if test=&quot;$vServerPort !='-'&quot;&gt;
                &lt;Port&gt;
                    &lt;xsl:value-of  select=&quot;$vServerPort&quot; /&gt;
                &lt;/Port&gt;
            &lt;/xsl:if&gt;
            &lt;!--  See if we  can get the Server location --&gt;
            &lt;xsl:variable name=&quot;sloc&quot;  select=&quot;stroom:lookup('FQDN_TO_LOC', $vServer, $formattedDate, true())&quot;  /&gt;
            &lt;xsl:if  test=&quot;$sloc&quot;&gt;
                &lt;xsl:copy-of select=&quot;$sloc&quot;  /&gt;
            &lt;/xsl:if&gt;
            &lt;/Server&gt;
            &lt;User&gt;
              &lt;Id&gt;
                &lt;xsl:value-of select=&quot;data[@name='user']/@value&quot; /&gt;
              &lt;/Id&gt;
            &lt;/User&gt;
        &lt;/EventSource&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match=&quot;node()&quot;  mode=&quot;eventDetail&quot;&gt;
        &lt;EventDetail&gt;
          &lt;TypeId&gt;SendToWebService&lt;/TypeId&gt;
          &lt;Description&gt;Send/Access data to Web Service&lt;/Description&gt;
          &lt;Classification&gt;
            &lt;Text&gt;UNCLASSIFIED&lt;/Text&gt;
          &lt;/Classification&gt;
          &lt;Send&gt;
            &lt;Source&gt;
              &lt;Device&gt;
                &lt;IPAddress&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'clientip']/@value&quot;/&gt;
                &lt;/IPAddress&gt;
                &lt;Port&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'vserverport']/@value&quot;/&gt;
                &lt;/Port&gt;
              &lt;/Device&gt;
            &lt;/Source&gt;
            &lt;Destination&gt;
              &lt;Device&gt;
                &lt;HostName&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'vserver']/@value&quot;/&gt;
                &lt;/HostName&gt;
                &lt;Port&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'vserverport']/@value&quot;/&gt;
                &lt;/Port&gt;
              &lt;/Device&gt;
            &lt;/Destination&gt;
            &lt;Payload&gt;
              &lt;Resource&gt;
                &lt;URL&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'url']/@value&quot;/&gt;
                &lt;/URL&gt;
                &lt;Referrer&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'referer']/@value&quot;/&gt;
                &lt;/Referrer&gt;
                &lt;HTTPMethod&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'url']/data[@name = 'httpMethod']/@value&quot;/&gt;
                &lt;/HTTPMethod&gt;
                &lt;HTTPVersion&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'url']/data[@name = 'version']/@value&quot;/&gt;
                &lt;/HTTPVersion&gt;
                &lt;UserAgent&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'userAgent']/@value&quot;/&gt;
                &lt;/UserAgent&gt;
                &lt;InboundSize&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'bytesIn']/@value&quot;/&gt;
                &lt;/InboundSize&gt;
                &lt;OutboundSize&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'bytesOut']/@value&quot;/&gt;
                &lt;/OutboundSize&gt;
                &lt;OutboundContentSize&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'bytesOutContent']/@value&quot;/&gt;
                &lt;/OutboundContentSize&gt;
                &lt;RequestTime&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'timeM']/@value&quot;/&gt;
                &lt;/RequestTime&gt;
                &lt;ConnectionStatus&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'constatus']/@value&quot;/&gt;
                &lt;/ConnectionStatus&gt;
                &lt;InitialResponseCode&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'responseB']/@value&quot;/&gt;
                &lt;/InitialResponseCode&gt;
                &lt;ResponseCode&gt;
                    &lt;xsl:value-of select=&quot;data[@name = 'response']/@value&quot;/&gt;
                &lt;/ResponseCode&gt;
                &lt;Data Name=&quot;Protocol&quot;&gt;
                  &lt;xsl:attribute select=&quot;data[@name = 'url']/data[@name = 'protocol']/@value&quot; name=&quot;Value&quot;/&gt;
                &lt;/Data&gt;
              &lt;/Resource&gt;
            &lt;/Payload&gt;
            &lt;!-- Normally our translation at this point would contain an &lt;Outcome&gt; attribute.
            Since all our sample data includes only successful outcomes we have ommitted the &lt;Outcome&gt; attribute 
            in the translation to minimise complexity--&gt;
          &lt;/Send&gt;
        &lt;/EventDetail&gt;
    &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>


    <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
    <div class="card-text" style="font-size: smaller; text-align: center;">
      
      <span class="" style="font-size: smaller">Apache BlackBox with Lookups Translation XSLT</span>
      
      (
      <a href="../../../files/HOWTOs/ReferenceFeeds/ApacheHPPTDwithLookups-TranslationXSLT.xslt" class="" style="font-size: smaller">Download ApacheHPPTDwithLookups-TranslationXSLT.xslt</a>
      <i class="external-link-icon fas fa-file-download fa-sm text-secondary" title="External link"></i>
      )
    </div>
  </div>
</div>
</p>
<h2 id="troubleshooting-lookup-issues">Troubleshooting lookup issues</h2>
<p>If your lookup is not working as expected you can use the 5th argument of the lookup function to help investigate the issue.</p>
<p>If we return to the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="Xslt" 
    alt="pipeline/xslt.svg">


 element of the pipeline and change the xslt from</p>
<pre><code class="language-xml">    &lt;Client&gt;
        &lt;xsl:variable name=&quot;chost&quot; select=&quot;stroom:lookup('IP_TO_FQDN', data[@name = 'clientip']/@value, $formattedDate, true())&quot; /&gt;
</code></pre>
<p>to</p>
<pre><code class="language-xml">    &lt;Client&gt;
        &lt;xsl:variable name=&quot;chost&quot; select=&quot;stroom:lookup('IP_TO_FQDN', data[@name = 'clientip']/@value, $formattedDate, true(), true())&quot; /&gt;
</code></pre>
<p>and then we press the Refresh Current Step icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh" 
    alt="refresh-green.svg">


</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-30.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-30.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-30.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-30.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - lookup 5th argument</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>you will notice the two blue squares at the top right of the code pane</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-31.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-31.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-31.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-31.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - lookup 5th argument</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If you click on the lower blue square then the code screen will reposition to the beginning of the xslt.
Note the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/info.svg" 
    title="Information" 
    alt="info.svg">


 icon at the top left of the screen.
If you hover over this information icon you will
see information about the path taken to resolve the lookup.
Hopefully this additional information guides resolution of the lookup issue.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-UseReferenceFeed-32.png" href="../../../images/HOWTOs/v6/UI-UseReferenceFeed-32.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-UseReferenceFeed-32.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-UseReferenceFeed-32.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - lookup trace information</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Once you have completed your troubleshooting you can either remove the 5th argument from the lookup function, or set to false.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '6.2.'; page-break-before: always">
    
  <h1 id="pg-5a8e03835fa0abb246a40bb39bc465d5">6.2 - Create a Simple Reference Feed</h1>
    <div class="lead">How to create a reference feed for decorating event data using reference data lookups.</div>
	<!-- Created with Stroom v6.1-beta.16 -->
<h2 id="introduction">Introduction</h2>
<p>A <strong>Reference Feed</strong> is a temporal set of data that a pipeline&rsquo;s translation can look up to gain additional information to decorate the subject data of the translation.
For example, an XML Event.</p>
<p>A Reference Feed is temporal, in that, each time a new set of reference data is loaded into Stroom, the effective date (for the data) is also recorded.
Thus by using a timestamp field with the subject data, the appropriate batch of reference data can be accessed.</p>
<p>A typical reference data set to support the Stroom XML Event schema might be on that relates to devices.
Such a data set can contain the device logical identifiers such as fully qualified domain name and ip address and their geographical location information such as country, site, building, room and timezone.</p>
<p>The following example will describe how to create a reference feed for such device data.
We will call the reference feed <code>GeoHost-V1.0-REFERENCE</code>.</p>
<h2 id="reference-data">Reference Data</h2>
<p>Our reference data will be supplied in a <TAB> separated file containing the fields</p>
<ul>
<li>the device Fully Qualified Domain Name</li>
<li>the device IP Address</li>
<li>the device Country location (using ISO 3166-1 alpha-3 codes)</li>
<li>the device Site location</li>
<li>the device Building location</li>
<li>the device TimeZone location (both standard then daylight timezone offsets from UTC)</li>
</ul>
<p>For simplicity, our example will use a file with just 5 entries</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-75.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-75.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-75.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-75.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Raw Data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>A copy of this sample data source can be found <a href="GeoHostReference.log" title="GeoHost REFERENCE  sample logs">here</a>.
Save a copy of this data to your local environment for use later in this HOWTO.
Save this file as a text document with ANSI encoding.</p>
<h2 id="creation">Creation</h2>
<p>To create our Reference Event stream we need to create:</p>
<ul>
<li>the <strong>Feed</strong></li>
<li>a <strong>Pipeline</strong> to automatically process and store the Reference data</li>
<li>a <strong>Text Parser</strong> to convert the text file into simple XML record format, and</li>
<li>a <strong>Translation</strong> to create reference data maps</li>
</ul>
<h3 id="create-feed">Create Feed</h3>
<p>First, within the Explorer pane, and with the cursor having selected the Event Sources group, right click the mouse to have the object context menu appear.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-00.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-00.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Feed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If you hover over the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 New icon then the New sub-context menu will be revealed.</p>
<p>Now hover the mouse over the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/feed.svg" 
    title="Feed" 
    alt="feed.svg">


 Feed icon and right click to select.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-01.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-01.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Feed Selection window</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>When the <strong>New Feed</strong> selection windows comes up, navigate to the <code>Event Sources</code> system group.
Then enter the name of the reference feed <code>GeoHost-V1.0-REFERENCE</code> onto the <strong>Name:</strong> text entry box.
On pressing the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button we will see the following Feed configuration tab appear.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-03.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-03.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-03.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-03.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Feed Data tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Click on the <strong>Settings</strong> sub-item in the <code>GeoHost-V1.0-REFERENCE</code> Feed tab to populate the initial Settings configuration.
Enter an appropriate description, classification and click on the <strong>Reference Feed</strong> check box</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-04.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-04.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Feed Settings tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and we then use the Stream Type drop-down menu to set the stream type as Raw Reference.
At this point we save our configuration so far, by clicking on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 save icon.
The save icon becomes ghosted and our feed configuration has been saved.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-05.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-05.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Feed Settings window configuration</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h3 id="load-sample-reference-data">Load sample Reference data</h3>
<p>At this point we want to load our sample reference data, in order to develop our reference feed.
We can do this two ways - posting the file to our Stroom web server, or directly upload the data using the user interface.
For this example we will use Stroom&rsquo;s user interface upload facility.</p>
<p>First, open the <strong>Data</strong> sub-item in the <code>GeoHost-V1.0-REFERENCE</code> feed configuration tab to reveal</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-06.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-06.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Reference Data configuration tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/upload.svg" 
    title="Upload" 
    alt="upload.svg">


 Upload icon in the bottom left of the <strong>Stream table</strong> (top pane).
On clicking the Upload icon, we are presented with the data upload selection window.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-07.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-07.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-07.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-07.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload Selection window</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Naturally, as this is a reference feed we are creating and this is raw data we are uploading, we select a <strong>Stream Type:</strong> of Raw Reference.
We need to set the <strong>Effective:</strong> date (really a timestamp) for this specific <em>stream</em> of reference data.
Clicking in the <strong>Effective:</strong> entry box will cause a calendar selection window to be displayed (initially set to the current date).</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-08.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-08.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-08.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-08.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload data settings</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We are going to set the effective date to be late in 2019.
Normally, you would choose a time stamp that matches the generation of the reference data.
Click on the blue Previous Month icon (a less than symbol <code>&lt;</code>) on the Year/Month line to move back to December 2019.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-09.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-09.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-09.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-09.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Calendar Effective Date Selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Select the 1st (clicking on 1) at which point the calendar selection window will disappear and a time of 2019-12-01T00:00:00.000Z is displayed.
This is the default whenever  using the calendar selection window in Stroom - the resultant timestamp is that of the day selected at 00:00:00 (Zulu time).
To get the calendar selection window to disappear, click anywhere outside of the timestamp entry box.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-10.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-10.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-10.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-10.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload data choose file</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note, if you happen to click on the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button before selecting the <strong>File</strong> (or Stream Type for that matter), an appropriate Alert dialog box will be displayed</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-11.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-11.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-11.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-11.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload Data No file set</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We don&rsquo;t need to set <strong>Meta Data</strong> for this stream of reference data, but we (obviously) need to select the file.
For the purposes of this example, we will utilise the file <strong>GeoHostReference.log</strong> you downloaded earlier in the <strong>Reference Data</strong> section of this document.
This file contains a header and five lines of reference data as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-75.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-75.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-75.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-75.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI CreateReferenceFeed - Raw Data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>When we construct the pipeline for this reference feed, we will see how to make use of the header line.</p>
<p>So, click on the <strong>Choose File</strong> button to bring up a file selector window.
Navigate within the selector window to the location on your location machine where you have saved the GeoHostReference.log file.
On clicking <strong>Open</strong> we return to the <strong>Upload</strong> window with the file selected.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-12.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-12.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-12.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-12.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload Reference Data - File chosen</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>On clicking 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 we get an Alert dialog window to advise a file has been uploaded.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-13.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-13.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-13.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-13.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload Alert window</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>at which point we press <strong>Close</strong>.</p>
<p>At this point, the <strong>Upload</strong> selection window closes, and we see our file displayed  in the <code>GeoHost-V1.0-REFERENCE</code> <strong>Data</strong> stream table.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-14.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-14.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-14.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-14.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload Display raw reference stream</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>When we click on the newly up-loaded stream in the <em>Stream Table</em> pane we see the other two panes fill with information.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-15.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-15.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-15.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-15.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload Selected stream</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The middle pane shows the selected or <em>Specific</em> feed and any linked streams.
A linked stream could be the resultant Reference data set generated from a Raw Reference stream.
If errors occur during processing of the stream, then a linked stream could be an Error stream.</p>
<p>The bottom pane displays the selected stream&rsquo;s data or meta-data.
If we click on the <strong>Meta</strong> link at the top of this pane, we will see the <em>Metadata</em> associated with this stream.
We also note that the <strong>Meta</strong> link at the bottom of the pane is now embolden.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-16.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-16.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-16.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-16.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Upload Selected stream - meta-data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We can see the metadata we set - the EffectiveTime, and implicitly, the Feed but we also see additional fields that Stroom has added that provide more detail about the data and its delivery to Stroom such as how and when it was received.
We now need to switch back to the Data display as we need to author our reference feed translation.</p>
<h3 id="create-pipeline">Create Pipeline</h3>
<p>We now need to create the pipeline for our reference feed so that we can create our translation and hence create reference data for our feed.</p>
<p>Within the Explorer pane, and having selected the <code>Event Sources</code> system group, right click to bring up the object context menu, then the New sub-context menu.
Move to the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Pipeline.svg" 
    title="Pipeline" 
    alt="document/Pipeline.svg">


 and left click to select.
When the <em>New Pipeline</em> selection window appears, navigate to, then select the <code>Feeds and Translations</code> system group then enter the name of the reference feed, GeoHost-V1.0-REFERENCE in the <strong>Name:</strong> text entry box.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-17.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-17.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-17.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-17.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline - GeoHost-V1.0-REFERENCE</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>On pressing the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button you will be presented with the new pipeline&rsquo;s configuration tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-18.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-18.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-18.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-18.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline - Configuration tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Within <strong>Settings</strong>, enter an appropriate description as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-19.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-19.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-19.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-19.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline - Configured settings</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We now need to select the structure this pipeline will use.
We need to move from the <strong>Settings</strong> sub-item on the pipeline configuration tab to the <strong>Structure</strong> sub-item.
This is done by clicking on the <strong>Structure</strong> link, at which we will see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-20.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-20.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-20.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-20.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline - Structure configuration</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As this pipeline will be processing reference data, we would use a <code>Reference Data</code> pipeline.
This is done by inheriting it from a defined set of Standard Pipelines.
To do this, click on the menu selection icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/assorted/popup.png" 
    title="Menu selection" 
    alt="assorted/popup.png">


 to the right of the <strong>Inherit From:</strong> test display box.</p>
<p>When the <strong>Choose item</strong> selection window appears, navigate to the <code>Template Pipelines</code> system group (if not already displayed), and select (left click) the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Pipeline.svg" 
    title="Pipeline" 
    alt="document/Pipeline.svg">


 <code>Reference Data</code> pipeline.
You can find further information about the Template Pipelines 






  

<span class="external-link">
  <a href="https://github.com/gchq/stroom-content/blob/master/source/template-pipelines/README.md" target="_blank" class="" style="" title="here (external link)">
    <span>here</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-21.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-21.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-21.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-21.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline - Reference Data pipeline inherited</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.
At this we will see the inherited pipeline structure of</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-22.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-22.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-22.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-22.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline - Inherited set</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Noting that this pipeline has not yet been saved - indicated by the * in the tab label and the highlighted 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 to save, which results in</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-23.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-23.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-23.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-23.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Pipeline - saved</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This ends the first stage of the pipeline creation.
We need to author the feed&rsquo;s translation.</p>
<h3 id="create-text-converter">Create Text Converter</h3>
<p>To turn our tab delimited data in Stroom reference data, we first need to convert the text into simple XML.
We do this using a <em>Text Converter</em>. <em>Test Converters</em> use a <em>Stroom Data Splitter</em> to convert text into simple XML.</p>
<p>Within the Explorer pane, and having selected the <code>Event Sources</code> system group, right click to bring up the object context menu.
Navigate to the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/pipeline/text.svg" 
    title="Text converter" 
    alt="pipeline/text.svg">


 item and left click to select.</p>
<p>When the <em>New Text Converter</em> selection window comes up, navigate to and select <code>Event Sources</code> system group, then enter the name of the feed, GeoHost-V1.0-REFERENCE into the <strong>Name:</strong> text entry box as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-24.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-24.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-24.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-24.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New TextConverter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>On pressing the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button we see the next text converter&rsquo;s configuration tab displayed.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-25.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-25.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-25.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-25.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New TextConverter Settings</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Enter an appropriate description into the <strong>Description:</strong> text entry box, for instance</p>
<pre><code class="language-text">Text converter for device Logical and Geographic reference feed holding FQDN, IPAddress, Country, Site, Building, Room and Time Zones.
Feed has a header and is tab separated.
</code></pre>
<p>Set the <strong>Converter Type:</strong> to be <code>Data Splitter</code> from the drop-down menu.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-26.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-26.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-26.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-26.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New TextConverter Settings configured</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We next press the <strong>Conversion</strong> sub-item on the TextConverter tab to bring up the <em>Data Splitter</em> editing window.</p>
<p>The following is our Data Splitter code (see <strong>Data Splitter</strong> documentation for more complete details)</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;dataSplitter xmlns=&quot;data-splitter:3&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;data-splitter:3 file://data-splitter-v3.0.1.xsd&quot; version=&quot;3.0&quot;&gt;
  &lt;!-- 
  GEOHOST REFERENCE FEED:
  
  CHANGE HISTORY
  v1.0.0 - 2020-02-09 John Doe
  
  This is a reference feed for device Logical and Geographic data.
  
  The feed provides for each device
  * the device FQDN
  * the device IP Address
  * the device Country location (using ISO 3166-1 alpha-3 codes)
  * the device Site location
  * the device Building location
  * the device Room location
  *the device TimeZone location (both standard then daylight timezone offsets from UTC)
  
  The data is a TAB delimited file with the first line providing headings.
  
  Example data:
  
  FQDN	IPAddress	Country	Site	Building	Room	TimeZones
stroomnode00.strmdev00.org	192.168.2.245	GBR	Bristol-S00	GZero	R00	+00:00/+01:00
stroomnode01.strmdev01.org	192.168.3.117	AUS	Sydney-S04	R6	5-134	+10:00/+11:00
host01.company4.org	192.168.4.220	USA	LosAngeles-S19	ILM	C5-54-2	-08:00/-07:00
  
   --&gt;
   
   &lt;!-- Match the heading line - split on newline and match a maximum of one line  --&gt;
   &lt;split delimiter=&quot;\n&quot; maxMatch=&quot;1&quot;&gt;
    
    &lt;!-- Store each heading and note we split fields on the TAB (&amp;#9;) character --&gt;
      &lt;group&gt;
        &lt;split delimiter=&quot;&amp;#9;&quot;&gt;
          &lt;var id=&quot;heading&quot;/&gt;
        &lt;/split&gt;
      &lt;/group&gt;
    &lt;/split&gt;
    
  &lt;!-- Match all other data lines - splitting on newline --&gt;
   &lt;split delimiter=&quot;\n&quot;&gt;
     &lt;group&gt;
       &lt;!-- Store each field using the column heading number for each column ($heading$1) and note we split fields on the TAB (&amp;#9;) character --&gt;
        &lt;split delimiter=&quot;&amp;#9;&quot;&gt;
          &lt;data name=&quot;$heading$1&quot; value=&quot;$1&quot;/&gt;
        &lt;/split&gt;
     &lt;/group&gt;
   &lt;/split&gt;
   &lt;/dataSplitter&gt;
</code></pre>
<p>At this point we want to save our Text Converter, so click on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 icon.</p>
<p>A copy of this data splitter can be found <a href="GeoHost-data-splitter.txt" title="GEOHOST Data Splitter">here</a>.</p>
<h2 id="assign-text-converter-to-pipeline">Assign Text Converter to Pipeline</h2>
<p>To test our Text Converter, we need to modify our <code>GeoHost-V1.0-REFERENCE</code> pipeline to use it.
Select the <code>GeoHost-V1.0-REFERENCE</code> pipeline tab and then select the <strong>Structure</strong> sub-item</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-27.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-27.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-27.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-27.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Associated text converter with pipeline</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>To associate our new Text Converter with the pipeline, click on the 








  
  








<span class="pipeline-element" title="combinedParser" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/text.svg" 
    title="combinedParser" 
    alt="text.svg">
  <span>combinedParser</span>
</span>
 pipeline element then move the cursor to the <em>Property</em> (middle) pane then double click on the <strong>textConverter</strong> Property Name to allow you to edit the property as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-28.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-28.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-28.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-28.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter Edit property</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We leave the Property <strong>Source:</strong> as <em>Inherit</em> but we need to change the Property <strong>Value:</strong> from <em>None</em> to be our newly created <code>GeoHost-V1.0-REFERENCE</code> text Converter</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-29.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-29.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-29.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-29.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter select GeoHost-V1.0-REFERENCE</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.
At this we will see the Property <em>Value</em> set</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-30.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-30.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-30.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-30.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter set Property Value</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Again press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to finish editing this property and we then see that the <strong>textConverter</strong> property has been set to GeoHost-V1.0-REFERENCE.
Similarly set the <strong>type</strong> property <em>Value</em> to &ldquo;Data Splitter&rdquo;.</p>
<p>At this point, we should save our changes, by clicking on the highlighted 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 icon.
The combined Parser window panes should now look like</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-31.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-31.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-31.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-31.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter set Property Value type</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h2 id="test-text-converter">Test Text Converter</h2>
<p>To test our Text Converter, we select the 













  <span class="stroom-tab " title="Feed tab - 'GeoHost-V1.0-REFERENCE'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Feed.svg" 
      title="GeoHost-V1.0-REFERENCE" 
      alt="Feed.svg">
    <span class="stroom-tab-name">GeoHost-V1.0-REFERENCE</span>
    <span class="stroom-tab-cross">×</span>
  </span>


 tab then click on our uploaded stream in the <em>Stream Table</em> pane, then click the check box of the <em>Raw Reference</em> stream in the <em>Specific Stream</em> table (middle pane)</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-33.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-33.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-33.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-33.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter - select raw reference data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We now want to step our data through the Text Converter.
We enter Stepping Mode by pressing the stepping button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/stepping.svg" 
    title="Stepping" 
    alt="stepping.svg">


 found at the bottom of the right of the stream <em>Raw Data</em> display.</p>
<p>You will then be requested to choose a pipeline to step with, at which, you should navigate to the <code>GeoHost-V1.0-REFERENCE</code> pipeline as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-34.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-34.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-34.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-34.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter - select pipeline to step with</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.</p>
<p>At this point we enter the pipeline Stepping tab</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-35.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-35.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-35.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-35.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter - stepping tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>which initially displays the Raw Reference data from our stream.</p>
<p>We click on the 








  
  








<span class="pipeline-element" title="combinedParser" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/text.svg" 
    title="combinedParser" 
    alt="text.svg">
  <span>combinedParser</span>
</span>
 icon, to display.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-36.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-36.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-36.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-36.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter - stepping editor workspace</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This <em>stepping</em> window is divided into three sub-panes. the top one is the Text Converter editor and it will allow you to adjust the text conversion should you wish too.
The bottom left window displays the <em>input</em> to the Text Converter.
The bottom right window displays the <em>output</em> from the Text Converter for the given input.</p>
<p>We now click on the pipeline Step Forward button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step Forward" 
    alt="step-forward-green.svg">


 to single step the Raw reference data throughout text converter.
We see that the Stepping function has displayed the heading and first data line of our raw reference data in the <em>input</em> sub-pane and the resultant simple <em>records</em> XML (adhering to the Stroom <strong>records v2.0</strong> schema) in the <em>output</em> pane.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-37.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-37.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-37.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-37.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter - pipeline stepping - 1st record</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we again press the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step Forward" 
    alt="step-forward-green.svg">


 button we see the second line in our raw reference data in the <em>input</em> sub-pane and the resultant simple <em>records</em> XML in the <em>output</em> pane.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-38.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-38.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-38.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-38.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter - pipeline stepping - 2nd record</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Pressing the Step Forward button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step Forward" 
    alt="step-forward-green.svg">


 again displays our third line of our raw and converted data.
Repeat this process to view the fourth and fifth lines of converted data.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-39.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-39.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-39.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-39.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">textConverter - pipeline stepping - 3rd record</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We have now successfully tested the Text Converter for our reference feed.
Our next step is to author our translation to generate reference data records that Stroom can use.</p>
<h2 id="create-xslt-translation">Create XSLT Translation</h2>
<p>We now need to create our translation.
This XSLT translation will convert simple <em>records</em> XML data into <em>ReferenceData</em> records - see the Stroom <strong>reference-data v2.0.1</strong> Schema for details.
More information can be found 






  

<span class="external-link">
  <a href="https://github.com/gchq/stroom-content/blob/master/source/core-xml-schemas/README.md" target="_blank" class="" style="" title="here (external link)">
    <span>here</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<p>We first need to create an XSLT translation for our feed.
Move back to the Explorer tree, right click on 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Folder.svg" 
    title="Folder" 
    alt="document/Folder.svg">


 <em>Event Sources</em> folder then select:</p>
<p>









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="New" 
    alt="add.svg">


 <em>New</em> =&gt; 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/XSLT.svg" 
    title="Xslt" 
    alt="document/XSLT.svg">


 <em>XSLT</em>.</p>
<p>When the <strong>New XSLT</strong> selection window comes up, navigate to the <code>Event Sources</code> system group and enter the name of the reference feed - GeoHost-V1.0-REFERENCE into the <strong>Name:</strong> text entry box as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-41.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-41.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-41.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-41.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New xslt Translation selection window</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>On pressing the 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 button we see the XSL tab for our translation and as previously, we enter an appropriate description before selecting the <strong>XSLT</strong> sub-item.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-42.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-42.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-42.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-42.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New xslt - Configuration tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>On selection of the <strong>XSLT</strong> sub-item, we are presented with the XSLT editor window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-43.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-43.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-43.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-43.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt Translation - XSLT editor</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this point, rather than edit the translation in this editor and then assign this translation to the GeoHost-V1.0-REFERENCE pipeline, we will first make the assignment in the pipeline and then develop the translation whilst stepping through the raw data.
This is to demonstrate there are a number of ways to <em>develop a translation</em>.</p>
<p>So, to start, save the XSLT by clicking on the 













  <span class="stroom-tab " title="Pipeline tab - 'GeoHost-V1.0-REFERENCE Pipeline'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Pipeline.svg" 
      title="GeoHost-V1.0-REFERENCE Pipeline" 
      alt="Pipeline.svg">
    <span class="stroom-tab-name">GeoHost-V1.0-REFERENCE Pipeline</span>
    <span class="stroom-tab-cross">×</span>
  </span>


 tab to raise the GeoHost-V1.0-REFERENCE pipeline.
Then select the <strong>Structure</strong> sub-item followed by selecting the 








  
  










<span class="pipeline-element" title="translationFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="translationFilter" 
    alt="xslt.svg">
  <span>translationFilter</span>
</span>
 element.
We now see the  <strong>XSL translationFilter</strong> Property Table for our pipeline in the middle pane.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-45.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-45.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-45.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-45.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt translation element - property pane</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>To associate our new translation with the pipeline, move the cursor to the <em>Property Table</em>, click on the grayed out <em>xslt</em> Property Name and then click on the Edit Property 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/edit.svg" 
    title="Edit" 
    alt="edit.svg">


 icon to allow you to edit the property as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-46.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-46.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-46.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-46.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt -property editor</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We leave the Property <strong>Source:</strong> as <em>Inherit</em> and we need to change the Property <strong>Value:</strong> from <em>None</em> to be our newly created GeoHost-V1.0-REFERENCE XSL translation.
To do this, position the cursor over the menu selection icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/assorted/popup.png" 
    title="Menu Selection" 
    alt="assorted/popup.png">


 of the <strong>Value:</strong> chooser and right click, at which the <code>Choose item</code> selection window appears.
Navigate to the <code>Event Sources</code> system group then select the GeoHost-V1.0-REFERENCE xsl translation.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-47.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-47.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-47.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-47.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt - value selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.
At this point we will see the property <strong>Value:</strong> set</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-48.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-48.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-48.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-48.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt - value selected</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Again press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to finish editing this property and we see that the <em>xslt</em> property has been set to GeoHost-V1.0-REFERENCE.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-49.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-49.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-49.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-49.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt - property set</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this point, we should save our changes, by clicking on the highlighted 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 save icon.</p>
<h2 id="test-xslt-translation">Test XSLT Translation</h2>
<p>We now go back to the 













  <span class="stroom-tab " title="Feed tab - 'GeoHost-V1.0-REFERENCE'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Feed.svg" 
      title="GeoHost-V1.0-REFERENCE" 
      alt="Feed.svg">
    <span class="stroom-tab-name">GeoHost-V1.0-REFERENCE</span>
    <span class="stroom-tab-cross">×</span>
  </span>


tab then click on our uploaded stream in the <em>Stream Table</em> pane.
Next click the check box of the <em>Raw Reference</em> stream in the <em>Specific Stream</em> table (middle pane) as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-33.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-33.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-33.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-33.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">GeoHost-V1.0-REFERENCE feedTab - Specific Stream</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We now want to step our data through the xslt Translation.
We enter Stepping Mode by pressing the stepping button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/stepping.svg" 
    title="Stepping" 
    alt="stepping.svg">


 found at the bottom of the right of the stream <em>Raw Data</em> display.</p>
<p>You will then be requested to choose a pipeline to step with, at which, you should navigate to the GeoHost-V1.0-REFERENCE pipeline as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-50.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-50.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-50.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-50.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt Translation - select pipeline to step with</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.</p>
<p>At this point we enter the pipeline through the Stepping tab 






  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-35.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-35.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-35.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-35.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt Translation - stepping tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
<p>which initially displays the Raw Reference data from our stream.</p>
<p>We click on the 








  
  










<span class="pipeline-element" title="translationFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="translationFilter" 
    alt="xslt.svg">
  <span>translationFilter</span>
</span>
 element to enter the <em>xslt Translation</em> stepping window and all panes are empty.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-51.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-51.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-51.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-51.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt Translation - editor</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>As for the Text Converter, this translation <em>stepping</em> window is divided into three sub-panes.
The top one is the XSLT Translation.
The bottom right window displays the <em>output</em> from the XSLT Translation for the given input.</p>
<p>We now click on the pipeline Step Forward button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step Forward" 
    alt="step-forward-green.svg">


 to single step the Raw reference data through our translation.
We see that the Stepping function has displayed the first <em>records</em> XML entry in the <em>input</em> sub-pane and the same data is displayed in the <em>output</em> sub-pane.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-52.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-52.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-52.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-52.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt Translation - editor 1st record</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>But we also note if we move along the pipeline structure to the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/fatal.svg" 
    title="Fatal Error" 
    alt="fatal.svg">


 icon.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-53.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-53.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-53.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-53.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt Translation - schema fault</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>In essence, since the <em>translation</em> has done nothing, and the data is simple <em>records</em> XML, the system is indicating that it expects the <em>output</em> data to be in the <em>reference-data v2.0.1</em> format.</p>
<p>We can correct this by adding the skeleton xslt translation for reference data into our translationFilter.
Move back to the 








  
  










<span class="pipeline-element" title="translationFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="translationFilter" 
    alt="xslt.svg">
  <span>translationFilter</span>
</span>
 element on the pipeline structure and add the following to the xsl window.</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet xpath-default-namespace=&quot;records:2&quot;
xmlns=&quot;reference-data:2&quot;
xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
xmlns:stroom=&quot;stroom&quot; 
xmlns:evt=&quot;event-logging:3&quot;
version=&quot;2.0&quot;&gt;

 &lt;xsl:template match=&quot;records&quot;&gt;
  &lt;referenceData xmlns=&quot;reference-data:2&quot;
  xsi:schemaLocation=&quot;reference-data:2 file://reference-data-v2.0.xsd&quot; version=&quot;2.0.1&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
  &lt;xsl:apply-templates/&gt;
  &lt;/referenceData&gt;
  &lt;/xsl:template&gt;
  
&lt;!-- MAIN TEMPLATE --&gt;
&lt;xsl:template match=&quot;record&quot;&gt;
  &lt;reference&gt;
    &lt;map&gt;&lt;/map&gt;
    &lt;key&gt;&lt;/key&gt;
    &lt;value&gt;&lt;/value&gt;
  &lt;/reference&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>And on pressing the refresh button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


 we see that the <em>output</em> window is an empty ReferenceData element.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-54.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-54.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-54.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-54.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt Translation - null translation</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Also note that if we move to the 








  
  








<span class="pipeline-element" title="schemaFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xsd.svg" 
    title="schemaFilter" 
    alt="xsd.svg">
  <span>schemaFilter</span>
</span>
 element on the pipeline structure, we no longer have an &ldquo;Invalid Schema Location&rdquo; error.</p>
<p>We next extend the translation to actually generate reference data.
The translation will now look like</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet xpath-default-namespace=&quot;records:2&quot;
xmlns=&quot;reference-data:2&quot;
xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xmlns:stroom=&quot;stroom&quot; 
xmlns:evt=&quot;event-logging:3&quot;
version=&quot;2.0&quot;&gt;

 &lt;!--
  GEOHOST REFERENCE FEED:
  
  CHANGE HISTORY
  v1.0.0 - 2020-02-09 John Doe
  
  This is a reference feed for device Logical and Geographic data.
  
  The feed provides for each device
  * the device FQDN
  * the device IP Address
  * the device Country location (using ISO 3166-1 alpha-3 codes)
  * the device Site location
  * the device Building location
  * the device Room location
  *the device TimeZone location (both standard then daylight timezone offsets from UTC)  
  
  The reference maps are
  FQDN_TO_IP - Fully Qualified Domain Name to IP Address
  IP_TO_FQDN - IP Address to FQDN (HostName)
  FQDN_TO_LOC - Fully Qualified Domain Name to Location element
  --&gt;

 &lt;xsl:template match=&quot;records&quot;&gt;
  &lt;referenceData xmlns=&quot;reference-data:2&quot;
  xsi:schemaLocation=&quot;reference-data:2 file://reference-data-v2.0.xsd&quot; version=&quot;2.0.1&quot;&gt;
  &lt;xsl:apply-templates/&gt;
  &lt;/referenceData&gt;
  &lt;/xsl:template&gt;
  
&lt;!-- MAIN TEMPLATE --&gt;
&lt;xsl:template match=&quot;record&quot;&gt;
  &lt;!-- FQDN_TO_IP map --&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_IP&lt;/map&gt;
    &lt;key&gt;
      &lt;xsl:value-of select=&quot;lower-case(data[@name='FQDN']/@value)&quot; /&gt;
    &lt;/key&gt;
    &lt;value&gt;
      &lt;IPAddress&gt;
        &lt;xsl:value-of select=&quot;data[@name='IPAddress']/@value&quot; /&gt;
      &lt;/IPAddress&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  
  &lt;!-- IP_TO_FQDN map --&gt;
  &lt;reference&gt;
    &lt;map&gt;IP_TO_FQDN&lt;/map&gt;
    &lt;key&gt;
      &lt;xsl:value-of select=&quot;lower-case(data[@name='IPAddress']/@value)&quot; /&gt;
    &lt;/key&gt;
    &lt;value&gt;
      &lt;HostName&gt;
        &lt;xsl:value-of select=&quot;data[@name='FQDN']/@value&quot; /&gt;
      &lt;/HostName&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
&lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>and when we refresh, by pressing the <em>Refresh Current Step</em> button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh-green.svg" 
    title="Refresh Step" 
    alt="refresh-green.svg">


 we see that the <em>output</em> window now has <em>Reference</em> elements within the parent <em>ReferenceData</em> element</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-55.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-55.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-55.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-55.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt Translation - basic translation</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we press the Step Forward button 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step Forward" 
    alt="step-forward-green.svg">


 we see the second <em>record</em> of our raw reference data in the <em>input</em> sub-pane and the resultant <em>Reference</em> elements</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-56.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-56.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-56.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-56.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt Translation - basic translation next record</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>At this point it would be wise to save our translation.
This is done by clicking on the highlighted 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 icon in the top left-hand area of the window under the tabs.</p>
<p>We can now further our Reference by adding a Fully Qualified Domain Name to Location reference - FQDN_TO_LOC and so now the translation looks like</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet xpath-default-namespace=&quot;records:2&quot;
xmlns=&quot;reference-data:2&quot;
xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xmlns:stroom=&quot;stroom&quot; 
xmlns:evt=&quot;event-logging:3&quot;
version=&quot;2.0&quot;&gt;

 &lt;!--
  GEOHOST REFERENCE FEED:
  
  CHANGE HISTORY
  v1.0.0 - 2020-02-09 John Doe
  
  This is a reference feed for device Logical and Geographic data.
  
  The feed provides for each device
  * the device FQDN
  * the device IP Address
  * the device Country location (using ISO 3166-1 alpha-3 codes)
  * the device Site location
  * the device Building location
  * the device Room location
  *the device TimeZone location (both standard then daylight timezone offsets from UTC)  
  
  The reference maps are
  FQDN_TO_IP - Fully Qualified Domain Name to IP Address
  IP_TO_FQDN - IP Address to FQDN (HostName)
  FQDN_TO_LOC - Fully Qualified Domain Name to Location element
  --&gt;

 &lt;xsl:template match=&quot;records&quot;&gt;
  &lt;referenceData xmlns=&quot;reference-data:2&quot;
  xsi:schemaLocation=&quot;reference-data:2 file://reference-data-v2.0.xsd&quot; version=&quot;2.0.1&quot;&gt;
  &lt;xsl:apply-templates/&gt;
  &lt;/referenceData&gt;
  &lt;/xsl:template&gt;
  
&lt;!-- MAIN TEMPLATE --&gt;
&lt;xsl:template match=&quot;record&quot;&gt;
  &lt;!-- FQDN_TO_IP map --&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_IP&lt;/map&gt;
    &lt;key&gt;
      &lt;xsl:value-of select=&quot;lower-case(data[@name='FQDN']/@value)&quot; /&gt;
    &lt;/key&gt;
    &lt;value&gt;
      &lt;IPAddress&gt;
        &lt;xsl:value-of select=&quot;data[@name='IPAddress']/@value&quot; /&gt;
      &lt;/IPAddress&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  
  &lt;!-- IP_TO_FQDN map --&gt;
  &lt;reference&gt;
    &lt;map&gt;IP_TO_FQDN&lt;/map&gt;
    &lt;key&gt;
      &lt;xsl:value-of select=&quot;lower-case(data[@name='IPAddress']/@value)&quot; /&gt;
    &lt;/key&gt;
    &lt;value&gt;
      &lt;HostName&gt;
        &lt;xsl:value-of select=&quot;data[@name='FQDN']/@value&quot; /&gt;
      &lt;/HostName&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  
   &lt;!-- FQDN_TO_LOC map --&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_LOC&lt;/map&gt;
    &lt;key&gt;
      &lt;xsl:value-of select=&quot;lower-case(data[@name='FQDN']/@value)&quot; /&gt;
    &lt;/key&gt;
    &lt;value&gt;
    &lt;!--
    Note, when mapping to a XML node set, we make use of the Event namespace - i.e. evt: 
    defined on our stylesheet element. This is done, so that, when the node set is returned,
    it is within the correct namespace.
    --&gt;
      &lt;evt:Location&gt;
        &lt;evt:Country&gt;
        &lt;xsl:value-of select=&quot;data[@name='Country']/@value&quot; /&gt;
        &lt;/evt:Country&gt;
        &lt;evt:Site&gt;
        &lt;xsl:value-of select=&quot;data[@name='Site']/@value&quot; /&gt;
        &lt;/evt:Site&gt;
        &lt;evt:Building&gt;
        &lt;xsl:value-of select=&quot;data[@name='Building']/@value&quot; /&gt;
        &lt;/evt:Building&gt;
        &lt;evt:Room&gt;
        &lt;xsl:value-of select=&quot;data[@name='Room']/@value&quot; /&gt;
        &lt;/evt:Room&gt;
        &lt;evt:TimeZone&gt;
        &lt;xsl:value-of select=&quot;data[@name='TimeZones']/@value&quot; /&gt;
        &lt;/evt:TimeZone&gt;
      &lt;/evt:Location&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
&lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>and our second ReferenceData element would now look like</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-57.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-57.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-57.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-57.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">xslt Translation - complete translation 2nd record</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We have completed the translation and have hence completed the development of our GeoHost-V1.0-REFERENCE reference feed.</p>
<p>At this point, the reference feed is set up to accept Raw Reference data, but it will not automatically process the raw data and hence it will not place reference data into the reference data store.
To have Stroom automatically process Raw Reference streams, you will need to enable <em>Processors</em> for this pipeline.</p>
<h2 id="enabling-the-reference-feed-processors">Enabling the Reference Feed Processors</h2>
<p>We now create the pipeline Processors for this feed, so that the raw reference data will be transformed into Reference Data on ingest and save to Reference Data stores.</p>
<p>Open the reference feed pipeline by selecting the 













  <span class="stroom-tab " title="Pipeline tab - 'GeoHost-V1.0-REFERENCE'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Pipeline.svg" 
      title="GeoHost-V1.0-REFERENCE" 
      alt="Pipeline.svg">
    <span class="stroom-tab-name">GeoHost-V1.0-REFERENCE</span>
    <span class="stroom-tab-cross">×</span>
  </span>


 tab to raise the GeoHost-V1.0-REFERENCE pipeline.
Then select the <strong>Processors</strong> sub-tab to show</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-58.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-58.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-58.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-58.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Processors</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This configuration tab is divided into two panes.
The top pane shows the current enabled Processors and any recently processed streams and the bottom pane provides meta-data about each Processor or recently processed streams.</p>
<p>First, move the mouse to the Add Processor 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add Processor" 
    alt="add.svg">


 icon at the top left of the top pane.
Select by left clicking this icon to have displayed the <strong>Add Filter</strong> selection window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-59.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-59.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-59.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-59.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Processors - Add Filter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This selection window allows us to <em>filter</em> what set of data streams we want our Processor to process.
As our intent is to enable processing for all GeoHost-V1.0-REFERENCE streams, both already received and yet to be received, then our filtering criteria is just to process all Raw Reference for this feed, ignoring all other conditions.</p>
<p>To do this, first click on the <strong>Add Term</strong> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add Term" 
    alt="add.svg">


 icon to navigate to the desired feed name (GeoHost-V1.0-REFERENCE) object</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-60.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-60.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-60.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-60.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Processors - Choose Feed name</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
 to make the selection.</p>
<p>Next, we select the required <em>stream type</em>.
To do this click on the <strong>Add Term</strong> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add Term" 
    alt="add.svg">


 icon again.
Click on the down arrow to change the Term selection from <em>Feed</em> to <em>Type</em>.
Click in the <strong>Value</strong> position on the highlighted line (it will be currently empty).
Once you have clicked here a drop-down box will appear as per</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-61.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-61.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-61.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-61.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Processors - Choose Stream Type</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>at which point, select the <em>Stream Type</em> of <strong>Raw Reference</strong>and then press 



<span class="stroom-button" title="Ok button" >
  <span class="stroom-button-text">Ok</span>
</span>
.
At this we return to the <strong>Add Processor</strong> selection window to see that the <em>Raw Reference</em> stream type has been added.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-62.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-62.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-62.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-62.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Processors - pipeline criteria set</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note the Processor has been added but it is in a <strong>disabled</strong> state.
We <strong>enable</strong> both pipeline processor and the processor filter</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-63.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-63.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-63.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-63.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Processors - Enable</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note - if this is the first time you have set up pipeline processing on your Stroom instance you may need to check that the <strong>Stream Processor</strong> job is enabled on your Stroom instance.
To do this go to the Stroom main menu and select <em>Monitoring&gt;Jobs&gt;</em>
Check the status of the Stream Processor job and enable if required.
If you need to enable the job also ensure you enable the job on the individual nodes as well (go to the bottom window pane and select the enable box on the far right)</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-64.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-64.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-64.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-64.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Processors - Enable node processing</figcaption>
      </div>
      
    </figure>
  </a>
</div>








  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-65.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-65.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-65.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-65.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Processors - Enable</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Returning to the 













  <span class="stroom-tab " title="Pipeline tab - 'GeoHost-V1.0-REFERENCE'" >
    <img
      class="stroom-icon" 
      src="../../../images/stroom-ui/document/Pipeline.svg" 
      title="GeoHost-V1.0-REFERENCE" 
      alt="Pipeline.svg">
    <span class="stroom-tab-name">GeoHost-V1.0-REFERENCE</span>
    <span class="stroom-tab-cross">×</span>
  </span>


 tab, <strong>Processors</strong> sub-item, if everything is working on your Stroom instance you should now see that Raw Reference streams are being processed by your processor - the <strong>Streams</strong> count is incrementing and the <strong>Tracker%</strong> is incrementing (when the Tracker% is 100% then all streams you selected (Filtered for) have been processed)</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-66.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-66.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-66.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-66.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Processors - Enable</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Navigating back to the <strong>Data</strong> sub-item and clicking on the reference feed stream in the <em>Stream Table</em> we see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-67.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-67.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-67.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-67.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">pipeline Display Data</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>In the top pane, we see the <em>Streams table</em> as per normal, but in the <em>Specific stream</em> table we see that we have both a <strong>Raw Reference</strong> stream and its child <strong>Reference</strong> stream.
By clicking on and highlighting the <strong>Reference</strong> stream we see its content in the bottom pane.</p>
<p>The complete ReferenceData for this stream is</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;referenceData xmlns=&quot;reference-data:2&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:stroom=&quot;stroom&quot; xmlns:evt=&quot;event-logging:3&quot; xsi:schemaLocation=&quot;reference-data:2 file://reference-data-v2.0.xsd&quot; version=&quot;2.0.1&quot;&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_IP&lt;/map&gt;
    &lt;key&gt;stroomnode00.strmdev00.org&lt;/key&gt;
    &lt;value&gt;
      &lt;IPAddress&gt;192.168.2.245&lt;/IPAddress&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;IP_TO_FQDN&lt;/map&gt;
    &lt;key&gt;192.168.2.245&lt;/key&gt;
    &lt;value&gt;
      &lt;HostName&gt;stroomnode00.strmdev00.org&lt;/HostName&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_LOC&lt;/map&gt;
    &lt;key&gt;stroomnode00.strmdev00.org&lt;/key&gt;
    &lt;value&gt;
      &lt;evt:Location&gt;
        &lt;evt:Country&gt;GBR&lt;/evt:Country&gt;
        &lt;evt:Site&gt;Bristol-S00&lt;/evt:Site&gt;
        &lt;evt:Building&gt;GZero&lt;/evt:Building&gt;
        &lt;evt:Room&gt;R00&lt;/evt:Room&gt;
        &lt;evt:TimeZone&gt;+00:00/+01:00&lt;/evt:TimeZone&gt;
      &lt;/evt:Location&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_IP&lt;/map&gt;
    &lt;key&gt;stroomnode01.strmdev01.org&lt;/key&gt;
    &lt;value&gt;
      &lt;IPAddress&gt;192.168.3.117&lt;/IPAddress&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;IP_TO_FQDN&lt;/map&gt;
    &lt;key&gt;192.168.3.117&lt;/key&gt;
    &lt;value&gt;
      &lt;HostName&gt;stroomnode01.strmdev01.org&lt;/HostName&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_LOC&lt;/map&gt;
    &lt;key&gt;stroomnode01.strmdev01.org&lt;/key&gt;
    &lt;value&gt;
      &lt;evt:Location&gt;
        &lt;evt:Country&gt;AUS&lt;/evt:Country&gt;
        &lt;evt:Site&gt;Sydney-S04&lt;/evt:Site&gt;
        &lt;evt:Building&gt;R6&lt;/evt:Building&gt;
        &lt;evt:Room&gt;5-134&lt;/evt:Room&gt;
        &lt;evt:TimeZone&gt;+10:00/+11:00&lt;/evt:TimeZone&gt;
      &lt;/evt:Location&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_IP&lt;/map&gt;
    &lt;key&gt;host01.company4.org&lt;/key&gt;
    &lt;value&gt;
      &lt;IPAddress&gt;192.168.4.220&lt;/IPAddress&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;IP_TO_FQDN&lt;/map&gt;
    &lt;key&gt;192.168.4.220&lt;/key&gt;
    &lt;value&gt;
      &lt;HostName&gt;host01.company4.org&lt;/HostName&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_LOC&lt;/map&gt;
    &lt;key&gt;host01.company4.org&lt;/key&gt;
    &lt;value&gt;
      &lt;evt:Location&gt;
        &lt;evt:Country&gt;USA&lt;/evt:Country&gt;
        &lt;evt:Site&gt;LosAngeles-S19&lt;/evt:Site&gt;
        &lt;evt:Building&gt;ILM&lt;/evt:Building&gt;
        &lt;evt:Room&gt;C5-54-2&lt;/evt:Room&gt;
        &lt;evt:TimeZone&gt;-08:00/-07:00&lt;/evt:TimeZone&gt;
      &lt;/evt:Location&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
&lt;/referenceData&gt;
&lt;reference&gt;
    &lt;map&gt;FQDN_TO_IP&lt;/map&gt;
    &lt;key&gt;host32.strmdev01.org&lt;/key&gt;
    &lt;value&gt;
      &lt;IPAddress&gt;192.168.8.151&lt;/IPAddress&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;IP_TO_FQDN&lt;/map&gt;
    &lt;key&gt;192.168.8.151&lt;/key&gt;
    &lt;value&gt;
      &lt;HostName&gt;host32.strmdev01.org&lt;/HostName&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_LOC&lt;/map&gt;
    &lt;key&gt;host32.strmdev01.org&lt;/key&gt;
    &lt;value&gt;
      &lt;evt:Location&gt;
        &lt;evt:Country&gt;AUS&lt;/evt:Country&gt;
        &lt;evt:Site&gt;Sydney-S02&lt;/evt:Site&gt;
        &lt;evt:Building&gt;RC45&lt;/evt:Building&gt;
        &lt;evt:Room&gt;5-134&lt;/evt:Room&gt;
        &lt;evt:TimeZone&gt;+10:00/+11:00&lt;/evt:TimeZone&gt;
      &lt;/evt:Location&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_IP&lt;/map&gt;
    &lt;key&gt;host14.strmdev00.org&lt;/key&gt;
    &lt;value&gt;
      &lt;IPAddress&gt;192.168.234.9&lt;/IPAddress&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;IP_TO_FQDN&lt;/map&gt;
    &lt;key&gt;192.168.234.9&lt;/key&gt;
    &lt;value&gt;
      &lt;HostName&gt;host14.strmdev00.org&lt;/HostName&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
  &lt;reference&gt;
    &lt;map&gt;FQDN_TO_LOC&lt;/map&gt;
    &lt;key&gt;host14.strmdev00.org&lt;/key&gt;
    &lt;value&gt;
      &lt;evt:Location&gt;
        &lt;evt:Country&gt;GBR&lt;/evt:Country&gt;
        &lt;evt:Site&gt;Bristol-S22&lt;/evt:Site&gt;
        &lt;evt:Building&gt;CAMP2&lt;/evt:Building&gt;
        &lt;evt:Room&gt;Rm67&lt;/evt:Room&gt;
        &lt;evt:TimeZone&gt;+00:00/+01:00&lt;/evt:TimeZone&gt;
      &lt;/evt:Location&gt;
    &lt;/value&gt;
  &lt;/reference&gt;
&lt;/referenceData&gt;
</code></pre>
<p>If we go back to the reference feed itself (and click on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


 button on the far right of the top and middle panes), we now see both the <em>Reference</em> and <em>Raw Reference</em> streams in the <em>Streams Table</em> pane.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-68.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-68.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-68.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-68.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">reference feed - Data tab</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Selecting the <em>Reference</em> stream in the <em>Stream Table</em> will result in the <em>Specific stream</em> pane displaying the <em>Raw Reference</em> and its child <em>Reference</em> stream (highlighted) and the actual ReferenceData output in the <em>Data</em> pane at the bottom.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-69.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-69.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-69.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-69.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">reference feed - Select reference</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Selecting the <em>Raw Reference</em> stream in the <em>Streams Table</em> will result in the <em>Specific stream</em> pane displaying the <em>Raw Reference</em> and its child <em>Reference</em> stream as before, but with the <em>Raw Reference</em> stream highlighted and the actual Raw Reference input data displayed in the <em>Data</em> pane at the bottom.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-70.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-70.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-70.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-70.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">reference feed - Select raw reference</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The creation of the <em>Raw Reference</em> is now complete.</p>
<p>At this point you may wish to organise the resources you have created within the Explorer pane to a more appropriate location such as <code>Reference/GeoHost</code>.
Because Stroom Explorer is a flat structure you can move resources around to reorganise the content without any impact on directory paths, configurations etc.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-71.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-71.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-71.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-71.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">reference feed - Organise Resources</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now you have created the new folder structure you can move the various GeoHost resources to this location.
Select all four resources by using the mouse right-click button while holding down the <em>Shift</em> key.
Then right click on the highlighted group to display the action menu</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-72.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-72.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-72.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-72.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Organise Resources - move content</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Select <strong>move</strong> and the <em>Move Multiple Items</em> window will display.
Navigate to the <code>Reference/GeoHost</code> folder to move the items to this destination.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-73.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-73.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-73.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-73.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Organise Resources - select destination</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>The final structure is seen below</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-CreateReferenceFeed-74.png" href="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-74.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-CreateReferenceFeed-74.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-CreateReferenceFeed-74.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Organise Resources - finished</figcaption>
      </div>
      
    </figure>
  </a>
</div>


</div>




    
	
  

    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '7.'; page-break-before: always">
    
  <h1 id="pg-a8dc99605d0ca1bf62927e149cb91965">7 - Search</h1>
    
	
</div>




    
      
  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '7.1.'; ">
    
  <h1 id="pg-8b7048c9a87146a09d8583a0c24e6139">7.1 - Elasticsearch integration</h1>
    <div class="lead">How to integrate Stroom with Elastic Search</div>
	<h2 id="introduction">Introduction</h2>
<p>Stroom v6.1 can pass data to Elasticsearch for indexing.
Indices created using this process (i.e. those containing a <code>StreamId</code> and <code>EventId</code> corresponding to a particular Stroom instance)
are searchable via a Stroom <em>dashboard</em>, much like a Stroom Lucene index.</p>
<p>This integration provides operators with the flexibility to utilise the additional capabilities of Elasticsearch,
(like clustering and replication) and expose indexed data for consumption by external analytic or processing tools.</p>
<p>This guide will take you through creating an Elasticsearch index, setting up an indexing pipeline, activating a stream processor and searching the indexed data in both Stroom and Elasticsearch.</p>
<h3 id="assumptions">Assumptions</h3>
<ol>
<li>You have created an Elasticsearch cluster.
For test purposes, you can quickly create a single-node cluster using Docker by following the steps in the 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html#docker-cli-run-dev-mode" target="_blank" class="" style="" title="Elasticsearch Docs (external link)">
    <span>Elasticsearch Docs</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</li>
<li>The Elasticsearch cluster is reachable via HTTP/S from all Stroom nodes participating in <a href="../../../docs/quick-start-guide/running/">stream processing</a>.</li>
<li>Elasticsearch security is disabled.</li>
<li>You have a feed containing <code>Event</code> data.</li>
</ol>
<h3 id="key-differences">Key differences</h3>
<ol>
<li>Unlike with <a href="../../../docs/howtos/search/solr/">Solr indexing</a>, Elasticsearch field mappings are managed outside of Stroom, usually via the 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-create-index.html#mappings" target="_blank" class="" style="" title="REST API (external link)">
    <span>REST API</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</li>
<li>Aside from creating the mandatory <code>StreamId</code> and <code>EventId</code> field mappings, explicitly defining mappings for other fields is optional.
It is however, considered good practice to define these mappings, to ensure each field&rsquo;s data type is correctly parsed and represented.
For text fields, it also pays to ensure that the 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-params.html" target="_blank" class="" style="" title="appropriate mapping parameters are used (external link)">
    <span>appropriate mapping parameters are used</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
,
in order to satisfy your search and analysis requirements - and meet system resource constraints.</li>
<li>Unlike both Solr and Lucene indexing, it is not necessary to mark a field as <code>stored</code> (i.e. storing its raw value in the inverted index).
This is because Elasticsearch stores the content of the original document in the 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-source-field.html" target="_blank" class="" style="" title="_source field (external link)">
    <span>_source field</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
,
which is retrieved when populating search results.
Provided the <code>_source</code> field is enabled (as it is by default), a field is treated as <code>stored</code> in Stroom and its value doesn&rsquo;t need to be retrieved via an <em>extraction pipeline</em>.</li>
</ol>
<h2 id="indexing-data">Indexing data</h2>
<h3 id="creating-an-index-in-elasticsearch">Creating an index in Elasticsearch</h3>
<p>The following cURL command creates an index named <code>stroom_test</code> in Elasticsearch cluster <code>http://localhost:9200</code> consisting of the following fields:</p>
<ol>
<li><code>StreamId</code> (mandatory, must be of data type <code>long</code>)</li>
<li><code>EventId</code> (mandatory, must also be <code>long</code>)</li>
<li><code>Name</code> (text). Uses the default analyzer, which tokenizes the text for matching on terms.
<code>fielddata</code> is enabled, which allows for 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/text.html#fielddata-mapping-param" target="_blank" class="" style="" title="aggregating on these terms (external link)">
    <span>aggregating on these terms</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</li>
<li><code>State</code> (keyword). Supports exact matching.</li>
</ol>
<p>The created index consists of <code>5</code> shards.
Note that the shard count cannot be changed after index creation, without a reindex.
See 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/size-your-shards.html" target="_blank" class="" style="" title="this guide (external link)">
    <span>this guide</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 on shard sizing.</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">curl -X PUT &#34;http://localhost:9200/stroom_test?pretty&#34; -H &#39;Content-Type: application/json&#39; -d&#39;
(out)   {
(out)      &#34;settings&#34;: {
(out)        &#34;number_of_shards&#34;: 5
(out)      },
(out)      &#34;mappings&#34;: {
(out)        &#34;properties&#34;: {
(out)          &#34;StreamId&#34;: {
(out)            &#34;type&#34;: &#34;long&#34;
(out)          },
(out)          &#34;EventId&#34;: {
(out)            &#34;type&#34;: &#34;long&#34;
(out)          },
(out)          &#34;Name&#34;: {
(out)            &#34;type&#34;: &#34;text&#34;,
(out)            &#34;fielddata&#34;: true
(out)          },
(out)          &#34;State&#34;: {
(out)            &#34;type&#34;: &#34;text&#34;,
(out)            &#34;fielddata&#34;: true
(out)          }
(out)        }
(out)      }
(out)    }
(out)&#39;</code></pre>
</div>

<p>After creating the index, you can add additional field mappings.
Note the 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-put-mapping.html#updating-field-mappings" target="_blank" class="" style="" title="limitations (external link)">
    <span>limitations</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 in doing so, particularly the fact that it will not cause existing documents to be re-indexed.
It is worthwhile to test index mappings on a subset of data before committing to indexing a large event feed, to ensure the resulting search experience meets your requirements.</p>
<h3 id="registering-the-index-in-stroom">Registering the index in Stroom</h3>
<p>This step creates an <em>Elasticsearch Index</em> in the <em>Stroom Tree</em> and tells Stroom how to connect to your Elasticsearch cluster
and index. Note that this process needs to be repeated for each index you create.</p>
<h4 id="steps">Steps</h4>
<ol>
<li>Right-click on the folder in the <em>Explorer Tree</em> where you wish to create the index</li>
<li>Select <code>New</code> / <code>Elasticsearch Index</code></li>
<li>Enter a valid name for the index. It is a good idea to choose one that reflects either the feed name being indexed, or if
indexing multiple feeds, the nature of data they represent.</li>
<li>In the index tab that just opened:
<ol>
<li>Select the <code>Settings</code> tab</li>
<li>Set the <code>Index</code> to the name of the index in Elasticsearch (e.g. <code>stroom_test</code> from the previous example)</li>
<li>Set the <code>Connection URLs</code> to one or more Elasticsearch node URLs. If multiple, separate each URL with <code>,</code>.
For example, a URL like <code>http://data-0.elastic:9200,http://data-1.elastic:9200</code> will balance requests to two data nodes
within an Elasticsearch cluster. See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html">this document</a> for guidance on node roles.</li>
<li>Click <code>Test Connection</code>. If the connection succeeds, and the index is found, a dialog is shown indicating
the test was successful. Otherwise, an error message is displayed.</li>
<li>If the test succeeded, click the <em>save</em> button in the top-left. The <code>Fields</code> tab will now be populated with fields from
the Elasticsearch index.</li>
</ol>
</li>
</ol>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>


    The field mappings list is only updated when index settings are changed, or a Stroom indexing or search task begins.
The refresh button in the <code>Fields</code> tab does not have any effect.

</div>


<h3 id="setting-index-retention">Setting index retention</h3>
<p>As with Solr indexing, index document retention is determined by defining a Stroom query.</p>
<p>Setting a retention query is optional and by default, documents will be retained in an index indefinitely.</p>
<p>It is recommended for indices containing events spanning long periods of time, that 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index-lifecycle-management.html" target="_blank" class="" style="" title="Elasticsearch Index Lifecycle Management (external link)">
    <span>Elasticsearch Index Lifecycle Management</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>

be used instead. The capabilities provided, such as automatic rollover to warm or cold storage tiers, are well worth considering, especially in high-volume production clusters.</p>
<h4 id="considerations-when-implementing-ilm">Considerations when implementing ILM</h4>
<ol>
<li>It is recommended that <em><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/data-streams.html">data streams</a></em> are used when
indexing data. These allow easier rollover and work well with ILM policies. A <em>data stream</em> is essentially a container for multiple date-based indices
and to a search client such as Stroom, appears and is searchable like a normal Elasticsearch index.</li>
<li>Use of <em>data streams</em> requires that a <code>@timestamp</code> field of type <code>date</code> be defined for each document (instead of say, <code>EventTime</code>).</li>
<li>Implementing ILM policies requires careful capacity planning, including anticipating search and retention requirements.</li>
</ol>
<h3 id="creating-an-indexing-pipeline">Creating an indexing pipeline</h3>
<p>As with Lucene and Solr indexing pipelines, indexing data using Elasticsearch uses a pipeline filter.
This filter accepts <code>&lt;record&gt;</code> elements and for each, sends a document to Elasticsearch for indexing.</p>
<p>Each <code>&lt;data&gt;</code> element contained within a <code>&lt;record&gt;</code> sets the document field name and value. You should ensure the <code>name</code> attribute
of each <code>&lt;data&gt;</code> element exactly matches the mapping property of the Elasticsearch index you created.</p>
<h4 id="steps-1">Steps</h4>
<ol>
<li>Create a pipeline inheriting from the built-in <code>Indexing</code> template.</li>
<li>Modify the <code>xsltFilter</code> pipeline stage to output the correct <code>&lt;records&gt;</code> XML (see the <a href="../../../docs/quick-start-guide/indexing/">Quick-Start Guide</a>.</li>
<li>Delete the default <code>indexingFilter</code> and in its place, create an <code>ElasticIndexingFilter</code> (see screenshot below).</li>
<li>Review and set the following properties:
<ol>
<li><code>batchSize</code> (default: <code>10,000</code>). Number of documents to send in a single request to the Elasticsearch 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html" target="_blank" class="" style="" title="Bulk API (external link)">
    <span>Bulk API</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.
Should usually be set to <code>1,000</code> or more.
The higher the number, the more memory is required by both Stroom and Elasticsearch when sending or receiving the request.</li>
<li><code>index</code> (required). Set this to the target Elasticsearch index in the Stroom <em>Explorer Tree</em>.</li>
<li><code>refreshAfterEachBatch</code> (default: <code>false</code>). Refreshes the Elasticsearch index after each batch has finished processing.
This makes any documents ingested in the batch available for searching.
Unless search results are needed in near-real-time, it is recommended this be set to <code>false</code> and the index refresh interval be set to an appropriate value.
See 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/tune-for-indexing-speed.html#_unset_or_increase_the_refresh_interval" target="_blank" class="" style="" title="this document (external link)">
    <span>this document</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 for guidance on optimising indexing performance.</li>
</ol>
</li>
</ol>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/Elastic-Add-Pipeline-Filter.png" href="../../../images/HOWTOs/Elastic-Add-Pipeline-Filter.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/Elastic-Add-Pipeline-Filter.png" style="max-width: fit-content" alt="images/HOWTOs/Elastic-Add-Pipeline-Filter.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Elasticsearch indexing filter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h3 id="creating-and-activating-a-stream-processor">Creating and activating a stream processor</h3>
<p>Follow the steps as in <a href="../../../docs/quick-start-guide/indexing/">this guide</a>.</p>
<h3 id="checking-data-has-been-indexed">Checking data has been indexed</h3>
<p>Query Elasticsearch, checking the fields you expect are there, and of the correct data type:</p>
<p>The following query displays five results:

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">curl -X GET &#34;http://localhost:9200/stroom_test/_search?size=5&#34;</code></pre>
</div>
</p>
<p>You can also get an exact document count, to ensure this matches the number of events you are expecting:</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">curl -X GET &#34;http://localhost:9200/stroom_test/_count&#34;</code></pre>
</div>

<p>For more information, see the Elasticsearch 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search.html" target="_blank" class="" style="" title="Search API documentation (external link)">
    <span>Search API documentation</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<h3 id="reindexing-data">Reindexing data</h3>
<p>By default, the original document values are stored in an Elasticsearch index and may be used later on to re-index data (such as when a change is made to field mappings).
This is done via the 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-reindex.html" target="_blank" class="" style="" title="Reindex API (external link)">
    <span>Reindex API</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.
Provided these values have not changed, it would likely be more efficient to use this API to perform a re-index,
instead of processing data from scratch using a Stroom stream processor.</p>
<p>On the other hand, if the content of documents being output to Elasticsearch has changed, the Elasticsearch index will need to be re-created
and the stream re-processed. Examples of where this would be required include:</p>
<ol>
<li>A new field is added to the indexing filter, which previously didn&rsquo;t exist. That field needs to be searchable for all historical
events.</li>
<li>A field is renamed</li>
<li>A field data type is changed</li>
</ol>
<p>If a field is omitted from the indexing translation, there is no need for a re-index, unless you wish to reclaim the space
occupied by that field.</p>
<h4 id="reindexing-using-a-pipeline-processor">Reindexing using a pipeline processor</h4>
<ol>
<li>Delete the index. While it is possible to 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-delete-by-query.html" target="_blank" class="" style="" title="delete by query (external link)">
    <span>delete by query</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
, it is more efficient to drop the index.
Additionally, deleting by query doesn&rsquo;t actually remove data from disk, until segments are merged.

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">curl -X DELETE &#34;http://localhost:9200/stroom_test&#34;</code></pre>
</div>
</li>
<li>Re-create the index (as shown earlier)</li>
<li>Create a new pipeline processor to index the documents</li>
</ol>
<h2 id="searching">Searching</h2>
<p>Once indexed in Elasticsearch, you can search either using the <em>Stroom Dashboard</em> user interface, or directly against
the Elasticsearch cluster.</p>
<p>The advantage of using Stroom to search is that it allows access to the raw source data (i.e. it is not limited to what&rsquo;s stored in the index).
It can also use <em>extraction pipelines</em> to enrich search results for export in a table.</p>
<p>Elasticsearch on the other hand, provides a rich






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search.html" target="_blank" class="" style="" title="Search REST API (external link)">
    <span>Search REST API</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>

with powerful <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html">aggregations</a> that can be
used to generate reports and discover patterns and anomalies. It can also be readily queried using third-party tools.</p>
<h3 id="stroom">Stroom</h3>
<p>See the <a href="../../../docs/quick-start-guide/dashboard/">Dashboard</a> page in the Quick-Start Guide.</p>
<p>Instead of selecting a Lucene index, set the target <em>data source</em> to the desired Elasticsearch index in the Stroom <em>Explorer Tree</em>.</p>
<p>Once the target <em>data source</em> has been set, the Dashboard can be used as with a Lucene or Solr index <em>data source</em>.</p>
<h3 id="elasticsearch">Elasticsearch</h3>
<p>Elasticsearch queries can be performed directly against the cluster using the 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search.html" target="_blank" class="" style="" title="Search API (external link)">
    <span>Search API</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<p>Alternatively, there are tools that make search and discovery easier and more intuitive, like 






  

<span class="external-link">
  <a href="https://www.elastic.co/kibana" target="_blank" class="" style="" title="Kibana (external link)">
    <span>Kibana</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.</p>
<h2 id="security">Security</h2>
<p>It is important to note that Elasticsearch data is not encrypted at rest, unless this feature is enabled and the relevant 






  

<span class="external-link">
  <a href="https://www.elastic.co/subscriptions" target="_blank" class="" style="" title="licensing tier (external link)">
    <span>licensing tier</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 is purchased.
Therefore, appropriate measures should be taken to control access to Elasticsearch user data at the file level.</p>
<p>For production clusters, the Elasticsearch 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/elasticsearch-security.html" target="_blank" class="" style="" title="security guidelines (external link)">
    <span>security guidelines</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 should be followed, in order to control access and ensure requests are audited.</p>
<p>You might want to consider implementing 






  

<span class="external-link">
  <a href="https://www.elastic.co/guide/en/kibana/current/development-security.html" target="_blank" class="" style="" title="role-based access control (external link)">
    <span>role-based access control</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>

to prevent unauthorised users of the native Elasticsearch API or tools like Kibana, from creating, modifying or deleting data within sensitive indices.</p>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '7.2.'; page-break-before: always">
    
  <h1 id="pg-1903af404d4813cef8da382cea0f650d">7.2 - Search API</h1>
    <div class="lead">Stroom v6 introduced an API that allows a user to perform queries against Stroom resources such as indices and statistics. This is a guide to show how to perform a Stroom Query directly from bash using Stroom v7.</div>
	<ol>
<li>
<p>Create an API Key for yourself, this will allow the API to authenticate as you and run the query with your privileges.</p>
</li>
<li>
<p>Create a Dashboard that extracts the data you are interested in. You should create a Query and Table.</p>
</li>
<li>
<p>Download the JSON for your Query.
Press the download icon in the Query Pane to generate a file containing the JSON.
Save the JSON to a file named <em>query.json</em>.</p>
</li>
<li>
<p>Use curl to send the query to Stroom.

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">API_KEY=&#39;&lt;put your API Key here&#39; \
URI=stroom.host/api/searchable/v2/search \
curl \
-s \
--request POST \
${URL} \
-o response.out \
-H &#34;Authorization:Bearer ${API_KEY}&#34; \
-H &#34;Content-Type: application/json&#34; \
--data-binary @query.json</code></pre>
</div>
</p>
</li>
<li>
<p>The query response should be in a file named response.out.</p>
</li>
<li>
<p>Optional step: reformat the response to csv using <code>jq</code>.</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">cat response.out | jq &#39;.results[0].rows[].values | @csv&#39;</code></pre>
</div>

</li>
</ol>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '7.3.'; page-break-before: always">
    
  <h1 id="pg-afe3aae761f55c7bc015a6134f44f6d5">7.3 - Solr integration</h1>
    <div class="lead">This document will show how to use Solr from within Stroom. A single Solr node will be used running in a docker container.</div>
	<h2 id="assumptions">Assumptions</h2>
<ol>
<li>You are familiar with Lucene indexing within Stroom</li>
<li>You have some data to index</li>
</ol>
<h2 id="points-to-note">Points to note</h2>
<ol>
<li>A Solr core is the home for exactly one Stroom index.</li>
<li>Cores must initially be created in Solr.</li>
<li>It is good practice to name your Solr core the same as your Stroom Index.</li>
</ol>
<h2 id="method">Method</h2>
<ol>
<li>
<p>Start a docker container for a single solr node.

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">docker run -d -p 8983:8983 --name my_solr solr</code></pre>
</div>
</p>
</li>
<li>
<p>Check your Solr node. Point your browser at http://yourSolrHost:8983</p>
</li>
<li>
<p>Create a core in Solr using the CLI.</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="user" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">docker exec -it my_solr solr create_core -c test_index</code></pre>
</div>

</li>
<li>
<p>Create a SolrIndex in Stroom







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v7/HT_SimpleSolr_NewSolrIndex.png" href="../../../images/HOWTOs/v7/HT_SimpleSolr_NewSolrIndex.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v7/HT_SimpleSolr_NewSolrIndex.png" style="max-width: fit-content" alt="images/HOWTOs/v7/HT_SimpleSolr_NewSolrIndex.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">New Solr Index</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
</li>
<li>
<p>Update settings for your new Solr Index in Stroom then press &ldquo;Test Connection&rdquo;.
If successful then press Save.
Note the &ldquo;Solr URL&rdquo; field is a reference to the newly created Solr core.







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v7/HT_SimpleSolr_Settings.png" href="../../../images/HOWTOs/v7/HT_SimpleSolr_Settings.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v7/HT_SimpleSolr_Settings.png" style="max-width: fit-content" alt="images/HOWTOs/v7/HT_SimpleSolr_Settings.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Solr Index Settings</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
</li>
<li>
<p>Add some Index fields.
e.g.EventTime, UserId</p>
</li>
<li>
<p>Retention is different in Solr, you must specify an expression that matches data that can be deleted.







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v7/HT_SimpleSolr_Retention.png" href="../../../images/HOWTOs/v7/HT_SimpleSolr_Retention.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v7/HT_SimpleSolr_Retention.png" style="max-width: fit-content" alt="images/HOWTOs/v7/HT_SimpleSolr_Retention.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Solr Retention</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
</li>
<li>
<p>Your Solr Index can now be used as per a Stroom Lucene Index.
However, your Indexing pipeline must use a SolrIndexingFilter instead of an IndexingFilter.</p>
</li>
</ol>

</div>




    
	
  

    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '8.'; page-break-before: always">
    
  <h1 id="pg-e3bc865056467ce77e907a179d52fbb5">8 - Event Post Processing</h1>
    <div class="lead">How to do further processing on Events.</div>
	
</div>




    
      
  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '8.1.'; ">
    
  <h1 id="pg-11dc23704255d3336b69c10c5c6a88d1">8.1 - Event Forwarding</h1>
    <div class="lead">How to write processed events to the file system for use by other systems.</div>
	<!-- Created with Stroom v6.1-beta.16  -->

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">See Also</h4>


    <p><a href="../../../docs/howtos/eventfeeds/createapachehttpdeventfeed/">HOWTO - Apache HTTPD Event Feed</a></p>


</div>


<h2 id="introduction">Introduction</h2>
<p>In some situations, you will want to automatically extract stored Events in their XML format to forward to the file system.
This is achieved via a Pipeline with an appropriate XSLT translation that is used to decide what events are forwarded.
Once the Events have been chosen, the Pipeline would need to validate the Events (via a schemaFilter) and then the Events would be passed to an xmlWriter and then onto a file system writer (fileSystemOutputStreamProvider or RollingFileAppender).</p>
<h2 id="example-event-forwarding---multiple-destinations">Example Event Forwarding - Multiple destinations</h2>
<p>In this example, we will create a pipeline that writes Events to the file system, but to multiple destinations based on the location of the Event Client element.</p>
<p>We will use the EventSource/Client/Location/Country element to decided where to store the events.
Specifically, we store events from clients in AUS in one location, and events from clients in GBR to another.
All other client locations will be ignored.</p>
<h2 id="create-translations">Create translations</h2>
<p>First, we will create two translations - one for each country location Australia (AUS) and Great Britain (GBR).
The AUS selection translation is</p>
<pre><code class="language-xml">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet 
    version=&quot;3.0&quot; 
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; 
    xmlns=&quot;event-logging:3&quot; 
    xmlns:stroom=&quot;stroom&quot; 
    xpath-default-namespace=&quot;event-logging:3 
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
    xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt; 

  &lt;!--
  ClientAUS Translation: CHANGE  HISTORY
  v1.0.0 - 2015-01-19  
  v1.5.0 - 2020-04-15

  This translation find all events where the EventSource/Client/Location/Country element
  contains the string 'AUS' and then copies them.
  --&gt;

  &lt;!--  Match all  events --&gt;
  &lt;xsl:template match=&quot;/Events|/Events/@*&quot;&gt;
  &lt;xsl:copy&gt;
  &lt;xsl:apply-templates  select=&quot;node()|@*&quot; /&gt;
  &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Find all  events  whose Client location is in the AUS --&gt;
  &lt;xsl:template match=&quot;Event&quot;&gt;
  &lt;xsl:apply-templates select=&quot;EventSource/Client/Location/Country[contains(upper-case(text()),  'AUS')]&quot; /&gt;
  &lt;/xsl:template&gt;

  &lt;!--  Country template - deep copy the event --&gt;
  &lt;xsl:template match=&quot;Country&quot;&gt;
  &lt;xsl:copy-of select=&quot;ancestor::Event&quot;  /&gt;
  &lt;/xsl:template&gt;
  &lt;/xsl:stylesheet&gt;
</code></pre>
<p>The Great Britain selection translation is</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet
    version=&quot;3.0&quot;
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;
    xmlns=&quot;event-logging:3&quot;
    xmlns:stroom=&quot;stroom&quot;
    xpath-default-namespace=&quot;event-logging:3
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt; 

  &lt;!--
  ClientGBR Translation: CHANGE  HISTORY
  v1.0.0 - 2015-01-19  
  v1.5.0 - 2020-04-15

  This translation find all events where the EventSource/Client/Location/Country
  element contains the string 'GBR' and then copies them.
  --&gt;

  &lt;!--  Match all  events --&gt;
  &lt;xsl:template  match=&quot;/Events|/Events/@*&quot;&gt;
  &lt;xsl:copy&gt;
  &lt;xsl:apply-templates  select=&quot;node()|@*&quot; /&gt;
  &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Find all  events  whose Client location is in the GBR --&gt;
  &lt;xsl:template  match=&quot;Event&quot;&gt;
  &lt;xsl:apply-templates select=&quot;EventSource/Client/Location/Country[contains(upper-case(text()),  'GBR')]&quot; /&gt;
  &lt;/xsl:template&gt;

  &lt;!--  Country template - deep copy the event --&gt;
  &lt;xsl:template  match=&quot;Country&quot;&gt;
  &lt;xsl:copy-of select=&quot;ancestor::Event&quot;  /&gt;
  &lt;/xsl:template&gt;
  &lt;/xsl:stylesheet&gt;
</code></pre>
<p>We will store this capability in the Explorer Folder <strong>MultiGeoForwarding</strong>.
Create two new XSLT under this folder, one called <strong>ClientAUS</strong> and one called <strong>ClientGBR</strong>.
Copy and paste the relevant XSL from the above code blocks into its comparable XSLT windows.
Save the XSLT by clicking on the save 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 icon.
Having created the two translations we see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-00.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-00.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-00.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-00.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Folder</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<h2 id="create-pipeline">Create Pipeline</h2>
<p>We now create a Pipeline called <strong>MultiGeoFwd</strong> in the Explorer tree.
Within the <em>MultiGeoForwarding</em> folder right click to bring up the object context menu and sub-menu then create a New
Pipeline called <strong>MultiGeoFwd</strong>.
The Explorer should now look like</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-01.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-01.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-01.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-01.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Clicking on the Pipeline <strong>Settings</strong> sub-item and add an appropriate description</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-02.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-02.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-02.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-02.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline description</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now switch to the <strong>Structure</strong> sub-item and select the 








  
  








<span class="pipeline-element" title="Source" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/stream.svg" 
    title="Source" 
    alt="stream.svg">
  <span>Source</span>
</span>
 element.</p>
<p>Next click on the <em>Add New Pipeline Element</em> icon 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add pipeline element" 
    alt="add.svg">


.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-04.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-04.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-04.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-04.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline add new pipeline element</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Select <em>Parser, XMLParser</em> from the Element context menu</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-05.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-05.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-05.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-05.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline select pipeline parser</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Click on <strong>OK</strong> in the <em>Create Element</em> dialog box to accept the default for the parser Id.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-06.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-06.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-06.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-06.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline select pipeline parser</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We continue building the pipeline structure by sequentially selecting the last Element and adding the next required Element.
We next add a <em>SplitFilter</em> Element</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-07.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-07.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-07.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-07.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline select pipeline SplitFilter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We change the SplitFilter <strong>Id:</strong> from <em>splitFilter</em> to <em>multiGeoSplitFilter</em> and click on <strong>OK</strong> to add the Element to the Pipeline</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-08.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-08.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-08.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-08.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline select pipeline SplitFilter Id</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Our Pipeline currently looks like</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-09.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-09.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-09.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-09.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Structure view</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We now add the two XSLT translation elements, ClientAUS and ClientGBR to the split Filter.
Left click on the split Filter then left click on the Add New Pipeline Element to bring up the pipeline Element context menu and select the XSLTFilter item</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-10.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-10.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-10.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-10.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline XSLT Filter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and change the <strong>Id:</strong> from <em>xsltFilter</em> to <em>ClientAUSxsltFilter</em></p>
<p>Now select the multiGeoSplitFilter Element again and add another XSLTFilter as previously</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-11.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-11.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-11.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-11.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline XSLT Filter2</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Name this xsltFilter <em>ClientGBRxsltFilter</em>.</p>
<p>At this stage the Pipeline should look like</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-12.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-12.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-12.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-12.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline view</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>To continue building the Pipeline Structure, left click the 








  
  










<span class="pipeline-element" title="ClientAUSxlstFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="ClientAUSxlstFilter" 
    alt="xslt.svg">
  <span>ClientAUSxlstFilter</span>
</span>
</p>
<p>ClientAUSxsltFilter element then left click on the <em>Add New Pipeline Element</em> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add new pipeline element" 
    alt="add.svg">


 to bring up the pipeline Element context menu and select the SchemaFilter item.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-14.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-14.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-14.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-14.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline select SchemaFilter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and change the <strong>Id:</strong> from schemaFilter to AUSschemaFilter to show</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-15.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-15.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-15.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-15.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline development</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now, left click the AUSschemaFilter element then then right click on the <em>Add New Pipeline Element</em> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add new pipeline element" 
    alt="add.svg">


 to bring up the pipeline Element context menu and select the XMLWriter item</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-16.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-16.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-16.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-16.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline select XMLWriter</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and change the <strong>Id:</strong> from xmlWriter to AUSxmlWriter</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-17.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-17.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-17.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-17.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline XMLWriter Id</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Your Pipeline should now look like</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-18.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-18.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-18.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-18.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline development2</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Finally, left click the  AUSxmlWriter element then then right click on the Add New Pipeline Element  <em>Add New Pipeline Element</em> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add new pipeline element" 
    alt="add.svg">


  to bring up the <strong>Destination</strong> pipeline Element context menu.</p>
<p>Select <strong>RollingFileAppender</strong></p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-19.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-19.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-19.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-19.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline select destination</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and change the <strong>Id:</strong> from rollingFileAppender to AUSrollingFileAppender to show</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-20.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-20.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-20.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-20.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline development3</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This completes the pipeline structure for the AUS branch of the pipeline.  Replicate the process of adding schemaFilter, xmlWriter, and rollingFileAppender Elements for the GBR branch of the pipeline to get the complete pipeline structure as below</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-21.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-21.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-21.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-21.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Structure completed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Save your Pipeline development work by clicking on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 icon at the top left of the MultiGeoFwd pipeline tab.</p>
<p>We will now assign appropriate properties to each of the pipeline’s elements.
First, the client xsltFilters.
Click the ClientAUSxsltFilter element to show</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-22.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-22.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-22.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-22.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline xsltFilter properties</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>In the middle pane click on the <em>xslt</em> <strong>Property Name</strong> line.
Now click on the <strong>Edit Property</strong> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/edit.svg" 
    title="Edit" 
    alt="edit.svg">


 icon</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-23.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-23.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-23.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-23.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline xslt Edit Property</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>This will bring up the <strong>Edit Property</strong> selection window</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-24.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-24.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-24.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-24.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline xslt Edit Property window</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Select the <strong>Value:</strong> to be the ClientAUS translation.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-25.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-25.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-25.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-25.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline xslt Edit Property window value</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Click on <strong>OK</strong> twice to get your back to main MultiGeoFwd tab which should now have an updated <em>middle pane</em> that looks like</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-26.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-26.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-26.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-26.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline xslt Edit Property completed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now go back to the top pane of the Pipeline Structure and select the AUSschemaFilter element on the pipeline.
Then click the <em>schemaGroup</em> <strong>Property Name</strong> line.
Now click on the <strong>Edit Property</strong> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/edit.svg" 
    title="Edit property" 
    alt="edit.svg">


 icon.
Set the Property Value to be EVENTS.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-27.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-27.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-27.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-27.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline schemaFilter Edit Property</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press <strong>OK</strong>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-28.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-28.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-28.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-28.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline schemaFilter Edit Property completed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Now select the AUSxmlWriter element in the pipeline structure and click the <em>indentOutput</em> <strong>Property Name</strong> line.
Click on the <strong>Edit Property</strong> 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/edit.svg" 
    title="Edit property" 
    alt="edit.svg">


 icon.
Set the Property Value to be <em>true</em>.
The completed Element should look like</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-29.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-29.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-29.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-29.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline xmlWriter Edit Property completed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Next, select the 








  
  








<span class="pipeline-element" title="AUSrollingFileAppender" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/files.svg" 
    title="AUSrollingFileAppender" 
    alt="files.svg">
  <span>AUSrollingFileAppender</span>
</span>
 and change the Properties as per</p>
<ul>
<li>fileName to be <code>fwd_${ms}.lock</code></li>
<li>frequency to be <code>15m</code></li>
<li>outputPaths to be <code>/stroom/volumes/defaultStreamVolume/forwarding/AUS00</code></li>
<li>rolledFileName to be <code>fwd_${ms}.ready</code></li>
</ul>
<p>Note that these settings are for demonstration purposes only and will depend on your unique Stroom instance&rsquo;s configuration.
The outputPath can contain replacement variables to provide more structure if desired, see <a href="../../../docs/user-guide/pipelines/file-output/">File Output substitution variables</a>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-31.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-31.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-31.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-31.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline rollingFileAppender Edit Property completed</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Repeat this Element Property Name assignment for the GBR branch of the pipeline substituting the ClientGBR translation and /stroom/volumes/defaultStreamVolume/forwarding/GBR00  for rollingFileAppender outputPaths where appropriate.</p>
<p>Note, if you expect lots of events to be processed by the pipeline, you may which to create multiple outputPaths.
For example, you could have</p>
<pre><code class="language-text">/stroom/volumes/defaultStreamVolume/forwarding/_AUS00_,
/stroom/volumes/defaultStreamVolume/forwarding/_AUS01_,
/stroom/volumes/defaultStreamVolume/forwarding/_AUS0n_
</code></pre>
<p>and</p>
<pre><code class="language-text">/stroom/volumes/defaultStreamVolume/forwarding/_GBR00_,
/stroom/volumes/defaultStreamVolume/forwarding/_GBR01_,
/stroom/volumes/defaultStreamVolume/forwarding/_GBR0n_
</code></pre>
<p>as appropriate.</p>
<p>Save the pipeline by pressing the Save 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/save.svg" 
    title="Save" 
    alt="save.svg">


 icon.</p>
<h2 id="test-pipeline">Test Pipeline</h2>
<p>We first select a stream of Events which we know to have both AUS and GBR Client locations.
We have such a stream from our Apache-SSLBlackBox-V2.0-EVENTS Feed.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-32.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-32.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-32.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-32.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Test Events selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We select the Events stream and Enter Stepping Mode by pressing the large 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/stepping.svg" 
    title="Stepping" 
    alt="stepping.svg">


 button in the bottom right.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-33.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-33.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-33.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-33.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Test Enter Stepping Mode</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>and we will choose the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/document/Pipeline.svg" 
    title="Pipeline" 
    alt="document/Pipeline.svg">


 <em>MultiGeoFwd</em> to step with.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-35.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-35.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-35.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-35.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Test selection</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We are now presented with the <em>Stepping</em> tab positioned at the start







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-36.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-36.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-36.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-36.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline start</figcaption>
      </div>
      
    </figure>
  </a>
</div>
</p>
<p>If we step forward by clicking on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step Forward" 
    alt="step-forward-green.svg">


 icon we will see that our first event in our source stream has a Client Country location of USA.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-37.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-37.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-37.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-37.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Test first record</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we now click on the 








  
  










<span class="pipeline-element" title="ClientAUSxsltFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="ClientAUSxsltFilter" 
    alt="xslt.svg">
  <span>ClientAUSxsltFilter</span>
</span>
 element we will see the ClientAUS translation in the code pane.
The first Event in the <em>input</em> pane and an empty event in the <em>output</em> pane.
The output is empty as the Client/Location/Country is NOT the string <em>AUS</em>, which is what the translation is matching on.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-38.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-38.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-38.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-38.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Test first record output empty</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we step forward to the 5th Event we will see the <em>output</em> pane change and become populated.
This is because this Event&rsquo;s Client/Location/Country value is the string <em>AUS</em>.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-39.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-39.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-39.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-39.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Test fifth record output</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Note, that you can move to the 5th Event on the pipeline by clicking on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step Forward" 
    alt="step-forward-green.svg">


 icon repeatedly until you get to the 5th event, or you can insert your cursor into the <strong>recordNo</strong> of the stepping key to manually change the recordNo from 1 to 5







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-40.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-40.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-40.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-40.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline stepping key</figcaption>
      </div>
      
    </figure>
  </a>
</div>
 and then press <strong>Enter</strong>.
This jumps the stepping process to the RecordNo you specify, in this particular case &ldquo;5&rdquo;.</p>
<p>If you repeatedly click on the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step Forward" 
    alt="step-forward-green.svg">


 icon seven more times you will continue to see Events in the <em>output</em> pane, as our stream source Client/Location/Country value is <em>AUS</em> for Events 5-11.</p>
<p>Now, double click on the 








  
  










<span class="pipeline-element" title="ClientGBRxsltFilter" >
  <img
    class="stroom-icon" 
    style="max-width: 15px;"
    src="../../../images/stroom-ui/pipeline/xslt.svg" 
    title="ClientGBRxsltFilter" 
    alt="xslt.svg">
  <span>ClientGBRxsltFilter</span>
</span>
 element.
The <em>output</em> pane will once again be empty as the Client/Location/Country value of this Event (AUS) does not match what your translation is filtering on (GBR).</p>
<p>If you now step forward one event using the 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/step-forward-green.svg" 
    title="Step Forward" 
    alt="step-forward-green.svg">


 icon, you will see the ClientGBR translation <em>output</em> pane populate as Events 12-16 have a Client/Location/Country of GRC.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-42.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-42.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-42.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-42.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline ClientGBR populated</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>We have thus tested the ‘splitting’ effect of our pipeline.
We now need to turn it on and produce files.</p>
<h3 id="enabling-processors-for-multi-forwarding-pipeline">Enabling Processors for Multi Forwarding Pipeline</h3>
<p>To enable the Processors for the pipeline, select the <em>MultiGeoFwd</em> pipeline tab and then select the Processors sub-item.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-43.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-43.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-43.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-43.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Processors</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>For testing purposes, we will only apply this pipeline to our Apache-SSLBlackBox-V2.0-EVENTS feed to minimise the test output files.</p>
<p>To create the Processor, click the Add Processor 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/add.svg" 
    title="Add Processor" 
    alt="add.svg">


 icon to bring up the <em>Add Processor</em> selection window.</p>
<p>Add the following items to the processor:</p>
<ul>
<li>Feed is <code>Apache-SSLBlackBox-V2.0-EVENTS</code></li>
<li>Type = <code>Events</code></li>
</ul>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-44.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-44.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-44.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-44.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Processors Filters</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>then press <strong>OK</strong> to see</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-45.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-45.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-45.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-45.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Processors Configured</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Enable the processors by checking both Enabled check boxes</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-46.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-46.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-46.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-46.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Processors Enabled</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>If we switch to the Active Tasks tab of the MultiGeoFwd pipeline, a refresh of the panes 









  <img 
    class="stroom-icon " 
    src="../../../images/stroom-ui/refresh.svg" 
    title="Refresh" 
    alt="refresh.svg">


 will show that we have passed streams from the
APACHE-SSLBlackBox-V2.0-EVENTS feed to completion.
If we select the MultiGeoFwd pipeline in the top pane we will see each stream that has run.</p>







  
  
  
  
  







  



<div class="card rounded shadow-stroom p-2 td-post-card mb-4 mt-4" style="width: fit-content;">

  <a title="images/HOWTOs/v6/UI-MultiGeoFwd-47.png" href="../../../images/HOWTOs/v6/UI-MultiGeoFwd-47.png">
    <figure style="margin-block-end: 0px" >
      
      <img class="card-img-top" src="../../../images/HOWTOs/v6/UI-MultiGeoFwd-47.png" style="max-width: fit-content" alt="images/HOWTOs/v6/UI-MultiGeoFwd-47.png">
      

      
      <div class="card-body px-0 pt-2 pb-0">
        <hr style="border-top: 1px solid #ddd; margin-top: 0px; margin-bottom:4px;">
        <figcaption class="card-text" style="font-size: smaller; text-align: center;">Stroom UI MultiGeoFwd - MultiGeoFwd Pipeline Processors Active Tasks</figcaption>
      </div>
      
    </figure>
  </a>
</div>

<p>Take note that all streams have processed on Node node1a.</p>
<h3 id="examine-output-files-on-destination-node">Examine Output Files on Destination Node</h3>
<p>If we navigate to the /stroom/volumes/defaultStreamVolume/forwarding directory on the processing node we should be able to view the expected output files.</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="testdoc" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">cd forwarding
ls -lR
(out).:
(out)total 0
(out)drwxr-xr-x. 2 testdoc testdoc 129 May  5 01:13 AUS00
(out)drwxr-xr-x. 2 testdoc testdoc 129 May  5 01:13 GBR00
(out)
(out)./AUS00:
(out)total 136
(out)-rw-r--r--. 1 testdoc testdoc 21702 May  4 22:28 fwd_1588588112856.ready
(out)-rw-r--r--. 1 testdoc testdoc 21702 May  4 22:44 fwd_1588589043294.ready
(out)-rw-r--r--. 1 testdoc testdoc 64452 May  5 01:09 fwd_1588597744865.ready
(out)-rw-r--r--. 1 testdoc testdoc 21692 May  5 01:14 fwd_1588598005439.lock
(out)
(out)./GBR00:
(out)total 96
(out)-rw-r--r--. 1 testdoc testdoc 15660 May  4 22:28 fwd_1588588112809.ready
(out)-rw-r--r--. 1 testdoc testdoc 15660 May  4 22:44 fwd_1588589043293.ready
(out)-rw-r--r--. 1 testdoc testdoc 46326 May  5 01:09 fwd_1588597744865.ready
(out)-rw-r--r--. 1 testdoc testdoc 15650 May  5 01:14 fwd_1588598005408.lock</code></pre>
</div>

<p>The output directory contains files with suffixes of  *.lock or *.ready.
All the files that are ‘currently processing’ have a nomenclature of *.lock suffix.
These are the files that our pipeline is currently writing to.
Remember we configured the rollingFileAppender to roll the files at a frequency of 15 minutes.
We may need to wait up to 15 minutes before a file move from .lock to .ready status.</p>
<p>If we check one of the AUS00 output files we see the expected result</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="testdoc" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">less AUS00/fwd_1588588112856.ready
(out)&lt;?xml version=&#34;1.1&#34; encoding=&#34;UTF-8&#34;?&gt;
(out)&lt;Events xmlns=&#34;event-logging:3&#34;
(out)        xmlns:stroom=&#34;stroom&#34;
(out)        xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
(out)        xmlns:xs=&#34;http://www.w3.org/2001/XMLSchema&#34;
(out)        xsi:schemaLocation=&#34;event-logging:3 file://event-logging-v3.2.3.xsd&#34;
(out)        Version=&#34;3.2.3&#34;&gt;
(out)   &lt;Event&gt;
(out)      &lt;EventTime&gt;
(out)         &lt;TimeCreated&gt;2020-01-18T22:43:04.000Z&lt;/TimeCreated&gt;
(out)      &lt;/EventTime&gt;
(out)      &lt;EventSource&gt;
(out)         &lt;System&gt;
(out)            &lt;Name&gt;LinuxWebServer&lt;/Name&gt;
(out)            &lt;Environment&gt;Production&lt;/Environment&gt;
(out)         &lt;/System&gt;
(out)         &lt;Generator&gt;Apache  HTTPD&lt;/Generator&gt;
(out)         &lt;Device&gt;
(out)            &lt;HostName&gt;stroomnode00.strmdev00.org&lt;/HostName&gt;
(out)            &lt;IPAddress&gt;192.168.2.245&lt;/IPAddress&gt;
(out)         &lt;/Device&gt;
(out)         &lt;Client&gt;
(out)            &lt;HostName&gt;host32.strmdev01.org&lt;/HostName&gt;
(out)            &lt;IPAddress&gt;192.168.8.151&lt;/IPAddress&gt;
(out)            &lt;Port&gt;62015&lt;/Port&gt;
(out)            &lt;Location&gt;
(out)               &lt;Country&gt;AUS&lt;/Country&gt;
(out)               &lt;Site&gt;Sydney-S02&lt;/Site&gt;
(out)               &lt;Building&gt;RC45&lt;/Building&gt;
(out)               &lt;Room&gt;5-134&lt;/Room&gt;
(out)               &lt;TimeZone&gt;&#43;10:00/&#43;11:00&lt;/TimeZone&gt;
(out)            &lt;/Location&gt;
(out)         &lt;/Client&gt;
(out)
(out)         ....</code></pre>
</div>

<p>Similarly, if we look at one of the GBR00 output files we also see the expected output</p>

  






<div class="code-toolbar">
  <pre 
    class="command-line language-bash" 
    data-user="testdoc" 
    data-host="localhost" 
    data-continuation-str="\"
    data-filter-output="(out)"><code class="language-bash">less GBR00/fwd_1588588112809.ready
(out)&lt;?xml version=&#34;1.1&#34; encoding=&#34;UTF-8&#34;?&gt;
(out)&lt;Events xmlns=&#34;event-logging:3&#34;
(out)        xmlns:stroom=&#34;stroom&#34;
(out)        xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
(out)        xmlns:xs=&#34;http://www.w3.org/2001/XMLSchema&#34;
(out)        xsi:schemaLocation=&#34;event-logging:3 file://event-logging-v3.2.3.xsd&#34;
(out)        Version=&#34;3.2.3&#34;&gt;
(out)   &lt;Event&gt;
(out)      &lt;EventTime&gt;
(out)         &lt;TimeCreated&gt;2020-01-18T12:50:06.000Z&lt;/TimeCreated&gt;
(out)      &lt;/EventTime&gt;
(out)      &lt;EventSource&gt;
(out)         &lt;System&gt;
(out)            &lt;Name&gt;LinuxWebServer&lt;/Name&gt;
(out)            &lt;Environment&gt;Production&lt;/Environment&gt;
(out)         &lt;/System&gt;
(out)         &lt;Generator&gt;Apache  HTTPD&lt;/Generator&gt;
(out)         &lt;Device&gt;
(out)            &lt;HostName&gt;stroomnode00.strmdev00.org&lt;/HostName&gt;
(out)            &lt;IPAddress&gt;192.168.2.245&lt;/IPAddress&gt;
(out)         &lt;/Device&gt;
(out)         &lt;Client&gt;
(out)            &lt;HostName&gt;host14.strmdev00.org&lt;/HostName&gt;
(out)            &lt;IPAddress&gt;192.168.234.9&lt;/IPAddress&gt;
(out)            &lt;Port&gt;62429&lt;/Port&gt;
(out)            &lt;Location&gt;
(out)               &lt;Country&gt;GBR&lt;/Country&gt;
(out)               &lt;Site&gt;Bristol-S22&lt;/Site&gt;
(out)               &lt;Building&gt;CAMP2&lt;/Building&gt;
(out)               &lt;Room&gt;Rm67&lt;/Room&gt;
(out)               &lt;TimeZone&gt;&#43;00:00/&#43;01:00&lt;/TimeZone&gt;
(out)            &lt;/Location&gt;
(out)         &lt;/Client&gt;
(out)
(out)        ....</code></pre>
</div>

<p>At this point, you can manage the .ready files in any manner you see fit.</p>

</div>




    
	
  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/gchq/stroom" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2024 Crown Copyright All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    

<script src='../../../js/popper.min.js'></script>
<script src='../../../js/bootstrap.min.js'></script>






<script src='../../../js/tabpane-persist.js'></script>




















<script src="../../../js/main.min.cbc1d428d83561c4dec32da9374290554119d7483329f849251cb7153b2ecd07.js" integrity="sha256-y8HUKNg1YcTewy2pN0KQVUEZ10gzKfhJJRy3FTsuzQc=" crossorigin="anonymous"></script>



<script src='../../../js/prism.js'></script>



  </body>
</html>
