<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.95.0" />
<link rel="canonical" type="text/html" href="../../../../../docs/user-guide/pipelines/xslt/">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="../../../../../favicons/favicon.ico" >
<link rel="apple-touch-icon" href="../../../../../favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="../../../../../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../../../../../favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../../../favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="../../../../../favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../../../../../favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="../../../../../favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../../../favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="../../../../../favicons/android-192x192.png" sizes="192x192">

<title>XSLT Conversion | Stroom</title>
<meta name="description" content="Using Extensible Stylesheet Language Transformations (XSLT) to transform data.
">
<meta property="og:title" content="XSLT Conversion" />
<meta property="og:description" content="Using Extensible Stylesheet Language Transformations (XSLT) to transform data.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/user-guide/pipelines/xslt/" /><meta property="og:site_name" content="Stroom" />

<meta itemprop="name" content="XSLT Conversion">
<meta itemprop="description" content="Using Extensible Stylesheet Language Transformations (XSLT) to transform data.
"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="XSLT Conversion"/>
<meta name="twitter:description" content="Using Extensible Stylesheet Language Transformations (XSLT) to transform data.
"/>




<link rel="preload" href="../../../../../scss/main.min.0646aebd0a039bbd6f3aa2e51efd141a973fed8c1a5cb4d7d8788638e62403fd.css" as="style">
<link href="../../../../../scss/main.min.0646aebd0a039bbd6f3aa2e51efd141a973fed8c1a5cb4d7d8788638e62403fd.css" rel="stylesheet" integrity="">


<script src='../../../../../js/jquery-3.6.0.min.js'></script>


<script src='../../../../../js/lunr.min.js'></script>
  
<link rel="stylesheet" href="../../../../../css/prism.css"/>
<link rel="stylesheet" href="../../../../../css/stroom-ui/icon-colours.css"/>
<link rel="stylesheet" href="../../../../../css/stroom-ui/material_design_colors.css"/>
<link rel="stylesheet" href="../../../../../css/stroom-ui/theme-root.css"/>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-00000000-0', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="../../../../../"><span class="navbar-brand__logo navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="110.61089" height="30.000004" viewBox="0 0 88.488641 23.999957" id="svg2" inkscape:version="0.91 r13725" sodipodi:docname="logo.svg"><defs id="defs20"/><sodipodi:namedview pagecolor="#989898" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1137" id="namedview18" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:zoom="5.5951814" inkscape:cx="55.451414" inkscape:cy="16.275348" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="svg2"/><g id="g4150" style="opacity:.97000002" transform="matrix(0.03883584,0,0,0.03883584,0,-3.1155874e-4)"><path id="path6" d="M121.99991 205.98497C54.999958 205.98497.0 259.98493.0 327.98487c0 66.99994 54.999958 121.99989 121.99991 121.99989h167.99987c24.99998.0 44.99996 20.99998 44.99996 44.99996.0 24.99998-19.99998 44.99996-44.99996 44.99996H109.20929C65.984126 553.87219 27.100843 581.57313.01093599 617.98462H289.99978c66.99994.0 121.99991-54.99996 121.99991-122.9999.0-66.99994-54.99997-121.99989-121.99991-121.99989H121.99991c-24.999984.0-44.999969-19.99999-44.999969-44.99996.0-24.99998 19.999985-44.99996 44.999969-44.99996h228.79045c26.9905-35.88325 65.47093-63.18547 108.21554-76.99994H121.99991z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path8" d="M601.44485-.00077860649C572.6583 8.3697982 546.49491 22.822962 524.44491 41.902305V205.78969l.002.19528h-.002c-65.11 48e-5-123.03145 30.0199-160.74675 76.99994h160.74675v334.99971h76.99994V282.98491h144.85298c27.16134-36.05885 65.96411-63.39275 109.02184-76.99994H601.44485v-205.98574860649z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path10" d="m919.42586 205.98497c-113.99519.0-205.99537 92.00648-206.00296 205.99982-15e-5 68.67178.0 137.32749.0 205.99983h77.99994c-.012-68.6493.0176-137.46869.0-205.99983.0846-70.92785 57.05747-128.99988 128.00462-128.99988 5.28623.0 10.49823.32864 15.62183.95311 18.2219-24.51229 41.78461-45.0838 68.42501-60.15146-25.65065-11.43799-54.08662-17.80159-84.04684-17.80159z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path12" d="m1109.4153 205.98457c-113.99994.0-205.99983 91.99993-205.99983 205.99984.0 112.9999 91.99989 205.9998 205.99983 205.9998 114 0 205.9999-92.9999 205.9999-205.9998.0-113.99991-91.9999-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.99994-56.99996-128.99994-127.9999.0-70.99995 58.00004-128.9999 128.99994-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path14" d="m1444.4737 205.98457c-113.9999.0-205.9998 91.99993-205.9998 205.99984.0 112.9999 91.9999 205.9998 205.9998 205.9998s205.9999-92.9999 205.9999-205.9998c0-113.99991-92-205.99984-205.9999-205.99984zm0 333.99974c-70.9999.0-128.9999-56.99996-128.9999-127.9999.0-70.99995 58-128.9999 128.9999-128.9999 71 0 128.9999 57.99995 128.9999 128.9999.0 70.99994-57.9999 127.9999-128.9999 127.9999z" style="fill:#fff" inkscape:connector-curvature="0"/><path id="path16" d="m1738.5308 379.98447c0-53 43-97 95.9999-97 53 0 97 44 97 97v237.9997h76.9999v-237.9997c0-53 43-97 96.9999-97 53 0 95.9999 44 95.9999 97v237.9997h77v-237.9997c0-96-77-173.9999-172.9999-173.9999-54.9999.0-103.9999 24.99998-135.9999 64.99995-31.9999-39.99997-79.9999-64.99995-134.9999-64.99995-95.9999.0-173.9998 77.9999-173.9998 173.9999v237.9997h77.9999z" style="fill:#fff" inkscape:connector-curvature="0"/></g></svg></span><span class="navbar-brand__name">Stroom</span></a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="../../../../../about/about/"><span>About</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link active" href="../../../../../docs/"><span class="active">Documentation</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="../../../../../releases/"><span>Releases Notes</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="../../../../../community/"><span>Community</span></a>
      </li>
      <li class="nav-item dropdown mr-4 d-none d-lg-block">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Stroom Version (7.3)
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	
	
	<a class="dropdown-item" href="../../../../../">7.4 (Latest)</a>
	
	<a class="dropdown-item" href="../../../../../7.3">7.3</a>
	
	<a class="dropdown-item" href="../../../../../7.2">7.2</a>
	
	<a class="dropdown-item" href="../../../../../7.1">7.1</a>
	
	<a class="dropdown-item" href="../../../../../7.0">7.0</a>
	
	<a class="dropdown-item" href="../../../../../legacy">Legacy</a>
	
</div>
</li>
      </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="../../../../../offline-search-index.4c2f4ae1e403ccc3e83289d4b3f4681b.json"
    data-offline-search-base-href="../../../../../"
    data-offline-search-max-results="50"
  >
</div>

  </div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="../../../../../docs/user-guide/pipelines/xslt/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">XSLT Conversion</h1>
<div class="lead">Using Extensible Stylesheet Language Transformations (XSLT) to transform data.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-01b168d16afe2c59c3f89aa71a185926">XSLT Basics</a></li>


    
  
    
    
	
<li>2: <a href="#pg-00fcef074a5fb84079d17e4049c5a7f8">XSLT Functions</a></li>


    
  
    
    
	
<li>3: <a href="#pg-3f52cd945d5eabe8bb9a84799caa130e">XSLT Includes</a></li>


    
  

    </ul>


<div class="content">
      <p><span class="glossary-link">
  <a href="../../../../../docs/glossary/#xslt" title="Glossary entry for XSLT">
    <span>XSLT</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> is a language that is typically used for transforming XML documents into either a different XML document or plain text.
XSLT is key part of Stroom&rsquo;s pipeline processing as it is used to normalise bespoke events into a common XML audit event document conforming to the <code>event-logging</code> <span class="glossary-link">
  <a href="../../../../../docs/glossary/#xml-schema" title="Glossary entry for XML Schema">
    <span>XML Schema</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span>.</p>
<p>Once a text file has been converted into intermediary XML (or the feed is already XML), <span class="glossary-link">
  <a href="../../../../../docs/glossary/#xslt" title="Glossary entry for XSLT">
    <span>XSLT</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> is used to
translate the XML into the <code>event-logging</code> XML format.</p>
<p>The 







  
  

  
  

  
  
  

  
  

  
  

  

    
    

    
      
      
      

      
      <a href="../../../../../docs/user-guide/pipelines/element-reference#xsltfilter" class="" style="" title="">
        <span class="pipeline-element" title="XSLTFilter &#34;XSLTFilter&#34;" >
          <span class="pipeline-element-content" >
            <span class="pipeline-element-icon">
              <span class="stroom-icon inline-svg-button icon-button  " >
    <span class="face" title="Xslt"><svg xmlns="http://www.w3.org/2000/svg" width="1792" height="1792" viewBox="0 0 1792 1792"><path style="fill:var(--icon-colour__xsl-background)" d="M 684.30664 211.38672 C 672.42766 211.38672 661.91891 215.95413 652.78125 225.0918 L 14.058594 863.81641 C 4.9209141 872.95409 0.3515625 883.46088 0.3515625 895.33984 C 0.3515625 907.21882 4.9209142 917.72756 14.058594 926.86523 L 652.78125 1565.5898 C 661.91891 1574.7275 672.42766 1579.2949 684.30664 1579.2949 C 696.1856 1579.2949 706.69435 1574.7275 715.83203 1565.5898 L 784.36523 1497.0566 C 793.5029 1487.9191 798.07031 1477.4102 798.07031 1465.5312 C 798.07031 1453.6524 793.5029 1443.1436 784.36523 1434.0059 L 245.69922 895.33984 L 784.36523 356.67578 C 793.5029 347.53811 798.07031 337.02937 798.07031 325.15039 C 798.07031 313.27142 793.5029 302.76268 784.36523 293.625 L 715.83203 225.0918 C 706.69435 215.95413 696.1856 211.38672 684.30664 211.38672 z M 1107.9082 211.38672 C 1096.0293 211.38672 1085.5225 215.95414 1076.3848 225.0918 L 1007.8516 293.625 C 998.71402 302.76268 994.14453 313.27142 994.14453 325.15039 C 994.14453 337.02937 998.71402 347.53811 1007.8516 356.67578 L 1546.5176 895.33984 L 1007.8516 1434.0059 C 998.71402 1443.1436 994.14453 1453.6523 994.14453 1465.5312 C 994.14453 1477.4102 998.71402 1487.9191 1007.8516 1497.0566 L 1076.3848 1565.5898 C 1085.5225 1574.7275 1096.0293 1579.2949 1107.9082 1579.2949 C 1119.7872 1579.2949 1130.2959 1574.7275 1139.4336 1565.5898 L 1778.1582 926.86523 C 1787.2959 917.72756 1791.8633 907.21882 1791.8633 895.33984 C 1791.8633 883.46088 1787.2959 872.95409 1778.1582 863.81641 L 1139.4336 225.0918 C 1130.2959 215.95414 1119.7872 211.38672 1107.9082 211.38672 z "/><path style="fill:var(--icon-colour__black)" d="M 914.01562 609.75391 C 846.69543 609.75391 793.7585 624.0295 755.20508 652.58203 C 716.65166 681.13457 697.375 720.39439 697.375 770.36133 C 697.375 809.25185 709.09092 840.2669 732.51953 863.4043 C 755.94815 886.29555 800.72934 908.20094 866.86328 929.12305 L 931.36523 949.42969 C 953.90415 956.5678 971.1042 966.4135 982.9668 978.9668 C 994.82939 991.27392 1000.7617 1005.6745 1000.7617 1022.166 C 1000.7617 1044.0727 991.86421 1061.1792 974.07031 1073.4863 C 956.27643 1085.5473 931.21618 1091.5781 898.89062 1091.5781 C 866.86163 1091.5781 834.38939 1086.5313 801.4707 1076.4395 C 768.84858 1066.3477 735.03956 1050.9651 700.04492 1030.2891 L 700.04492 1142.8984 C 730.88766 1155.6978 762.76881 1165.2975 795.6875 1171.6973 C 828.90275 1178.3431 861.96998 1181.666 894.88867 1181.666 C 974.96115 1181.666 1034.719 1168.0054 1074.1621 1140.6836 C 1113.9018 1113.1156 1133.7715 1071.5169 1133.7715 1015.8887 C 1133.7715 975.02903 1121.167 941.18506 1095.959 914.35547 C 1070.751 887.52595 1031.4559 865.98759 978.07422 849.74219 L 921.57812 832.01953 C 882.43158 819.95854 856.6315 809.00586 844.17578 799.16016 C 832.01663 789.06832 825.93555 776.3917 825.93555 761.13086 C 825.93555 741.43946 834.38878 726.30288 851.29297 715.71875 C 868.19716 705.13462 892.51562 699.8418 924.24805 699.8418 C 952.71826 699.8418 981.4855 704.14869 1010.5488 712.76367 C 1039.6122 721.37867 1068.2307 733.93228 1096.4043 750.42383 L 1096.4043 644.08984 C 1066.4513 632.76728 1036.2005 624.27651 1005.6543 618.61523 C 975.10813 612.70782 944.56179 609.75391 914.01562 609.75391 z M 109.28711 619.72266 L 298.79297 891.09375 L 103.94922 1170.959 L 239.62891 1170.959 L 365.96484 988.56641 L 492.74609 1170.959 L 628.42383 1170.959 L 434.4707 891.09375 L 623.08594 619.72266 L 487.4082 619.72266 L 365.96484 795.09961 L 244.9668 619.72266 L 109.28711 619.72266 z M 1288.1328 619.72266 L 1288.1328 1170.959 L 1700.0605 1170.959 L 1700.0605 1074.9629 L 1419.3633 1074.9629 L 1419.3633 619.72266 L 1288.1328 619.72266 z "/></svg> </span>
  </span>
            </span>
            <span class="pipeline-element-text">XSLTFilter</span>
          </span>
        </span>
      </a>

      
      <span class="USED FOR SPLITTING" ></span>

    
  







 pipeline element defines the XSLT document and is used to do the transformation of the input XML into XML or plain text.
You can have multiple XSLTFilter elements in a pipeline if you want to break the transformation into steps, or wish to have simpler XSLTs that can be reused.</p>
<p><em>Raw Event</em> Feeds are typically translated into the <code>event-logging:3</code> schema and <em>Raw Reference</em> into the <code>reference-data:2</code> schema.</p>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    



<div class="td-content" style="--base-section-num: '1.'; page-break-before: always">
    
  <h1 id="pg-01b168d16afe2c59c3f89aa71a185926">1 - XSLT Basics</h1>
    <div class="lead">The basics of using XSLT and the XSLTFilter element.</div>
	<p><span class="glossary-link">
  <a href="../../../../../docs/glossary/#xslt" title="Glossary entry for XSLT">
    <span>XSLT</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> is a very powerful language and allows the user to perform very complex transformations of XML data.
This documentation does not aim to document how to write XSLT documents, for that, we strongly recommend you refer to online references (e.g. 







  
  

<span class="external-link">
  <a href="https://www.w3schools.com/xml/xsl_intro.asp" target="_blank" class="" style="" title="W3Schools (external link to https://www.w3schools.com/xml/xsl_intro.asp)">
    <span>W3Schools</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
 or obtain a book covering XSLT 2.0 and <span class="glossary-link">
  <a href="../../../../../docs/glossary/#xpath" title="Glossary entry for XPath">
    <span>XPath</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span>).
It does however aim to document aspects of XSLT that are specific to the use of XSLT in Stroom.</p>
<h2 id="examples">Examples</h2>
<h3 id="event-normalisation">Event Normalisation</h3>
<p>Here is an example XSLT document that transforms XML data in the <code>records:2</code> <span class="glossary-link">
  <a href="../../../../../docs/glossary/#namespace" title="Glossary entry for namespace">
    <span>namespace</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> (which is the output of the 







  
  

  
  

  
  
  

  
  

  
  

  

    
    

    
      
      
      

      
      <a href="../../../../../docs/user-guide/pipelines/element-reference#dsparser" class="" style="" title="">
        <span class="pipeline-element" title="DSParser &#34;DSParser&#34;" >
          <span class="pipeline-element-content" >
            <span class="pipeline-element-icon">
              <span class="stroom-icon inline-svg-button icon-button  " >
    <span class="face" title="Text"><svg xmlns="http://www.w3.org/2000/svg" width="1792" height="1792" viewBox="0 0 1792 1792"><path style="fill:var(--icon-colour__black)" d="m 1522.1543,129.30336 16.9536,359.41707 -42.9492,0 q -12.4327,-94.94036 -33.9073,-135.62908 -35.0375,-65.55406 -93.8101,-96.0706 -57.6424,-31.64679 -152.5827,-31.64679 l -215.8763,0 0,1170.93104 q 0,141.2803 30.5165,176.3178 42.9492,47.4702 132.2384,47.4702 l 53.1214,0 0,41.819 -649.88937,0 0,-41.819 54.25164,0 q 97.20084,0 137.88956,-58.7726 24.86533,-36.1677 24.86533,-165.0154 l 0,-1170.93104 -184.2295,0 q -107.37302,0 -152.58272,15.8234 -58.7726,21.4746 -100.59156,82.50769 -41.81897,61.03308 -49.73067,165.01538 l -42.94921,0 18.08388,-359.41707 1251.17832,0 z"/></svg> </span>
  </span>
            </span>
            <span class="pipeline-element-text">DSParser</span>
          </span>
        </span>
      </a>

      
      <span class="USED FOR SPLITTING" ></span>

    
  







 element) into event XML in the <code>event-logging:3</code> namespace.
It is an example of event normalisation from a bespoke format.</p>

<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    This example aims to show some typical uses of XSLT in a typical Stroom use case.
It does not necessarily represent best practice in terms of creation of a normalised event.

</div>


<pre><code class="language-xml">&lt;?xml version=&quot;1.1&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet 
    xpath-default-namespace=&quot;records:2&quot; 
    xmlns=&quot;event-logging:3&quot; 
    xmlns:stroom=&quot;stroom&quot; 
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; 
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
    version=&quot;2.0&quot;&gt;

  &lt;!-- Match the root element --&gt;
  &lt;xsl:template match=&quot;records&quot;&gt;
    &lt;Events 
        xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.0.0.xsd&quot; 
        Version=&quot;3.0.0&quot;&gt;
      &lt;xsl:apply-templates /&gt;
    &lt;/Events&gt;
  &lt;/xsl:template&gt;

  &lt;!-- Match each 'record' element --&gt;
  &lt;xsl:template match=&quot;record&quot;&gt;
    &lt;xsl:variable name=&quot;user&quot; select=&quot;data[@name='User']/@value&quot; /&gt;
    &lt;Event&gt;
      &lt;xsl:call-template name=&quot;header&quot; /&gt;
      &lt;xsl:value-of select=&quot;stroom:log('info', concat('Processing user: ', $user))&quot;/&gt;
      &lt;EventDetail&gt;
        &lt;TypeId&gt;0001&lt;/TypeId&gt;
        &lt;Description&gt;
          &lt;xsl:value-of select=&quot;data[@name='Message']/@value&quot; /&gt;
        &lt;/Description&gt;
        &lt;Authenticate&gt;
          &lt;Action&gt;Logon&lt;/Action&gt;
          &lt;LogonType&gt;Interactive&lt;/LogonType&gt;
          &lt;User&gt;
            &lt;Id&gt;
              &lt;xsl:value-of select=&quot;$user&quot; /&gt;
            &lt;/Id&gt;
          &lt;/User&gt;
          &lt;Data Name=&quot;FileNo&quot;&gt;
            &lt;xsl:attribute name=&quot;Value&quot; select=&quot;data[@name='FileNo']/@value&quot; /&gt;
          &lt;/Data&gt;
          &lt;Data Name=&quot;LineNo&quot;&gt;
            &lt;xsl:attribute name=&quot;Value&quot; select=&quot;data[@name='LineNo']/@value&quot; /&gt;
          &lt;/Data&gt;
        &lt;/Authenticate&gt;
      &lt;/EventDetail&gt;
    &lt;/Event&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template name=&quot;header&quot;&gt;
    &lt;xsl:variable name=&quot;date&quot; select=&quot;data[@name='Date']/@value&quot; /&gt;
    &lt;xsl:variable name=&quot;time&quot; select=&quot;data[@name='Time']/@value&quot; /&gt;
    &lt;xsl:variable name=&quot;dateTime&quot; select=&quot;concat($date, $time)&quot; /&gt;
    &lt;xsl:variable name=&quot;formattedDateTime&quot; select=&quot;stroom:format-date($dateTime, 'dd/MM/yyyyHH:mm:ss')&quot; /&gt;
    &lt;xsl:variable name=&quot;user&quot; select=&quot;data[@name='User']/@value&quot; /&gt;
    &lt;EventTime&gt;
      &lt;TimeCreated&gt;
        &lt;xsl:value-of select=&quot;$formattedDateTime&quot; /&gt;
      &lt;/TimeCreated&gt;
    &lt;/EventTime&gt;
    &lt;EventSource&gt;
      &lt;System&gt;
        &lt;Name&gt;Test&lt;/Name&gt;
        &lt;Environment&gt;Test&lt;/Environment&gt;
      &lt;/System&gt;
      &lt;Generator&gt;CSV&lt;/Generator&gt;
      &lt;Device&gt;
        &lt;IPAddress&gt;1.1.1.1&lt;/IPAddress&gt;
        &lt;MACAddress&gt;00-00-00-00-00-00&lt;/MACAddress&gt;
        &lt;xsl:variable name=&quot;location&quot; select=&quot;stroom:lookup('FILENO_TO_LOCATION_MAP', data[@name='FileNo']/@value, $formattedDateTime)&quot; /&gt;
        &lt;xsl:if test=&quot;$location&quot;&gt;
          &lt;xsl:copy-of select=&quot;$location&quot; /&gt;
        &lt;/xsl:if&gt;
        &lt;Data Name=&quot;Zone1&quot;&gt;
          &lt;xsl:attribute name=&quot;Value&quot; select=&quot;stroom:lookup('IPToLocation', stroom:numeric-ip('192.168.1.1'))&quot; /&gt;
        &lt;/Data&gt;
      &lt;/Device&gt;
      &lt;User&gt;
        &lt;Id&gt;
          &lt;xsl:value-of select=&quot;$user&quot; /&gt;
        &lt;/Id&gt;
      &lt;/User&gt;
    &lt;/EventSource&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>
<h3 id="reference-data">Reference Data</h3>
<p>Here is an example of transforming <a href="../../../../../docs/user-guide/pipelines/reference-data/">Reference Data</a> in the <code>records:2</code> <span class="glossary-link">
  <a href="../../../../../docs/glossary/#namespace" title="Glossary entry for namespace">
    <span>namespace</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> (which is the output of the 







  
  

  
  

  
  
  

  
  

  
  

  

    
    

    
      
      
      

      
      <a href="../../../../../docs/user-guide/pipelines/element-reference#dsparser" class="" style="" title="">
        <span class="pipeline-element" title="DSParser &#34;DSParser&#34;" >
          <span class="pipeline-element-content" >
            <span class="pipeline-element-icon">
              <span class="stroom-icon inline-svg-button icon-button  " >
    <span class="face" title="Text"><svg xmlns="http://www.w3.org/2000/svg" width="1792" height="1792" viewBox="0 0 1792 1792"><path style="fill:var(--icon-colour__black)" d="m 1522.1543,129.30336 16.9536,359.41707 -42.9492,0 q -12.4327,-94.94036 -33.9073,-135.62908 -35.0375,-65.55406 -93.8101,-96.0706 -57.6424,-31.64679 -152.5827,-31.64679 l -215.8763,0 0,1170.93104 q 0,141.2803 30.5165,176.3178 42.9492,47.4702 132.2384,47.4702 l 53.1214,0 0,41.819 -649.88937,0 0,-41.819 54.25164,0 q 97.20084,0 137.88956,-58.7726 24.86533,-36.1677 24.86533,-165.0154 l 0,-1170.93104 -184.2295,0 q -107.37302,0 -152.58272,15.8234 -58.7726,21.4746 -100.59156,82.50769 -41.81897,61.03308 -49.73067,165.01538 l -42.94921,0 18.08388,-359.41707 1251.17832,0 z"/></svg> </span>
  </span>
            </span>
            <span class="pipeline-element-text">DSParser</span>
          </span>
        </span>
      </a>

      
      <span class="USED FOR SPLITTING" ></span>

    
  







 element) into XML in the <code>reference-data:2</code> namespace that is suitable for loading using the 







  
  

  
  

  
  
  

  
  

  
  

  

    
    

    
      
      
      

      
      <a href="../../../../../docs/user-guide/pipelines/element-reference#referencedatafilter" class="" style="" title="">
        <span class="pipeline-element" title="ReferenceDataFilter &#34;ReferenceDataFilter&#34;" >
          <span class="pipeline-element-content" >
            <span class="pipeline-element-icon">
              <span class="stroom-icon inline-svg-button icon-button  " >
    <span class="face" title="Reference data"><svg xmlns="http://www.w3.org/2000/svg" width="1792" height="1792" viewBox="0 0 1792 1792"><path style="fill:var(--icon-colour__blue)" d="m 1205.3507,897.46166 q 0,20.9696 -14.368,35.3376 L 938.18285,1185.5992 q -15.14469,14.368 -35.33761,14.368 -19.80459,0 -34.94929,-14.368 l -29.1244,-29.1244 q -14.75637,-14.7564 -14.75637,-35.3377 0,-20.5812 14.75637,-35.3376 l 113.77934,-113.77934 -273.38109,0 q -20.19292,0 -32.81349,-14.5622 -12.62058,-14.5622 -12.62058,-35.1435 l 0,-49.7056 q 0,-20.5813 12.62058,-35.1435 12.62057,-14.5622 32.81349,-14.5622 l 273.38109,0 -113.77934,-114.1676 q -14.75637,-13.9798 -14.75637,-34.9493 0,-20.9696 14.75637,-34.9493 l 29.1244,-29.1244 q 14.75637,-14.7564 34.94929,-14.7564 20.58125,0 35.33761,14.7564 l 252.79985,252.7998 q 14.368,13.5914 14.368,34.9493 z"/><path style="fill:var(--icon-colour__blue)" d="M 155.66211 541.10742 L 377.63672 873.35547 L 123.20117 1253.8164 L 227.26758 1253.8164 L 429.19336 950.6875 L 629.6875 1253.8164 L 733.27734 1253.8164 L 488.86523 883.37891 L 718 541.10742 L 614.41211 541.10742 L 436.35352 806.04492 L 259.25 541.10742 L 155.66211 541.10742 z M 1073.6406 541.10742 L 1325.6895 914.4082 L 1325.6895 1253.8164 L 1422.5957 1253.8164 L 1422.5957 914.4082 L 1674.6465 541.10742 L 1571.0566 541.10742 L 1374.8594 834.21094 L 1177.2285 541.10742 L 1073.6406 541.10742 z "/></svg></span>
  </span>
            </span>
            <span class="pipeline-element-text">ReferenceDataFilter</span>
          </span>
        </span>
      </a>

      
      <span class="USED FOR SPLITTING" ></span>

    
  







</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet 
    xpath-default-namespace=&quot;records:2&quot; 
    xmlns=&quot;reference-data:2&quot; 
    xmlns:evt=&quot;event-logging:3&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;
    version=&quot;2.0&quot;&gt;

    &lt;xsl:template match=&quot;records&quot;&gt;
        &lt;referenceData 
           xsi:schemaLocation=&quot;reference-data:2 file://reference-data-v2.0.1.xsd event-logging:3 file://event-logging-v3.0.0.xsd&quot;
           version=&quot;2.0.1&quot;&gt;
            &lt;xsl:apply-templates/&gt;
        &lt;/referenceData&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match=&quot;record&quot;&gt;
        &lt;reference&gt;
            &lt;map&gt;USER_ID_TO_STAFF_NO_MAP&lt;/map&gt;
            &lt;key&gt;&lt;xsl:value-of select=&quot;data[@name='userId']/@value&quot;/&gt;&lt;/key&gt;
            &lt;value&gt;&lt;xsl:value-of select=&quot;data[@name='staffNo']/@value&quot;/&gt;&lt;/value&gt;
        &lt;/reference&gt;
    &lt;/xsl:template&gt;
    
&lt;/xsl:stylesheet&gt;
</code></pre>
<h2 id="identity-transformation">Identity Transformation</h2>
<p>If you want an XSLT to decorate an Events XML document with some additional data or to change it slightly without changing its namespace then a good starting point is the identity transformation.</p>
<pre><code class="language-xml">&lt;xsl:stylesheet 
    version=&quot;1.0&quot; 
    xpath-default-namespace=&quot;event-logging:3&quot; 
    xmlns=&quot;event-logging:3&quot; 
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;

  &lt;!-- Match Root Object --&gt;
  &lt;xsl:template match=&quot;Events&quot;&gt;
    &lt;Events 
        xmlns=&quot;event-logging:3&quot; 
        xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
        xsi:schemaLocation=&quot;event-logging:3 file://event-logging-v3.4.2.xsd&quot; 
        Version=&quot;3.4.2&quot;&gt;

      &lt;xsl:apply-templates /&gt;
    &lt;/Events&gt;
  &lt;/xsl:template&gt;
  

  &lt;!-- Whenever you match any node or any attribute --&gt;
  &lt;xsl:template match=&quot;node( )|@*&quot;&gt;

    &lt;!-- Copy the current node --&gt;
    &lt;xsl:copy&gt;

      &lt;!-- Including any attributes it has and any child nodes --&gt;
      &lt;xsl:apply-templates select=&quot;@*|node( )&quot; /&gt;
    &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>This XSLT will copy every node and attribute as they are, returning the input document completely un-changed.
You can then add additional templates to match on specific elements and modify them, for example decorating a user&rsquo;s <code>UserDetails</code> elements with value obtained from a reference data lookup on a user ID.</p>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>



    <p>You can insert this identity skeleton into an XSLT editor using this editor <a href="../../../../../docs/user-guide/content/editing-text/snippet-reference/#events-identity-skeleton">snippet</a>.</p>


</div>


<h2 id="xslmessage"><code>&lt;xsl:message&gt;</code></h2>
<p>Stroom supports the standard <code>&lt;xsl:message&gt;</code> element from the 







  
  

<span class="external-link">
  <a href="http://www.w3.org/1999/XSL/Transform" target="_blank" class="" style="" title="http://www.w3.org/1999/XSL/Transform (external link to http://www.w3.org/1999/XSL/Transform)">
    <span>http://www.w3.org/1999/XSL/Transform</span>
    <i class="external-link-icon fas fa-external-link-alt fa-sm text-secondary"></i>
  </a>
</span>
.
This element behaves in a similar way to the <a href="../../../../../docs/user-guide/pipelines/xslt/xslt-functions/#log"><code>stroom:log()</code></a> XSLT function.
The element text is logged to the Error stream with a default severity of <code>ERROR</code>.</p>
<p>A child element can optionally be used to set the severity level (one of <code>FATAL|ERROR|WARN|INFO</code>).
The namespace of this element does not matter.
You can also set the attribute <code>terminate=&quot;yes&quot;</code> to log the message at severity <code>FATAL</code> and halt processing of that stream part.
If the stream is multi-part then processing will continue with the next part.</p>

<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note</h4>


    Setting <code>terminate=&quot;yes&quot;</code> will trump any severity defined by a child element.
It will always be logged at <code>FATAL</code>.

</div>


<p>The following are some examples of using <code>&lt;xsl:message&gt;</code>.</p>
<pre><code class="language-xml">&lt;!-- Log a message using default severity of ERROR --&gt;
&lt;xsl:message&gt;Invalid length&lt;/xsl:message&gt;

&lt;!-- terminate=&quot;yes&quot; means log the message as a FATAL ERROR and halt processing of the stream part --&gt;
&lt;xsl:message terminate=&quot;yes&quot;&gt;Invalid length&lt;/xsl:message&gt;

&lt;!-- Log a message with a child element name specifying the severity. --&gt;
&lt;xsl:message&gt;
  &lt;warn&gt;Invalid length&lt;/warn&gt;
&lt;/xsl:message&gt;

&lt;!-- Log a message with a child element name specifying the severity. --&gt;
&lt;xsl:message&gt;
  &lt;info&gt;Invalid length&lt;/info&gt;
&lt;/xsl:message&gt;

&lt;!-- Log a message, specifying the severity and using a dynamic value. --&gt;
&lt;xsl:message&gt;
  &lt;info&gt;
    &lt;xsl:value-of select=&quot;concat('User ID ', $userId, ' is invalid')&quot; /&gt;
  &lt;/info&gt;
&lt;/xsl:message&gt;
</code></pre>

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '2.'; page-break-before: always">
    
  <h1 id="pg-00fcef074a5fb84079d17e4049c5a7f8">2 - XSLT Functions</h1>
    <div class="lead">Custom XSLT functions available in Stroom.</div>
	<!-- 
TODO
This file needs splitting up with one file per function.
These files can be generated from annotations in the Java code (see https://github.com/gchq/stroom/issues/2932)
-->
<p>By including the following namespace:</p>
<pre><code class="language-xml">xmlns:stroom=&quot;stroom&quot;
</code></pre>
<p>E.g.</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;xsl:stylesheet
    xmlns=&quot;event-logging:3&quot;
    xmlns:stroom=&quot;stroom&quot;
    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    version=&quot;2.0&quot;&gt;
</code></pre>
<p>The following functions are available to aid your translation:</p>
<ul>
<li><a href="#bitmap-lookup"><code>bitmap-lookup(String map, String key)</code></a> - Bitmap based look up against reference data map using the period start time</li>
<li><a href="#bitmap-lookup"><code>bitmap-lookup(String map, String key, String time)</code></a> - Bitmap based look up against reference data map using a specified time, e.g. the event time</li>
<li><a href="#bitmap-lookup"><code>bitmap-lookup(String map, String key, String time, Boolean ignoreWarnings)</code></a> - Bitmap based look up against reference data map using a specified time, e.g. the event time, and ignore any warnings generated by a failed lookup</li>
<li><a href="#bitmap-lookup"><code>bitmap-lookup(String map, String key, String time, Boolean ignoreWarnings, Boolean trace)</code></a> - Bitmap based look up against reference data map using a specified time, e.g. the event time, and ignore any warnings generated by a failed lookup and get trace information for the path taken to resolve the lookup.</li>
<li><a href="#cidr-to-numeric-ip-range"><code>cidr-to-numeric-ip-range()</code></a> - Converts a CIDR IP address range to an array of numeric IP addresses representing the start and end addresses of the range.</li>
<li><code>classification()</code> - The classification of the feed for the data being processed</li>
<li><code>col-from()</code> - The column in the input that the current record begins on (can be 0).</li>
<li><code>col-to()</code> - The column in the input that the current record ends at.</li>
<li><code>current-time()</code> - The current system time</li>
<li><code>current-user()</code> - The current user logged into Stroom (only relevant for interactive use, e.g. search)</li>
<li><code>decode-url(String encodedUrl)</code> - Decode the provided url.</li>
<li><a href="#dictionary"><code>dictionary(String name)</code></a> - Loads the contents of the named dictionary for use within the translation</li>
<li><code>encode-url(String url)</code> - Encode the provided url.</li>
<li><code>feed-attribute(String attributeKey)</code> - <strong>NOTE:</strong> This function is deprecated, use <code>meta(String key)</code> instead.
The value for the supplied feed <code>attributeKey</code>.</li>
<li><code>feed-name()</code> - Name of the feed for the data being processed</li>
<li><code>fetch-json(String url)</code> - Simplistic version of <code>http-call</code> that sends a request to the passed <code>url</code> and converts the JSON response body to XML using <code>json-to-xml</code>.
Currently does not support SSL configuration like <code>http-call</code> does.</li>
<li><a href="#format-date"><code>format-date(String date, String pattern)</code></a> - Format a date that uses the specified pattern using the default time zone</li>
<li><a href="#format-date"><code>format-date(String date, String pattern, String timeZone)</code></a> - Format a date that uses the specified pattern with the specified time zone</li>
<li><a href="#format-date"><code>format-date(String date, String patternIn, String timeZoneIn, String patternOut, String timeZoneOut)</code></a> - Parse a date with the specified input pattern and time zone and format the output with the specified output pattern and time zone</li>
<li><a href="#format-date"><code>format-date(String milliseconds)</code></a> - Format a date that is specified as a number of milliseconds since a standard base time known as &ldquo;the epoch&rdquo;, namely January 1, 1970, 00:00:00 GMT</li>
<li><a href="#put-and-get"><code>get(String key)</code></a> - Returns the value associated with a <code>key</code> that has been stored in a map using the <a href="#put-and-get"><code>put()</code></a> function.
The map is in the scope of the current pipeline process so values do not live after the stream has been processed.</li>
<li><code>hash(String value)</code> - Hash a string value using the default <code>SHA-256</code> algorithm and no salt</li>
<li><code>hash(String value, String algorithm, String salt)</code> - Hash a string value using the specified hashing algorithm and supplied salt value.
Supported hashing algorithms include <code>SHA-256</code>, <code>SHA-512</code>, <code>MD5</code>.</li>
<li><code>hex-to-dec(String hex)</code> - Convert hex to dec representation.</li>
<li><code>hex-to-oct(String hex)</code> - Convert hex to oct representation.</li>
<li><a href="#hex-to-string"><code>hex-to-string(String hex, String textEncoding)</code></a> - Convert hex to string using the specified text encoding.</li>
<li><code>host-address(String hostname)</code> - Convert a hostname into an IP address.</li>
<li><code>host-name(String ipAddress)</code> - Convert an IP address into a hostname.</li>
<li><a href="#http-call"><code>http-call(String url, String headers, String mediaType, String data, String clientConfig)</code></a> - Makes an HTTP(S) request to a remote server.</li>
<li><code>ip-in-cidr(String ipAddress, String cidr)</code> - Return whether an IPv4 address is within the specified CIDR (e.g. <code>192.168.1.0/24</code>).</li>
<li><code>json-to-xml(String json)</code> - Returns an XML representation of the supplied JSON value for use in XPath expressions</li>
<li><code>line-from()</code> - The line in the input that the current record begins on (1 based).</li>
<li><code>line-to()</code> - The line in the input that the current record ends at.</li>
<li><a href="#link"><code>link(String url)</code></a> - Creates a stroom dashboard table link.</li>
<li><a href="#link"><code>link(String title, String url)</code></a> - Creates a stroom dashboard table link.</li>
<li><a href="#link"><code>link(String title, String url, String type)</code></a> - Creates a stroom dashboard table link.</li>
<li><a href="#log"><code>log(String severity, String message)</code></a> - Logs a message to the processing log with the specified severity</li>
<li><a href="#lookup"><code>lookup(String map, String key)</code></a> - Look up a reference data map using the period start time</li>
<li><a href="#lookup"><code>lookup(String map, String key, String time)</code></a> - Look up a reference data map using a specified time, e.g. the event time</li>
<li><a href="#lookup"><code>lookup(String map, String key, String time, Boolean ignoreWarnings)</code></a> - Look up a reference data map using a specified time, e.g. the event time, and ignore any warnings generated by a failed lookup</li>
<li><a href="#lookup"><code>lookup(String map, String key, String time, Boolean ignoreWarnings, Boolean trace)</code></a> - Look up a reference data map using a specified time, e.g. the event time, ignore any warnings generated by a failed lookup and get trace information for the path taken to resolve the lookup.</li>
<li><code>meta(String key)</code> - Lookup a meta data value for the current stream using the specified key.
The key can be <code>Feed</code>, <code>StreamType</code>, <code>CreatedTime</code>, <code>EffectiveTime</code>, <code>Pipeline</code> or any other attribute supplied when the stream was sent to Stroom, e.g. meta(&lsquo;System&rsquo;).</li>
<li><a href="#meta-keys"><code>meta-keys()</code></a> - Returns an array of meta keys for the current stream. Each key can then be used to retrieve its corresponding meta value, by calling <code>meta($key)</code>.</li>
<li><code>numeric-ip(String ipAddress)</code> - Convert an IP address to a numeric representation for range comparison</li>
<li><code>part-no()</code> - The current part within a multi part aggregated input stream (AKA the substream number) (1 based)</li>
<li><a href="#parse-uri"><code>parse-uri(String URI)</code></a> - Returns an XML structure of the URI providing <code>authority</code>, <code>fragment</code>, <code>host</code>, <code>path</code>, <code>port</code>, <code>query</code>, <code>scheme</code>, <code>schemeSpecificPart</code>, and <code>userInfo</code> components if present.</li>
<li><code>pipeline-name()</code> - Get the name of the pipeline currently processing the stream.</li>
<li><a href="#pointIsInsideXYPolygon"><code>pointIsInsideXYPolygon(Number xPos, Number yPos, Number[] xPolyData, Number[] yPolyData)</code></a> - Get the name of the pipeline currently processing the stream.</li>
<li><code>random()</code> - Get a system generated random number between 0 and 1.</li>
<li><code>record-no()</code> - The current record number within the current part (substream) (1 based).</li>
<li><code>search-id()</code> - Get the id of the batch search when a pipeline is processing as part of a batch search</li>
<li><code>source()</code> - Returns an XML structure with the <code>stroom-meta</code> namespace detailing the current source location.</li>
<li><code>source-id()</code> - Get the id of the current input stream that is being processed</li>
<li><code>stream-id()</code> - An alias for <code>source-id</code> included for backward compatibility.</li>
<li><code>pipeline-name()</code> - Name of the current processing pipeline using the XSLT</li>
<li><a href="#put-and-get"><code>put(String key, String value)</code></a> - Store a value for use later on in the translation</li>
</ul>
<h2 id="bitmap-lookup">bitmap-lookup()</h2>
<p>The bitmap-lookup() function looks up a bitmap key from reference or context data a value (which can be an XML node set) for each set bit position and adds it to the resultant XML.</p>
<pre><code class="language-text">bitmap-lookup(String map, String key)
bitmap-lookup(String map, String key, String time)
bitmap-lookup(String map, String key, String time, Boolean ignoreWarnings)
bitmap-lookup(String map, String key, String time, Boolean ignoreWarnings, Boolean trace)
</code></pre>
<ul>
<li><code>map</code> - The name of the reference data map to perform the lookup against.</li>
<li><code>key</code> - The bitmap value to lookup.
This can either be represented as a decimal integer (e.g. <code>14</code>) or as hexadecimal by prefixing with <code>0x</code> (e.g <code>0xE</code>).</li>
<li><code>time</code> - Determines which set of reference data was effective at the requested time.
If no reference data exists with an effective time before the requested time then the lookup will fail.
Time is in the format <code>yyyy-MM-dd'T'HH:mm:ss.SSSXX</code>, e.g. <code>2010-01-01T00:00:00.000Z</code>.</li>
<li><code>ignoreWarnings</code> - If true, any lookup failures will be ignored, else they will be reported as warnings.</li>
<li><code>trace</code> - If true, additional trace information is output as INFO messages.</li>
</ul>
<p>If the look up fails no result will be returned.</p>
<p>The key is a bitmap expressed as either a decimal integer or a hexidecimal value, e.g. <code>14</code>/<code>0xE</code> is <code>1110</code> as a binary bitmap.
For each bit position that is set, (i.e. has a binary value of <code>1</code>) a lookup will be performed using that bit position as the key.
In this example, positions <code>1</code>, <code>2</code> &amp; <code>3</code> are set so a lookup would be performed for these bit positions.
The result of each lookup for the bitmap are concatenated together in bit position order, separated by a space.</p>
<p>If <code>ignoreWarnings</code> is true then any lookup failures will be ignored and it will return the value(s) for the bit positions it was able to lookup.</p>
<p>This function can be useful when you have a set of values that can be represented as a bitmap and you need them to be converted back to individual values.
For example if you have a set of additive account permissions (e.g Admin, ManageUsers, PerformExport, etc.), each of which is associated with a bit position, then a user&rsquo;s permissions could be defined as a single decimal/hex bitmap value.
Thus a bitmap lookup with this value would return all the permissions held by the user.</p>
<p>For example the reference data store may contain:</p>
<table>
<thead>
<tr>
<th>Key (Bit position)</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Administrator</td>
</tr>
<tr>
<td>1</td>
<td>Manage_Users</td>
</tr>
<tr>
<td>2</td>
<td>Perform_Export</td>
</tr>
<tr>
<td>3</td>
<td>View_Data</td>
</tr>
<tr>
<td>4</td>
<td>Manage_Jobs</td>
</tr>
<tr>
<td>5</td>
<td>Delete_Data</td>
</tr>
<tr>
<td>6</td>
<td>Manage_Volumes</td>
</tr>
</tbody>
</table>
<p>The following are example lookups using the above reference data:</p>
<table>
<thead>
<tr>
<th>Lookup Key (decimal)</th>
<th>Lookup Key (Hex)</th>
<th>Bitmap</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td><code>0x0</code></td>
<td><code>0000000</code></td>
<td>-</td>
</tr>
<tr>
<td><code>1</code></td>
<td><code>0x1</code></td>
<td><code>0000001</code></td>
<td><code>Administrator</code></td>
</tr>
<tr>
<td><code>74</code></td>
<td><code>0x4A</code></td>
<td><code>1001010</code></td>
<td><code>Manage_Users View_Data Manage_Volumes</code></td>
</tr>
<tr>
<td><code>2</code></td>
<td><code>0x2</code></td>
<td><code>0000010</code></td>
<td><code>Manage_Users</code></td>
</tr>
<tr>
<td><code>96</code></td>
<td><code>0x60</code></td>
<td><code>1100000</code></td>
<td><code>Delete_Data Manage_Volumes</code></td>
</tr>
</tbody>
</table>
<h2 id="cidr-to-numeric-ip-range">cidr-to-numeric-ip-range()</h2>
<p>Converts a CIDR IP address range to an array of numeric IP addresses representing the start and end (broadcast) of the range.</p>
<p>When storing the result in a variable, ensure you indicate the type as a string array (<code>xs:string*</code>), as shown in the below example.</p>
<h3 id="example-xslt">Example XSLT</h3>
<pre><code class="language-xml">&lt;xsl:variable name=&quot;range&quot; select=&quot;stroom:cidr-to-numeric-ip-range('192.168.1.0/24')&quot; as=&quot;xs:string*&quot; /&gt;
&lt;Range&gt;
  &lt;Start&gt;&lt;xsl:value-of select=&quot;$range[1]&quot; /&gt;&lt;/Start&gt;
  &lt;End&gt;&lt;xsl:value-of select=&quot;$range[2]&quot; /&gt;&lt;/End&gt;
&lt;/Range&gt;
</code></pre>
<h3 id="example-output">Example output</h3>
<pre><code class="language-xml">&lt;Range&gt;
  &lt;Start&gt;3232235776&lt;/Start&gt;
  &lt;End&gt;3232236031&lt;/End&gt;
&lt;/Range&gt;
</code></pre>
<h2 id="dictionary">dictionary()</h2>
<p>The dictionary() function gets the contents of the specified dictionary for use during translation.
The main use for this function is to allow users to abstract the management of a set of keywords from the XSLT so that it is easier for some users to make quick alterations to a dictionary that is used by some XSLT, without the need for the user to understand the complexities of XSLT.</p>
<h2 id="format-date">format-date()</h2>
<p>The format-date() function takes a Pattern and optional TimeZone arguments and replaces the parsed
contents with an XML standard Date Format. The pattern must be a Java based SimpleDateFormat.
If the optional TimeZone argument is present the pattern must not include the time zone pattern tokens (z and Z).
A special time zone value of &ldquo;GMT/BST&rdquo; can be used to guess the time based on the date (BST during British Summer Time).</p>
<p>E.g. Convert a GMT date time &ldquo;2009/12/01 12:34:11&rdquo;</p>
<pre><code class="language-xml">&lt;xsl:value-of select=&quot;stroom:format-date('2009/08/01 12:34:11', 'yyyy/MM/dd HH:mm:ss')&quot;/&gt;
</code></pre>
<p>E.g. Convert a GMT or BST date time &ldquo;2009/08/01 12:34:11&rdquo;</p>
<pre><code class="language-xml">&lt;xsl:value-of select=&quot;stroom:format-date('2009/08/01 12:34:11', 'yyyy/MM/dd HH:mm:ss', 'GMT/BST')&quot;/&gt;
</code></pre>
<p>E.g. Convert a GMT+1:00 date time &ldquo;2009/08/01 12:34:11&rdquo;</p>
<pre><code class="language-xml">&lt;xsl:value-of select=&quot;stroom:format-date('2009/08/01 12:34:11', 'yyyy/MM/dd HH:mm:ss', 'GMT+1:00')&quot;/&gt;
</code></pre>
<p>E.g. Convert a date time specified as milliseconds since the epoch &ldquo;1269270011640&rdquo;</p>
<pre><code class="language-xml">&lt;xsl:value-of select=&quot;stroom:format-date('1269270011640')&quot;/&gt;
</code></pre>
<p>Time Zone Must be as per the rules defined in SimpleDateFormat under General Time Zone syntax.</p>
<h2 id="hex-to-string">hex-to-string()</h2>
<p>For a hexadecimal input string, decode it using the specified character set to its original form.</p>
<p>Valid character set names are listed at: <a href="https://www.iana.org/assignments/character-sets/character-sets.xhtml">https://www.iana.org/assignments/character-sets/character-sets.xhtml</a>.
Common examples are: <code>ASCII</code>, <code>UTF-8</code> and <code>UTF-16</code>.</p>
<h3 id="example">Example</h3>
<h4 id="input">Input</h4>
<pre><code class="language-xml">&lt;string&gt;&lt;xsl:value-of select=&quot;hex-to-string('74 65 73 74 69 6e 67 20 31 32 33', 'UTF-8')&quot; /&gt;&lt;/string&gt;
</code></pre>
<h4 id="output">Output</h4>
<pre><code class="language-xml">&lt;string&gt;testing 123&lt;/string&gt;
</code></pre>
<h2 id="http-call">http-call()</h2>
<p>Executes an HTTP(S) request to a remote server and returns the response.</p>
<pre><code class="language-text">http-call(String url, [String headers], [String mediaType], [String data], [String clientConfig])
</code></pre>
<p>The arguments are as follows:</p>
<ul>
<li><code>url</code> - The URL to send the request to.</li>
<li><code>headers</code> - A newline (<code>&amp;#10;</code>) delimited list of HTTP headers to send.
Each header is of the form <code>key:value</code>.</li>
<li><code>mediaType</code> - The media (or MIME) type of the request <code>data</code>, e.g. <code>application/json</code>.
If not set <code>application/json; charset=utf-8</code> will be used.</li>
<li><code>data</code> - The data to send.
The data type should be consistent with <code>mediaType</code>.
Supplying the <code>data</code> argument means a POST request method will be used rather than the default GET.</li>
<li><code>clientConfig</code> - A JSON object containing the configuration for the HTTP client to use, including any SSL configuration.</li>
</ul>
<p>The function returns the response as XML with namespace <code>stroom-http</code>.
The XML includes the body of the response in addition to the status code, success status, message and any headers.</p>
<h3 id="clientconfig"><code>clientConfig</code></h3>
<p>The client can be configured using a JSON object containing various optional configuration items.
The following is an example of the client configuration object with all keys populated.</p>
<pre><code class="language-json">{
  &quot;callTimeout&quot;: &quot;PT30S&quot;,
  &quot;connectionTimeout&quot;: &quot;PT30S&quot;,
  &quot;followRedirects&quot;: false,
  &quot;followSslRedirects&quot;: false,
  &quot;httpProtocols&quot;: [
    &quot;http/2&quot;,
    &quot;http/1.1&quot;
  ],
  &quot;readTimeout&quot;: &quot;PT30S&quot;,
  &quot;retryOnConnectionFailure&quot;: true,
  &quot;sslConfig&quot;: {
    &quot;keyStorePassword&quot;: &quot;password&quot;,
    &quot;keyStorePath&quot;: &quot;/some/path/client.jks&quot;,
    &quot;keyStoreType&quot;: &quot;JKS&quot;,
    &quot;trustStorePassword&quot;: &quot;password&quot;,
    &quot;trustStorePath&quot;: &quot;/some/path/ca.jks&quot;,
    &quot;trustStoreType&quot;: &quot;JKS&quot;,
    &quot;sslProtocol&quot;: &quot;TLSv1.2&quot;,
    &quot;hostnameVerificationEnabled&quot;: false
  },
  &quot;writeTimeout&quot;: &quot;PT30S&quot;
}
</code></pre>
<p>If you are using two-way SSL then you may need to set the protocol to <code>HTTP/1.1</code>.</p>
<pre><code class="language-json">  &quot;httpProtocols&quot;: [
    &quot;http/1.1&quot;
  ],
</code></pre>
<h3 id="example-output-1">Example output</h3>
<p>The following is an example of the XML returned from the <code>http-call</code> function:</p>
<pre><code class="language-xml">&lt;response xmlns=&quot;stroom-http&quot;&gt;
  &lt;successful&gt;true&lt;/successful&gt;
  &lt;code&gt;200&lt;/code&gt;
  &lt;message&gt;OK&lt;/message&gt;
  &lt;headers&gt;
    &lt;header&gt;
      &lt;key&gt;cache-control&lt;/key&gt;
      &lt;value&gt;public, max-age=600&lt;/value&gt;
    &lt;/header&gt;
    &lt;header&gt;
      &lt;key&gt;connection&lt;/key&gt;
      &lt;value&gt;keep-alive&lt;/value&gt;
    &lt;/header&gt;
    &lt;header&gt;
      &lt;key&gt;content-length&lt;/key&gt;
      &lt;value&gt;108&lt;/value&gt;
    &lt;/header&gt;
    &lt;header&gt;
      &lt;key&gt;content-type&lt;/key&gt;
      &lt;value&gt;application/json;charset=iso-8859-1&lt;/value&gt;
    &lt;/header&gt;
    &lt;header&gt;
      &lt;key&gt;date&lt;/key&gt;
      &lt;value&gt;Wed, 29 Jun 2022 13:03:38 GMT&lt;/value&gt;
    &lt;/header&gt;
    &lt;header&gt;
      &lt;key&gt;expires&lt;/key&gt;
      &lt;value&gt;Wed, 29 Jun 2022 13:13:38 GMT&lt;/value&gt;
    &lt;/header&gt;
    &lt;header&gt;
      &lt;key&gt;server&lt;/key&gt;
      &lt;value&gt;nginx/1.21.6&lt;/value&gt;
    &lt;/header&gt;
    &lt;header&gt;
      &lt;key&gt;vary&lt;/key&gt;
      &lt;value&gt;Accept-Encoding&lt;/value&gt;
    &lt;/header&gt;
    &lt;header&gt;
      &lt;key&gt;x-content-type-options&lt;/key&gt;
      &lt;value&gt;nosniff&lt;/value&gt;
    &lt;/header&gt;
    &lt;header&gt;
      &lt;key&gt;x-frame-options&lt;/key&gt;
      &lt;value&gt;sameorigin&lt;/value&gt;
    &lt;/header&gt;
    &lt;header&gt;
      &lt;key&gt;x-xss-protection&lt;/key&gt;
      &lt;value&gt;1; mode=block&lt;/value&gt;
    &lt;/header&gt;
  &lt;/headers&gt;
  &lt;body&gt;{&quot;buildDate&quot;:&quot;2022-06-29T09:22:41.541886118Z&quot;,&quot;buildVersion&quot;:&quot;SNAPSHOT&quot;,&quot;upDate&quot;:&quot;2022-06-29T11:06:26.869Z&quot;}&lt;/body&gt;
&lt;/response&gt;
</code></pre>
<h3 id="example-usage">Example usage</h3>
<p>This is an example of how to use the function call in your XSLT.
It is recommended to place the <code>clientConfig</code> JSON in a <span class="glossary-link">
  <a href="../../../../../docs/glossary/#dictionary" title="Glossary entry for Dictionary">
    <span>Dictionary</span>
    <i class="glossary-link-icon fas fa-book fa-sm text-primary"></i>
  </a>
</span> to make it easier to edit and to avoid having to escape all the quotes.</p>
<pre><code class="language-xml">  ...
  &lt;xsl:template match=&quot;record&quot;&gt;
    ...
    &lt;!-- Read the client config from a Dictionary into a variable --&gt;
    &lt;xsl:variable name=&quot;clientConfig&quot; select=&quot;stroom:dictionary('HTTP Client Config')&quot; /&gt;
    &lt;!-- Make the HTTP call and store the response in a variable --&gt;
    &lt;xsl:variable name=&quot;response&quot; select=&quot;stroom:http-call('https://reqbin.com/echo', null, null, null, $clientConfig)&quot; /&gt;
    &lt;!-- Apply 'response' templates to the response --&gt;
    &lt;xsl:apply-templates mode=&quot;response&quot; select=&quot;$response&quot; /&gt;
    ...
  &lt;/xsl:template&gt;
  
  &lt;xsl:template mode=&quot;response&quot; match=&quot;http:response&quot;&gt;
    &lt;!-- Extract just the body of the response --&gt;
    &lt;val&gt;&lt;xsl:value-of select=&quot;./http:body/text()&quot; /&gt;&lt;/val&gt;
  &lt;/xsl:template&gt;
  ...
</code></pre>
<h2 id="link">link()</h2>
<p>Create a string that represents a hyperlink for display in a dashboard table.</p>
<pre><code>link(url)
link(title, url)
link(title, url, type)
</code></pre>
<p>Example</p>
<pre><code>link('https://www.somehost.com/somepath')
&gt; [https://www.somehost.com/somepath](https://www.somehost.com/somepath)
link('Click Here','https://www.somehost.com/somepath')
&gt; [Click Here](https://www.somehost.com/somepath)
link('Click Here','https://www.somehost.com/somepath', 'dialog')
&gt; [Click Here](https://www.somehost.com/somepath){dialog}
link('Click Here','https://www.somehost.com/somepath', 'dialog|Dialog Title')
&gt; [Click Here](https://www.somehost.com/somepath){dialog|Dialog Title}
</code></pre>
<p>Type can be one of:</p>
<ul>
<li><code>dialog</code> : Display the content of the link URL within a stroom popup dialog.</li>
<li><code>tab</code> : Display the content of the link URL within a stroom tab.</li>
<li><code>browser</code> : Display the content of the link URL within a new browser tab.</li>
<li><code>dashboard</code> : Used to launch a stroom dashboard internally with parameters in the URL.</li>
</ul>
<p>If you wish to override the default title or URL of the target link in either a tab or dialog you can. Both <code>dialog</code> and <code>tab</code> types allow titles to be specified after a <code>|</code>, e.g. <code>dialog|My Title</code>.</p>
<h2 id="log">log()</h2>
<p>The log() function writes a message to the processing log with the specified severity.
Severities of INFO, WARN, ERROR and FATAL can be used.
Severities of ERROR and FATAL will result in records being omitted from the output if a RecordOutputFilter is used in the pipeline.
The counts for RecWarn, RecError will be affected by warnings or errors generated in this way therefore this function is useful for adding business rules to XML output.</p>
<p>E.g. Warn if a SID is not the correct length.</p>
<pre><code class="language-xml">&lt;xsl:if test=&quot;string-length($sid) != 7&quot;&gt;
  &lt;xsl:value-of select=&quot;stroom:log('WARN', concat($sid, ' is not the correct length'))&quot;/&gt;
&lt;/xsl:if&gt;
</code></pre>
<p>The same functionality can also be achieved using the standard <code>xsl:message</code> element, see <a href="../../../../../docs/user-guide/pipelines/xslt/xslt-basics/#xslmessage"><code>&lt;xsl:message&gt;</code></a></p>
<h2 id="lookup">lookup()</h2>
<p>The lookup() function looks up from reference or context data a value (which can be an XML node set) and adds it to the resultant XML.</p>
<pre><code class="language-text">lookup(String map, String key)
lookup(String map, String key, String time)
lookup(String map, String key, String time, Boolean ignoreWarnings)
lookup(String map, String key, String time, Boolean ignoreWarnings, Boolean trace)
</code></pre>
<ul>
<li><code>map</code> - The name of the reference data map to perform the lookup against.</li>
<li><code>key</code> - The key to lookup. The key can be a simple string, an integer value in a numeric range or a nested lookup key.</li>
<li><code>time</code> - Determines which set of reference data was effective at the requested time.
If no reference data exists with an effective time before the requested time then the lookup will fail.
Time is in the format <code>yyyy-MM-dd'T'HH:mm:ss.SSSXX</code>, e.g. <code>2010-01-01T00:00:00.000Z</code>.</li>
<li><code>ignoreWarnings</code> - If true, any lookup failures will be ignored, else they will be reported as warnings.</li>
<li><code>trace</code> - If true, additional trace information is output as INFO messages.</li>
</ul>
<p>If the look up fails no result will be returned.
By testing the result a default value may be output if no result is returned.</p>
<p>E.g. Look up a SID given a PF</p>
<pre><code class="language-xml">&lt;xsl:variable name=&quot;pf&quot; select=&quot;PFNumber&quot;/&gt;
&lt;xsl:if test=&quot;$pf&quot;&gt;
   &lt;xsl:variable name=&quot;sid&quot; select=&quot;stroom:lookup('PF_TO_SID', $pf, $formattedDateTime)&quot;/&gt;

   &lt;xsl:choose&gt;
      &lt;xsl:when test=&quot;$sid&quot;&gt;
         &lt;User&gt;
             &lt;Id&gt;&lt;xsl:value-of select=&quot;$sid&quot;/&gt;&lt;/Id&gt;
         &lt;/User&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
         &lt;data name=&quot;PFNumber&quot;&gt;
            &lt;xsl:attribute name=&quot;Value&quot;&gt;&lt;xsl:value-of select=&quot;$pf&quot;/&gt;&lt;/xsl:attribute&gt;
         &lt;/data&gt;
      &lt;/xsl:otherwise&gt;
   &lt;/xsl:choose&gt;
&lt;/xsl:if&gt;
</code></pre>
<h3 id="range-lookups">Range lookups</h3>
<p>Reference data entries can either be stored with single string key or a key range that defines a numeric range, e.g 1-100.
When a lookup is preformed the passed key is looked up as if it were a normal string key.
If that lookup fails Stroom will try to convert the key to an integer (long) value.
If it can be converted to an integer than a second lookup will be performed against entries with key ranges to see if there is a key range that includes the requested key.</p>
<p>Range lookups can be used for looking up an IP address where the reference data values are associated with ranges of IP addresses.
In this use case, the IP address must first be converted into a numeric value using <code>numeric-ip()</code>, e.g:</p>
<pre><code class="language-xslt">stroom:lookup('IP_TO_LOCATION', numeric-ip($ipAddress))
</code></pre>
<p>Similarly the reference data must be stored with key ranges whose bounds were created using this function.</p>
<h3 id="nested-maps">Nested Maps</h3>
<p>The lookup function allows you to perform chained lookups using nested maps.
For example you may have a reference data map called <em>USER_ID_TO_LOCATION</em> that maps user IDs to some location information for that user and a map called <em>USER_ID_TO_MANAGER</em> that maps user IDs to the user ID of their manager.
If you wanted to decorate a user&rsquo;s event with the location of their manager you could use a nested map to achieve the lookup chain.
To perform the lookup set the <code>map</code> argument to the list of maps in the lookup chain, separated by a <code>/</code>, e.g. <code>USER_ID_TO_MANAGER/USER_ID_TO_LOCATION</code>.</p>
<p>This will perform a lookup against the first map in the list using the requested key.
If a value is found the value will be used as the key in a lookup against the next map.
The value from each map lookup is used as the key in the next map all the way down the chain.
The value from the last lookup is then returned as the result of the <code>lookup()</code> call.
If no value is found at any point in the chain then that results in no value being returned from the function.</p>
<p>In order to use nested map lookups each intermediate map must contain simple string values.
The last map in the chain can either contain string values or XML fragment values.</p>
<h2 id="put-and-get">put() and get()</h2>
<p>You can put values into a map using the <code>put()</code> function.
These values can then be retrieved later using the <code>get()</code> function.
Values are stored against a key name so that multiple values can be stored.
These functions can be used for many purposes but are most commonly used to count a number of records that meet certain criteria.</p>
<p>The map is in the scope of the current pipeline process so values do not live after the stream has been processed.
Also, the map will only contain entries that were <code>put()</code> within the current pipeline process.</p>
<p>An example of how to count records is shown below:</p>
<pre><code class="language-xml">&lt;!-- Get the current record count --&gt;
&lt;xsl:variable name=&quot;currentCount&quot; select=&quot;number(s:get('count'))&quot; /&gt;

&lt;!-- Increment the record count --&gt;
&lt;xsl:variable name=&quot;count&quot;&gt;
  &lt;xsl:choose&gt;
    &lt;xsl:when test=&quot;$currentCount&quot;&gt;
      &lt;xsl:value-of select=&quot;$currentCount + 1&quot; /&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;xsl:value-of select=&quot;1&quot; /&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/xsl:variable&gt;

&lt;!-- Store the count for future retrieval --&gt;
&lt;xsl:value-of select=&quot;stroom:put('count', $count)&quot; /&gt;

&lt;!-- Output the new count --&gt;
&lt;data name=&quot;Count&quot;&gt;
  &lt;xsl:attribute name=&quot;Value&quot; select=&quot;$count&quot; /&gt;
&lt;/data&gt;
</code></pre>
<h2 id="meta-keys">meta-keys()</h2>
<p>When calling this function and assigning the result to a variable, you must specify the variable data type of <code>xs:string*</code> (array of strings).</p>
<p>The following fragment is an example of using <code>meta-keys()</code> to emit all meta values for a given stream, into an <code>Event/Meta</code> element:</p>
<pre><code class="language-xml">&lt;Event&gt;
  &lt;xsl:variable name=&quot;metaKeys&quot; select=&quot;stroom:meta-keys()&quot; as=&quot;xs:string*&quot; /&gt;
  &lt;Meta&gt;
    &lt;xsl:for-each select=&quot;$metaKeys&quot;&gt;
      &lt;string key=&quot;{.}&quot;&gt;&lt;xsl:value-of select=&quot;stroom:meta(.)&quot; /&gt;&lt;/string&gt;
    &lt;/xsl:for-each&gt;
  &lt;/Meta&gt;
&lt;/Event&gt;
</code></pre>
<h2 id="parse-uri">parse-uri()</h2>
<p>The parse-uri() function takes a Uniform Resource Identifier (URI) in string form and returns an XML node with a namespace of <code>uri</code> containing the URI&rsquo;s individual components of <code>authority</code>, <code>fragment</code>, <code>host</code>, <code>path</code>, <code>port</code>, <code>query</code>, <code>scheme</code>, <code>schemeSpecificPart</code> and <code>userInfo</code>. See either <a href="http://www.ietf.org/rfc/rfc2396.txt">RFC 2306: Uniform Resource Identifiers (URI): Generic Syntax</a> or Java&rsquo;s java.net.URI Class for details regarding the components.</p>
<p>The following xml</p>
<pre><code class="language-xml">&lt;!-- Display and parse the URI contained within the text of the rURI element --&gt;
&lt;xsl:variable name=&quot;u&quot; select=&quot;stroom:parseUri(rURI)&quot; /&gt;

&lt;URI&gt;
  &lt;xsl:value-of select=&quot;rURI&quot; /&gt;
&lt;/URI&gt;
&lt;URIDetail&gt;
  &lt;xsl:copy-of select=&quot;$v&quot;/&gt;
&lt;/URIDetail&gt;
</code></pre>
<p>given the rURI text contains</p>
<pre><code>   http://foo:bar@w1.superman.com:8080/very/long/path.html?p1=v1&amp;amp;p2=v2#more-details
</code></pre>
<p>would provide</p>
<pre><code class="language-xml">&lt;URL&gt;http://foo:bar@w1.superman.com:8080/very/long/path.html?p1=v1&amp;amp;p2=v2#more-details&lt;/URL&gt;
&lt;URIDetail&gt;
  &lt;authority xmlns=&quot;uri&quot;&gt;foo:bar@w1.superman.com:8080&lt;/authority&gt;
  &lt;fragment xmlns=&quot;uri&quot;&gt;more-details&lt;/fragment&gt;
  &lt;host xmlns=&quot;uri&quot;&gt;w1.superman.com&lt;/host&gt;
  &lt;path xmlns=&quot;uri&quot;&gt;/very/long/path.html&lt;/path&gt;
  &lt;port xmlns=&quot;uri&quot;&gt;8080&lt;/port&gt;
  &lt;query xmlns=&quot;uri&quot;&gt;p1=v1&amp;amp;p2=v2&lt;/query&gt;
  &lt;scheme xmlns=&quot;uri&quot;&gt;http&lt;/scheme&gt;
  &lt;schemeSpecificPart xmlns=&quot;uri&quot;&gt;//foo:bar@w1.superman.com:8080/very/long/path.html?p1=v1&amp;amp;p2=v2&lt;/schemeSpecificPart&gt;
  &lt;userInfo xmlns=&quot;uri&quot;&gt;foo:bar&lt;/userInfo&gt;
&lt;/URIDetail&gt;
</code></pre>
<h2 id="pointisinsidexypolygon">pointIsInsideXYPolygon()</h2>
<p>Returns true if the specified point is inside the specified polygon.
Useful for determining if a user is inside a physical zone based on their location and the boundary of that zone.</p>
<pre><code class="language-text">pointIsInsideXYPolygon(Number xPos, Number yPos, Number[] xPolyData, Number[] yPolyData)
</code></pre>
<p>Arguments:</p>
<ul>
<li><code>xPos</code> - The X value of the point to be tested.</li>
<li><code>yPos</code> - The Y value of the point to be tested.</li>
<li><code>xPolyData</code> - A sequence of X values that define the polygon.</li>
<li><code>yPolyData</code> - A sequence of Y values that define the polygon.</li>
</ul>
<p>The list of values supplied for <code>xPolyData</code> must correspond with the list of values supplied for <code>yPolyData</code>.
The points that define the polygon must be provided in order, i.e. starting from one point on the polygon and then traveling round the path of the polygon until it gets back to the beginning.</p>
<!-- TODO add example XSLT -->

</div>




    
	
  
    
    
	
    



<div class="td-content" style="--base-section-num: '3.'; page-break-before: always">
    
  <h1 id="pg-3f52cd945d5eabe8bb9a84799caa130e">3 - XSLT Includes</h1>
    <div class="lead">Using an XSLT import to include XSLT from another translation.</div>
	<p>You can use an XSLT import to include XSLT from another translation.
E.g.:</p>
<pre><code class="language-xml">&lt;xsl:import href=&quot;ApacheAccessCommon&quot; /&gt;
</code></pre>
<p>This would include the XSLT from the ApacheAccessCommon translation.</p>

</div>




    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/gchq/stroom" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2024 Crown Copyright All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    

<script src='../../../../../js/popper.min.js'></script>
<script src='../../../../../js/bootstrap.min.js'></script>






<script src='../../../../../js/tabpane-persist.js'></script>




















<script src="../../../../../js/main.min.cbc1d428d83561c4dec32da9374290554119d7483329f849251cb7153b2ecd07.js" integrity="sha256-y8HUKNg1YcTewy2pN0KQVUEZ10gzKfhJJRy3FTsuzQc=" crossorigin="anonymous"></script>



<script src='../../../../../js/prism.js'></script>



  </body>
</html>
